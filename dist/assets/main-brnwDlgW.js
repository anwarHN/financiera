function aw(t,e){for(var n=0;n<e.length;n++){const s=e[n];if(typeof s!="string"&&!Array.isArray(s)){for(const r in s)if(r!=="default"&&!(r in t)){const a=Object.getOwnPropertyDescriptor(s,r);a&&Object.defineProperty(t,r,a.get?a:{enumerable:!0,get:()=>s[r]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function n(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(r){if(r.ep)return;r.ep=!0;const a=n(r);fetch(r.href,a)}})();function ow(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var yd={exports:{}},_a={},vd={exports:{}},Ne={};var qm;function lw(){if(qm)return Ne;qm=1;var t=Symbol.for("react.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),g=Symbol.iterator;function y(W){return W===null||typeof W!="object"?null:(W=g&&W[g]||W["@@iterator"],typeof W=="function"?W:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_=Object.assign,S={};function b(W,B,le){this.props=W,this.context=B,this.refs=S,this.updater=le||x}b.prototype.isReactComponent={},b.prototype.setState=function(W,B){if(typeof W!="object"&&typeof W!="function"&&W!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,W,B,"setState")},b.prototype.forceUpdate=function(W){this.updater.enqueueForceUpdate(this,W,"forceUpdate")};function k(){}k.prototype=b.prototype;function I(W,B,le){this.props=W,this.context=B,this.refs=S,this.updater=le||x}var C=I.prototype=new k;C.constructor=I,_(C,b.prototype),C.isPureReactComponent=!0;var N=Array.isArray,O=Object.prototype.hasOwnProperty,U={current:null},E={key:!0,ref:!0,__self:!0,__source:!0};function L(W,B,le){var ae,ge={},_e=null,De=null;if(B!=null)for(ae in B.ref!==void 0&&(De=B.ref),B.key!==void 0&&(_e=""+B.key),B)O.call(B,ae)&&!E.hasOwnProperty(ae)&&(ge[ae]=B[ae]);var Te=arguments.length-2;if(Te===1)ge.children=le;else if(1<Te){for(var Fe=Array(Te),mt=0;mt<Te;mt++)Fe[mt]=arguments[mt+2];ge.children=Fe}if(W&&W.defaultProps)for(ae in Te=W.defaultProps,Te)ge[ae]===void 0&&(ge[ae]=Te[ae]);return{$$typeof:t,type:W,key:_e,ref:De,props:ge,_owner:U.current}}function R(W,B){return{$$typeof:t,type:W.type,key:B,ref:W.ref,props:W.props,_owner:W._owner}}function T(W){return typeof W=="object"&&W!==null&&W.$$typeof===t}function D(W){var B={"=":"=0",":":"=2"};return"$"+W.replace(/[=:]/g,function(le){return B[le]})}var Y=/\/+/g;function se(W,B){return typeof W=="object"&&W!==null&&W.key!=null?D(""+W.key):B.toString(36)}function H(W,B,le,ae,ge){var _e=typeof W;(_e==="undefined"||_e==="boolean")&&(W=null);var De=!1;if(W===null)De=!0;else switch(_e){case"string":case"number":De=!0;break;case"object":switch(W.$$typeof){case t:case e:De=!0}}if(De)return De=W,ge=ge(De),W=ae===""?"."+se(De,0):ae,N(ge)?(le="",W!=null&&(le=W.replace(Y,"$&/")+"/"),H(ge,B,le,"",function(mt){return mt})):ge!=null&&(T(ge)&&(ge=R(ge,le+(!ge.key||De&&De.key===ge.key?"":(""+ge.key).replace(Y,"$&/")+"/")+W)),B.push(ge)),1;if(De=0,ae=ae===""?".":ae+":",N(W))for(var Te=0;Te<W.length;Te++){_e=W[Te];var Fe=ae+se(_e,Te);De+=H(_e,B,le,Fe,ge)}else if(Fe=y(W),typeof Fe=="function")for(W=Fe.call(W),Te=0;!(_e=W.next()).done;)_e=_e.value,Fe=ae+se(_e,Te++),De+=H(_e,B,le,Fe,ge);else if(_e==="object")throw B=String(W),Error("Objects are not valid as a React child (found: "+(B==="[object Object]"?"object with keys {"+Object.keys(W).join(", ")+"}":B)+"). If you meant to render a collection of children, use an array instead.");return De}function J(W,B,le){if(W==null)return W;var ae=[],ge=0;return H(W,ae,"","",function(_e){return B.call(le,_e,ge++)}),ae}function ee(W){if(W._status===-1){var B=W._result;B=B(),B.then(function(le){(W._status===0||W._status===-1)&&(W._status=1,W._result=le)},function(le){(W._status===0||W._status===-1)&&(W._status=2,W._result=le)}),W._status===-1&&(W._status=0,W._result=B)}if(W._status===1)return W._result.default;throw W._result}var he={current:null},Z={transition:null},oe={ReactCurrentDispatcher:he,ReactCurrentBatchConfig:Z,ReactCurrentOwner:U};function ie(){throw Error("act(...) is not supported in production builds of React.")}return Ne.Children={map:J,forEach:function(W,B,le){J(W,function(){B.apply(this,arguments)},le)},count:function(W){var B=0;return J(W,function(){B++}),B},toArray:function(W){return J(W,function(B){return B})||[]},only:function(W){if(!T(W))throw Error("React.Children.only expected to receive a single React element child.");return W}},Ne.Component=b,Ne.Fragment=n,Ne.Profiler=r,Ne.PureComponent=I,Ne.StrictMode=s,Ne.Suspense=d,Ne.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=oe,Ne.act=ie,Ne.cloneElement=function(W,B,le){if(W==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+W+".");var ae=_({},W.props),ge=W.key,_e=W.ref,De=W._owner;if(B!=null){if(B.ref!==void 0&&(_e=B.ref,De=U.current),B.key!==void 0&&(ge=""+B.key),W.type&&W.type.defaultProps)var Te=W.type.defaultProps;for(Fe in B)O.call(B,Fe)&&!E.hasOwnProperty(Fe)&&(ae[Fe]=B[Fe]===void 0&&Te!==void 0?Te[Fe]:B[Fe])}var Fe=arguments.length-2;if(Fe===1)ae.children=le;else if(1<Fe){Te=Array(Fe);for(var mt=0;mt<Fe;mt++)Te[mt]=arguments[mt+2];ae.children=Te}return{$$typeof:t,type:W.type,key:ge,ref:_e,props:ae,_owner:De}},Ne.createContext=function(W){return W={$$typeof:l,_currentValue:W,_currentValue2:W,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},W.Provider={$$typeof:a,_context:W},W.Consumer=W},Ne.createElement=L,Ne.createFactory=function(W){var B=L.bind(null,W);return B.type=W,B},Ne.createRef=function(){return{current:null}},Ne.forwardRef=function(W){return{$$typeof:c,render:W}},Ne.isValidElement=T,Ne.lazy=function(W){return{$$typeof:m,_payload:{_status:-1,_result:W},_init:ee}},Ne.memo=function(W,B){return{$$typeof:f,type:W,compare:B===void 0?null:B}},Ne.startTransition=function(W){var B=Z.transition;Z.transition={};try{W()}finally{Z.transition=B}},Ne.unstable_act=ie,Ne.useCallback=function(W,B){return he.current.useCallback(W,B)},Ne.useContext=function(W){return he.current.useContext(W)},Ne.useDebugValue=function(){},Ne.useDeferredValue=function(W){return he.current.useDeferredValue(W)},Ne.useEffect=function(W,B){return he.current.useEffect(W,B)},Ne.useId=function(){return he.current.useId()},Ne.useImperativeHandle=function(W,B,le){return he.current.useImperativeHandle(W,B,le)},Ne.useInsertionEffect=function(W,B){return he.current.useInsertionEffect(W,B)},Ne.useLayoutEffect=function(W,B){return he.current.useLayoutEffect(W,B)},Ne.useMemo=function(W,B){return he.current.useMemo(W,B)},Ne.useReducer=function(W,B,le){return he.current.useReducer(W,B,le)},Ne.useRef=function(W){return he.current.useRef(W)},Ne.useState=function(W){return he.current.useState(W)},Ne.useSyncExternalStore=function(W,B,le){return he.current.useSyncExternalStore(W,B,le)},Ne.useTransition=function(){return he.current.useTransition()},Ne.version="18.3.1",Ne}var Hm;function Bh(){return Hm||(Hm=1,vd.exports=lw()),vd.exports}var Km;function cw(){if(Km)return _a;Km=1;var t=Bh(),e=Symbol.for("react.element"),n=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,r=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function l(c,d,f){var m,g={},y=null,x=null;f!==void 0&&(y=""+f),d.key!==void 0&&(y=""+d.key),d.ref!==void 0&&(x=d.ref);for(m in d)s.call(d,m)&&!a.hasOwnProperty(m)&&(g[m]=d[m]);if(c&&c.defaultProps)for(m in d=c.defaultProps,d)g[m]===void 0&&(g[m]=d[m]);return{$$typeof:e,type:c,key:y,ref:x,props:g,_owner:r.current}}return _a.Fragment=n,_a.jsx=l,_a.jsxs=l,_a}var Gm;function uw(){return Gm||(Gm=1,yd.exports=cw()),yd.exports}var u=uw(),j=Bh();const Es=ow(j),dw=aw({__proto__:null,default:Es},[j]);var jl={},xd={exports:{}},en={},bd={exports:{}},wd={};var Ym;function hw(){return Ym||(Ym=1,(function(t){function e(Z,oe){var ie=Z.length;Z.push(oe);e:for(;0<ie;){var W=ie-1>>>1,B=Z[W];if(0<r(B,oe))Z[W]=oe,Z[ie]=B,ie=W;else break e}}function n(Z){return Z.length===0?null:Z[0]}function s(Z){if(Z.length===0)return null;var oe=Z[0],ie=Z.pop();if(ie!==oe){Z[0]=ie;e:for(var W=0,B=Z.length,le=B>>>1;W<le;){var ae=2*(W+1)-1,ge=Z[ae],_e=ae+1,De=Z[_e];if(0>r(ge,ie))_e<B&&0>r(De,ge)?(Z[W]=De,Z[_e]=ie,W=_e):(Z[W]=ge,Z[ae]=ie,W=ae);else if(_e<B&&0>r(De,ie))Z[W]=De,Z[_e]=ie,W=_e;else break e}}return oe}function r(Z,oe){var ie=Z.sortIndex-oe.sortIndex;return ie!==0?ie:Z.id-oe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var l=Date,c=l.now();t.unstable_now=function(){return l.now()-c}}var d=[],f=[],m=1,g=null,y=3,x=!1,_=!1,S=!1,b=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function C(Z){for(var oe=n(f);oe!==null;){if(oe.callback===null)s(f);else if(oe.startTime<=Z)s(f),oe.sortIndex=oe.expirationTime,e(d,oe);else break;oe=n(f)}}function N(Z){if(S=!1,C(Z),!_)if(n(d)!==null)_=!0,ee(O);else{var oe=n(f);oe!==null&&he(N,oe.startTime-Z)}}function O(Z,oe){_=!1,S&&(S=!1,k(L),L=-1),x=!0;var ie=y;try{for(C(oe),g=n(d);g!==null&&(!(g.expirationTime>oe)||Z&&!D());){var W=g.callback;if(typeof W=="function"){g.callback=null,y=g.priorityLevel;var B=W(g.expirationTime<=oe);oe=t.unstable_now(),typeof B=="function"?g.callback=B:g===n(d)&&s(d),C(oe)}else s(d);g=n(d)}if(g!==null)var le=!0;else{var ae=n(f);ae!==null&&he(N,ae.startTime-oe),le=!1}return le}finally{g=null,y=ie,x=!1}}var U=!1,E=null,L=-1,R=5,T=-1;function D(){return!(t.unstable_now()-T<R)}function Y(){if(E!==null){var Z=t.unstable_now();T=Z;var oe=!0;try{oe=E(!0,Z)}finally{oe?se():(U=!1,E=null)}}else U=!1}var se;if(typeof I=="function")se=function(){I(Y)};else if(typeof MessageChannel<"u"){var H=new MessageChannel,J=H.port2;H.port1.onmessage=Y,se=function(){J.postMessage(null)}}else se=function(){b(Y,0)};function ee(Z){E=Z,U||(U=!0,se())}function he(Z,oe){L=b(function(){Z(t.unstable_now())},oe)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Z){Z.callback=null},t.unstable_continueExecution=function(){_||x||(_=!0,ee(O))},t.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<Z?Math.floor(1e3/Z):5},t.unstable_getCurrentPriorityLevel=function(){return y},t.unstable_getFirstCallbackNode=function(){return n(d)},t.unstable_next=function(Z){switch(y){case 1:case 2:case 3:var oe=3;break;default:oe=y}var ie=y;y=oe;try{return Z()}finally{y=ie}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Z,oe){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var ie=y;y=Z;try{return oe()}finally{y=ie}},t.unstable_scheduleCallback=function(Z,oe,ie){var W=t.unstable_now();switch(typeof ie=="object"&&ie!==null?(ie=ie.delay,ie=typeof ie=="number"&&0<ie?W+ie:W):ie=W,Z){case 1:var B=-1;break;case 2:B=250;break;case 5:B=1073741823;break;case 4:B=1e4;break;default:B=5e3}return B=ie+B,Z={id:m++,callback:oe,priorityLevel:Z,startTime:ie,expirationTime:B,sortIndex:-1},ie>W?(Z.sortIndex=ie,e(f,Z),n(d)===null&&Z===n(f)&&(S?(k(L),L=-1):S=!0,he(N,ie-W))):(Z.sortIndex=B,e(d,Z),_||x||(_=!0,ee(O))),Z},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(Z){var oe=y;return function(){var ie=y;y=oe;try{return Z.apply(this,arguments)}finally{y=ie}}}})(wd)),wd}var Jm;function fw(){return Jm||(Jm=1,bd.exports=hw()),bd.exports}var Xm;function pw(){if(Xm)return en;Xm=1;var t=Bh(),e=fw();function n(i){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+i,h=1;h<arguments.length;h++)o+="&args[]="+encodeURIComponent(arguments[h]);return"Minified React error #"+i+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,r={};function a(i,o){l(i,o),l(i+"Capture",o)}function l(i,o){for(r[i]=o,i=0;i<o.length;i++)s.add(o[i])}var c=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),d=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m={},g={};function y(i){return d.call(g,i)?!0:d.call(m,i)?!1:f.test(i)?g[i]=!0:(m[i]=!0,!1)}function x(i,o,h,p){if(h!==null&&h.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return p?!1:h!==null?!h.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function _(i,o,h,p){if(o===null||typeof o>"u"||x(i,o,h,p))return!0;if(p)return!1;if(h!==null)switch(h.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function S(i,o,h,p,v,w,P){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=p,this.attributeNamespace=v,this.mustUseProperty=h,this.propertyName=i,this.type=o,this.sanitizeURL=w,this.removeEmptyString=P}var b={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){b[i]=new S(i,0,!1,i,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var o=i[0];b[o]=new S(o,1,!1,i[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(i){b[i]=new S(i,2,!1,i.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){b[i]=new S(i,2,!1,i,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){b[i]=new S(i,3,!1,i.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(i){b[i]=new S(i,3,!0,i,null,!1,!1)}),["capture","download"].forEach(function(i){b[i]=new S(i,4,!1,i,null,!1,!1)}),["cols","rows","size","span"].forEach(function(i){b[i]=new S(i,6,!1,i,null,!1,!1)}),["rowSpan","start"].forEach(function(i){b[i]=new S(i,5,!1,i.toLowerCase(),null,!1,!1)});var k=/[\-:]([a-z])/g;function I(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var o=i.replace(k,I);b[o]=new S(o,1,!1,i,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var o=i.replace(k,I);b[o]=new S(o,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(i){var o=i.replace(k,I);b[o]=new S(o,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(i){b[i]=new S(i,1,!1,i.toLowerCase(),null,!1,!1)}),b.xlinkHref=new S("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(i){b[i]=new S(i,1,!1,i.toLowerCase(),null,!0,!0)});function C(i,o,h,p){var v=b.hasOwnProperty(o)?b[o]:null;(v!==null?v.type!==0:p||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(_(o,h,v,p)&&(h=null),p||v===null?y(o)&&(h===null?i.removeAttribute(o):i.setAttribute(o,""+h)):v.mustUseProperty?i[v.propertyName]=h===null?v.type===3?!1:"":h:(o=v.attributeName,p=v.attributeNamespace,h===null?i.removeAttribute(o):(v=v.type,h=v===3||v===4&&h===!0?"":""+h,p?i.setAttributeNS(p,o,h):i.setAttribute(o,h))))}var N=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,O=Symbol.for("react.element"),U=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),L=Symbol.for("react.strict_mode"),R=Symbol.for("react.profiler"),T=Symbol.for("react.provider"),D=Symbol.for("react.context"),Y=Symbol.for("react.forward_ref"),se=Symbol.for("react.suspense"),H=Symbol.for("react.suspense_list"),J=Symbol.for("react.memo"),ee=Symbol.for("react.lazy"),he=Symbol.for("react.offscreen"),Z=Symbol.iterator;function oe(i){return i===null||typeof i!="object"?null:(i=Z&&i[Z]||i["@@iterator"],typeof i=="function"?i:null)}var ie=Object.assign,W;function B(i){if(W===void 0)try{throw Error()}catch(h){var o=h.stack.trim().match(/\n( *(at )?)/);W=o&&o[1]||""}return`
`+W+i}var le=!1;function ae(i,o){if(!i||le)return"";le=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(K){var p=K}Reflect.construct(i,[],o)}else{try{o.call()}catch(K){p=K}i.call(o.prototype)}else{try{throw Error()}catch(K){p=K}i()}}catch(K){if(K&&p&&typeof K.stack=="string"){for(var v=K.stack.split(`
`),w=p.stack.split(`
`),P=v.length-1,A=w.length-1;1<=P&&0<=A&&v[P]!==w[A];)A--;for(;1<=P&&0<=A;P--,A--)if(v[P]!==w[A]){if(P!==1||A!==1)do if(P--,A--,0>A||v[P]!==w[A]){var F=`
`+v[P].replace(" at new "," at ");return i.displayName&&F.includes("<anonymous>")&&(F=F.replace("<anonymous>",i.displayName)),F}while(1<=P&&0<=A);break}}}finally{le=!1,Error.prepareStackTrace=h}return(i=i?i.displayName||i.name:"")?B(i):""}function ge(i){switch(i.tag){case 5:return B(i.type);case 16:return B("Lazy");case 13:return B("Suspense");case 19:return B("SuspenseList");case 0:case 2:case 15:return i=ae(i.type,!1),i;case 11:return i=ae(i.type.render,!1),i;case 1:return i=ae(i.type,!0),i;default:return""}}function _e(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case E:return"Fragment";case U:return"Portal";case R:return"Profiler";case L:return"StrictMode";case se:return"Suspense";case H:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case D:return(i.displayName||"Context")+".Consumer";case T:return(i._context.displayName||"Context")+".Provider";case Y:var o=i.render;return i=i.displayName,i||(i=o.displayName||o.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case J:return o=i.displayName||null,o!==null?o:_e(i.type)||"Memo";case ee:o=i._payload,i=i._init;try{return _e(i(o))}catch{}}return null}function De(i){var o=i.type;switch(i.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=o.render,i=i.displayName||i.name||"",o.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return _e(o);case 8:return o===L?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function Te(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Fe(i){var o=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function mt(i){var o=Fe(i)?"checked":"value",h=Object.getOwnPropertyDescriptor(i.constructor.prototype,o),p=""+i[o];if(!i.hasOwnProperty(o)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var v=h.get,w=h.set;return Object.defineProperty(i,o,{configurable:!0,get:function(){return v.call(this)},set:function(P){p=""+P,w.call(this,P)}}),Object.defineProperty(i,o,{enumerable:h.enumerable}),{getValue:function(){return p},setValue:function(P){p=""+P},stopTracking:function(){i._valueTracker=null,delete i[o]}}}}function Kt(i){i._valueTracker||(i._valueTracker=mt(i))}function gn(i){if(!i)return!1;var o=i._valueTracker;if(!o)return!0;var h=o.getValue(),p="";return i&&(p=Fe(i)?i.checked?"true":"false":i.value),i=p,i!==h?(o.setValue(i),!0):!1}function os(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function We(i,o){var h=o.checked;return ie({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:h??i._wrapperState.initialChecked})}function ls(i,o){var h=o.defaultValue==null?"":o.defaultValue,p=o.checked!=null?o.checked:o.defaultChecked;h=Te(o.value!=null?o.value:h),i._wrapperState={initialChecked:p,initialValue:h,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function cs(i,o){o=o.checked,o!=null&&C(i,"checked",o,!1)}function Hn(i,o){cs(i,o);var h=Te(o.value),p=o.type;if(h!=null)p==="number"?(h===0&&i.value===""||i.value!=h)&&(i.value=""+h):i.value!==""+h&&(i.value=""+h);else if(p==="submit"||p==="reset"){i.removeAttribute("value");return}o.hasOwnProperty("value")?Ut(i,o.type,h):o.hasOwnProperty("defaultValue")&&Ut(i,o.type,Te(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(i.defaultChecked=!!o.defaultChecked)}function Tn(i,o,h){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var p=o.type;if(!(p!=="submit"&&p!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+i._wrapperState.initialValue,h||o===i.value||(i.value=o),i.defaultValue=o}h=i.name,h!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,h!==""&&(i.name=h)}function Ut(i,o,h){(o!=="number"||os(i.ownerDocument)!==i)&&(h==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+h&&(i.defaultValue=""+h))}var rn=Array.isArray;function yn(i,o,h,p){if(i=i.options,o){o={};for(var v=0;v<h.length;v++)o["$"+h[v]]=!0;for(h=0;h<i.length;h++)v=o.hasOwnProperty("$"+i[h].value),i[h].selected!==v&&(i[h].selected=v),v&&p&&(i[h].defaultSelected=!0)}else{for(h=""+Te(h),o=null,v=0;v<i.length;v++){if(i[v].value===h){i[v].selected=!0,p&&(i[v].defaultSelected=!0);return}o!==null||i[v].disabled||(o=i[v])}o!==null&&(o.selected=!0)}}function us(i,o){if(o.dangerouslySetInnerHTML!=null)throw Error(n(91));return ie({},o,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function vn(i,o){var h=o.value;if(h==null){if(h=o.children,o=o.defaultValue,h!=null){if(o!=null)throw Error(n(92));if(rn(h)){if(1<h.length)throw Error(n(93));h=h[0]}o=h}o==null&&(o=""),h=o}i._wrapperState={initialValue:Te(h)}}function Gt(i,o){var h=Te(o.value),p=Te(o.defaultValue);h!=null&&(h=""+h,h!==i.value&&(i.value=h),o.defaultValue==null&&i.defaultValue!==h&&(i.defaultValue=h)),p!=null&&(i.defaultValue=""+p)}function St(i){var o=i.textContent;o===i._wrapperState.initialValue&&o!==""&&o!==null&&(i.value=o)}function Ot(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function xn(i,o){return i==null||i==="http://www.w3.org/1999/xhtml"?Ot(o):i==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var bn,gr=(function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,h,p,v){MSApp.execUnsafeLocalFunction(function(){return i(o,h,p,v)})}:i})(function(i,o){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=o;else{for(bn=bn||document.createElement("div"),bn.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=bn.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;o.firstChild;)i.appendChild(o.firstChild)}});function an(i,o){if(o){var h=i.firstChild;if(h&&h===i.lastChild&&h.nodeType===3){h.nodeValue=o;return}}i.textContent=o}var Kn={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Os=["Webkit","ms","Moz","O"];Object.keys(Kn).forEach(function(i){Os.forEach(function(o){o=o+i.charAt(0).toUpperCase()+i.substring(1),Kn[o]=Kn[i]})});function Jr(i,o,h){return o==null||typeof o=="boolean"||o===""?"":h||typeof o!="number"||o===0||Kn.hasOwnProperty(i)&&Kn[i]?(""+o).trim():o+"px"}function gt(i,o){i=i.style;for(var h in o)if(o.hasOwnProperty(h)){var p=h.indexOf("--")===0,v=Jr(h,o[h],p);h==="float"&&(h="cssFloat"),p?i.setProperty(h,v):i[h]=v}}var Rs=ie({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ms(i,o){if(o){if(Rs[i]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(n(137,i));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(n(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(n(61))}if(o.style!=null&&typeof o.style!="object")throw Error(n(62))}}function Gn(i,o){if(i.indexOf("-")===-1)return typeof o.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var z=null;function xe(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Be=null,Ve=null,wn=null;function yr(i){if(i=oa(i)){if(typeof Be!="function")throw Error(n(280));var o=i.stateNode;o&&(o=$o(o),Be(i.stateNode,i.type,o))}}function Xr(i){Ve?wn?wn.push(i):wn=[i]:Ve=i}function xo(){if(Ve){var i=Ve,o=wn;if(wn=Ve=null,yr(i),o)for(i=0;i<o.length;i++)yr(o[i])}}function M(i,o){return i(o)}function ne(){}var ce=!1;function je(i,o,h){if(ce)return i(o,h);ce=!0;try{return M(i,o,h)}finally{ce=!1,(Ve!==null||wn!==null)&&(ne(),xo())}}function Me(i,o){var h=i.stateNode;if(h===null)return null;var p=$o(h);if(p===null)return null;h=p[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(i=i.type,p=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!p;break e;default:i=!1}if(i)return null;if(h&&typeof h!="function")throw Error(n(231,o,typeof h));return h}var ot=!1;if(c)try{var Wt={};Object.defineProperty(Wt,"passive",{get:function(){ot=!0}}),window.addEventListener("test",Wt,Wt),window.removeEventListener("test",Wt,Wt)}catch{ot=!1}function Ls(i,o,h,p,v,w,P,A,F){var K=Array.prototype.slice.call(arguments,3);try{o.apply(h,K)}catch(Q){this.onError(Q)}}var Nn=!1,ds=null,Yn=!1,vr=null,Mc={onError:function(i){Nn=!0,ds=i}};function Lc(i,o,h,p,v,w,P,A,F){Nn=!1,ds=null,Ls.apply(Mc,arguments)}function mb(i,o,h,p,v,w,P,A,F){if(Lc.apply(this,arguments),Nn){if(Nn){var K=ds;Nn=!1,ds=null}else throw Error(n(198));Yn||(Yn=!0,vr=K)}}function xr(i){var o=i,h=i;if(i.alternate)for(;o.return;)o=o.return;else{i=o;do o=i,(o.flags&4098)!==0&&(h=o.return),i=o.return;while(i)}return o.tag===3?h:null}function pf(i){if(i.tag===13){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function mf(i){if(xr(i)!==i)throw Error(n(188))}function gb(i){var o=i.alternate;if(!o){if(o=xr(i),o===null)throw Error(n(188));return o!==i?null:i}for(var h=i,p=o;;){var v=h.return;if(v===null)break;var w=v.alternate;if(w===null){if(p=v.return,p!==null){h=p;continue}break}if(v.child===w.child){for(w=v.child;w;){if(w===h)return mf(v),i;if(w===p)return mf(v),o;w=w.sibling}throw Error(n(188))}if(h.return!==p.return)h=v,p=w;else{for(var P=!1,A=v.child;A;){if(A===h){P=!0,h=v,p=w;break}if(A===p){P=!0,p=v,h=w;break}A=A.sibling}if(!P){for(A=w.child;A;){if(A===h){P=!0,h=w,p=v;break}if(A===p){P=!0,p=w,h=v;break}A=A.sibling}if(!P)throw Error(n(189))}}if(h.alternate!==p)throw Error(n(190))}if(h.tag!==3)throw Error(n(188));return h.stateNode.current===h?i:o}function gf(i){return i=gb(i),i!==null?yf(i):null}function yf(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var o=yf(i);if(o!==null)return o;i=i.sibling}return null}var vf=e.unstable_scheduleCallback,xf=e.unstable_cancelCallback,yb=e.unstable_shouldYield,vb=e.unstable_requestPaint,ht=e.unstable_now,xb=e.unstable_getCurrentPriorityLevel,Dc=e.unstable_ImmediatePriority,bf=e.unstable_UserBlockingPriority,bo=e.unstable_NormalPriority,bb=e.unstable_LowPriority,wf=e.unstable_IdlePriority,wo=null,Jn=null;function wb(i){if(Jn&&typeof Jn.onCommitFiberRoot=="function")try{Jn.onCommitFiberRoot(wo,i,void 0,(i.current.flags&128)===128)}catch{}}var An=Math.clz32?Math.clz32:kb,_b=Math.log,Sb=Math.LN2;function kb(i){return i>>>=0,i===0?32:31-(_b(i)/Sb|0)|0}var _o=64,So=4194304;function Wi(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function ko(i,o){var h=i.pendingLanes;if(h===0)return 0;var p=0,v=i.suspendedLanes,w=i.pingedLanes,P=h&268435455;if(P!==0){var A=P&~v;A!==0?p=Wi(A):(w&=P,w!==0&&(p=Wi(w)))}else P=h&~v,P!==0?p=Wi(P):w!==0&&(p=Wi(w));if(p===0)return 0;if(o!==0&&o!==p&&(o&v)===0&&(v=p&-p,w=o&-o,v>=w||v===16&&(w&4194240)!==0))return o;if((p&4)!==0&&(p|=h&16),o=i.entangledLanes,o!==0)for(i=i.entanglements,o&=p;0<o;)h=31-An(o),v=1<<h,p|=i[h],o&=~v;return p}function jb(i,o){switch(i){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Cb(i,o){for(var h=i.suspendedLanes,p=i.pingedLanes,v=i.expirationTimes,w=i.pendingLanes;0<w;){var P=31-An(w),A=1<<P,F=v[P];F===-1?((A&h)===0||(A&p)!==0)&&(v[P]=jb(A,o)):F<=o&&(i.expiredLanes|=A),w&=~A}}function Fc(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function _f(){var i=_o;return _o<<=1,(_o&4194240)===0&&(_o=64),i}function Bc(i){for(var o=[],h=0;31>h;h++)o.push(i);return o}function Vi(i,o,h){i.pendingLanes|=o,o!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,o=31-An(o),i[o]=h}function Pb(i,o){var h=i.pendingLanes&~o;i.pendingLanes=o,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=o,i.mutableReadLanes&=o,i.entangledLanes&=o,o=i.entanglements;var p=i.eventTimes;for(i=i.expirationTimes;0<h;){var v=31-An(h),w=1<<v;o[v]=0,p[v]=-1,i[v]=-1,h&=~w}}function $c(i,o){var h=i.entangledLanes|=o;for(i=i.entanglements;h;){var p=31-An(h),v=1<<p;v&o|i[p]&o&&(i[p]|=o),h&=~v}}var qe=0;function Sf(i){return i&=-i,1<i?4<i?(i&268435455)!==0?16:536870912:4:1}var kf,zc,jf,Cf,Pf,Uc=!1,jo=[],Ds=null,Fs=null,Bs=null,qi=new Map,Hi=new Map,$s=[],Ib="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function If(i,o){switch(i){case"focusin":case"focusout":Ds=null;break;case"dragenter":case"dragleave":Fs=null;break;case"mouseover":case"mouseout":Bs=null;break;case"pointerover":case"pointerout":qi.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Hi.delete(o.pointerId)}}function Ki(i,o,h,p,v,w){return i===null||i.nativeEvent!==w?(i={blockedOn:o,domEventName:h,eventSystemFlags:p,nativeEvent:w,targetContainers:[v]},o!==null&&(o=oa(o),o!==null&&zc(o)),i):(i.eventSystemFlags|=p,o=i.targetContainers,v!==null&&o.indexOf(v)===-1&&o.push(v),i)}function Eb(i,o,h,p,v){switch(o){case"focusin":return Ds=Ki(Ds,i,o,h,p,v),!0;case"dragenter":return Fs=Ki(Fs,i,o,h,p,v),!0;case"mouseover":return Bs=Ki(Bs,i,o,h,p,v),!0;case"pointerover":var w=v.pointerId;return qi.set(w,Ki(qi.get(w)||null,i,o,h,p,v)),!0;case"gotpointercapture":return w=v.pointerId,Hi.set(w,Ki(Hi.get(w)||null,i,o,h,p,v)),!0}return!1}function Ef(i){var o=br(i.target);if(o!==null){var h=xr(o);if(h!==null){if(o=h.tag,o===13){if(o=pf(h),o!==null){i.blockedOn=o,Pf(i.priority,function(){jf(h)});return}}else if(o===3&&h.stateNode.current.memoizedState.isDehydrated){i.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Co(i){if(i.blockedOn!==null)return!1;for(var o=i.targetContainers;0<o.length;){var h=Vc(i.domEventName,i.eventSystemFlags,o[0],i.nativeEvent);if(h===null){h=i.nativeEvent;var p=new h.constructor(h.type,h);z=p,h.target.dispatchEvent(p),z=null}else return o=oa(h),o!==null&&zc(o),i.blockedOn=h,!1;o.shift()}return!0}function Tf(i,o,h){Co(i)&&h.delete(o)}function Tb(){Uc=!1,Ds!==null&&Co(Ds)&&(Ds=null),Fs!==null&&Co(Fs)&&(Fs=null),Bs!==null&&Co(Bs)&&(Bs=null),qi.forEach(Tf),Hi.forEach(Tf)}function Gi(i,o){i.blockedOn===o&&(i.blockedOn=null,Uc||(Uc=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Tb)))}function Yi(i){function o(v){return Gi(v,i)}if(0<jo.length){Gi(jo[0],i);for(var h=1;h<jo.length;h++){var p=jo[h];p.blockedOn===i&&(p.blockedOn=null)}}for(Ds!==null&&Gi(Ds,i),Fs!==null&&Gi(Fs,i),Bs!==null&&Gi(Bs,i),qi.forEach(o),Hi.forEach(o),h=0;h<$s.length;h++)p=$s[h],p.blockedOn===i&&(p.blockedOn=null);for(;0<$s.length&&(h=$s[0],h.blockedOn===null);)Ef(h),h.blockedOn===null&&$s.shift()}var Qr=N.ReactCurrentBatchConfig,Po=!0;function Nb(i,o,h,p){var v=qe,w=Qr.transition;Qr.transition=null;try{qe=1,Wc(i,o,h,p)}finally{qe=v,Qr.transition=w}}function Ab(i,o,h,p){var v=qe,w=Qr.transition;Qr.transition=null;try{qe=4,Wc(i,o,h,p)}finally{qe=v,Qr.transition=w}}function Wc(i,o,h,p){if(Po){var v=Vc(i,o,h,p);if(v===null)ou(i,o,p,Io,h),If(i,p);else if(Eb(v,i,o,h,p))p.stopPropagation();else if(If(i,p),o&4&&-1<Ib.indexOf(i)){for(;v!==null;){var w=oa(v);if(w!==null&&kf(w),w=Vc(i,o,h,p),w===null&&ou(i,o,p,Io,h),w===v)break;v=w}v!==null&&p.stopPropagation()}else ou(i,o,p,null,h)}}var Io=null;function Vc(i,o,h,p){if(Io=null,i=xe(p),i=br(i),i!==null)if(o=xr(i),o===null)i=null;else if(h=o.tag,h===13){if(i=pf(o),i!==null)return i;i=null}else if(h===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;i=null}else o!==i&&(i=null);return Io=i,null}function Nf(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(xb()){case Dc:return 1;case bf:return 4;case bo:case bb:return 16;case wf:return 536870912;default:return 16}default:return 16}}var zs=null,qc=null,Eo=null;function Af(){if(Eo)return Eo;var i,o=qc,h=o.length,p,v="value"in zs?zs.value:zs.textContent,w=v.length;for(i=0;i<h&&o[i]===v[i];i++);var P=h-i;for(p=1;p<=P&&o[h-p]===v[w-p];p++);return Eo=v.slice(i,1<p?1-p:void 0)}function To(i){var o=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&o===13&&(i=13)):i=o,i===10&&(i=13),32<=i||i===13?i:0}function No(){return!0}function Of(){return!1}function on(i){function o(h,p,v,w,P){this._reactName=h,this._targetInst=v,this.type=p,this.nativeEvent=w,this.target=P,this.currentTarget=null;for(var A in i)i.hasOwnProperty(A)&&(h=i[A],this[A]=h?h(w):w[A]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?No:Of,this.isPropagationStopped=Of,this}return ie(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=No)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=No)},persist:function(){},isPersistent:No}),o}var Zr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Hc=on(Zr),Ji=ie({},Zr,{view:0,detail:0}),Ob=on(Ji),Kc,Gc,Xi,Ao=ie({},Ji,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Jc,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Xi&&(Xi&&i.type==="mousemove"?(Kc=i.screenX-Xi.screenX,Gc=i.screenY-Xi.screenY):Gc=Kc=0,Xi=i),Kc)},movementY:function(i){return"movementY"in i?i.movementY:Gc}}),Rf=on(Ao),Rb=ie({},Ao,{dataTransfer:0}),Mb=on(Rb),Lb=ie({},Ji,{relatedTarget:0}),Yc=on(Lb),Db=ie({},Zr,{animationName:0,elapsedTime:0,pseudoElement:0}),Fb=on(Db),Bb=ie({},Zr,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),$b=on(Bb),zb=ie({},Zr,{data:0}),Mf=on(zb),Ub={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Wb={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Vb={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function qb(i){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(i):(i=Vb[i])?!!o[i]:!1}function Jc(){return qb}var Hb=ie({},Ji,{key:function(i){if(i.key){var o=Ub[i.key]||i.key;if(o!=="Unidentified")return o}return i.type==="keypress"?(i=To(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?Wb[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Jc,charCode:function(i){return i.type==="keypress"?To(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?To(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),Kb=on(Hb),Gb=ie({},Ao,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Lf=on(Gb),Yb=ie({},Ji,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Jc}),Jb=on(Yb),Xb=ie({},Zr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Qb=on(Xb),Zb=ie({},Ao,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),e0=on(Zb),t0=[9,13,27,32],Xc=c&&"CompositionEvent"in window,Qi=null;c&&"documentMode"in document&&(Qi=document.documentMode);var n0=c&&"TextEvent"in window&&!Qi,Df=c&&(!Xc||Qi&&8<Qi&&11>=Qi),Ff=" ",Bf=!1;function $f(i,o){switch(i){case"keyup":return t0.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zf(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var ei=!1;function s0(i,o){switch(i){case"compositionend":return zf(o);case"keypress":return o.which!==32?null:(Bf=!0,Ff);case"textInput":return i=o.data,i===Ff&&Bf?null:i;default:return null}}function r0(i,o){if(ei)return i==="compositionend"||!Xc&&$f(i,o)?(i=Af(),Eo=qc=zs=null,ei=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Df&&o.locale!=="ko"?null:o.data;default:return null}}var i0={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Uf(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o==="input"?!!i0[i.type]:o==="textarea"}function Wf(i,o,h,p){Xr(p),o=Do(o,"onChange"),0<o.length&&(h=new Hc("onChange","change",null,h,p),i.push({event:h,listeners:o}))}var Zi=null,ea=null;function a0(i){op(i,0)}function Oo(i){var o=ii(i);if(gn(o))return i}function o0(i,o){if(i==="change")return o}var Vf=!1;if(c){var Qc;if(c){var Zc="oninput"in document;if(!Zc){var qf=document.createElement("div");qf.setAttribute("oninput","return;"),Zc=typeof qf.oninput=="function"}Qc=Zc}else Qc=!1;Vf=Qc&&(!document.documentMode||9<document.documentMode)}function Hf(){Zi&&(Zi.detachEvent("onpropertychange",Kf),ea=Zi=null)}function Kf(i){if(i.propertyName==="value"&&Oo(ea)){var o=[];Wf(o,ea,i,xe(i)),je(a0,o)}}function l0(i,o,h){i==="focusin"?(Hf(),Zi=o,ea=h,Zi.attachEvent("onpropertychange",Kf)):i==="focusout"&&Hf()}function c0(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Oo(ea)}function u0(i,o){if(i==="click")return Oo(o)}function d0(i,o){if(i==="input"||i==="change")return Oo(o)}function h0(i,o){return i===o&&(i!==0||1/i===1/o)||i!==i&&o!==o}var On=typeof Object.is=="function"?Object.is:h0;function ta(i,o){if(On(i,o))return!0;if(typeof i!="object"||i===null||typeof o!="object"||o===null)return!1;var h=Object.keys(i),p=Object.keys(o);if(h.length!==p.length)return!1;for(p=0;p<h.length;p++){var v=h[p];if(!d.call(o,v)||!On(i[v],o[v]))return!1}return!0}function Gf(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Yf(i,o){var h=Gf(i);i=0;for(var p;h;){if(h.nodeType===3){if(p=i+h.textContent.length,i<=o&&p>=o)return{node:h,offset:o-i};i=p}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=Gf(h)}}function Jf(i,o){return i&&o?i===o?!0:i&&i.nodeType===3?!1:o&&o.nodeType===3?Jf(i,o.parentNode):"contains"in i?i.contains(o):i.compareDocumentPosition?!!(i.compareDocumentPosition(o)&16):!1:!1}function Xf(){for(var i=window,o=os();o instanceof i.HTMLIFrameElement;){try{var h=typeof o.contentWindow.location.href=="string"}catch{h=!1}if(h)i=o.contentWindow;else break;o=os(i.document)}return o}function eu(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o&&(o==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||o==="textarea"||i.contentEditable==="true")}function f0(i){var o=Xf(),h=i.focusedElem,p=i.selectionRange;if(o!==h&&h&&h.ownerDocument&&Jf(h.ownerDocument.documentElement,h)){if(p!==null&&eu(h)){if(o=p.start,i=p.end,i===void 0&&(i=o),"selectionStart"in h)h.selectionStart=o,h.selectionEnd=Math.min(i,h.value.length);else if(i=(o=h.ownerDocument||document)&&o.defaultView||window,i.getSelection){i=i.getSelection();var v=h.textContent.length,w=Math.min(p.start,v);p=p.end===void 0?w:Math.min(p.end,v),!i.extend&&w>p&&(v=p,p=w,w=v),v=Yf(h,w);var P=Yf(h,p);v&&P&&(i.rangeCount!==1||i.anchorNode!==v.node||i.anchorOffset!==v.offset||i.focusNode!==P.node||i.focusOffset!==P.offset)&&(o=o.createRange(),o.setStart(v.node,v.offset),i.removeAllRanges(),w>p?(i.addRange(o),i.extend(P.node,P.offset)):(o.setEnd(P.node,P.offset),i.addRange(o)))}}for(o=[],i=h;i=i.parentNode;)i.nodeType===1&&o.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof h.focus=="function"&&h.focus(),h=0;h<o.length;h++)i=o[h],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var p0=c&&"documentMode"in document&&11>=document.documentMode,ti=null,tu=null,na=null,nu=!1;function Qf(i,o,h){var p=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;nu||ti==null||ti!==os(p)||(p=ti,"selectionStart"in p&&eu(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),na&&ta(na,p)||(na=p,p=Do(tu,"onSelect"),0<p.length&&(o=new Hc("onSelect","select",null,o,h),i.push({event:o,listeners:p}),o.target=ti)))}function Ro(i,o){var h={};return h[i.toLowerCase()]=o.toLowerCase(),h["Webkit"+i]="webkit"+o,h["Moz"+i]="moz"+o,h}var ni={animationend:Ro("Animation","AnimationEnd"),animationiteration:Ro("Animation","AnimationIteration"),animationstart:Ro("Animation","AnimationStart"),transitionend:Ro("Transition","TransitionEnd")},su={},Zf={};c&&(Zf=document.createElement("div").style,"AnimationEvent"in window||(delete ni.animationend.animation,delete ni.animationiteration.animation,delete ni.animationstart.animation),"TransitionEvent"in window||delete ni.transitionend.transition);function Mo(i){if(su[i])return su[i];if(!ni[i])return i;var o=ni[i],h;for(h in o)if(o.hasOwnProperty(h)&&h in Zf)return su[i]=o[h];return i}var ep=Mo("animationend"),tp=Mo("animationiteration"),np=Mo("animationstart"),sp=Mo("transitionend"),rp=new Map,ip="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Us(i,o){rp.set(i,o),a(o,[i])}for(var ru=0;ru<ip.length;ru++){var iu=ip[ru],m0=iu.toLowerCase(),g0=iu[0].toUpperCase()+iu.slice(1);Us(m0,"on"+g0)}Us(ep,"onAnimationEnd"),Us(tp,"onAnimationIteration"),Us(np,"onAnimationStart"),Us("dblclick","onDoubleClick"),Us("focusin","onFocus"),Us("focusout","onBlur"),Us(sp,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var sa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),y0=new Set("cancel close invalid load scroll toggle".split(" ").concat(sa));function ap(i,o,h){var p=i.type||"unknown-event";i.currentTarget=h,mb(p,o,void 0,i),i.currentTarget=null}function op(i,o){o=(o&4)!==0;for(var h=0;h<i.length;h++){var p=i[h],v=p.event;p=p.listeners;e:{var w=void 0;if(o)for(var P=p.length-1;0<=P;P--){var A=p[P],F=A.instance,K=A.currentTarget;if(A=A.listener,F!==w&&v.isPropagationStopped())break e;ap(v,A,K),w=F}else for(P=0;P<p.length;P++){if(A=p[P],F=A.instance,K=A.currentTarget,A=A.listener,F!==w&&v.isPropagationStopped())break e;ap(v,A,K),w=F}}}if(Yn)throw i=vr,Yn=!1,vr=null,i}function Je(i,o){var h=o[fu];h===void 0&&(h=o[fu]=new Set);var p=i+"__bubble";h.has(p)||(lp(o,i,2,!1),h.add(p))}function au(i,o,h){var p=0;o&&(p|=4),lp(h,i,p,o)}var Lo="_reactListening"+Math.random().toString(36).slice(2);function ra(i){if(!i[Lo]){i[Lo]=!0,s.forEach(function(h){h!=="selectionchange"&&(y0.has(h)||au(h,!1,i),au(h,!0,i))});var o=i.nodeType===9?i:i.ownerDocument;o===null||o[Lo]||(o[Lo]=!0,au("selectionchange",!1,o))}}function lp(i,o,h,p){switch(Nf(o)){case 1:var v=Nb;break;case 4:v=Ab;break;default:v=Wc}h=v.bind(null,o,h,i),v=void 0,!ot||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(v=!0),p?v!==void 0?i.addEventListener(o,h,{capture:!0,passive:v}):i.addEventListener(o,h,!0):v!==void 0?i.addEventListener(o,h,{passive:v}):i.addEventListener(o,h,!1)}function ou(i,o,h,p,v){var w=p;if((o&1)===0&&(o&2)===0&&p!==null)e:for(;;){if(p===null)return;var P=p.tag;if(P===3||P===4){var A=p.stateNode.containerInfo;if(A===v||A.nodeType===8&&A.parentNode===v)break;if(P===4)for(P=p.return;P!==null;){var F=P.tag;if((F===3||F===4)&&(F=P.stateNode.containerInfo,F===v||F.nodeType===8&&F.parentNode===v))return;P=P.return}for(;A!==null;){if(P=br(A),P===null)return;if(F=P.tag,F===5||F===6){p=w=P;continue e}A=A.parentNode}}p=p.return}je(function(){var K=w,Q=xe(h),te=[];e:{var X=rp.get(i);if(X!==void 0){var ue=Hc,pe=i;switch(i){case"keypress":if(To(h)===0)break e;case"keydown":case"keyup":ue=Kb;break;case"focusin":pe="focus",ue=Yc;break;case"focusout":pe="blur",ue=Yc;break;case"beforeblur":case"afterblur":ue=Yc;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ue=Rf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ue=Mb;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ue=Jb;break;case ep:case tp:case np:ue=Fb;break;case sp:ue=Qb;break;case"scroll":ue=Ob;break;case"wheel":ue=e0;break;case"copy":case"cut":case"paste":ue=$b;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ue=Lf}var me=(o&4)!==0,ft=!me&&i==="scroll",V=me?X!==null?X+"Capture":null:X;me=[];for(var $=K,q;$!==null;){q=$;var re=q.stateNode;if(q.tag===5&&re!==null&&(q=re,V!==null&&(re=Me($,V),re!=null&&me.push(ia($,re,q)))),ft)break;$=$.return}0<me.length&&(X=new ue(X,pe,null,h,Q),te.push({event:X,listeners:me}))}}if((o&7)===0){e:{if(X=i==="mouseover"||i==="pointerover",ue=i==="mouseout"||i==="pointerout",X&&h!==z&&(pe=h.relatedTarget||h.fromElement)&&(br(pe)||pe[hs]))break e;if((ue||X)&&(X=Q.window===Q?Q:(X=Q.ownerDocument)?X.defaultView||X.parentWindow:window,ue?(pe=h.relatedTarget||h.toElement,ue=K,pe=pe?br(pe):null,pe!==null&&(ft=xr(pe),pe!==ft||pe.tag!==5&&pe.tag!==6)&&(pe=null)):(ue=null,pe=K),ue!==pe)){if(me=Rf,re="onMouseLeave",V="onMouseEnter",$="mouse",(i==="pointerout"||i==="pointerover")&&(me=Lf,re="onPointerLeave",V="onPointerEnter",$="pointer"),ft=ue==null?X:ii(ue),q=pe==null?X:ii(pe),X=new me(re,$+"leave",ue,h,Q),X.target=ft,X.relatedTarget=q,re=null,br(Q)===K&&(me=new me(V,$+"enter",pe,h,Q),me.target=q,me.relatedTarget=ft,re=me),ft=re,ue&&pe)t:{for(me=ue,V=pe,$=0,q=me;q;q=si(q))$++;for(q=0,re=V;re;re=si(re))q++;for(;0<$-q;)me=si(me),$--;for(;0<q-$;)V=si(V),q--;for(;$--;){if(me===V||V!==null&&me===V.alternate)break t;me=si(me),V=si(V)}me=null}else me=null;ue!==null&&cp(te,X,ue,me,!1),pe!==null&&ft!==null&&cp(te,ft,pe,me,!0)}}e:{if(X=K?ii(K):window,ue=X.nodeName&&X.nodeName.toLowerCase(),ue==="select"||ue==="input"&&X.type==="file")var ye=o0;else if(Uf(X))if(Vf)ye=d0;else{ye=c0;var be=l0}else(ue=X.nodeName)&&ue.toLowerCase()==="input"&&(X.type==="checkbox"||X.type==="radio")&&(ye=u0);if(ye&&(ye=ye(i,K))){Wf(te,ye,h,Q);break e}be&&be(i,X,K),i==="focusout"&&(be=X._wrapperState)&&be.controlled&&X.type==="number"&&Ut(X,"number",X.value)}switch(be=K?ii(K):window,i){case"focusin":(Uf(be)||be.contentEditable==="true")&&(ti=be,tu=K,na=null);break;case"focusout":na=tu=ti=null;break;case"mousedown":nu=!0;break;case"contextmenu":case"mouseup":case"dragend":nu=!1,Qf(te,h,Q);break;case"selectionchange":if(p0)break;case"keydown":case"keyup":Qf(te,h,Q)}var we;if(Xc)e:{switch(i){case"compositionstart":var Ce="onCompositionStart";break e;case"compositionend":Ce="onCompositionEnd";break e;case"compositionupdate":Ce="onCompositionUpdate";break e}Ce=void 0}else ei?$f(i,h)&&(Ce="onCompositionEnd"):i==="keydown"&&h.keyCode===229&&(Ce="onCompositionStart");Ce&&(Df&&h.locale!=="ko"&&(ei||Ce!=="onCompositionStart"?Ce==="onCompositionEnd"&&ei&&(we=Af()):(zs=Q,qc="value"in zs?zs.value:zs.textContent,ei=!0)),be=Do(K,Ce),0<be.length&&(Ce=new Mf(Ce,i,null,h,Q),te.push({event:Ce,listeners:be}),we?Ce.data=we:(we=zf(h),we!==null&&(Ce.data=we)))),(we=n0?s0(i,h):r0(i,h))&&(K=Do(K,"onBeforeInput"),0<K.length&&(Q=new Mf("onBeforeInput","beforeinput",null,h,Q),te.push({event:Q,listeners:K}),Q.data=we))}op(te,o)})}function ia(i,o,h){return{instance:i,listener:o,currentTarget:h}}function Do(i,o){for(var h=o+"Capture",p=[];i!==null;){var v=i,w=v.stateNode;v.tag===5&&w!==null&&(v=w,w=Me(i,h),w!=null&&p.unshift(ia(i,w,v)),w=Me(i,o),w!=null&&p.push(ia(i,w,v))),i=i.return}return p}function si(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function cp(i,o,h,p,v){for(var w=o._reactName,P=[];h!==null&&h!==p;){var A=h,F=A.alternate,K=A.stateNode;if(F!==null&&F===p)break;A.tag===5&&K!==null&&(A=K,v?(F=Me(h,w),F!=null&&P.unshift(ia(h,F,A))):v||(F=Me(h,w),F!=null&&P.push(ia(h,F,A)))),h=h.return}P.length!==0&&i.push({event:o,listeners:P})}var v0=/\r\n?/g,x0=/\u0000|\uFFFD/g;function up(i){return(typeof i=="string"?i:""+i).replace(v0,`
`).replace(x0,"")}function Fo(i,o,h){if(o=up(o),up(i)!==o&&h)throw Error(n(425))}function Bo(){}var lu=null,cu=null;function uu(i,o){return i==="textarea"||i==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var du=typeof setTimeout=="function"?setTimeout:void 0,b0=typeof clearTimeout=="function"?clearTimeout:void 0,dp=typeof Promise=="function"?Promise:void 0,w0=typeof queueMicrotask=="function"?queueMicrotask:typeof dp<"u"?function(i){return dp.resolve(null).then(i).catch(_0)}:du;function _0(i){setTimeout(function(){throw i})}function hu(i,o){var h=o,p=0;do{var v=h.nextSibling;if(i.removeChild(h),v&&v.nodeType===8)if(h=v.data,h==="/$"){if(p===0){i.removeChild(v),Yi(o);return}p--}else h!=="$"&&h!=="$?"&&h!=="$!"||p++;h=v}while(h);Yi(o)}function Ws(i){for(;i!=null;i=i.nextSibling){var o=i.nodeType;if(o===1||o===3)break;if(o===8){if(o=i.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return i}function hp(i){i=i.previousSibling;for(var o=0;i;){if(i.nodeType===8){var h=i.data;if(h==="$"||h==="$!"||h==="$?"){if(o===0)return i;o--}else h==="/$"&&o++}i=i.previousSibling}return null}var ri=Math.random().toString(36).slice(2),Xn="__reactFiber$"+ri,aa="__reactProps$"+ri,hs="__reactContainer$"+ri,fu="__reactEvents$"+ri,S0="__reactListeners$"+ri,k0="__reactHandles$"+ri;function br(i){var o=i[Xn];if(o)return o;for(var h=i.parentNode;h;){if(o=h[hs]||h[Xn]){if(h=o.alternate,o.child!==null||h!==null&&h.child!==null)for(i=hp(i);i!==null;){if(h=i[Xn])return h;i=hp(i)}return o}i=h,h=i.parentNode}return null}function oa(i){return i=i[Xn]||i[hs],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function ii(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(n(33))}function $o(i){return i[aa]||null}var pu=[],ai=-1;function Vs(i){return{current:i}}function Xe(i){0>ai||(i.current=pu[ai],pu[ai]=null,ai--)}function Ke(i,o){ai++,pu[ai]=i.current,i.current=o}var qs={},Rt=Vs(qs),Yt=Vs(!1),wr=qs;function oi(i,o){var h=i.type.contextTypes;if(!h)return qs;var p=i.stateNode;if(p&&p.__reactInternalMemoizedUnmaskedChildContext===o)return p.__reactInternalMemoizedMaskedChildContext;var v={},w;for(w in h)v[w]=o[w];return p&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=o,i.__reactInternalMemoizedMaskedChildContext=v),v}function Jt(i){return i=i.childContextTypes,i!=null}function zo(){Xe(Yt),Xe(Rt)}function fp(i,o,h){if(Rt.current!==qs)throw Error(n(168));Ke(Rt,o),Ke(Yt,h)}function pp(i,o,h){var p=i.stateNode;if(o=o.childContextTypes,typeof p.getChildContext!="function")return h;p=p.getChildContext();for(var v in p)if(!(v in o))throw Error(n(108,De(i)||"Unknown",v));return ie({},h,p)}function Uo(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||qs,wr=Rt.current,Ke(Rt,i),Ke(Yt,Yt.current),!0}function mp(i,o,h){var p=i.stateNode;if(!p)throw Error(n(169));h?(i=pp(i,o,wr),p.__reactInternalMemoizedMergedChildContext=i,Xe(Yt),Xe(Rt),Ke(Rt,i)):Xe(Yt),Ke(Yt,h)}var fs=null,Wo=!1,mu=!1;function gp(i){fs===null?fs=[i]:fs.push(i)}function j0(i){Wo=!0,gp(i)}function Hs(){if(!mu&&fs!==null){mu=!0;var i=0,o=qe;try{var h=fs;for(qe=1;i<h.length;i++){var p=h[i];do p=p(!0);while(p!==null)}fs=null,Wo=!1}catch(v){throw fs!==null&&(fs=fs.slice(i+1)),vf(Dc,Hs),v}finally{qe=o,mu=!1}}return null}var li=[],ci=0,Vo=null,qo=0,_n=[],Sn=0,_r=null,ps=1,ms="";function Sr(i,o){li[ci++]=qo,li[ci++]=Vo,Vo=i,qo=o}function yp(i,o,h){_n[Sn++]=ps,_n[Sn++]=ms,_n[Sn++]=_r,_r=i;var p=ps;i=ms;var v=32-An(p)-1;p&=~(1<<v),h+=1;var w=32-An(o)+v;if(30<w){var P=v-v%5;w=(p&(1<<P)-1).toString(32),p>>=P,v-=P,ps=1<<32-An(o)+v|h<<v|p,ms=w+i}else ps=1<<w|h<<v|p,ms=i}function gu(i){i.return!==null&&(Sr(i,1),yp(i,1,0))}function yu(i){for(;i===Vo;)Vo=li[--ci],li[ci]=null,qo=li[--ci],li[ci]=null;for(;i===_r;)_r=_n[--Sn],_n[Sn]=null,ms=_n[--Sn],_n[Sn]=null,ps=_n[--Sn],_n[Sn]=null}var ln=null,cn=null,Ze=!1,Rn=null;function vp(i,o){var h=Pn(5,null,null,0);h.elementType="DELETED",h.stateNode=o,h.return=i,o=i.deletions,o===null?(i.deletions=[h],i.flags|=16):o.push(h)}function xp(i,o){switch(i.tag){case 5:var h=i.type;return o=o.nodeType!==1||h.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(i.stateNode=o,ln=i,cn=Ws(o.firstChild),!0):!1;case 6:return o=i.pendingProps===""||o.nodeType!==3?null:o,o!==null?(i.stateNode=o,ln=i,cn=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(h=_r!==null?{id:ps,overflow:ms}:null,i.memoizedState={dehydrated:o,treeContext:h,retryLane:1073741824},h=Pn(18,null,null,0),h.stateNode=o,h.return=i,i.child=h,ln=i,cn=null,!0):!1;default:return!1}}function vu(i){return(i.mode&1)!==0&&(i.flags&128)===0}function xu(i){if(Ze){var o=cn;if(o){var h=o;if(!xp(i,o)){if(vu(i))throw Error(n(418));o=Ws(h.nextSibling);var p=ln;o&&xp(i,o)?vp(p,h):(i.flags=i.flags&-4097|2,Ze=!1,ln=i)}}else{if(vu(i))throw Error(n(418));i.flags=i.flags&-4097|2,Ze=!1,ln=i}}}function bp(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;ln=i}function Ho(i){if(i!==ln)return!1;if(!Ze)return bp(i),Ze=!0,!1;var o;if((o=i.tag!==3)&&!(o=i.tag!==5)&&(o=i.type,o=o!=="head"&&o!=="body"&&!uu(i.type,i.memoizedProps)),o&&(o=cn)){if(vu(i))throw wp(),Error(n(418));for(;o;)vp(i,o),o=Ws(o.nextSibling)}if(bp(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(n(317));e:{for(i=i.nextSibling,o=0;i;){if(i.nodeType===8){var h=i.data;if(h==="/$"){if(o===0){cn=Ws(i.nextSibling);break e}o--}else h!=="$"&&h!=="$!"&&h!=="$?"||o++}i=i.nextSibling}cn=null}}else cn=ln?Ws(i.stateNode.nextSibling):null;return!0}function wp(){for(var i=cn;i;)i=Ws(i.nextSibling)}function ui(){cn=ln=null,Ze=!1}function bu(i){Rn===null?Rn=[i]:Rn.push(i)}var C0=N.ReactCurrentBatchConfig;function la(i,o,h){if(i=h.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(h._owner){if(h=h._owner,h){if(h.tag!==1)throw Error(n(309));var p=h.stateNode}if(!p)throw Error(n(147,i));var v=p,w=""+i;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===w?o.ref:(o=function(P){var A=v.refs;P===null?delete A[w]:A[w]=P},o._stringRef=w,o)}if(typeof i!="string")throw Error(n(284));if(!h._owner)throw Error(n(290,i))}return i}function Ko(i,o){throw i=Object.prototype.toString.call(o),Error(n(31,i==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":i))}function _p(i){var o=i._init;return o(i._payload)}function Sp(i){function o(V,$){if(i){var q=V.deletions;q===null?(V.deletions=[$],V.flags|=16):q.push($)}}function h(V,$){if(!i)return null;for(;$!==null;)o(V,$),$=$.sibling;return null}function p(V,$){for(V=new Map;$!==null;)$.key!==null?V.set($.key,$):V.set($.index,$),$=$.sibling;return V}function v(V,$){return V=er(V,$),V.index=0,V.sibling=null,V}function w(V,$,q){return V.index=q,i?(q=V.alternate,q!==null?(q=q.index,q<$?(V.flags|=2,$):q):(V.flags|=2,$)):(V.flags|=1048576,$)}function P(V){return i&&V.alternate===null&&(V.flags|=2),V}function A(V,$,q,re){return $===null||$.tag!==6?($=dd(q,V.mode,re),$.return=V,$):($=v($,q),$.return=V,$)}function F(V,$,q,re){var ye=q.type;return ye===E?Q(V,$,q.props.children,re,q.key):$!==null&&($.elementType===ye||typeof ye=="object"&&ye!==null&&ye.$$typeof===ee&&_p(ye)===$.type)?(re=v($,q.props),re.ref=la(V,$,q),re.return=V,re):(re=yl(q.type,q.key,q.props,null,V.mode,re),re.ref=la(V,$,q),re.return=V,re)}function K(V,$,q,re){return $===null||$.tag!==4||$.stateNode.containerInfo!==q.containerInfo||$.stateNode.implementation!==q.implementation?($=hd(q,V.mode,re),$.return=V,$):($=v($,q.children||[]),$.return=V,$)}function Q(V,$,q,re,ye){return $===null||$.tag!==7?($=Nr(q,V.mode,re,ye),$.return=V,$):($=v($,q),$.return=V,$)}function te(V,$,q){if(typeof $=="string"&&$!==""||typeof $=="number")return $=dd(""+$,V.mode,q),$.return=V,$;if(typeof $=="object"&&$!==null){switch($.$$typeof){case O:return q=yl($.type,$.key,$.props,null,V.mode,q),q.ref=la(V,null,$),q.return=V,q;case U:return $=hd($,V.mode,q),$.return=V,$;case ee:var re=$._init;return te(V,re($._payload),q)}if(rn($)||oe($))return $=Nr($,V.mode,q,null),$.return=V,$;Ko(V,$)}return null}function X(V,$,q,re){var ye=$!==null?$.key:null;if(typeof q=="string"&&q!==""||typeof q=="number")return ye!==null?null:A(V,$,""+q,re);if(typeof q=="object"&&q!==null){switch(q.$$typeof){case O:return q.key===ye?F(V,$,q,re):null;case U:return q.key===ye?K(V,$,q,re):null;case ee:return ye=q._init,X(V,$,ye(q._payload),re)}if(rn(q)||oe(q))return ye!==null?null:Q(V,$,q,re,null);Ko(V,q)}return null}function ue(V,$,q,re,ye){if(typeof re=="string"&&re!==""||typeof re=="number")return V=V.get(q)||null,A($,V,""+re,ye);if(typeof re=="object"&&re!==null){switch(re.$$typeof){case O:return V=V.get(re.key===null?q:re.key)||null,F($,V,re,ye);case U:return V=V.get(re.key===null?q:re.key)||null,K($,V,re,ye);case ee:var be=re._init;return ue(V,$,q,be(re._payload),ye)}if(rn(re)||oe(re))return V=V.get(q)||null,Q($,V,re,ye,null);Ko($,re)}return null}function pe(V,$,q,re){for(var ye=null,be=null,we=$,Ce=$=0,Ct=null;we!==null&&Ce<q.length;Ce++){we.index>Ce?(Ct=we,we=null):Ct=we.sibling;var $e=X(V,we,q[Ce],re);if($e===null){we===null&&(we=Ct);break}i&&we&&$e.alternate===null&&o(V,we),$=w($e,$,Ce),be===null?ye=$e:be.sibling=$e,be=$e,we=Ct}if(Ce===q.length)return h(V,we),Ze&&Sr(V,Ce),ye;if(we===null){for(;Ce<q.length;Ce++)we=te(V,q[Ce],re),we!==null&&($=w(we,$,Ce),be===null?ye=we:be.sibling=we,be=we);return Ze&&Sr(V,Ce),ye}for(we=p(V,we);Ce<q.length;Ce++)Ct=ue(we,V,Ce,q[Ce],re),Ct!==null&&(i&&Ct.alternate!==null&&we.delete(Ct.key===null?Ce:Ct.key),$=w(Ct,$,Ce),be===null?ye=Ct:be.sibling=Ct,be=Ct);return i&&we.forEach(function(tr){return o(V,tr)}),Ze&&Sr(V,Ce),ye}function me(V,$,q,re){var ye=oe(q);if(typeof ye!="function")throw Error(n(150));if(q=ye.call(q),q==null)throw Error(n(151));for(var be=ye=null,we=$,Ce=$=0,Ct=null,$e=q.next();we!==null&&!$e.done;Ce++,$e=q.next()){we.index>Ce?(Ct=we,we=null):Ct=we.sibling;var tr=X(V,we,$e.value,re);if(tr===null){we===null&&(we=Ct);break}i&&we&&tr.alternate===null&&o(V,we),$=w(tr,$,Ce),be===null?ye=tr:be.sibling=tr,be=tr,we=Ct}if($e.done)return h(V,we),Ze&&Sr(V,Ce),ye;if(we===null){for(;!$e.done;Ce++,$e=q.next())$e=te(V,$e.value,re),$e!==null&&($=w($e,$,Ce),be===null?ye=$e:be.sibling=$e,be=$e);return Ze&&Sr(V,Ce),ye}for(we=p(V,we);!$e.done;Ce++,$e=q.next())$e=ue(we,V,Ce,$e.value,re),$e!==null&&(i&&$e.alternate!==null&&we.delete($e.key===null?Ce:$e.key),$=w($e,$,Ce),be===null?ye=$e:be.sibling=$e,be=$e);return i&&we.forEach(function(iw){return o(V,iw)}),Ze&&Sr(V,Ce),ye}function ft(V,$,q,re){if(typeof q=="object"&&q!==null&&q.type===E&&q.key===null&&(q=q.props.children),typeof q=="object"&&q!==null){switch(q.$$typeof){case O:e:{for(var ye=q.key,be=$;be!==null;){if(be.key===ye){if(ye=q.type,ye===E){if(be.tag===7){h(V,be.sibling),$=v(be,q.props.children),$.return=V,V=$;break e}}else if(be.elementType===ye||typeof ye=="object"&&ye!==null&&ye.$$typeof===ee&&_p(ye)===be.type){h(V,be.sibling),$=v(be,q.props),$.ref=la(V,be,q),$.return=V,V=$;break e}h(V,be);break}else o(V,be);be=be.sibling}q.type===E?($=Nr(q.props.children,V.mode,re,q.key),$.return=V,V=$):(re=yl(q.type,q.key,q.props,null,V.mode,re),re.ref=la(V,$,q),re.return=V,V=re)}return P(V);case U:e:{for(be=q.key;$!==null;){if($.key===be)if($.tag===4&&$.stateNode.containerInfo===q.containerInfo&&$.stateNode.implementation===q.implementation){h(V,$.sibling),$=v($,q.children||[]),$.return=V,V=$;break e}else{h(V,$);break}else o(V,$);$=$.sibling}$=hd(q,V.mode,re),$.return=V,V=$}return P(V);case ee:return be=q._init,ft(V,$,be(q._payload),re)}if(rn(q))return pe(V,$,q,re);if(oe(q))return me(V,$,q,re);Ko(V,q)}return typeof q=="string"&&q!==""||typeof q=="number"?(q=""+q,$!==null&&$.tag===6?(h(V,$.sibling),$=v($,q),$.return=V,V=$):(h(V,$),$=dd(q,V.mode,re),$.return=V,V=$),P(V)):h(V,$)}return ft}var di=Sp(!0),kp=Sp(!1),Go=Vs(null),Yo=null,hi=null,wu=null;function _u(){wu=hi=Yo=null}function Su(i){var o=Go.current;Xe(Go),i._currentValue=o}function ku(i,o,h){for(;i!==null;){var p=i.alternate;if((i.childLanes&o)!==o?(i.childLanes|=o,p!==null&&(p.childLanes|=o)):p!==null&&(p.childLanes&o)!==o&&(p.childLanes|=o),i===h)break;i=i.return}}function fi(i,o){Yo=i,wu=hi=null,i=i.dependencies,i!==null&&i.firstContext!==null&&((i.lanes&o)!==0&&(Xt=!0),i.firstContext=null)}function kn(i){var o=i._currentValue;if(wu!==i)if(i={context:i,memoizedValue:o,next:null},hi===null){if(Yo===null)throw Error(n(308));hi=i,Yo.dependencies={lanes:0,firstContext:i}}else hi=hi.next=i;return o}var kr=null;function ju(i){kr===null?kr=[i]:kr.push(i)}function jp(i,o,h,p){var v=o.interleaved;return v===null?(h.next=h,ju(o)):(h.next=v.next,v.next=h),o.interleaved=h,gs(i,p)}function gs(i,o){i.lanes|=o;var h=i.alternate;for(h!==null&&(h.lanes|=o),h=i,i=i.return;i!==null;)i.childLanes|=o,h=i.alternate,h!==null&&(h.childLanes|=o),h=i,i=i.return;return h.tag===3?h.stateNode:null}var Ks=!1;function Cu(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Cp(i,o){i=i.updateQueue,o.updateQueue===i&&(o.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function ys(i,o){return{eventTime:i,lane:o,tag:0,payload:null,callback:null,next:null}}function Gs(i,o,h){var p=i.updateQueue;if(p===null)return null;if(p=p.shared,(Le&2)!==0){var v=p.pending;return v===null?o.next=o:(o.next=v.next,v.next=o),p.pending=o,gs(i,h)}return v=p.interleaved,v===null?(o.next=o,ju(p)):(o.next=v.next,v.next=o),p.interleaved=o,gs(i,h)}function Jo(i,o,h){if(o=o.updateQueue,o!==null&&(o=o.shared,(h&4194240)!==0)){var p=o.lanes;p&=i.pendingLanes,h|=p,o.lanes=h,$c(i,h)}}function Pp(i,o){var h=i.updateQueue,p=i.alternate;if(p!==null&&(p=p.updateQueue,h===p)){var v=null,w=null;if(h=h.firstBaseUpdate,h!==null){do{var P={eventTime:h.eventTime,lane:h.lane,tag:h.tag,payload:h.payload,callback:h.callback,next:null};w===null?v=w=P:w=w.next=P,h=h.next}while(h!==null);w===null?v=w=o:w=w.next=o}else v=w=o;h={baseState:p.baseState,firstBaseUpdate:v,lastBaseUpdate:w,shared:p.shared,effects:p.effects},i.updateQueue=h;return}i=h.lastBaseUpdate,i===null?h.firstBaseUpdate=o:i.next=o,h.lastBaseUpdate=o}function Xo(i,o,h,p){var v=i.updateQueue;Ks=!1;var w=v.firstBaseUpdate,P=v.lastBaseUpdate,A=v.shared.pending;if(A!==null){v.shared.pending=null;var F=A,K=F.next;F.next=null,P===null?w=K:P.next=K,P=F;var Q=i.alternate;Q!==null&&(Q=Q.updateQueue,A=Q.lastBaseUpdate,A!==P&&(A===null?Q.firstBaseUpdate=K:A.next=K,Q.lastBaseUpdate=F))}if(w!==null){var te=v.baseState;P=0,Q=K=F=null,A=w;do{var X=A.lane,ue=A.eventTime;if((p&X)===X){Q!==null&&(Q=Q.next={eventTime:ue,lane:0,tag:A.tag,payload:A.payload,callback:A.callback,next:null});e:{var pe=i,me=A;switch(X=o,ue=h,me.tag){case 1:if(pe=me.payload,typeof pe=="function"){te=pe.call(ue,te,X);break e}te=pe;break e;case 3:pe.flags=pe.flags&-65537|128;case 0:if(pe=me.payload,X=typeof pe=="function"?pe.call(ue,te,X):pe,X==null)break e;te=ie({},te,X);break e;case 2:Ks=!0}}A.callback!==null&&A.lane!==0&&(i.flags|=64,X=v.effects,X===null?v.effects=[A]:X.push(A))}else ue={eventTime:ue,lane:X,tag:A.tag,payload:A.payload,callback:A.callback,next:null},Q===null?(K=Q=ue,F=te):Q=Q.next=ue,P|=X;if(A=A.next,A===null){if(A=v.shared.pending,A===null)break;X=A,A=X.next,X.next=null,v.lastBaseUpdate=X,v.shared.pending=null}}while(!0);if(Q===null&&(F=te),v.baseState=F,v.firstBaseUpdate=K,v.lastBaseUpdate=Q,o=v.shared.interleaved,o!==null){v=o;do P|=v.lane,v=v.next;while(v!==o)}else w===null&&(v.shared.lanes=0);Pr|=P,i.lanes=P,i.memoizedState=te}}function Ip(i,o,h){if(i=o.effects,o.effects=null,i!==null)for(o=0;o<i.length;o++){var p=i[o],v=p.callback;if(v!==null){if(p.callback=null,p=h,typeof v!="function")throw Error(n(191,v));v.call(p)}}}var ca={},Qn=Vs(ca),ua=Vs(ca),da=Vs(ca);function jr(i){if(i===ca)throw Error(n(174));return i}function Pu(i,o){switch(Ke(da,o),Ke(ua,i),Ke(Qn,ca),i=o.nodeType,i){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:xn(null,"");break;default:i=i===8?o.parentNode:o,o=i.namespaceURI||null,i=i.tagName,o=xn(o,i)}Xe(Qn),Ke(Qn,o)}function pi(){Xe(Qn),Xe(ua),Xe(da)}function Ep(i){jr(da.current);var o=jr(Qn.current),h=xn(o,i.type);o!==h&&(Ke(ua,i),Ke(Qn,h))}function Iu(i){ua.current===i&&(Xe(Qn),Xe(ua))}var rt=Vs(0);function Qo(i){for(var o=i;o!==null;){if(o.tag===13){var h=o.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||h.data==="$?"||h.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Eu=[];function Tu(){for(var i=0;i<Eu.length;i++)Eu[i]._workInProgressVersionPrimary=null;Eu.length=0}var Zo=N.ReactCurrentDispatcher,Nu=N.ReactCurrentBatchConfig,Cr=0,it=null,xt=null,kt=null,el=!1,ha=!1,fa=0,P0=0;function Mt(){throw Error(n(321))}function Au(i,o){if(o===null)return!1;for(var h=0;h<o.length&&h<i.length;h++)if(!On(i[h],o[h]))return!1;return!0}function Ou(i,o,h,p,v,w){if(Cr=w,it=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,Zo.current=i===null||i.memoizedState===null?N0:A0,i=h(p,v),ha){w=0;do{if(ha=!1,fa=0,25<=w)throw Error(n(301));w+=1,kt=xt=null,o.updateQueue=null,Zo.current=O0,i=h(p,v)}while(ha)}if(Zo.current=sl,o=xt!==null&&xt.next!==null,Cr=0,kt=xt=it=null,el=!1,o)throw Error(n(300));return i}function Ru(){var i=fa!==0;return fa=0,i}function Zn(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return kt===null?it.memoizedState=kt=i:kt=kt.next=i,kt}function jn(){if(xt===null){var i=it.alternate;i=i!==null?i.memoizedState:null}else i=xt.next;var o=kt===null?it.memoizedState:kt.next;if(o!==null)kt=o,xt=i;else{if(i===null)throw Error(n(310));xt=i,i={memoizedState:xt.memoizedState,baseState:xt.baseState,baseQueue:xt.baseQueue,queue:xt.queue,next:null},kt===null?it.memoizedState=kt=i:kt=kt.next=i}return kt}function pa(i,o){return typeof o=="function"?o(i):o}function Mu(i){var o=jn(),h=o.queue;if(h===null)throw Error(n(311));h.lastRenderedReducer=i;var p=xt,v=p.baseQueue,w=h.pending;if(w!==null){if(v!==null){var P=v.next;v.next=w.next,w.next=P}p.baseQueue=v=w,h.pending=null}if(v!==null){w=v.next,p=p.baseState;var A=P=null,F=null,K=w;do{var Q=K.lane;if((Cr&Q)===Q)F!==null&&(F=F.next={lane:0,action:K.action,hasEagerState:K.hasEagerState,eagerState:K.eagerState,next:null}),p=K.hasEagerState?K.eagerState:i(p,K.action);else{var te={lane:Q,action:K.action,hasEagerState:K.hasEagerState,eagerState:K.eagerState,next:null};F===null?(A=F=te,P=p):F=F.next=te,it.lanes|=Q,Pr|=Q}K=K.next}while(K!==null&&K!==w);F===null?P=p:F.next=A,On(p,o.memoizedState)||(Xt=!0),o.memoizedState=p,o.baseState=P,o.baseQueue=F,h.lastRenderedState=p}if(i=h.interleaved,i!==null){v=i;do w=v.lane,it.lanes|=w,Pr|=w,v=v.next;while(v!==i)}else v===null&&(h.lanes=0);return[o.memoizedState,h.dispatch]}function Lu(i){var o=jn(),h=o.queue;if(h===null)throw Error(n(311));h.lastRenderedReducer=i;var p=h.dispatch,v=h.pending,w=o.memoizedState;if(v!==null){h.pending=null;var P=v=v.next;do w=i(w,P.action),P=P.next;while(P!==v);On(w,o.memoizedState)||(Xt=!0),o.memoizedState=w,o.baseQueue===null&&(o.baseState=w),h.lastRenderedState=w}return[w,p]}function Tp(){}function Np(i,o){var h=it,p=jn(),v=o(),w=!On(p.memoizedState,v);if(w&&(p.memoizedState=v,Xt=!0),p=p.queue,Du(Rp.bind(null,h,p,i),[i]),p.getSnapshot!==o||w||kt!==null&&kt.memoizedState.tag&1){if(h.flags|=2048,ma(9,Op.bind(null,h,p,v,o),void 0,null),jt===null)throw Error(n(349));(Cr&30)!==0||Ap(h,o,v)}return v}function Ap(i,o,h){i.flags|=16384,i={getSnapshot:o,value:h},o=it.updateQueue,o===null?(o={lastEffect:null,stores:null},it.updateQueue=o,o.stores=[i]):(h=o.stores,h===null?o.stores=[i]:h.push(i))}function Op(i,o,h,p){o.value=h,o.getSnapshot=p,Mp(o)&&Lp(i)}function Rp(i,o,h){return h(function(){Mp(o)&&Lp(i)})}function Mp(i){var o=i.getSnapshot;i=i.value;try{var h=o();return!On(i,h)}catch{return!0}}function Lp(i){var o=gs(i,1);o!==null&&Fn(o,i,1,-1)}function Dp(i){var o=Zn();return typeof i=="function"&&(i=i()),o.memoizedState=o.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:pa,lastRenderedState:i},o.queue=i,i=i.dispatch=T0.bind(null,it,i),[o.memoizedState,i]}function ma(i,o,h,p){return i={tag:i,create:o,destroy:h,deps:p,next:null},o=it.updateQueue,o===null?(o={lastEffect:null,stores:null},it.updateQueue=o,o.lastEffect=i.next=i):(h=o.lastEffect,h===null?o.lastEffect=i.next=i:(p=h.next,h.next=i,i.next=p,o.lastEffect=i)),i}function Fp(){return jn().memoizedState}function tl(i,o,h,p){var v=Zn();it.flags|=i,v.memoizedState=ma(1|o,h,void 0,p===void 0?null:p)}function nl(i,o,h,p){var v=jn();p=p===void 0?null:p;var w=void 0;if(xt!==null){var P=xt.memoizedState;if(w=P.destroy,p!==null&&Au(p,P.deps)){v.memoizedState=ma(o,h,w,p);return}}it.flags|=i,v.memoizedState=ma(1|o,h,w,p)}function Bp(i,o){return tl(8390656,8,i,o)}function Du(i,o){return nl(2048,8,i,o)}function $p(i,o){return nl(4,2,i,o)}function zp(i,o){return nl(4,4,i,o)}function Up(i,o){if(typeof o=="function")return i=i(),o(i),function(){o(null)};if(o!=null)return i=i(),o.current=i,function(){o.current=null}}function Wp(i,o,h){return h=h!=null?h.concat([i]):null,nl(4,4,Up.bind(null,o,i),h)}function Fu(){}function Vp(i,o){var h=jn();o=o===void 0?null:o;var p=h.memoizedState;return p!==null&&o!==null&&Au(o,p[1])?p[0]:(h.memoizedState=[i,o],i)}function qp(i,o){var h=jn();o=o===void 0?null:o;var p=h.memoizedState;return p!==null&&o!==null&&Au(o,p[1])?p[0]:(i=i(),h.memoizedState=[i,o],i)}function Hp(i,o,h){return(Cr&21)===0?(i.baseState&&(i.baseState=!1,Xt=!0),i.memoizedState=h):(On(h,o)||(h=_f(),it.lanes|=h,Pr|=h,i.baseState=!0),o)}function I0(i,o){var h=qe;qe=h!==0&&4>h?h:4,i(!0);var p=Nu.transition;Nu.transition={};try{i(!1),o()}finally{qe=h,Nu.transition=p}}function Kp(){return jn().memoizedState}function E0(i,o,h){var p=Qs(i);if(h={lane:p,action:h,hasEagerState:!1,eagerState:null,next:null},Gp(i))Yp(o,h);else if(h=jp(i,o,h,p),h!==null){var v=qt();Fn(h,i,p,v),Jp(h,o,p)}}function T0(i,o,h){var p=Qs(i),v={lane:p,action:h,hasEagerState:!1,eagerState:null,next:null};if(Gp(i))Yp(o,v);else{var w=i.alternate;if(i.lanes===0&&(w===null||w.lanes===0)&&(w=o.lastRenderedReducer,w!==null))try{var P=o.lastRenderedState,A=w(P,h);if(v.hasEagerState=!0,v.eagerState=A,On(A,P)){var F=o.interleaved;F===null?(v.next=v,ju(o)):(v.next=F.next,F.next=v),o.interleaved=v;return}}catch{}h=jp(i,o,v,p),h!==null&&(v=qt(),Fn(h,i,p,v),Jp(h,o,p))}}function Gp(i){var o=i.alternate;return i===it||o!==null&&o===it}function Yp(i,o){ha=el=!0;var h=i.pending;h===null?o.next=o:(o.next=h.next,h.next=o),i.pending=o}function Jp(i,o,h){if((h&4194240)!==0){var p=o.lanes;p&=i.pendingLanes,h|=p,o.lanes=h,$c(i,h)}}var sl={readContext:kn,useCallback:Mt,useContext:Mt,useEffect:Mt,useImperativeHandle:Mt,useInsertionEffect:Mt,useLayoutEffect:Mt,useMemo:Mt,useReducer:Mt,useRef:Mt,useState:Mt,useDebugValue:Mt,useDeferredValue:Mt,useTransition:Mt,useMutableSource:Mt,useSyncExternalStore:Mt,useId:Mt,unstable_isNewReconciler:!1},N0={readContext:kn,useCallback:function(i,o){return Zn().memoizedState=[i,o===void 0?null:o],i},useContext:kn,useEffect:Bp,useImperativeHandle:function(i,o,h){return h=h!=null?h.concat([i]):null,tl(4194308,4,Up.bind(null,o,i),h)},useLayoutEffect:function(i,o){return tl(4194308,4,i,o)},useInsertionEffect:function(i,o){return tl(4,2,i,o)},useMemo:function(i,o){var h=Zn();return o=o===void 0?null:o,i=i(),h.memoizedState=[i,o],i},useReducer:function(i,o,h){var p=Zn();return o=h!==void 0?h(o):o,p.memoizedState=p.baseState=o,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:o},p.queue=i,i=i.dispatch=E0.bind(null,it,i),[p.memoizedState,i]},useRef:function(i){var o=Zn();return i={current:i},o.memoizedState=i},useState:Dp,useDebugValue:Fu,useDeferredValue:function(i){return Zn().memoizedState=i},useTransition:function(){var i=Dp(!1),o=i[0];return i=I0.bind(null,i[1]),Zn().memoizedState=i,[o,i]},useMutableSource:function(){},useSyncExternalStore:function(i,o,h){var p=it,v=Zn();if(Ze){if(h===void 0)throw Error(n(407));h=h()}else{if(h=o(),jt===null)throw Error(n(349));(Cr&30)!==0||Ap(p,o,h)}v.memoizedState=h;var w={value:h,getSnapshot:o};return v.queue=w,Bp(Rp.bind(null,p,w,i),[i]),p.flags|=2048,ma(9,Op.bind(null,p,w,h,o),void 0,null),h},useId:function(){var i=Zn(),o=jt.identifierPrefix;if(Ze){var h=ms,p=ps;h=(p&~(1<<32-An(p)-1)).toString(32)+h,o=":"+o+"R"+h,h=fa++,0<h&&(o+="H"+h.toString(32)),o+=":"}else h=P0++,o=":"+o+"r"+h.toString(32)+":";return i.memoizedState=o},unstable_isNewReconciler:!1},A0={readContext:kn,useCallback:Vp,useContext:kn,useEffect:Du,useImperativeHandle:Wp,useInsertionEffect:$p,useLayoutEffect:zp,useMemo:qp,useReducer:Mu,useRef:Fp,useState:function(){return Mu(pa)},useDebugValue:Fu,useDeferredValue:function(i){var o=jn();return Hp(o,xt.memoizedState,i)},useTransition:function(){var i=Mu(pa)[0],o=jn().memoizedState;return[i,o]},useMutableSource:Tp,useSyncExternalStore:Np,useId:Kp,unstable_isNewReconciler:!1},O0={readContext:kn,useCallback:Vp,useContext:kn,useEffect:Du,useImperativeHandle:Wp,useInsertionEffect:$p,useLayoutEffect:zp,useMemo:qp,useReducer:Lu,useRef:Fp,useState:function(){return Lu(pa)},useDebugValue:Fu,useDeferredValue:function(i){var o=jn();return xt===null?o.memoizedState=i:Hp(o,xt.memoizedState,i)},useTransition:function(){var i=Lu(pa)[0],o=jn().memoizedState;return[i,o]},useMutableSource:Tp,useSyncExternalStore:Np,useId:Kp,unstable_isNewReconciler:!1};function Mn(i,o){if(i&&i.defaultProps){o=ie({},o),i=i.defaultProps;for(var h in i)o[h]===void 0&&(o[h]=i[h]);return o}return o}function Bu(i,o,h,p){o=i.memoizedState,h=h(p,o),h=h==null?o:ie({},o,h),i.memoizedState=h,i.lanes===0&&(i.updateQueue.baseState=h)}var rl={isMounted:function(i){return(i=i._reactInternals)?xr(i)===i:!1},enqueueSetState:function(i,o,h){i=i._reactInternals;var p=qt(),v=Qs(i),w=ys(p,v);w.payload=o,h!=null&&(w.callback=h),o=Gs(i,w,v),o!==null&&(Fn(o,i,v,p),Jo(o,i,v))},enqueueReplaceState:function(i,o,h){i=i._reactInternals;var p=qt(),v=Qs(i),w=ys(p,v);w.tag=1,w.payload=o,h!=null&&(w.callback=h),o=Gs(i,w,v),o!==null&&(Fn(o,i,v,p),Jo(o,i,v))},enqueueForceUpdate:function(i,o){i=i._reactInternals;var h=qt(),p=Qs(i),v=ys(h,p);v.tag=2,o!=null&&(v.callback=o),o=Gs(i,v,p),o!==null&&(Fn(o,i,p,h),Jo(o,i,p))}};function Xp(i,o,h,p,v,w,P){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(p,w,P):o.prototype&&o.prototype.isPureReactComponent?!ta(h,p)||!ta(v,w):!0}function Qp(i,o,h){var p=!1,v=qs,w=o.contextType;return typeof w=="object"&&w!==null?w=kn(w):(v=Jt(o)?wr:Rt.current,p=o.contextTypes,w=(p=p!=null)?oi(i,v):qs),o=new o(h,w),i.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=rl,i.stateNode=o,o._reactInternals=i,p&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=v,i.__reactInternalMemoizedMaskedChildContext=w),o}function Zp(i,o,h,p){i=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(h,p),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(h,p),o.state!==i&&rl.enqueueReplaceState(o,o.state,null)}function $u(i,o,h,p){var v=i.stateNode;v.props=h,v.state=i.memoizedState,v.refs={},Cu(i);var w=o.contextType;typeof w=="object"&&w!==null?v.context=kn(w):(w=Jt(o)?wr:Rt.current,v.context=oi(i,w)),v.state=i.memoizedState,w=o.getDerivedStateFromProps,typeof w=="function"&&(Bu(i,o,w,h),v.state=i.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(o=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),o!==v.state&&rl.enqueueReplaceState(v,v.state,null),Xo(i,h,v,p),v.state=i.memoizedState),typeof v.componentDidMount=="function"&&(i.flags|=4194308)}function mi(i,o){try{var h="",p=o;do h+=ge(p),p=p.return;while(p);var v=h}catch(w){v=`
Error generating stack: `+w.message+`
`+w.stack}return{value:i,source:o,stack:v,digest:null}}function zu(i,o,h){return{value:i,source:null,stack:h??null,digest:o??null}}function Uu(i,o){try{console.error(o.value)}catch(h){setTimeout(function(){throw h})}}var R0=typeof WeakMap=="function"?WeakMap:Map;function em(i,o,h){h=ys(-1,h),h.tag=3,h.payload={element:null};var p=o.value;return h.callback=function(){dl||(dl=!0,sd=p),Uu(i,o)},h}function tm(i,o,h){h=ys(-1,h),h.tag=3;var p=i.type.getDerivedStateFromError;if(typeof p=="function"){var v=o.value;h.payload=function(){return p(v)},h.callback=function(){Uu(i,o)}}var w=i.stateNode;return w!==null&&typeof w.componentDidCatch=="function"&&(h.callback=function(){Uu(i,o),typeof p!="function"&&(Js===null?Js=new Set([this]):Js.add(this));var P=o.stack;this.componentDidCatch(o.value,{componentStack:P!==null?P:""})}),h}function nm(i,o,h){var p=i.pingCache;if(p===null){p=i.pingCache=new R0;var v=new Set;p.set(o,v)}else v=p.get(o),v===void 0&&(v=new Set,p.set(o,v));v.has(h)||(v.add(h),i=G0.bind(null,i,o,h),o.then(i,i))}function sm(i){do{var o;if((o=i.tag===13)&&(o=i.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return i;i=i.return}while(i!==null);return null}function rm(i,o,h,p,v){return(i.mode&1)===0?(i===o?i.flags|=65536:(i.flags|=128,h.flags|=131072,h.flags&=-52805,h.tag===1&&(h.alternate===null?h.tag=17:(o=ys(-1,1),o.tag=2,Gs(h,o,1))),h.lanes|=1),i):(i.flags|=65536,i.lanes=v,i)}var M0=N.ReactCurrentOwner,Xt=!1;function Vt(i,o,h,p){o.child=i===null?kp(o,null,h,p):di(o,i.child,h,p)}function im(i,o,h,p,v){h=h.render;var w=o.ref;return fi(o,v),p=Ou(i,o,h,p,w,v),h=Ru(),i!==null&&!Xt?(o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~v,vs(i,o,v)):(Ze&&h&&gu(o),o.flags|=1,Vt(i,o,p,v),o.child)}function am(i,o,h,p,v){if(i===null){var w=h.type;return typeof w=="function"&&!ud(w)&&w.defaultProps===void 0&&h.compare===null&&h.defaultProps===void 0?(o.tag=15,o.type=w,om(i,o,w,p,v)):(i=yl(h.type,null,p,o,o.mode,v),i.ref=o.ref,i.return=o,o.child=i)}if(w=i.child,(i.lanes&v)===0){var P=w.memoizedProps;if(h=h.compare,h=h!==null?h:ta,h(P,p)&&i.ref===o.ref)return vs(i,o,v)}return o.flags|=1,i=er(w,p),i.ref=o.ref,i.return=o,o.child=i}function om(i,o,h,p,v){if(i!==null){var w=i.memoizedProps;if(ta(w,p)&&i.ref===o.ref)if(Xt=!1,o.pendingProps=p=w,(i.lanes&v)!==0)(i.flags&131072)!==0&&(Xt=!0);else return o.lanes=i.lanes,vs(i,o,v)}return Wu(i,o,h,p,v)}function lm(i,o,h){var p=o.pendingProps,v=p.children,w=i!==null?i.memoizedState:null;if(p.mode==="hidden")if((o.mode&1)===0)o.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ke(yi,un),un|=h;else{if((h&1073741824)===0)return i=w!==null?w.baseLanes|h:h,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:i,cachePool:null,transitions:null},o.updateQueue=null,Ke(yi,un),un|=i,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},p=w!==null?w.baseLanes:h,Ke(yi,un),un|=p}else w!==null?(p=w.baseLanes|h,o.memoizedState=null):p=h,Ke(yi,un),un|=p;return Vt(i,o,v,h),o.child}function cm(i,o){var h=o.ref;(i===null&&h!==null||i!==null&&i.ref!==h)&&(o.flags|=512,o.flags|=2097152)}function Wu(i,o,h,p,v){var w=Jt(h)?wr:Rt.current;return w=oi(o,w),fi(o,v),h=Ou(i,o,h,p,w,v),p=Ru(),i!==null&&!Xt?(o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~v,vs(i,o,v)):(Ze&&p&&gu(o),o.flags|=1,Vt(i,o,h,v),o.child)}function um(i,o,h,p,v){if(Jt(h)){var w=!0;Uo(o)}else w=!1;if(fi(o,v),o.stateNode===null)al(i,o),Qp(o,h,p),$u(o,h,p,v),p=!0;else if(i===null){var P=o.stateNode,A=o.memoizedProps;P.props=A;var F=P.context,K=h.contextType;typeof K=="object"&&K!==null?K=kn(K):(K=Jt(h)?wr:Rt.current,K=oi(o,K));var Q=h.getDerivedStateFromProps,te=typeof Q=="function"||typeof P.getSnapshotBeforeUpdate=="function";te||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(A!==p||F!==K)&&Zp(o,P,p,K),Ks=!1;var X=o.memoizedState;P.state=X,Xo(o,p,P,v),F=o.memoizedState,A!==p||X!==F||Yt.current||Ks?(typeof Q=="function"&&(Bu(o,h,Q,p),F=o.memoizedState),(A=Ks||Xp(o,h,A,p,X,F,K))?(te||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount()),typeof P.componentDidMount=="function"&&(o.flags|=4194308)):(typeof P.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=p,o.memoizedState=F),P.props=p,P.state=F,P.context=K,p=A):(typeof P.componentDidMount=="function"&&(o.flags|=4194308),p=!1)}else{P=o.stateNode,Cp(i,o),A=o.memoizedProps,K=o.type===o.elementType?A:Mn(o.type,A),P.props=K,te=o.pendingProps,X=P.context,F=h.contextType,typeof F=="object"&&F!==null?F=kn(F):(F=Jt(h)?wr:Rt.current,F=oi(o,F));var ue=h.getDerivedStateFromProps;(Q=typeof ue=="function"||typeof P.getSnapshotBeforeUpdate=="function")||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(A!==te||X!==F)&&Zp(o,P,p,F),Ks=!1,X=o.memoizedState,P.state=X,Xo(o,p,P,v);var pe=o.memoizedState;A!==te||X!==pe||Yt.current||Ks?(typeof ue=="function"&&(Bu(o,h,ue,p),pe=o.memoizedState),(K=Ks||Xp(o,h,K,p,X,pe,F)||!1)?(Q||typeof P.UNSAFE_componentWillUpdate!="function"&&typeof P.componentWillUpdate!="function"||(typeof P.componentWillUpdate=="function"&&P.componentWillUpdate(p,pe,F),typeof P.UNSAFE_componentWillUpdate=="function"&&P.UNSAFE_componentWillUpdate(p,pe,F)),typeof P.componentDidUpdate=="function"&&(o.flags|=4),typeof P.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof P.componentDidUpdate!="function"||A===i.memoizedProps&&X===i.memoizedState||(o.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||A===i.memoizedProps&&X===i.memoizedState||(o.flags|=1024),o.memoizedProps=p,o.memoizedState=pe),P.props=p,P.state=pe,P.context=F,p=K):(typeof P.componentDidUpdate!="function"||A===i.memoizedProps&&X===i.memoizedState||(o.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||A===i.memoizedProps&&X===i.memoizedState||(o.flags|=1024),p=!1)}return Vu(i,o,h,p,w,v)}function Vu(i,o,h,p,v,w){cm(i,o);var P=(o.flags&128)!==0;if(!p&&!P)return v&&mp(o,h,!1),vs(i,o,w);p=o.stateNode,M0.current=o;var A=P&&typeof h.getDerivedStateFromError!="function"?null:p.render();return o.flags|=1,i!==null&&P?(o.child=di(o,i.child,null,w),o.child=di(o,null,A,w)):Vt(i,o,A,w),o.memoizedState=p.state,v&&mp(o,h,!0),o.child}function dm(i){var o=i.stateNode;o.pendingContext?fp(i,o.pendingContext,o.pendingContext!==o.context):o.context&&fp(i,o.context,!1),Pu(i,o.containerInfo)}function hm(i,o,h,p,v){return ui(),bu(v),o.flags|=256,Vt(i,o,h,p),o.child}var qu={dehydrated:null,treeContext:null,retryLane:0};function Hu(i){return{baseLanes:i,cachePool:null,transitions:null}}function fm(i,o,h){var p=o.pendingProps,v=rt.current,w=!1,P=(o.flags&128)!==0,A;if((A=P)||(A=i!==null&&i.memoizedState===null?!1:(v&2)!==0),A?(w=!0,o.flags&=-129):(i===null||i.memoizedState!==null)&&(v|=1),Ke(rt,v&1),i===null)return xu(o),i=o.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?((o.mode&1)===0?o.lanes=1:i.data==="$!"?o.lanes=8:o.lanes=1073741824,null):(P=p.children,i=p.fallback,w?(p=o.mode,w=o.child,P={mode:"hidden",children:P},(p&1)===0&&w!==null?(w.childLanes=0,w.pendingProps=P):w=vl(P,p,0,null),i=Nr(i,p,h,null),w.return=o,i.return=o,w.sibling=i,o.child=w,o.child.memoizedState=Hu(h),o.memoizedState=qu,i):Ku(o,P));if(v=i.memoizedState,v!==null&&(A=v.dehydrated,A!==null))return L0(i,o,P,p,A,v,h);if(w){w=p.fallback,P=o.mode,v=i.child,A=v.sibling;var F={mode:"hidden",children:p.children};return(P&1)===0&&o.child!==v?(p=o.child,p.childLanes=0,p.pendingProps=F,o.deletions=null):(p=er(v,F),p.subtreeFlags=v.subtreeFlags&14680064),A!==null?w=er(A,w):(w=Nr(w,P,h,null),w.flags|=2),w.return=o,p.return=o,p.sibling=w,o.child=p,p=w,w=o.child,P=i.child.memoizedState,P=P===null?Hu(h):{baseLanes:P.baseLanes|h,cachePool:null,transitions:P.transitions},w.memoizedState=P,w.childLanes=i.childLanes&~h,o.memoizedState=qu,p}return w=i.child,i=w.sibling,p=er(w,{mode:"visible",children:p.children}),(o.mode&1)===0&&(p.lanes=h),p.return=o,p.sibling=null,i!==null&&(h=o.deletions,h===null?(o.deletions=[i],o.flags|=16):h.push(i)),o.child=p,o.memoizedState=null,p}function Ku(i,o){return o=vl({mode:"visible",children:o},i.mode,0,null),o.return=i,i.child=o}function il(i,o,h,p){return p!==null&&bu(p),di(o,i.child,null,h),i=Ku(o,o.pendingProps.children),i.flags|=2,o.memoizedState=null,i}function L0(i,o,h,p,v,w,P){if(h)return o.flags&256?(o.flags&=-257,p=zu(Error(n(422))),il(i,o,P,p)):o.memoizedState!==null?(o.child=i.child,o.flags|=128,null):(w=p.fallback,v=o.mode,p=vl({mode:"visible",children:p.children},v,0,null),w=Nr(w,v,P,null),w.flags|=2,p.return=o,w.return=o,p.sibling=w,o.child=p,(o.mode&1)!==0&&di(o,i.child,null,P),o.child.memoizedState=Hu(P),o.memoizedState=qu,w);if((o.mode&1)===0)return il(i,o,P,null);if(v.data==="$!"){if(p=v.nextSibling&&v.nextSibling.dataset,p)var A=p.dgst;return p=A,w=Error(n(419)),p=zu(w,p,void 0),il(i,o,P,p)}if(A=(P&i.childLanes)!==0,Xt||A){if(p=jt,p!==null){switch(P&-P){case 4:v=2;break;case 16:v=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:v=32;break;case 536870912:v=268435456;break;default:v=0}v=(v&(p.suspendedLanes|P))!==0?0:v,v!==0&&v!==w.retryLane&&(w.retryLane=v,gs(i,v),Fn(p,i,v,-1))}return cd(),p=zu(Error(n(421))),il(i,o,P,p)}return v.data==="$?"?(o.flags|=128,o.child=i.child,o=Y0.bind(null,i),v._reactRetry=o,null):(i=w.treeContext,cn=Ws(v.nextSibling),ln=o,Ze=!0,Rn=null,i!==null&&(_n[Sn++]=ps,_n[Sn++]=ms,_n[Sn++]=_r,ps=i.id,ms=i.overflow,_r=o),o=Ku(o,p.children),o.flags|=4096,o)}function pm(i,o,h){i.lanes|=o;var p=i.alternate;p!==null&&(p.lanes|=o),ku(i.return,o,h)}function Gu(i,o,h,p,v){var w=i.memoizedState;w===null?i.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:p,tail:h,tailMode:v}:(w.isBackwards=o,w.rendering=null,w.renderingStartTime=0,w.last=p,w.tail=h,w.tailMode=v)}function mm(i,o,h){var p=o.pendingProps,v=p.revealOrder,w=p.tail;if(Vt(i,o,p.children,h),p=rt.current,(p&2)!==0)p=p&1|2,o.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=o.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&pm(i,h,o);else if(i.tag===19)pm(i,h,o);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===o)break e;for(;i.sibling===null;){if(i.return===null||i.return===o)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}p&=1}if(Ke(rt,p),(o.mode&1)===0)o.memoizedState=null;else switch(v){case"forwards":for(h=o.child,v=null;h!==null;)i=h.alternate,i!==null&&Qo(i)===null&&(v=h),h=h.sibling;h=v,h===null?(v=o.child,o.child=null):(v=h.sibling,h.sibling=null),Gu(o,!1,v,h,w);break;case"backwards":for(h=null,v=o.child,o.child=null;v!==null;){if(i=v.alternate,i!==null&&Qo(i)===null){o.child=v;break}i=v.sibling,v.sibling=h,h=v,v=i}Gu(o,!0,h,null,w);break;case"together":Gu(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function al(i,o){(o.mode&1)===0&&i!==null&&(i.alternate=null,o.alternate=null,o.flags|=2)}function vs(i,o,h){if(i!==null&&(o.dependencies=i.dependencies),Pr|=o.lanes,(h&o.childLanes)===0)return null;if(i!==null&&o.child!==i.child)throw Error(n(153));if(o.child!==null){for(i=o.child,h=er(i,i.pendingProps),o.child=h,h.return=o;i.sibling!==null;)i=i.sibling,h=h.sibling=er(i,i.pendingProps),h.return=o;h.sibling=null}return o.child}function D0(i,o,h){switch(o.tag){case 3:dm(o),ui();break;case 5:Ep(o);break;case 1:Jt(o.type)&&Uo(o);break;case 4:Pu(o,o.stateNode.containerInfo);break;case 10:var p=o.type._context,v=o.memoizedProps.value;Ke(Go,p._currentValue),p._currentValue=v;break;case 13:if(p=o.memoizedState,p!==null)return p.dehydrated!==null?(Ke(rt,rt.current&1),o.flags|=128,null):(h&o.child.childLanes)!==0?fm(i,o,h):(Ke(rt,rt.current&1),i=vs(i,o,h),i!==null?i.sibling:null);Ke(rt,rt.current&1);break;case 19:if(p=(h&o.childLanes)!==0,(i.flags&128)!==0){if(p)return mm(i,o,h);o.flags|=128}if(v=o.memoizedState,v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),Ke(rt,rt.current),p)break;return null;case 22:case 23:return o.lanes=0,lm(i,o,h)}return vs(i,o,h)}var gm,Yu,ym,vm;gm=function(i,o){for(var h=o.child;h!==null;){if(h.tag===5||h.tag===6)i.appendChild(h.stateNode);else if(h.tag!==4&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===o)break;for(;h.sibling===null;){if(h.return===null||h.return===o)return;h=h.return}h.sibling.return=h.return,h=h.sibling}},Yu=function(){},ym=function(i,o,h,p){var v=i.memoizedProps;if(v!==p){i=o.stateNode,jr(Qn.current);var w=null;switch(h){case"input":v=We(i,v),p=We(i,p),w=[];break;case"select":v=ie({},v,{value:void 0}),p=ie({},p,{value:void 0}),w=[];break;case"textarea":v=us(i,v),p=us(i,p),w=[];break;default:typeof v.onClick!="function"&&typeof p.onClick=="function"&&(i.onclick=Bo)}Ms(h,p);var P;h=null;for(K in v)if(!p.hasOwnProperty(K)&&v.hasOwnProperty(K)&&v[K]!=null)if(K==="style"){var A=v[K];for(P in A)A.hasOwnProperty(P)&&(h||(h={}),h[P]="")}else K!=="dangerouslySetInnerHTML"&&K!=="children"&&K!=="suppressContentEditableWarning"&&K!=="suppressHydrationWarning"&&K!=="autoFocus"&&(r.hasOwnProperty(K)?w||(w=[]):(w=w||[]).push(K,null));for(K in p){var F=p[K];if(A=v?.[K],p.hasOwnProperty(K)&&F!==A&&(F!=null||A!=null))if(K==="style")if(A){for(P in A)!A.hasOwnProperty(P)||F&&F.hasOwnProperty(P)||(h||(h={}),h[P]="");for(P in F)F.hasOwnProperty(P)&&A[P]!==F[P]&&(h||(h={}),h[P]=F[P])}else h||(w||(w=[]),w.push(K,h)),h=F;else K==="dangerouslySetInnerHTML"?(F=F?F.__html:void 0,A=A?A.__html:void 0,F!=null&&A!==F&&(w=w||[]).push(K,F)):K==="children"?typeof F!="string"&&typeof F!="number"||(w=w||[]).push(K,""+F):K!=="suppressContentEditableWarning"&&K!=="suppressHydrationWarning"&&(r.hasOwnProperty(K)?(F!=null&&K==="onScroll"&&Je("scroll",i),w||A===F||(w=[])):(w=w||[]).push(K,F))}h&&(w=w||[]).push("style",h);var K=w;(o.updateQueue=K)&&(o.flags|=4)}},vm=function(i,o,h,p){h!==p&&(o.flags|=4)};function ga(i,o){if(!Ze)switch(i.tailMode){case"hidden":o=i.tail;for(var h=null;o!==null;)o.alternate!==null&&(h=o),o=o.sibling;h===null?i.tail=null:h.sibling=null;break;case"collapsed":h=i.tail;for(var p=null;h!==null;)h.alternate!==null&&(p=h),h=h.sibling;p===null?o||i.tail===null?i.tail=null:i.tail.sibling=null:p.sibling=null}}function Lt(i){var o=i.alternate!==null&&i.alternate.child===i.child,h=0,p=0;if(o)for(var v=i.child;v!==null;)h|=v.lanes|v.childLanes,p|=v.subtreeFlags&14680064,p|=v.flags&14680064,v.return=i,v=v.sibling;else for(v=i.child;v!==null;)h|=v.lanes|v.childLanes,p|=v.subtreeFlags,p|=v.flags,v.return=i,v=v.sibling;return i.subtreeFlags|=p,i.childLanes=h,o}function F0(i,o,h){var p=o.pendingProps;switch(yu(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Lt(o),null;case 1:return Jt(o.type)&&zo(),Lt(o),null;case 3:return p=o.stateNode,pi(),Xe(Yt),Xe(Rt),Tu(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(i===null||i.child===null)&&(Ho(o)?o.flags|=4:i===null||i.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,Rn!==null&&(ad(Rn),Rn=null))),Yu(i,o),Lt(o),null;case 5:Iu(o);var v=jr(da.current);if(h=o.type,i!==null&&o.stateNode!=null)ym(i,o,h,p,v),i.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!p){if(o.stateNode===null)throw Error(n(166));return Lt(o),null}if(i=jr(Qn.current),Ho(o)){p=o.stateNode,h=o.type;var w=o.memoizedProps;switch(p[Xn]=o,p[aa]=w,i=(o.mode&1)!==0,h){case"dialog":Je("cancel",p),Je("close",p);break;case"iframe":case"object":case"embed":Je("load",p);break;case"video":case"audio":for(v=0;v<sa.length;v++)Je(sa[v],p);break;case"source":Je("error",p);break;case"img":case"image":case"link":Je("error",p),Je("load",p);break;case"details":Je("toggle",p);break;case"input":ls(p,w),Je("invalid",p);break;case"select":p._wrapperState={wasMultiple:!!w.multiple},Je("invalid",p);break;case"textarea":vn(p,w),Je("invalid",p)}Ms(h,w),v=null;for(var P in w)if(w.hasOwnProperty(P)){var A=w[P];P==="children"?typeof A=="string"?p.textContent!==A&&(w.suppressHydrationWarning!==!0&&Fo(p.textContent,A,i),v=["children",A]):typeof A=="number"&&p.textContent!==""+A&&(w.suppressHydrationWarning!==!0&&Fo(p.textContent,A,i),v=["children",""+A]):r.hasOwnProperty(P)&&A!=null&&P==="onScroll"&&Je("scroll",p)}switch(h){case"input":Kt(p),Tn(p,w,!0);break;case"textarea":Kt(p),St(p);break;case"select":case"option":break;default:typeof w.onClick=="function"&&(p.onclick=Bo)}p=v,o.updateQueue=p,p!==null&&(o.flags|=4)}else{P=v.nodeType===9?v:v.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=Ot(h)),i==="http://www.w3.org/1999/xhtml"?h==="script"?(i=P.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof p.is=="string"?i=P.createElement(h,{is:p.is}):(i=P.createElement(h),h==="select"&&(P=i,p.multiple?P.multiple=!0:p.size&&(P.size=p.size))):i=P.createElementNS(i,h),i[Xn]=o,i[aa]=p,gm(i,o,!1,!1),o.stateNode=i;e:{switch(P=Gn(h,p),h){case"dialog":Je("cancel",i),Je("close",i),v=p;break;case"iframe":case"object":case"embed":Je("load",i),v=p;break;case"video":case"audio":for(v=0;v<sa.length;v++)Je(sa[v],i);v=p;break;case"source":Je("error",i),v=p;break;case"img":case"image":case"link":Je("error",i),Je("load",i),v=p;break;case"details":Je("toggle",i),v=p;break;case"input":ls(i,p),v=We(i,p),Je("invalid",i);break;case"option":v=p;break;case"select":i._wrapperState={wasMultiple:!!p.multiple},v=ie({},p,{value:void 0}),Je("invalid",i);break;case"textarea":vn(i,p),v=us(i,p),Je("invalid",i);break;default:v=p}Ms(h,v),A=v;for(w in A)if(A.hasOwnProperty(w)){var F=A[w];w==="style"?gt(i,F):w==="dangerouslySetInnerHTML"?(F=F?F.__html:void 0,F!=null&&gr(i,F)):w==="children"?typeof F=="string"?(h!=="textarea"||F!=="")&&an(i,F):typeof F=="number"&&an(i,""+F):w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&w!=="autoFocus"&&(r.hasOwnProperty(w)?F!=null&&w==="onScroll"&&Je("scroll",i):F!=null&&C(i,w,F,P))}switch(h){case"input":Kt(i),Tn(i,p,!1);break;case"textarea":Kt(i),St(i);break;case"option":p.value!=null&&i.setAttribute("value",""+Te(p.value));break;case"select":i.multiple=!!p.multiple,w=p.value,w!=null?yn(i,!!p.multiple,w,!1):p.defaultValue!=null&&yn(i,!!p.multiple,p.defaultValue,!0);break;default:typeof v.onClick=="function"&&(i.onclick=Bo)}switch(h){case"button":case"input":case"select":case"textarea":p=!!p.autoFocus;break e;case"img":p=!0;break e;default:p=!1}}p&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return Lt(o),null;case 6:if(i&&o.stateNode!=null)vm(i,o,i.memoizedProps,p);else{if(typeof p!="string"&&o.stateNode===null)throw Error(n(166));if(h=jr(da.current),jr(Qn.current),Ho(o)){if(p=o.stateNode,h=o.memoizedProps,p[Xn]=o,(w=p.nodeValue!==h)&&(i=ln,i!==null))switch(i.tag){case 3:Fo(p.nodeValue,h,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&Fo(p.nodeValue,h,(i.mode&1)!==0)}w&&(o.flags|=4)}else p=(h.nodeType===9?h:h.ownerDocument).createTextNode(p),p[Xn]=o,o.stateNode=p}return Lt(o),null;case 13:if(Xe(rt),p=o.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(Ze&&cn!==null&&(o.mode&1)!==0&&(o.flags&128)===0)wp(),ui(),o.flags|=98560,w=!1;else if(w=Ho(o),p!==null&&p.dehydrated!==null){if(i===null){if(!w)throw Error(n(318));if(w=o.memoizedState,w=w!==null?w.dehydrated:null,!w)throw Error(n(317));w[Xn]=o}else ui(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;Lt(o),w=!1}else Rn!==null&&(ad(Rn),Rn=null),w=!0;if(!w)return o.flags&65536?o:null}return(o.flags&128)!==0?(o.lanes=h,o):(p=p!==null,p!==(i!==null&&i.memoizedState!==null)&&p&&(o.child.flags|=8192,(o.mode&1)!==0&&(i===null||(rt.current&1)!==0?bt===0&&(bt=3):cd())),o.updateQueue!==null&&(o.flags|=4),Lt(o),null);case 4:return pi(),Yu(i,o),i===null&&ra(o.stateNode.containerInfo),Lt(o),null;case 10:return Su(o.type._context),Lt(o),null;case 17:return Jt(o.type)&&zo(),Lt(o),null;case 19:if(Xe(rt),w=o.memoizedState,w===null)return Lt(o),null;if(p=(o.flags&128)!==0,P=w.rendering,P===null)if(p)ga(w,!1);else{if(bt!==0||i!==null&&(i.flags&128)!==0)for(i=o.child;i!==null;){if(P=Qo(i),P!==null){for(o.flags|=128,ga(w,!1),p=P.updateQueue,p!==null&&(o.updateQueue=p,o.flags|=4),o.subtreeFlags=0,p=h,h=o.child;h!==null;)w=h,i=p,w.flags&=14680066,P=w.alternate,P===null?(w.childLanes=0,w.lanes=i,w.child=null,w.subtreeFlags=0,w.memoizedProps=null,w.memoizedState=null,w.updateQueue=null,w.dependencies=null,w.stateNode=null):(w.childLanes=P.childLanes,w.lanes=P.lanes,w.child=P.child,w.subtreeFlags=0,w.deletions=null,w.memoizedProps=P.memoizedProps,w.memoizedState=P.memoizedState,w.updateQueue=P.updateQueue,w.type=P.type,i=P.dependencies,w.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),h=h.sibling;return Ke(rt,rt.current&1|2),o.child}i=i.sibling}w.tail!==null&&ht()>vi&&(o.flags|=128,p=!0,ga(w,!1),o.lanes=4194304)}else{if(!p)if(i=Qo(P),i!==null){if(o.flags|=128,p=!0,h=i.updateQueue,h!==null&&(o.updateQueue=h,o.flags|=4),ga(w,!0),w.tail===null&&w.tailMode==="hidden"&&!P.alternate&&!Ze)return Lt(o),null}else 2*ht()-w.renderingStartTime>vi&&h!==1073741824&&(o.flags|=128,p=!0,ga(w,!1),o.lanes=4194304);w.isBackwards?(P.sibling=o.child,o.child=P):(h=w.last,h!==null?h.sibling=P:o.child=P,w.last=P)}return w.tail!==null?(o=w.tail,w.rendering=o,w.tail=o.sibling,w.renderingStartTime=ht(),o.sibling=null,h=rt.current,Ke(rt,p?h&1|2:h&1),o):(Lt(o),null);case 22:case 23:return ld(),p=o.memoizedState!==null,i!==null&&i.memoizedState!==null!==p&&(o.flags|=8192),p&&(o.mode&1)!==0?(un&1073741824)!==0&&(Lt(o),o.subtreeFlags&6&&(o.flags|=8192)):Lt(o),null;case 24:return null;case 25:return null}throw Error(n(156,o.tag))}function B0(i,o){switch(yu(o),o.tag){case 1:return Jt(o.type)&&zo(),i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 3:return pi(),Xe(Yt),Xe(Rt),Tu(),i=o.flags,(i&65536)!==0&&(i&128)===0?(o.flags=i&-65537|128,o):null;case 5:return Iu(o),null;case 13:if(Xe(rt),i=o.memoizedState,i!==null&&i.dehydrated!==null){if(o.alternate===null)throw Error(n(340));ui()}return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 19:return Xe(rt),null;case 4:return pi(),null;case 10:return Su(o.type._context),null;case 22:case 23:return ld(),null;case 24:return null;default:return null}}var ol=!1,Dt=!1,$0=typeof WeakSet=="function"?WeakSet:Set,fe=null;function gi(i,o){var h=i.ref;if(h!==null)if(typeof h=="function")try{h(null)}catch(p){lt(i,o,p)}else h.current=null}function Ju(i,o,h){try{h()}catch(p){lt(i,o,p)}}var xm=!1;function z0(i,o){if(lu=Po,i=Xf(),eu(i)){if("selectionStart"in i)var h={start:i.selectionStart,end:i.selectionEnd};else e:{h=(h=i.ownerDocument)&&h.defaultView||window;var p=h.getSelection&&h.getSelection();if(p&&p.rangeCount!==0){h=p.anchorNode;var v=p.anchorOffset,w=p.focusNode;p=p.focusOffset;try{h.nodeType,w.nodeType}catch{h=null;break e}var P=0,A=-1,F=-1,K=0,Q=0,te=i,X=null;t:for(;;){for(var ue;te!==h||v!==0&&te.nodeType!==3||(A=P+v),te!==w||p!==0&&te.nodeType!==3||(F=P+p),te.nodeType===3&&(P+=te.nodeValue.length),(ue=te.firstChild)!==null;)X=te,te=ue;for(;;){if(te===i)break t;if(X===h&&++K===v&&(A=P),X===w&&++Q===p&&(F=P),(ue=te.nextSibling)!==null)break;te=X,X=te.parentNode}te=ue}h=A===-1||F===-1?null:{start:A,end:F}}else h=null}h=h||{start:0,end:0}}else h=null;for(cu={focusedElem:i,selectionRange:h},Po=!1,fe=o;fe!==null;)if(o=fe,i=o.child,(o.subtreeFlags&1028)!==0&&i!==null)i.return=o,fe=i;else for(;fe!==null;){o=fe;try{var pe=o.alternate;if((o.flags&1024)!==0)switch(o.tag){case 0:case 11:case 15:break;case 1:if(pe!==null){var me=pe.memoizedProps,ft=pe.memoizedState,V=o.stateNode,$=V.getSnapshotBeforeUpdate(o.elementType===o.type?me:Mn(o.type,me),ft);V.__reactInternalSnapshotBeforeUpdate=$}break;case 3:var q=o.stateNode.containerInfo;q.nodeType===1?q.textContent="":q.nodeType===9&&q.documentElement&&q.removeChild(q.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(n(163))}}catch(re){lt(o,o.return,re)}if(i=o.sibling,i!==null){i.return=o.return,fe=i;break}fe=o.return}return pe=xm,xm=!1,pe}function ya(i,o,h){var p=o.updateQueue;if(p=p!==null?p.lastEffect:null,p!==null){var v=p=p.next;do{if((v.tag&i)===i){var w=v.destroy;v.destroy=void 0,w!==void 0&&Ju(o,h,w)}v=v.next}while(v!==p)}}function ll(i,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var h=o=o.next;do{if((h.tag&i)===i){var p=h.create;h.destroy=p()}h=h.next}while(h!==o)}}function Xu(i){var o=i.ref;if(o!==null){var h=i.stateNode;i.tag,i=h,typeof o=="function"?o(i):o.current=i}}function bm(i){var o=i.alternate;o!==null&&(i.alternate=null,bm(o)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(o=i.stateNode,o!==null&&(delete o[Xn],delete o[aa],delete o[fu],delete o[S0],delete o[k0])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function wm(i){return i.tag===5||i.tag===3||i.tag===4}function _m(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||wm(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Qu(i,o,h){var p=i.tag;if(p===5||p===6)i=i.stateNode,o?h.nodeType===8?h.parentNode.insertBefore(i,o):h.insertBefore(i,o):(h.nodeType===8?(o=h.parentNode,o.insertBefore(i,h)):(o=h,o.appendChild(i)),h=h._reactRootContainer,h!=null||o.onclick!==null||(o.onclick=Bo));else if(p!==4&&(i=i.child,i!==null))for(Qu(i,o,h),i=i.sibling;i!==null;)Qu(i,o,h),i=i.sibling}function Zu(i,o,h){var p=i.tag;if(p===5||p===6)i=i.stateNode,o?h.insertBefore(i,o):h.appendChild(i);else if(p!==4&&(i=i.child,i!==null))for(Zu(i,o,h),i=i.sibling;i!==null;)Zu(i,o,h),i=i.sibling}var It=null,Ln=!1;function Ys(i,o,h){for(h=h.child;h!==null;)Sm(i,o,h),h=h.sibling}function Sm(i,o,h){if(Jn&&typeof Jn.onCommitFiberUnmount=="function")try{Jn.onCommitFiberUnmount(wo,h)}catch{}switch(h.tag){case 5:Dt||gi(h,o);case 6:var p=It,v=Ln;It=null,Ys(i,o,h),It=p,Ln=v,It!==null&&(Ln?(i=It,h=h.stateNode,i.nodeType===8?i.parentNode.removeChild(h):i.removeChild(h)):It.removeChild(h.stateNode));break;case 18:It!==null&&(Ln?(i=It,h=h.stateNode,i.nodeType===8?hu(i.parentNode,h):i.nodeType===1&&hu(i,h),Yi(i)):hu(It,h.stateNode));break;case 4:p=It,v=Ln,It=h.stateNode.containerInfo,Ln=!0,Ys(i,o,h),It=p,Ln=v;break;case 0:case 11:case 14:case 15:if(!Dt&&(p=h.updateQueue,p!==null&&(p=p.lastEffect,p!==null))){v=p=p.next;do{var w=v,P=w.destroy;w=w.tag,P!==void 0&&((w&2)!==0||(w&4)!==0)&&Ju(h,o,P),v=v.next}while(v!==p)}Ys(i,o,h);break;case 1:if(!Dt&&(gi(h,o),p=h.stateNode,typeof p.componentWillUnmount=="function"))try{p.props=h.memoizedProps,p.state=h.memoizedState,p.componentWillUnmount()}catch(A){lt(h,o,A)}Ys(i,o,h);break;case 21:Ys(i,o,h);break;case 22:h.mode&1?(Dt=(p=Dt)||h.memoizedState!==null,Ys(i,o,h),Dt=p):Ys(i,o,h);break;default:Ys(i,o,h)}}function km(i){var o=i.updateQueue;if(o!==null){i.updateQueue=null;var h=i.stateNode;h===null&&(h=i.stateNode=new $0),o.forEach(function(p){var v=J0.bind(null,i,p);h.has(p)||(h.add(p),p.then(v,v))})}}function Dn(i,o){var h=o.deletions;if(h!==null)for(var p=0;p<h.length;p++){var v=h[p];try{var w=i,P=o,A=P;e:for(;A!==null;){switch(A.tag){case 5:It=A.stateNode,Ln=!1;break e;case 3:It=A.stateNode.containerInfo,Ln=!0;break e;case 4:It=A.stateNode.containerInfo,Ln=!0;break e}A=A.return}if(It===null)throw Error(n(160));Sm(w,P,v),It=null,Ln=!1;var F=v.alternate;F!==null&&(F.return=null),v.return=null}catch(K){lt(v,o,K)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)jm(o,i),o=o.sibling}function jm(i,o){var h=i.alternate,p=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(Dn(o,i),es(i),p&4){try{ya(3,i,i.return),ll(3,i)}catch(me){lt(i,i.return,me)}try{ya(5,i,i.return)}catch(me){lt(i,i.return,me)}}break;case 1:Dn(o,i),es(i),p&512&&h!==null&&gi(h,h.return);break;case 5:if(Dn(o,i),es(i),p&512&&h!==null&&gi(h,h.return),i.flags&32){var v=i.stateNode;try{an(v,"")}catch(me){lt(i,i.return,me)}}if(p&4&&(v=i.stateNode,v!=null)){var w=i.memoizedProps,P=h!==null?h.memoizedProps:w,A=i.type,F=i.updateQueue;if(i.updateQueue=null,F!==null)try{A==="input"&&w.type==="radio"&&w.name!=null&&cs(v,w),Gn(A,P);var K=Gn(A,w);for(P=0;P<F.length;P+=2){var Q=F[P],te=F[P+1];Q==="style"?gt(v,te):Q==="dangerouslySetInnerHTML"?gr(v,te):Q==="children"?an(v,te):C(v,Q,te,K)}switch(A){case"input":Hn(v,w);break;case"textarea":Gt(v,w);break;case"select":var X=v._wrapperState.wasMultiple;v._wrapperState.wasMultiple=!!w.multiple;var ue=w.value;ue!=null?yn(v,!!w.multiple,ue,!1):X!==!!w.multiple&&(w.defaultValue!=null?yn(v,!!w.multiple,w.defaultValue,!0):yn(v,!!w.multiple,w.multiple?[]:"",!1))}v[aa]=w}catch(me){lt(i,i.return,me)}}break;case 6:if(Dn(o,i),es(i),p&4){if(i.stateNode===null)throw Error(n(162));v=i.stateNode,w=i.memoizedProps;try{v.nodeValue=w}catch(me){lt(i,i.return,me)}}break;case 3:if(Dn(o,i),es(i),p&4&&h!==null&&h.memoizedState.isDehydrated)try{Yi(o.containerInfo)}catch(me){lt(i,i.return,me)}break;case 4:Dn(o,i),es(i);break;case 13:Dn(o,i),es(i),v=i.child,v.flags&8192&&(w=v.memoizedState!==null,v.stateNode.isHidden=w,!w||v.alternate!==null&&v.alternate.memoizedState!==null||(nd=ht())),p&4&&km(i);break;case 22:if(Q=h!==null&&h.memoizedState!==null,i.mode&1?(Dt=(K=Dt)||Q,Dn(o,i),Dt=K):Dn(o,i),es(i),p&8192){if(K=i.memoizedState!==null,(i.stateNode.isHidden=K)&&!Q&&(i.mode&1)!==0)for(fe=i,Q=i.child;Q!==null;){for(te=fe=Q;fe!==null;){switch(X=fe,ue=X.child,X.tag){case 0:case 11:case 14:case 15:ya(4,X,X.return);break;case 1:gi(X,X.return);var pe=X.stateNode;if(typeof pe.componentWillUnmount=="function"){p=X,h=X.return;try{o=p,pe.props=o.memoizedProps,pe.state=o.memoizedState,pe.componentWillUnmount()}catch(me){lt(p,h,me)}}break;case 5:gi(X,X.return);break;case 22:if(X.memoizedState!==null){Im(te);continue}}ue!==null?(ue.return=X,fe=ue):Im(te)}Q=Q.sibling}e:for(Q=null,te=i;;){if(te.tag===5){if(Q===null){Q=te;try{v=te.stateNode,K?(w=v.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none"):(A=te.stateNode,F=te.memoizedProps.style,P=F!=null&&F.hasOwnProperty("display")?F.display:null,A.style.display=Jr("display",P))}catch(me){lt(i,i.return,me)}}}else if(te.tag===6){if(Q===null)try{te.stateNode.nodeValue=K?"":te.memoizedProps}catch(me){lt(i,i.return,me)}}else if((te.tag!==22&&te.tag!==23||te.memoizedState===null||te===i)&&te.child!==null){te.child.return=te,te=te.child;continue}if(te===i)break e;for(;te.sibling===null;){if(te.return===null||te.return===i)break e;Q===te&&(Q=null),te=te.return}Q===te&&(Q=null),te.sibling.return=te.return,te=te.sibling}}break;case 19:Dn(o,i),es(i),p&4&&km(i);break;case 21:break;default:Dn(o,i),es(i)}}function es(i){var o=i.flags;if(o&2){try{e:{for(var h=i.return;h!==null;){if(wm(h)){var p=h;break e}h=h.return}throw Error(n(160))}switch(p.tag){case 5:var v=p.stateNode;p.flags&32&&(an(v,""),p.flags&=-33);var w=_m(i);Zu(i,w,v);break;case 3:case 4:var P=p.stateNode.containerInfo,A=_m(i);Qu(i,A,P);break;default:throw Error(n(161))}}catch(F){lt(i,i.return,F)}i.flags&=-3}o&4096&&(i.flags&=-4097)}function U0(i,o,h){fe=i,Cm(i)}function Cm(i,o,h){for(var p=(i.mode&1)!==0;fe!==null;){var v=fe,w=v.child;if(v.tag===22&&p){var P=v.memoizedState!==null||ol;if(!P){var A=v.alternate,F=A!==null&&A.memoizedState!==null||Dt;A=ol;var K=Dt;if(ol=P,(Dt=F)&&!K)for(fe=v;fe!==null;)P=fe,F=P.child,P.tag===22&&P.memoizedState!==null?Em(v):F!==null?(F.return=P,fe=F):Em(v);for(;w!==null;)fe=w,Cm(w),w=w.sibling;fe=v,ol=A,Dt=K}Pm(i)}else(v.subtreeFlags&8772)!==0&&w!==null?(w.return=v,fe=w):Pm(i)}}function Pm(i){for(;fe!==null;){var o=fe;if((o.flags&8772)!==0){var h=o.alternate;try{if((o.flags&8772)!==0)switch(o.tag){case 0:case 11:case 15:Dt||ll(5,o);break;case 1:var p=o.stateNode;if(o.flags&4&&!Dt)if(h===null)p.componentDidMount();else{var v=o.elementType===o.type?h.memoizedProps:Mn(o.type,h.memoizedProps);p.componentDidUpdate(v,h.memoizedState,p.__reactInternalSnapshotBeforeUpdate)}var w=o.updateQueue;w!==null&&Ip(o,w,p);break;case 3:var P=o.updateQueue;if(P!==null){if(h=null,o.child!==null)switch(o.child.tag){case 5:h=o.child.stateNode;break;case 1:h=o.child.stateNode}Ip(o,P,h)}break;case 5:var A=o.stateNode;if(h===null&&o.flags&4){h=A;var F=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":F.autoFocus&&h.focus();break;case"img":F.src&&(h.src=F.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var K=o.alternate;if(K!==null){var Q=K.memoizedState;if(Q!==null){var te=Q.dehydrated;te!==null&&Yi(te)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(n(163))}Dt||o.flags&512&&Xu(o)}catch(X){lt(o,o.return,X)}}if(o===i){fe=null;break}if(h=o.sibling,h!==null){h.return=o.return,fe=h;break}fe=o.return}}function Im(i){for(;fe!==null;){var o=fe;if(o===i){fe=null;break}var h=o.sibling;if(h!==null){h.return=o.return,fe=h;break}fe=o.return}}function Em(i){for(;fe!==null;){var o=fe;try{switch(o.tag){case 0:case 11:case 15:var h=o.return;try{ll(4,o)}catch(F){lt(o,h,F)}break;case 1:var p=o.stateNode;if(typeof p.componentDidMount=="function"){var v=o.return;try{p.componentDidMount()}catch(F){lt(o,v,F)}}var w=o.return;try{Xu(o)}catch(F){lt(o,w,F)}break;case 5:var P=o.return;try{Xu(o)}catch(F){lt(o,P,F)}}}catch(F){lt(o,o.return,F)}if(o===i){fe=null;break}var A=o.sibling;if(A!==null){A.return=o.return,fe=A;break}fe=o.return}}var W0=Math.ceil,cl=N.ReactCurrentDispatcher,ed=N.ReactCurrentOwner,Cn=N.ReactCurrentBatchConfig,Le=0,jt=null,yt=null,Et=0,un=0,yi=Vs(0),bt=0,va=null,Pr=0,ul=0,td=0,xa=null,Qt=null,nd=0,vi=1/0,xs=null,dl=!1,sd=null,Js=null,hl=!1,Xs=null,fl=0,ba=0,rd=null,pl=-1,ml=0;function qt(){return(Le&6)!==0?ht():pl!==-1?pl:pl=ht()}function Qs(i){return(i.mode&1)===0?1:(Le&2)!==0&&Et!==0?Et&-Et:C0.transition!==null?(ml===0&&(ml=_f()),ml):(i=qe,i!==0||(i=window.event,i=i===void 0?16:Nf(i.type)),i)}function Fn(i,o,h,p){if(50<ba)throw ba=0,rd=null,Error(n(185));Vi(i,h,p),((Le&2)===0||i!==jt)&&(i===jt&&((Le&2)===0&&(ul|=h),bt===4&&Zs(i,Et)),Zt(i,p),h===1&&Le===0&&(o.mode&1)===0&&(vi=ht()+500,Wo&&Hs()))}function Zt(i,o){var h=i.callbackNode;Cb(i,o);var p=ko(i,i===jt?Et:0);if(p===0)h!==null&&xf(h),i.callbackNode=null,i.callbackPriority=0;else if(o=p&-p,i.callbackPriority!==o){if(h!=null&&xf(h),o===1)i.tag===0?j0(Nm.bind(null,i)):gp(Nm.bind(null,i)),w0(function(){(Le&6)===0&&Hs()}),h=null;else{switch(Sf(p)){case 1:h=Dc;break;case 4:h=bf;break;case 16:h=bo;break;case 536870912:h=wf;break;default:h=bo}h=Bm(h,Tm.bind(null,i))}i.callbackPriority=o,i.callbackNode=h}}function Tm(i,o){if(pl=-1,ml=0,(Le&6)!==0)throw Error(n(327));var h=i.callbackNode;if(xi()&&i.callbackNode!==h)return null;var p=ko(i,i===jt?Et:0);if(p===0)return null;if((p&30)!==0||(p&i.expiredLanes)!==0||o)o=gl(i,p);else{o=p;var v=Le;Le|=2;var w=Om();(jt!==i||Et!==o)&&(xs=null,vi=ht()+500,Er(i,o));do try{H0();break}catch(A){Am(i,A)}while(!0);_u(),cl.current=w,Le=v,yt!==null?o=0:(jt=null,Et=0,o=bt)}if(o!==0){if(o===2&&(v=Fc(i),v!==0&&(p=v,o=id(i,v))),o===1)throw h=va,Er(i,0),Zs(i,p),Zt(i,ht()),h;if(o===6)Zs(i,p);else{if(v=i.current.alternate,(p&30)===0&&!V0(v)&&(o=gl(i,p),o===2&&(w=Fc(i),w!==0&&(p=w,o=id(i,w))),o===1))throw h=va,Er(i,0),Zs(i,p),Zt(i,ht()),h;switch(i.finishedWork=v,i.finishedLanes=p,o){case 0:case 1:throw Error(n(345));case 2:Tr(i,Qt,xs);break;case 3:if(Zs(i,p),(p&130023424)===p&&(o=nd+500-ht(),10<o)){if(ko(i,0)!==0)break;if(v=i.suspendedLanes,(v&p)!==p){qt(),i.pingedLanes|=i.suspendedLanes&v;break}i.timeoutHandle=du(Tr.bind(null,i,Qt,xs),o);break}Tr(i,Qt,xs);break;case 4:if(Zs(i,p),(p&4194240)===p)break;for(o=i.eventTimes,v=-1;0<p;){var P=31-An(p);w=1<<P,P=o[P],P>v&&(v=P),p&=~w}if(p=v,p=ht()-p,p=(120>p?120:480>p?480:1080>p?1080:1920>p?1920:3e3>p?3e3:4320>p?4320:1960*W0(p/1960))-p,10<p){i.timeoutHandle=du(Tr.bind(null,i,Qt,xs),p);break}Tr(i,Qt,xs);break;case 5:Tr(i,Qt,xs);break;default:throw Error(n(329))}}}return Zt(i,ht()),i.callbackNode===h?Tm.bind(null,i):null}function id(i,o){var h=xa;return i.current.memoizedState.isDehydrated&&(Er(i,o).flags|=256),i=gl(i,o),i!==2&&(o=Qt,Qt=h,o!==null&&ad(o)),i}function ad(i){Qt===null?Qt=i:Qt.push.apply(Qt,i)}function V0(i){for(var o=i;;){if(o.flags&16384){var h=o.updateQueue;if(h!==null&&(h=h.stores,h!==null))for(var p=0;p<h.length;p++){var v=h[p],w=v.getSnapshot;v=v.value;try{if(!On(w(),v))return!1}catch{return!1}}}if(h=o.child,o.subtreeFlags&16384&&h!==null)h.return=o,o=h;else{if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Zs(i,o){for(o&=~td,o&=~ul,i.suspendedLanes|=o,i.pingedLanes&=~o,i=i.expirationTimes;0<o;){var h=31-An(o),p=1<<h;i[h]=-1,o&=~p}}function Nm(i){if((Le&6)!==0)throw Error(n(327));xi();var o=ko(i,0);if((o&1)===0)return Zt(i,ht()),null;var h=gl(i,o);if(i.tag!==0&&h===2){var p=Fc(i);p!==0&&(o=p,h=id(i,p))}if(h===1)throw h=va,Er(i,0),Zs(i,o),Zt(i,ht()),h;if(h===6)throw Error(n(345));return i.finishedWork=i.current.alternate,i.finishedLanes=o,Tr(i,Qt,xs),Zt(i,ht()),null}function od(i,o){var h=Le;Le|=1;try{return i(o)}finally{Le=h,Le===0&&(vi=ht()+500,Wo&&Hs())}}function Ir(i){Xs!==null&&Xs.tag===0&&(Le&6)===0&&xi();var o=Le;Le|=1;var h=Cn.transition,p=qe;try{if(Cn.transition=null,qe=1,i)return i()}finally{qe=p,Cn.transition=h,Le=o,(Le&6)===0&&Hs()}}function ld(){un=yi.current,Xe(yi)}function Er(i,o){i.finishedWork=null,i.finishedLanes=0;var h=i.timeoutHandle;if(h!==-1&&(i.timeoutHandle=-1,b0(h)),yt!==null)for(h=yt.return;h!==null;){var p=h;switch(yu(p),p.tag){case 1:p=p.type.childContextTypes,p!=null&&zo();break;case 3:pi(),Xe(Yt),Xe(Rt),Tu();break;case 5:Iu(p);break;case 4:pi();break;case 13:Xe(rt);break;case 19:Xe(rt);break;case 10:Su(p.type._context);break;case 22:case 23:ld()}h=h.return}if(jt=i,yt=i=er(i.current,null),Et=un=o,bt=0,va=null,td=ul=Pr=0,Qt=xa=null,kr!==null){for(o=0;o<kr.length;o++)if(h=kr[o],p=h.interleaved,p!==null){h.interleaved=null;var v=p.next,w=h.pending;if(w!==null){var P=w.next;w.next=v,p.next=P}h.pending=p}kr=null}return i}function Am(i,o){do{var h=yt;try{if(_u(),Zo.current=sl,el){for(var p=it.memoizedState;p!==null;){var v=p.queue;v!==null&&(v.pending=null),p=p.next}el=!1}if(Cr=0,kt=xt=it=null,ha=!1,fa=0,ed.current=null,h===null||h.return===null){bt=1,va=o,yt=null;break}e:{var w=i,P=h.return,A=h,F=o;if(o=Et,A.flags|=32768,F!==null&&typeof F=="object"&&typeof F.then=="function"){var K=F,Q=A,te=Q.tag;if((Q.mode&1)===0&&(te===0||te===11||te===15)){var X=Q.alternate;X?(Q.updateQueue=X.updateQueue,Q.memoizedState=X.memoizedState,Q.lanes=X.lanes):(Q.updateQueue=null,Q.memoizedState=null)}var ue=sm(P);if(ue!==null){ue.flags&=-257,rm(ue,P,A,w,o),ue.mode&1&&nm(w,K,o),o=ue,F=K;var pe=o.updateQueue;if(pe===null){var me=new Set;me.add(F),o.updateQueue=me}else pe.add(F);break e}else{if((o&1)===0){nm(w,K,o),cd();break e}F=Error(n(426))}}else if(Ze&&A.mode&1){var ft=sm(P);if(ft!==null){(ft.flags&65536)===0&&(ft.flags|=256),rm(ft,P,A,w,o),bu(mi(F,A));break e}}w=F=mi(F,A),bt!==4&&(bt=2),xa===null?xa=[w]:xa.push(w),w=P;do{switch(w.tag){case 3:w.flags|=65536,o&=-o,w.lanes|=o;var V=em(w,F,o);Pp(w,V);break e;case 1:A=F;var $=w.type,q=w.stateNode;if((w.flags&128)===0&&(typeof $.getDerivedStateFromError=="function"||q!==null&&typeof q.componentDidCatch=="function"&&(Js===null||!Js.has(q)))){w.flags|=65536,o&=-o,w.lanes|=o;var re=tm(w,A,o);Pp(w,re);break e}}w=w.return}while(w!==null)}Mm(h)}catch(ye){o=ye,yt===h&&h!==null&&(yt=h=h.return);continue}break}while(!0)}function Om(){var i=cl.current;return cl.current=sl,i===null?sl:i}function cd(){(bt===0||bt===3||bt===2)&&(bt=4),jt===null||(Pr&268435455)===0&&(ul&268435455)===0||Zs(jt,Et)}function gl(i,o){var h=Le;Le|=2;var p=Om();(jt!==i||Et!==o)&&(xs=null,Er(i,o));do try{q0();break}catch(v){Am(i,v)}while(!0);if(_u(),Le=h,cl.current=p,yt!==null)throw Error(n(261));return jt=null,Et=0,bt}function q0(){for(;yt!==null;)Rm(yt)}function H0(){for(;yt!==null&&!yb();)Rm(yt)}function Rm(i){var o=Fm(i.alternate,i,un);i.memoizedProps=i.pendingProps,o===null?Mm(i):yt=o,ed.current=null}function Mm(i){var o=i;do{var h=o.alternate;if(i=o.return,(o.flags&32768)===0){if(h=F0(h,o,un),h!==null){yt=h;return}}else{if(h=B0(h,o),h!==null){h.flags&=32767,yt=h;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{bt=6,yt=null;return}}if(o=o.sibling,o!==null){yt=o;return}yt=o=i}while(o!==null);bt===0&&(bt=5)}function Tr(i,o,h){var p=qe,v=Cn.transition;try{Cn.transition=null,qe=1,K0(i,o,h,p)}finally{Cn.transition=v,qe=p}return null}function K0(i,o,h,p){do xi();while(Xs!==null);if((Le&6)!==0)throw Error(n(327));h=i.finishedWork;var v=i.finishedLanes;if(h===null)return null;if(i.finishedWork=null,i.finishedLanes=0,h===i.current)throw Error(n(177));i.callbackNode=null,i.callbackPriority=0;var w=h.lanes|h.childLanes;if(Pb(i,w),i===jt&&(yt=jt=null,Et=0),(h.subtreeFlags&2064)===0&&(h.flags&2064)===0||hl||(hl=!0,Bm(bo,function(){return xi(),null})),w=(h.flags&15990)!==0,(h.subtreeFlags&15990)!==0||w){w=Cn.transition,Cn.transition=null;var P=qe;qe=1;var A=Le;Le|=4,ed.current=null,z0(i,h),jm(h,i),f0(cu),Po=!!lu,cu=lu=null,i.current=h,U0(h),vb(),Le=A,qe=P,Cn.transition=w}else i.current=h;if(hl&&(hl=!1,Xs=i,fl=v),w=i.pendingLanes,w===0&&(Js=null),wb(h.stateNode),Zt(i,ht()),o!==null)for(p=i.onRecoverableError,h=0;h<o.length;h++)v=o[h],p(v.value,{componentStack:v.stack,digest:v.digest});if(dl)throw dl=!1,i=sd,sd=null,i;return(fl&1)!==0&&i.tag!==0&&xi(),w=i.pendingLanes,(w&1)!==0?i===rd?ba++:(ba=0,rd=i):ba=0,Hs(),null}function xi(){if(Xs!==null){var i=Sf(fl),o=Cn.transition,h=qe;try{if(Cn.transition=null,qe=16>i?16:i,Xs===null)var p=!1;else{if(i=Xs,Xs=null,fl=0,(Le&6)!==0)throw Error(n(331));var v=Le;for(Le|=4,fe=i.current;fe!==null;){var w=fe,P=w.child;if((fe.flags&16)!==0){var A=w.deletions;if(A!==null){for(var F=0;F<A.length;F++){var K=A[F];for(fe=K;fe!==null;){var Q=fe;switch(Q.tag){case 0:case 11:case 15:ya(8,Q,w)}var te=Q.child;if(te!==null)te.return=Q,fe=te;else for(;fe!==null;){Q=fe;var X=Q.sibling,ue=Q.return;if(bm(Q),Q===K){fe=null;break}if(X!==null){X.return=ue,fe=X;break}fe=ue}}}var pe=w.alternate;if(pe!==null){var me=pe.child;if(me!==null){pe.child=null;do{var ft=me.sibling;me.sibling=null,me=ft}while(me!==null)}}fe=w}}if((w.subtreeFlags&2064)!==0&&P!==null)P.return=w,fe=P;else e:for(;fe!==null;){if(w=fe,(w.flags&2048)!==0)switch(w.tag){case 0:case 11:case 15:ya(9,w,w.return)}var V=w.sibling;if(V!==null){V.return=w.return,fe=V;break e}fe=w.return}}var $=i.current;for(fe=$;fe!==null;){P=fe;var q=P.child;if((P.subtreeFlags&2064)!==0&&q!==null)q.return=P,fe=q;else e:for(P=$;fe!==null;){if(A=fe,(A.flags&2048)!==0)try{switch(A.tag){case 0:case 11:case 15:ll(9,A)}}catch(ye){lt(A,A.return,ye)}if(A===P){fe=null;break e}var re=A.sibling;if(re!==null){re.return=A.return,fe=re;break e}fe=A.return}}if(Le=v,Hs(),Jn&&typeof Jn.onPostCommitFiberRoot=="function")try{Jn.onPostCommitFiberRoot(wo,i)}catch{}p=!0}return p}finally{qe=h,Cn.transition=o}}return!1}function Lm(i,o,h){o=mi(h,o),o=em(i,o,1),i=Gs(i,o,1),o=qt(),i!==null&&(Vi(i,1,o),Zt(i,o))}function lt(i,o,h){if(i.tag===3)Lm(i,i,h);else for(;o!==null;){if(o.tag===3){Lm(o,i,h);break}else if(o.tag===1){var p=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(Js===null||!Js.has(p))){i=mi(h,i),i=tm(o,i,1),o=Gs(o,i,1),i=qt(),o!==null&&(Vi(o,1,i),Zt(o,i));break}}o=o.return}}function G0(i,o,h){var p=i.pingCache;p!==null&&p.delete(o),o=qt(),i.pingedLanes|=i.suspendedLanes&h,jt===i&&(Et&h)===h&&(bt===4||bt===3&&(Et&130023424)===Et&&500>ht()-nd?Er(i,0):td|=h),Zt(i,o)}function Dm(i,o){o===0&&((i.mode&1)===0?o=1:(o=So,So<<=1,(So&130023424)===0&&(So=4194304)));var h=qt();i=gs(i,o),i!==null&&(Vi(i,o,h),Zt(i,h))}function Y0(i){var o=i.memoizedState,h=0;o!==null&&(h=o.retryLane),Dm(i,h)}function J0(i,o){var h=0;switch(i.tag){case 13:var p=i.stateNode,v=i.memoizedState;v!==null&&(h=v.retryLane);break;case 19:p=i.stateNode;break;default:throw Error(n(314))}p!==null&&p.delete(o),Dm(i,h)}var Fm;Fm=function(i,o,h){if(i!==null)if(i.memoizedProps!==o.pendingProps||Yt.current)Xt=!0;else{if((i.lanes&h)===0&&(o.flags&128)===0)return Xt=!1,D0(i,o,h);Xt=(i.flags&131072)!==0}else Xt=!1,Ze&&(o.flags&1048576)!==0&&yp(o,qo,o.index);switch(o.lanes=0,o.tag){case 2:var p=o.type;al(i,o),i=o.pendingProps;var v=oi(o,Rt.current);fi(o,h),v=Ou(null,o,p,i,v,h);var w=Ru();return o.flags|=1,typeof v=="object"&&v!==null&&typeof v.render=="function"&&v.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,Jt(p)?(w=!0,Uo(o)):w=!1,o.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,Cu(o),v.updater=rl,o.stateNode=v,v._reactInternals=o,$u(o,p,i,h),o=Vu(null,o,p,!0,w,h)):(o.tag=0,Ze&&w&&gu(o),Vt(null,o,v,h),o=o.child),o;case 16:p=o.elementType;e:{switch(al(i,o),i=o.pendingProps,v=p._init,p=v(p._payload),o.type=p,v=o.tag=Q0(p),i=Mn(p,i),v){case 0:o=Wu(null,o,p,i,h);break e;case 1:o=um(null,o,p,i,h);break e;case 11:o=im(null,o,p,i,h);break e;case 14:o=am(null,o,p,Mn(p.type,i),h);break e}throw Error(n(306,p,""))}return o;case 0:return p=o.type,v=o.pendingProps,v=o.elementType===p?v:Mn(p,v),Wu(i,o,p,v,h);case 1:return p=o.type,v=o.pendingProps,v=o.elementType===p?v:Mn(p,v),um(i,o,p,v,h);case 3:e:{if(dm(o),i===null)throw Error(n(387));p=o.pendingProps,w=o.memoizedState,v=w.element,Cp(i,o),Xo(o,p,null,h);var P=o.memoizedState;if(p=P.element,w.isDehydrated)if(w={element:p,isDehydrated:!1,cache:P.cache,pendingSuspenseBoundaries:P.pendingSuspenseBoundaries,transitions:P.transitions},o.updateQueue.baseState=w,o.memoizedState=w,o.flags&256){v=mi(Error(n(423)),o),o=hm(i,o,p,h,v);break e}else if(p!==v){v=mi(Error(n(424)),o),o=hm(i,o,p,h,v);break e}else for(cn=Ws(o.stateNode.containerInfo.firstChild),ln=o,Ze=!0,Rn=null,h=kp(o,null,p,h),o.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling;else{if(ui(),p===v){o=vs(i,o,h);break e}Vt(i,o,p,h)}o=o.child}return o;case 5:return Ep(o),i===null&&xu(o),p=o.type,v=o.pendingProps,w=i!==null?i.memoizedProps:null,P=v.children,uu(p,v)?P=null:w!==null&&uu(p,w)&&(o.flags|=32),cm(i,o),Vt(i,o,P,h),o.child;case 6:return i===null&&xu(o),null;case 13:return fm(i,o,h);case 4:return Pu(o,o.stateNode.containerInfo),p=o.pendingProps,i===null?o.child=di(o,null,p,h):Vt(i,o,p,h),o.child;case 11:return p=o.type,v=o.pendingProps,v=o.elementType===p?v:Mn(p,v),im(i,o,p,v,h);case 7:return Vt(i,o,o.pendingProps,h),o.child;case 8:return Vt(i,o,o.pendingProps.children,h),o.child;case 12:return Vt(i,o,o.pendingProps.children,h),o.child;case 10:e:{if(p=o.type._context,v=o.pendingProps,w=o.memoizedProps,P=v.value,Ke(Go,p._currentValue),p._currentValue=P,w!==null)if(On(w.value,P)){if(w.children===v.children&&!Yt.current){o=vs(i,o,h);break e}}else for(w=o.child,w!==null&&(w.return=o);w!==null;){var A=w.dependencies;if(A!==null){P=w.child;for(var F=A.firstContext;F!==null;){if(F.context===p){if(w.tag===1){F=ys(-1,h&-h),F.tag=2;var K=w.updateQueue;if(K!==null){K=K.shared;var Q=K.pending;Q===null?F.next=F:(F.next=Q.next,Q.next=F),K.pending=F}}w.lanes|=h,F=w.alternate,F!==null&&(F.lanes|=h),ku(w.return,h,o),A.lanes|=h;break}F=F.next}}else if(w.tag===10)P=w.type===o.type?null:w.child;else if(w.tag===18){if(P=w.return,P===null)throw Error(n(341));P.lanes|=h,A=P.alternate,A!==null&&(A.lanes|=h),ku(P,h,o),P=w.sibling}else P=w.child;if(P!==null)P.return=w;else for(P=w;P!==null;){if(P===o){P=null;break}if(w=P.sibling,w!==null){w.return=P.return,P=w;break}P=P.return}w=P}Vt(i,o,v.children,h),o=o.child}return o;case 9:return v=o.type,p=o.pendingProps.children,fi(o,h),v=kn(v),p=p(v),o.flags|=1,Vt(i,o,p,h),o.child;case 14:return p=o.type,v=Mn(p,o.pendingProps),v=Mn(p.type,v),am(i,o,p,v,h);case 15:return om(i,o,o.type,o.pendingProps,h);case 17:return p=o.type,v=o.pendingProps,v=o.elementType===p?v:Mn(p,v),al(i,o),o.tag=1,Jt(p)?(i=!0,Uo(o)):i=!1,fi(o,h),Qp(o,p,v),$u(o,p,v,h),Vu(null,o,p,!0,i,h);case 19:return mm(i,o,h);case 22:return lm(i,o,h)}throw Error(n(156,o.tag))};function Bm(i,o){return vf(i,o)}function X0(i,o,h,p){this.tag=i,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pn(i,o,h,p){return new X0(i,o,h,p)}function ud(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Q0(i){if(typeof i=="function")return ud(i)?1:0;if(i!=null){if(i=i.$$typeof,i===Y)return 11;if(i===J)return 14}return 2}function er(i,o){var h=i.alternate;return h===null?(h=Pn(i.tag,o,i.key,i.mode),h.elementType=i.elementType,h.type=i.type,h.stateNode=i.stateNode,h.alternate=i,i.alternate=h):(h.pendingProps=o,h.type=i.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=i.flags&14680064,h.childLanes=i.childLanes,h.lanes=i.lanes,h.child=i.child,h.memoizedProps=i.memoizedProps,h.memoizedState=i.memoizedState,h.updateQueue=i.updateQueue,o=i.dependencies,h.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},h.sibling=i.sibling,h.index=i.index,h.ref=i.ref,h}function yl(i,o,h,p,v,w){var P=2;if(p=i,typeof i=="function")ud(i)&&(P=1);else if(typeof i=="string")P=5;else e:switch(i){case E:return Nr(h.children,v,w,o);case L:P=8,v|=8;break;case R:return i=Pn(12,h,o,v|2),i.elementType=R,i.lanes=w,i;case se:return i=Pn(13,h,o,v),i.elementType=se,i.lanes=w,i;case H:return i=Pn(19,h,o,v),i.elementType=H,i.lanes=w,i;case he:return vl(h,v,w,o);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case T:P=10;break e;case D:P=9;break e;case Y:P=11;break e;case J:P=14;break e;case ee:P=16,p=null;break e}throw Error(n(130,i==null?i:typeof i,""))}return o=Pn(P,h,o,v),o.elementType=i,o.type=p,o.lanes=w,o}function Nr(i,o,h,p){return i=Pn(7,i,p,o),i.lanes=h,i}function vl(i,o,h,p){return i=Pn(22,i,p,o),i.elementType=he,i.lanes=h,i.stateNode={isHidden:!1},i}function dd(i,o,h){return i=Pn(6,i,null,o),i.lanes=h,i}function hd(i,o,h){return o=Pn(4,i.children!==null?i.children:[],i.key,o),o.lanes=h,o.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},o}function Z0(i,o,h,p,v){this.tag=o,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Bc(0),this.expirationTimes=Bc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Bc(0),this.identifierPrefix=p,this.onRecoverableError=v,this.mutableSourceEagerHydrationData=null}function fd(i,o,h,p,v,w,P,A,F){return i=new Z0(i,o,h,A,F),o===1?(o=1,w===!0&&(o|=8)):o=0,w=Pn(3,null,null,o),i.current=w,w.stateNode=i,w.memoizedState={element:p,isDehydrated:h,cache:null,transitions:null,pendingSuspenseBoundaries:null},Cu(w),i}function ew(i,o,h){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:U,key:p==null?null:""+p,children:i,containerInfo:o,implementation:h}}function $m(i){if(!i)return qs;i=i._reactInternals;e:{if(xr(i)!==i||i.tag!==1)throw Error(n(170));var o=i;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(Jt(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(n(171))}if(i.tag===1){var h=i.type;if(Jt(h))return pp(i,h,o)}return o}function zm(i,o,h,p,v,w,P,A,F){return i=fd(h,p,!0,i,v,w,P,A,F),i.context=$m(null),h=i.current,p=qt(),v=Qs(h),w=ys(p,v),w.callback=o??null,Gs(h,w,v),i.current.lanes=v,Vi(i,v,p),Zt(i,p),i}function xl(i,o,h,p){var v=o.current,w=qt(),P=Qs(v);return h=$m(h),o.context===null?o.context=h:o.pendingContext=h,o=ys(w,P),o.payload={element:i},p=p===void 0?null:p,p!==null&&(o.callback=p),i=Gs(v,o,P),i!==null&&(Fn(i,v,P,w),Jo(i,v,P)),P}function bl(i){return i=i.current,i.child?(i.child.tag===5,i.child.stateNode):null}function Um(i,o){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var h=i.retryLane;i.retryLane=h!==0&&h<o?h:o}}function pd(i,o){Um(i,o),(i=i.alternate)&&Um(i,o)}function tw(){return null}var Wm=typeof reportError=="function"?reportError:function(i){console.error(i)};function md(i){this._internalRoot=i}wl.prototype.render=md.prototype.render=function(i){var o=this._internalRoot;if(o===null)throw Error(n(409));xl(i,o,null,null)},wl.prototype.unmount=md.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var o=i.containerInfo;Ir(function(){xl(null,i,null,null)}),o[hs]=null}};function wl(i){this._internalRoot=i}wl.prototype.unstable_scheduleHydration=function(i){if(i){var o=Cf();i={blockedOn:null,target:i,priority:o};for(var h=0;h<$s.length&&o!==0&&o<$s[h].priority;h++);$s.splice(h,0,i),h===0&&Ef(i)}};function gd(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function _l(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function Vm(){}function nw(i,o,h,p,v){if(v){if(typeof p=="function"){var w=p;p=function(){var K=bl(P);w.call(K)}}var P=zm(o,p,i,0,null,!1,!1,"",Vm);return i._reactRootContainer=P,i[hs]=P.current,ra(i.nodeType===8?i.parentNode:i),Ir(),P}for(;v=i.lastChild;)i.removeChild(v);if(typeof p=="function"){var A=p;p=function(){var K=bl(F);A.call(K)}}var F=fd(i,0,!1,null,null,!1,!1,"",Vm);return i._reactRootContainer=F,i[hs]=F.current,ra(i.nodeType===8?i.parentNode:i),Ir(function(){xl(o,F,h,p)}),F}function Sl(i,o,h,p,v){var w=h._reactRootContainer;if(w){var P=w;if(typeof v=="function"){var A=v;v=function(){var F=bl(P);A.call(F)}}xl(o,P,i,v)}else P=nw(h,o,i,v,p);return bl(P)}kf=function(i){switch(i.tag){case 3:var o=i.stateNode;if(o.current.memoizedState.isDehydrated){var h=Wi(o.pendingLanes);h!==0&&($c(o,h|1),Zt(o,ht()),(Le&6)===0&&(vi=ht()+500,Hs()))}break;case 13:Ir(function(){var p=gs(i,1);if(p!==null){var v=qt();Fn(p,i,1,v)}}),pd(i,1)}},zc=function(i){if(i.tag===13){var o=gs(i,134217728);if(o!==null){var h=qt();Fn(o,i,134217728,h)}pd(i,134217728)}},jf=function(i){if(i.tag===13){var o=Qs(i),h=gs(i,o);if(h!==null){var p=qt();Fn(h,i,o,p)}pd(i,o)}},Cf=function(){return qe},Pf=function(i,o){var h=qe;try{return qe=i,o()}finally{qe=h}},Be=function(i,o,h){switch(o){case"input":if(Hn(i,h),o=h.name,h.type==="radio"&&o!=null){for(h=i;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<h.length;o++){var p=h[o];if(p!==i&&p.form===i.form){var v=$o(p);if(!v)throw Error(n(90));gn(p),Hn(p,v)}}}break;case"textarea":Gt(i,h);break;case"select":o=h.value,o!=null&&yn(i,!!h.multiple,o,!1)}},M=od,ne=Ir;var sw={usingClientEntryPoint:!1,Events:[oa,ii,$o,Xr,xo,od]},wa={findFiberByHostInstance:br,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},rw={bundleType:wa.bundleType,version:wa.version,rendererPackageName:wa.rendererPackageName,rendererConfig:wa.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:N.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=gf(i),i===null?null:i.stateNode},findFiberByHostInstance:wa.findFiberByHostInstance||tw,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var kl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!kl.isDisabled&&kl.supportsFiber)try{wo=kl.inject(rw),Jn=kl}catch{}}return en.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sw,en.createPortal=function(i,o){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!gd(o))throw Error(n(200));return ew(i,o,null,h)},en.createRoot=function(i,o){if(!gd(i))throw Error(n(299));var h=!1,p="",v=Wm;return o!=null&&(o.unstable_strictMode===!0&&(h=!0),o.identifierPrefix!==void 0&&(p=o.identifierPrefix),o.onRecoverableError!==void 0&&(v=o.onRecoverableError)),o=fd(i,1,!1,null,null,h,!1,p,v),i[hs]=o.current,ra(i.nodeType===8?i.parentNode:i),new md(o)},en.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var o=i._reactInternals;if(o===void 0)throw typeof i.render=="function"?Error(n(188)):(i=Object.keys(i).join(","),Error(n(268,i)));return i=gf(o),i=i===null?null:i.stateNode,i},en.flushSync=function(i){return Ir(i)},en.hydrate=function(i,o,h){if(!_l(o))throw Error(n(200));return Sl(null,i,o,!0,h)},en.hydrateRoot=function(i,o,h){if(!gd(i))throw Error(n(405));var p=h!=null&&h.hydratedSources||null,v=!1,w="",P=Wm;if(h!=null&&(h.unstable_strictMode===!0&&(v=!0),h.identifierPrefix!==void 0&&(w=h.identifierPrefix),h.onRecoverableError!==void 0&&(P=h.onRecoverableError)),o=zm(o,null,i,1,h??null,v,!1,w,P),i[hs]=o.current,ra(i),p)for(i=0;i<p.length;i++)h=p[i],v=h._getVersion,v=v(h._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[h,v]:o.mutableSourceEagerHydrationData.push(h,v);return new wl(o)},en.render=function(i,o,h){if(!_l(o))throw Error(n(200));return Sl(null,i,o,!1,h)},en.unmountComponentAtNode=function(i){if(!_l(i))throw Error(n(40));return i._reactRootContainer?(Ir(function(){Sl(null,null,i,!1,function(){i._reactRootContainer=null,i[hs]=null})}),!0):!1},en.unstable_batchedUpdates=od,en.unstable_renderSubtreeIntoContainer=function(i,o,h,p){if(!_l(h))throw Error(n(200));if(i==null||i._reactInternals===void 0)throw Error(n(38));return Sl(i,o,h,!1,p)},en.version="18.3.1-next-f1338f8080-20240426",en}var Qm;function kv(){if(Qm)return xd.exports;Qm=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),xd.exports=pw(),xd.exports}var Zm;function mw(){if(Zm)return jl;Zm=1;var t=kv();return jl.createRoot=t.createRoot,jl.hydrateRoot=t.hydrateRoot,jl}var gw=mw(),eg=kv();function qa(){return qa=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},qa.apply(this,arguments)}var rr;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(rr||(rr={}));const tg="popstate";function yw(t){t===void 0&&(t={});function e(s,r){let{pathname:a,search:l,hash:c}=s.location;return oh("",{pathname:a,search:l,hash:c},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function n(s,r){return typeof r=="string"?r:Zl(r)}return xw(e,n,null,t)}function at(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function $h(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function vw(){return Math.random().toString(36).substr(2,8)}function ng(t,e){return{usr:t.state,key:t.key,idx:e}}function oh(t,e,n,s){return n===void 0&&(n=null),qa({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?$i(e):e,{state:n,key:e&&e.key||s||vw()})}function Zl(t){let{pathname:e="/",search:n="",hash:s=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function $i(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let s=t.indexOf("?");s>=0&&(e.search=t.substr(s),t=t.substr(0,s)),t&&(e.pathname=t)}return e}function xw(t,e,n,s){s===void 0&&(s={});let{window:r=document.defaultView,v5Compat:a=!1}=s,l=r.history,c=rr.Pop,d=null,f=m();f==null&&(f=0,l.replaceState(qa({},l.state,{idx:f}),""));function m(){return(l.state||{idx:null}).idx}function g(){c=rr.Pop;let b=m(),k=b==null?null:b-f;f=b,d&&d({action:c,location:S.location,delta:k})}function y(b,k){c=rr.Push;let I=oh(S.location,b,k);f=m()+1;let C=ng(I,f),N=S.createHref(I);try{l.pushState(C,"",N)}catch(O){if(O instanceof DOMException&&O.name==="DataCloneError")throw O;r.location.assign(N)}a&&d&&d({action:c,location:S.location,delta:1})}function x(b,k){c=rr.Replace;let I=oh(S.location,b,k);f=m();let C=ng(I,f),N=S.createHref(I);l.replaceState(C,"",N),a&&d&&d({action:c,location:S.location,delta:0})}function _(b){let k=r.location.origin!=="null"?r.location.origin:r.location.href,I=typeof b=="string"?b:Zl(b);return I=I.replace(/ $/,"%20"),at(k,"No window.location.(origin|href) available to create URL for href: "+I),new URL(I,k)}let S={get action(){return c},get location(){return t(r,l)},listen(b){if(d)throw new Error("A history only accepts one active listener");return r.addEventListener(tg,g),d=b,()=>{r.removeEventListener(tg,g),d=null}},createHref(b){return e(r,b)},createURL:_,encodeLocation(b){let k=_(b);return{pathname:k.pathname,search:k.search,hash:k.hash}},push:y,replace:x,go(b){return l.go(b)}};return S}var sg;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(sg||(sg={}));function bw(t,e,n){return n===void 0&&(n="/"),ww(t,e,n)}function ww(t,e,n,s){let r=typeof e=="string"?$i(e):e,a=Mi(r.pathname||"/",n);if(a==null)return null;let l=jv(t);_w(l);let c=null;for(let d=0;c==null&&d<l.length;++d){let f=Ow(a);c=Nw(l[d],f)}return c}function jv(t,e,n,s){e===void 0&&(e=[]),n===void 0&&(n=[]),s===void 0&&(s="");let r=(a,l,c)=>{let d={relativePath:c===void 0?a.path||"":c,caseSensitive:a.caseSensitive===!0,childrenIndex:l,route:a};d.relativePath.startsWith("/")&&(at(d.relativePath.startsWith(s),'Absolute route path "'+d.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),d.relativePath=d.relativePath.slice(s.length));let f=cr([s,d.relativePath]),m=n.concat(d);a.children&&a.children.length>0&&(at(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+f+'".')),jv(a.children,e,m,f)),!(a.path==null&&!a.index)&&e.push({path:f,score:Ew(f,a.index),routesMeta:m})};return t.forEach((a,l)=>{var c;if(a.path===""||!((c=a.path)!=null&&c.includes("?")))r(a,l);else for(let d of Cv(a.path))r(a,l,d)}),e}function Cv(t){let e=t.split("/");if(e.length===0)return[];let[n,...s]=e,r=n.endsWith("?"),a=n.replace(/\?$/,"");if(s.length===0)return r?[a,""]:[a];let l=Cv(s.join("/")),c=[];return c.push(...l.map(d=>d===""?a:[a,d].join("/"))),r&&c.push(...l),c.map(d=>t.startsWith("/")&&d===""?"/":d)}function _w(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:Tw(e.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}const Sw=/^:[\w-]+$/,kw=3,jw=2,Cw=1,Pw=10,Iw=-2,rg=t=>t==="*";function Ew(t,e){let n=t.split("/"),s=n.length;return n.some(rg)&&(s+=Iw),e&&(s+=jw),n.filter(r=>!rg(r)).reduce((r,a)=>r+(Sw.test(a)?kw:a===""?Cw:Pw),s)}function Tw(t,e){return t.length===e.length&&t.slice(0,-1).every((s,r)=>s===e[r])?t[t.length-1]-e[e.length-1]:0}function Nw(t,e,n){let{routesMeta:s}=t,r={},a="/",l=[];for(let c=0;c<s.length;++c){let d=s[c],f=c===s.length-1,m=a==="/"?e:e.slice(a.length)||"/",g=lh({path:d.relativePath,caseSensitive:d.caseSensitive,end:f},m),y=d.route;if(!g)return null;Object.assign(r,g.params),l.push({params:r,pathname:cr([a,g.pathname]),pathnameBase:Fw(cr([a,g.pathnameBase])),route:y}),g.pathnameBase!=="/"&&(a=cr([a,g.pathnameBase]))}return l}function lh(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,s]=Aw(t.path,t.caseSensitive,t.end),r=e.match(n);if(!r)return null;let a=r[0],l=a.replace(/(.)\/+$/,"$1"),c=r.slice(1);return{params:s.reduce((f,m,g)=>{let{paramName:y,isOptional:x}=m;if(y==="*"){let S=c[g]||"";l=a.slice(0,a.length-S.length).replace(/(.)\/+$/,"$1")}const _=c[g];return x&&!_?f[y]=void 0:f[y]=(_||"").replace(/%2F/g,"/"),f},{}),pathname:a,pathnameBase:l,pattern:t}}function Aw(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),$h(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let s=[],r="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,c,d)=>(s.push({paramName:c,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(s.push({paramName:"*"}),r+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":t!==""&&t!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),s]}function Ow(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return $h(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Mi(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,s=t.charAt(n);return s&&s!=="/"?null:t.slice(n)||"/"}const Rw=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Mw=t=>Rw.test(t);function Lw(t,e){e===void 0&&(e="/");let{pathname:n,search:s="",hash:r=""}=typeof t=="string"?$i(t):t,a;if(n)if(Mw(n))a=n;else{if(n.includes("//")){let l=n;n=n.replace(/\/\/+/g,"/"),$h(!1,"Pathnames cannot have embedded double slashes - normalizing "+(l+" -> "+n))}n.startsWith("/")?a=ig(n.substring(1),"/"):a=ig(n,e)}else a=e;return{pathname:a,search:Bw(s),hash:$w(r)}}function ig(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function _d(t,e,n,s){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Dw(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function zh(t,e){let n=Dw(t);return e?n.map((s,r)=>r===n.length-1?s.pathname:s.pathnameBase):n.map(s=>s.pathnameBase)}function Uh(t,e,n,s){s===void 0&&(s=!1);let r;typeof t=="string"?r=$i(t):(r=qa({},t),at(!r.pathname||!r.pathname.includes("?"),_d("?","pathname","search",r)),at(!r.pathname||!r.pathname.includes("#"),_d("#","pathname","hash",r)),at(!r.search||!r.search.includes("#"),_d("#","search","hash",r)));let a=t===""||r.pathname==="",l=a?"/":r.pathname,c;if(l==null)c=n;else{let g=e.length-1;if(!s&&l.startsWith("..")){let y=l.split("/");for(;y[0]==="..";)y.shift(),g-=1;r.pathname=y.join("/")}c=g>=0?e[g]:"/"}let d=Lw(r,c),f=l&&l!=="/"&&l.endsWith("/"),m=(a||l===".")&&n.endsWith("/");return!d.pathname.endsWith("/")&&(f||m)&&(d.pathname+="/"),d}const cr=t=>t.join("/").replace(/\/\/+/g,"/"),Fw=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),Bw=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,$w=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function zw(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const Pv=["post","put","patch","delete"];new Set(Pv);const Uw=["get",...Pv];new Set(Uw);function Ha(){return Ha=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Ha.apply(this,arguments)}const yc=j.createContext(null),Iv=j.createContext(null),Ts=j.createContext(null),vc=j.createContext(null),is=j.createContext({outlet:null,matches:[],isDataRoute:!1}),Ev=j.createContext(null);function Ww(t,e){let{relative:n}=e===void 0?{}:e;zi()||at(!1);let{basename:s,navigator:r}=j.useContext(Ts),{hash:a,pathname:l,search:c}=xc(t,{relative:n}),d=l;return s!=="/"&&(d=l==="/"?s:cr([s,l])),r.createHref({pathname:d,search:c,hash:a})}function zi(){return j.useContext(vc)!=null}function Wn(){return zi()||at(!1),j.useContext(vc).location}function Tv(t){j.useContext(Ts).static||j.useLayoutEffect(t)}function Ht(){let{isDataRoute:t}=j.useContext(is);return t?r_():Vw()}function Vw(){zi()||at(!1);let t=j.useContext(yc),{basename:e,future:n,navigator:s}=j.useContext(Ts),{matches:r}=j.useContext(is),{pathname:a}=Wn(),l=JSON.stringify(zh(r,n.v7_relativeSplatPath)),c=j.useRef(!1);return Tv(()=>{c.current=!0}),j.useCallback(function(f,m){if(m===void 0&&(m={}),!c.current)return;if(typeof f=="number"){s.go(f);return}let g=Uh(f,JSON.parse(l),a,m.relative==="path");t==null&&e!=="/"&&(g.pathname=g.pathname==="/"?e:cr([e,g.pathname])),(m.replace?s.replace:s.push)(g,m.state,m)},[e,s,l,a,t])}const qw=j.createContext(null);function Hw(t){let e=j.useContext(is).outlet;return e&&j.createElement(qw.Provider,{value:t},e)}function Vn(){let{matches:t}=j.useContext(is),e=t[t.length-1];return e?e.params:{}}function xc(t,e){let{relative:n}=e===void 0?{}:e,{future:s}=j.useContext(Ts),{matches:r}=j.useContext(is),{pathname:a}=Wn(),l=JSON.stringify(zh(r,s.v7_relativeSplatPath));return j.useMemo(()=>Uh(t,JSON.parse(l),a,n==="path"),[t,l,a,n])}function Kw(t,e){return Gw(t,e)}function Gw(t,e,n,s){zi()||at(!1);let{navigator:r}=j.useContext(Ts),{matches:a}=j.useContext(is),l=a[a.length-1],c=l?l.params:{};l&&l.pathname;let d=l?l.pathnameBase:"/";l&&l.route;let f=Wn(),m;if(e){var g;let b=typeof e=="string"?$i(e):e;d==="/"||(g=b.pathname)!=null&&g.startsWith(d)||at(!1),m=b}else m=f;let y=m.pathname||"/",x=y;if(d!=="/"){let b=d.replace(/^\//,"").split("/");x="/"+y.replace(/^\//,"").split("/").slice(b.length).join("/")}let _=bw(t,{pathname:x}),S=Zw(_&&_.map(b=>Object.assign({},b,{params:Object.assign({},c,b.params),pathname:cr([d,r.encodeLocation?r.encodeLocation(b.pathname).pathname:b.pathname]),pathnameBase:b.pathnameBase==="/"?d:cr([d,r.encodeLocation?r.encodeLocation(b.pathnameBase).pathname:b.pathnameBase])})),a,n,s);return e&&S?j.createElement(vc.Provider,{value:{location:Ha({pathname:"/",search:"",hash:"",state:null,key:"default"},m),navigationType:rr.Pop}},S):S}function Yw(){let t=s_(),e=zw(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return j.createElement(j.Fragment,null,j.createElement("h2",null,"Unexpected Application Error!"),j.createElement("h3",{style:{fontStyle:"italic"}},e),n?j.createElement("pre",{style:r},n):null,null)}const Jw=j.createElement(Yw,null);class Xw extends j.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?j.createElement(is.Provider,{value:this.props.routeContext},j.createElement(Ev.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Qw(t){let{routeContext:e,match:n,children:s}=t,r=j.useContext(yc);return r&&r.static&&r.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=n.route.id),j.createElement(is.Provider,{value:e},s)}function Zw(t,e,n,s){var r;if(e===void 0&&(e=[]),n===void 0&&(n=null),s===void 0&&(s=null),t==null){var a;if(!n)return null;if(n.errors)t=n.matches;else if((a=s)!=null&&a.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let l=t,c=(r=n)==null?void 0:r.errors;if(c!=null){let m=l.findIndex(g=>g.route.id&&c?.[g.route.id]!==void 0);m>=0||at(!1),l=l.slice(0,Math.min(l.length,m+1))}let d=!1,f=-1;if(n&&s&&s.v7_partialHydration)for(let m=0;m<l.length;m++){let g=l[m];if((g.route.HydrateFallback||g.route.hydrateFallbackElement)&&(f=m),g.route.id){let{loaderData:y,errors:x}=n,_=g.route.loader&&y[g.route.id]===void 0&&(!x||x[g.route.id]===void 0);if(g.route.lazy||_){d=!0,f>=0?l=l.slice(0,f+1):l=[l[0]];break}}}return l.reduceRight((m,g,y)=>{let x,_=!1,S=null,b=null;n&&(x=c&&g.route.id?c[g.route.id]:void 0,S=g.route.errorElement||Jw,d&&(f<0&&y===0?(i_("route-fallback"),_=!0,b=null):f===y&&(_=!0,b=g.route.hydrateFallbackElement||null)));let k=e.concat(l.slice(0,y+1)),I=()=>{let C;return x?C=S:_?C=b:g.route.Component?C=j.createElement(g.route.Component,null):g.route.element?C=g.route.element:C=m,j.createElement(Qw,{match:g,routeContext:{outlet:m,matches:k,isDataRoute:n!=null},children:C})};return n&&(g.route.ErrorBoundary||g.route.errorElement||y===0)?j.createElement(Xw,{location:n.location,revalidation:n.revalidation,component:S,error:x,children:I(),routeContext:{outlet:null,matches:k,isDataRoute:!0}}):I()},null)}var Nv=(function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t})(Nv||{}),Av=(function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t})(Av||{});function e_(t){let e=j.useContext(yc);return e||at(!1),e}function t_(t){let e=j.useContext(Iv);return e||at(!1),e}function n_(t){let e=j.useContext(is);return e||at(!1),e}function Ov(t){let e=n_(),n=e.matches[e.matches.length-1];return n.route.id||at(!1),n.route.id}function s_(){var t;let e=j.useContext(Ev),n=t_(),s=Ov();return e!==void 0?e:(t=n.errors)==null?void 0:t[s]}function r_(){let{router:t}=e_(Nv.UseNavigateStable),e=Ov(Av.UseNavigateStable),n=j.useRef(!1);return Tv(()=>{n.current=!0}),j.useCallback(function(r,a){a===void 0&&(a={}),n.current&&(typeof r=="number"?t.navigate(r):t.navigate(r,Ha({fromRouteId:e},a)))},[t,e])}const ag={};function i_(t,e,n){ag[t]||(ag[t]=!0)}function a_(t,e){t?.v7_startTransition,t?.v7_relativeSplatPath}function js(t){let{to:e,replace:n,state:s,relative:r}=t;zi()||at(!1);let{future:a,static:l}=j.useContext(Ts),{matches:c}=j.useContext(is),{pathname:d}=Wn(),f=Ht(),m=Uh(e,zh(c,a.v7_relativeSplatPath),d,r==="path"),g=JSON.stringify(m);return j.useEffect(()=>f(JSON.parse(g),{replace:n,state:s,relative:r}),[f,g,r,n,s]),null}function ch(t){return Hw(t.context)}function de(t){at(!1)}function o_(t){let{basename:e="/",children:n=null,location:s,navigationType:r=rr.Pop,navigator:a,static:l=!1,future:c}=t;zi()&&at(!1);let d=e.replace(/^\/*/,"/"),f=j.useMemo(()=>({basename:d,navigator:a,static:l,future:Ha({v7_relativeSplatPath:!1},c)}),[d,c,a,l]);typeof s=="string"&&(s=$i(s));let{pathname:m="/",search:g="",hash:y="",state:x=null,key:_="default"}=s,S=j.useMemo(()=>{let b=Mi(m,d);return b==null?null:{location:{pathname:b,search:g,hash:y,state:x,key:_},navigationType:r}},[d,m,g,y,x,_,r]);return S==null?null:j.createElement(Ts.Provider,{value:f},j.createElement(vc.Provider,{children:n,value:S}))}function l_(t){let{children:e,location:n}=t;return Kw(uh(e),n)}new Promise(()=>{});function uh(t,e){e===void 0&&(e=[]);let n=[];return j.Children.forEach(t,(s,r)=>{if(!j.isValidElement(s))return;let a=[...e,r];if(s.type===j.Fragment){n.push.apply(n,uh(s.props.children,a));return}s.type!==de&&at(!1),!s.props.index||!s.props.children||at(!1);let l={id:s.props.id||a.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(l.children=uh(s.props.children,a)),n.push(l)}),n}function ec(){return ec=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},ec.apply(this,arguments)}function Rv(t,e){if(t==null)return{};var n={},s=Object.keys(t),r,a;for(a=0;a<s.length;a++)r=s[a],!(e.indexOf(r)>=0)&&(n[r]=t[r]);return n}function c_(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function u_(t,e){return t.button===0&&(!e||e==="_self")&&!c_(t)}function dh(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let s=t[n];return e.concat(Array.isArray(s)?s.map(r=>[n,r]):[[n,s]])},[]))}function d_(t,e){let n=dh(t);return e&&e.forEach((s,r)=>{n.has(r)||e.getAll(r).forEach(a=>{n.append(r,a)})}),n}const h_=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],f_=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],p_="6";try{window.__reactRouterVersion=p_}catch{}const m_=j.createContext({isTransitioning:!1}),g_="startTransition",og=dw[g_];function y_(t){let{basename:e,children:n,future:s,window:r}=t,a=j.useRef();a.current==null&&(a.current=yw({window:r,v5Compat:!0}));let l=a.current,[c,d]=j.useState({action:l.action,location:l.location}),{v7_startTransition:f}=s||{},m=j.useCallback(g=>{f&&og?og(()=>d(g)):d(g)},[d,f]);return j.useLayoutEffect(()=>l.listen(m),[l,m]),j.useEffect(()=>a_(s),[s]),j.createElement(o_,{basename:e,children:n,location:c.location,navigationType:c.action,navigator:l,future:s})}const v_=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",x_=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,st=j.forwardRef(function(e,n){let{onClick:s,relative:r,reloadDocument:a,replace:l,state:c,target:d,to:f,preventScrollReset:m,viewTransition:g}=e,y=Rv(e,h_),{basename:x}=j.useContext(Ts),_,S=!1;if(typeof f=="string"&&x_.test(f)&&(_=f,v_))try{let C=new URL(window.location.href),N=f.startsWith("//")?new URL(C.protocol+f):new URL(f),O=Mi(N.pathname,x);N.origin===C.origin&&O!=null?f=O+N.search+N.hash:S=!0}catch{}let b=Ww(f,{relative:r}),k=w_(f,{replace:l,state:c,target:d,preventScrollReset:m,relative:r,viewTransition:g});function I(C){s&&s(C),C.defaultPrevented||k(C)}return j.createElement("a",ec({},y,{href:_||b,onClick:S||a?s:I,ref:n,target:d}))}),Fa=j.forwardRef(function(e,n){let{"aria-current":s="page",caseSensitive:r=!1,className:a="",end:l=!1,style:c,to:d,viewTransition:f,children:m}=e,g=Rv(e,f_),y=xc(d,{relative:g.relative}),x=Wn(),_=j.useContext(Iv),{navigator:S,basename:b}=j.useContext(Ts),k=_!=null&&__(y)&&f===!0,I=S.encodeLocation?S.encodeLocation(y).pathname:y.pathname,C=x.pathname,N=_&&_.navigation&&_.navigation.location?_.navigation.location.pathname:null;r||(C=C.toLowerCase(),N=N?N.toLowerCase():null,I=I.toLowerCase()),N&&b&&(N=Mi(N,b)||N);const O=I!=="/"&&I.endsWith("/")?I.length-1:I.length;let U=C===I||!l&&C.startsWith(I)&&C.charAt(O)==="/",E=N!=null&&(N===I||!l&&N.startsWith(I)&&N.charAt(I.length)==="/"),L={isActive:U,isPending:E,isTransitioning:k},R=U?s:void 0,T;typeof a=="function"?T=a(L):T=[a,U?"active":null,E?"pending":null,k?"transitioning":null].filter(Boolean).join(" ");let D=typeof c=="function"?c(L):c;return j.createElement(st,ec({},g,{"aria-current":R,className:T,ref:n,style:D,to:d,viewTransition:f}),typeof m=="function"?m(L):m)});var hh;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(hh||(hh={}));var lg;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(lg||(lg={}));function b_(t){let e=j.useContext(yc);return e||at(!1),e}function w_(t,e){let{target:n,replace:s,state:r,preventScrollReset:a,relative:l,viewTransition:c}=e===void 0?{}:e,d=Ht(),f=Wn(),m=xc(t,{relative:l});return j.useCallback(g=>{if(u_(g,n)){g.preventDefault();let y=s!==void 0?s:Zl(f)===Zl(m);d(t,{replace:y,state:r,preventScrollReset:a,relative:l,viewTransition:c})}},[f,d,m,s,r,n,t,a,l,c])}function as(t){let e=j.useRef(dh(t)),n=j.useRef(!1),s=Wn(),r=j.useMemo(()=>d_(s.search,n.current?null:e.current),[s.search]),a=Ht(),l=j.useCallback((c,d)=>{const f=dh(typeof c=="function"?c(r):c);n.current=!0,a("?"+f,d)},[a,r]);return[r,l]}function __(t,e){e===void 0&&(e={});let n=j.useContext(m_);n==null&&at(!1);let{basename:s}=b_(hh.useViewTransitionState),r=xc(t,{relative:e.relative});if(!n.isTransitioning)return!1;let a=Mi(n.currentLocation.pathname,s)||n.currentLocation.pathname,l=Mi(n.nextLocation.pathname,s)||n.nextLocation.pathname;return lh(r.pathname,l)!=null||lh(r.pathname,a)!=null}var Mv={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},cg=Es.createContext&&Es.createContext(Mv),S_=["attr","size","title"];function k_(t,e){if(t==null)return{};var n=j_(t,e),s,r;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(r=0;r<a.length;r++)s=a[r],!(e.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(t,s)&&(n[s]=t[s])}return n}function j_(t,e){if(t==null)return{};var n={};for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){if(e.indexOf(s)>=0)continue;n[s]=t[s]}return n}function tc(){return tc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},tc.apply(this,arguments)}function ug(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function nc(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?ug(Object(n),!0).forEach(function(s){C_(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ug(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function C_(t,e,n){return e=P_(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function P_(t){var e=I_(t,"string");return typeof e=="symbol"?e:e+""}function I_(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Lv(t){return t&&t.map((e,n)=>Es.createElement(e.tag,nc({key:n},e.attr),Lv(e.child)))}function Ue(t){return e=>Es.createElement(E_,tc({attr:nc({},t.attr)},e),Lv(t.child))}function E_(t){var e=n=>{var{attr:s,size:r,title:a}=t,l=k_(t,S_),c=r||n.size||"1em",d;return n.className&&(d=n.className),t.className&&(d=(d?d+" ":"")+t.className),Es.createElement("svg",tc({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,s,l,{className:d,style:nc(nc({color:t.color||n.color},n.style),t.style),height:c,width:c,xmlns:"http://www.w3.org/2000/svg"}),a&&Es.createElement("title",null,a),t.children)};return cg!==void 0?Es.createElement(cg.Consumer,null,n=>e(n)):e(Mv)}function dg(t){return Ue({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"18",y1:"20",x2:"18",y2:"10"},child:[]},{tag:"line",attr:{x1:"12",y1:"20",x2:"12",y2:"4"},child:[]},{tag:"line",attr:{x1:"6",y1:"20",x2:"6",y2:"14"},child:[]}]})(t)}function T_(t){return Ue({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"},child:[]},{tag:"path",attr:{d:"M13.73 21a2 2 0 0 1-3.46 0"},child:[]}]})(t)}function hg(t){return Ue({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"},child:[]},{tag:"polyline",attr:{points:"3.27 6.96 12 12.01 20.73 6.96"},child:[]},{tag:"line",attr:{x1:"12",y1:"22.08",x2:"12",y2:"12"},child:[]}]})(t)}function fg(t){return Ue({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"6 9 12 15 18 9"},child:[]}]})(t)}function N_(t){return Ue({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"15 18 9 12 15 6"},child:[]}]})(t)}function A_(t){return Ue({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"9 18 15 12 9 6"},child:[]}]})(t)}function fh(t){return Ue({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"1",y:"4",width:"22",height:"16",rx:"2",ry:"2"},child:[]},{tag:"line",attr:{x1:"1",y1:"10",x2:"23",y2:"10"},child:[]}]})(t)}function Sd(t){return Ue({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"1",x2:"12",y2:"23"},child:[]},{tag:"path",attr:{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"},child:[]}]})(t)}function kd(t){return Ue({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"},child:[]},{tag:"polyline",attr:{points:"14 2 14 8 20 8"},child:[]},{tag:"line",attr:{x1:"16",y1:"13",x2:"8",y2:"13"},child:[]},{tag:"line",attr:{x1:"16",y1:"17",x2:"8",y2:"17"},child:[]},{tag:"polyline",attr:{points:"10 9 9 9 8 9"},child:[]}]})(t)}function pg(t){return Ue({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"},child:[]}]})(t)}function O_(t){return Ue({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"18",cy:"18",r:"3"},child:[]},{tag:"circle",attr:{cx:"6",cy:"6",r:"3"},child:[]},{tag:"path",attr:{d:"M6 21V9a9 9 0 0 0 9 9"},child:[]}]})(t)}function R_(t){return Ue({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"},child:[]},{tag:"polyline",attr:{points:"9 22 9 12 15 12 15 22"},child:[]}]})(t)}function mg(t){return Ue({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"12 2 2 7 12 12 22 7 12 2"},child:[]},{tag:"polyline",attr:{points:"2 17 12 22 22 17"},child:[]},{tag:"polyline",attr:{points:"2 12 12 17 22 12"},child:[]}]})(t)}function gg(t){return Ue({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"8",y1:"6",x2:"21",y2:"6"},child:[]},{tag:"line",attr:{x1:"8",y1:"12",x2:"21",y2:"12"},child:[]},{tag:"line",attr:{x1:"8",y1:"18",x2:"21",y2:"18"},child:[]},{tag:"line",attr:{x1:"3",y1:"6",x2:"3.01",y2:"6"},child:[]},{tag:"line",attr:{x1:"3",y1:"12",x2:"3.01",y2:"12"},child:[]},{tag:"line",attr:{x1:"3",y1:"18",x2:"3.01",y2:"18"},child:[]}]})(t)}function M_(t){return Ue({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"},child:[]},{tag:"polyline",attr:{points:"22,6 12,13 2,6"},child:[]}]})(t)}function L_(t){return Ue({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"},child:[]}]})(t)}function D_(t){return Ue({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"1"},child:[]},{tag:"circle",attr:{cx:"12",cy:"5",r:"1"},child:[]},{tag:"circle",attr:{cx:"12",cy:"19",r:"1"},child:[]}]})(t)}function Cl(t){return Ue({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"16.5",y1:"9.4",x2:"7.5",y2:"4.21"},child:[]},{tag:"path",attr:{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"},child:[]},{tag:"polyline",attr:{points:"3.27 6.96 12 12.01 20.73 6.96"},child:[]},{tag:"line",attr:{x1:"12",y1:"22.08",x2:"12",y2:"12"},child:[]}]})(t)}function F_(t){return Ue({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"5",x2:"12",y2:"19"},child:[]},{tag:"line",attr:{x1:"5",y1:"12",x2:"19",y2:"12"},child:[]}]})(t)}function jd(t){return Ue({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"11",cy:"11",r:"8"},child:[]},{tag:"line",attr:{x1:"21",y1:"21",x2:"16.65",y2:"16.65"},child:[]}]})(t)}function B_(t){return Ue({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"3"},child:[]},{tag:"path",attr:{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"},child:[]}]})(t)}function Dv(t){return Ue({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"18",cy:"5",r:"3"},child:[]},{tag:"circle",attr:{cx:"6",cy:"12",r:"3"},child:[]},{tag:"circle",attr:{cx:"18",cy:"19",r:"3"},child:[]},{tag:"line",attr:{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"},child:[]},{tag:"line",attr:{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"},child:[]}]})(t)}function $_(t){return Ue({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"},child:[]}]})(t)}function z_(t){return Ue({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"5"},child:[]},{tag:"line",attr:{x1:"12",y1:"1",x2:"12",y2:"3"},child:[]},{tag:"line",attr:{x1:"12",y1:"21",x2:"12",y2:"23"},child:[]},{tag:"line",attr:{x1:"4.22",y1:"4.22",x2:"5.64",y2:"5.64"},child:[]},{tag:"line",attr:{x1:"18.36",y1:"18.36",x2:"19.78",y2:"19.78"},child:[]},{tag:"line",attr:{x1:"1",y1:"12",x2:"3",y2:"12"},child:[]},{tag:"line",attr:{x1:"21",y1:"12",x2:"23",y2:"12"},child:[]},{tag:"line",attr:{x1:"4.22",y1:"19.78",x2:"5.64",y2:"18.36"},child:[]},{tag:"line",attr:{x1:"18.36",y1:"5.64",x2:"19.78",y2:"4.22"},child:[]}]})(t)}function yg(t){return Ue({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"23 18 13.5 8.5 8.5 13.5 1 6"},child:[]},{tag:"polyline",attr:{points:"17 18 23 18 23 12"},child:[]}]})(t)}function U_(t){return Ue({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"23 6 13.5 15.5 8.5 10.5 1 18"},child:[]},{tag:"polyline",attr:{points:"17 6 23 6 23 12"},child:[]}]})(t)}function W_(t){return Ue({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"8.5",cy:"7",r:"4"},child:[]},{tag:"polyline",attr:{points:"17 11 19 13 23 9"},child:[]}]})(t)}function V_(t){return Ue({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"8.5",cy:"7",r:"4"},child:[]},{tag:"line",attr:{x1:"20",y1:"8",x2:"20",y2:"14"},child:[]},{tag:"line",attr:{x1:"23",y1:"11",x2:"17",y2:"11"},child:[]}]})(t)}function q_(t){return Ue({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"12",cy:"7",r:"4"},child:[]}]})(t)}function H_(t){return Ue({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"9",cy:"7",r:"4"},child:[]},{tag:"path",attr:{d:"M23 21v-2a4 4 0 0 0-3-3.87"},child:[]},{tag:"path",attr:{d:"M16 3.13a4 4 0 0 1 0 7.75"},child:[]}]})(t)}function bc(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(t);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(n[s[r]]=t[s[r]]);return n}function K_(t,e,n,s){function r(a){return a instanceof n?a:new n(function(l){l(a)})}return new(n||(n=Promise))(function(a,l){function c(m){try{f(s.next(m))}catch(g){l(g)}}function d(m){try{f(s.throw(m))}catch(g){l(g)}}function f(m){m.done?a(m.value):r(m.value).then(c,d)}f((s=s.apply(t,e||[])).next())})}const G_=t=>t?(...e)=>t(...e):(...e)=>fetch(...e);class Wh extends Error{constructor(e,n="FunctionsError",s){super(e),this.name=n,this.context=s}}class Y_ extends Wh{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class vg extends Wh{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class xg extends Wh{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var ph;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(ph||(ph={}));class J_{constructor(e,{headers:n={},customFetch:s,region:r=ph.Any}={}){this.url=e,this.headers=n,this.region=r,this.fetch=G_(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return K_(this,arguments,void 0,function*(n,s={}){var r;let a,l;try{const{headers:c,method:d,body:f,signal:m,timeout:g}=s;let y={},{region:x}=s;x||(x=this.region);const _=new URL(`${this.url}/${n}`);x&&x!=="any"&&(y["x-region"]=x,_.searchParams.set("forceFunctionRegion",x));let S;f&&(c&&!Object.prototype.hasOwnProperty.call(c,"Content-Type")||!c)?typeof Blob<"u"&&f instanceof Blob||f instanceof ArrayBuffer?(y["Content-Type"]="application/octet-stream",S=f):typeof f=="string"?(y["Content-Type"]="text/plain",S=f):typeof FormData<"u"&&f instanceof FormData?S=f:(y["Content-Type"]="application/json",S=JSON.stringify(f)):f&&typeof f!="string"&&!(typeof Blob<"u"&&f instanceof Blob)&&!(f instanceof ArrayBuffer)&&!(typeof FormData<"u"&&f instanceof FormData)?S=JSON.stringify(f):S=f;let b=m;g&&(l=new AbortController,a=setTimeout(()=>l.abort(),g),m?(b=l.signal,m.addEventListener("abort",()=>l.abort())):b=l.signal);const k=yield this.fetch(_.toString(),{method:d||"POST",headers:Object.assign(Object.assign(Object.assign({},y),this.headers),c),body:S,signal:b}).catch(O=>{throw new Y_(O)}),I=k.headers.get("x-relay-error");if(I&&I==="true")throw new vg(k);if(!k.ok)throw new xg(k);let C=((r=k.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),N;return C==="application/json"?N=yield k.json():C==="application/octet-stream"||C==="application/pdf"?N=yield k.blob():C==="text/event-stream"?N=k:C==="multipart/form-data"?N=yield k.formData():N=yield k.text(),{data:N,error:null,response:k}}catch(c){return{data:null,error:c,response:c instanceof xg||c instanceof vg?c.context:void 0}}finally{a&&clearTimeout(a)}})}}var X_=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}},Q_=class{constructor(t){var e,n,s;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(e=t.shouldThrowOnError)!==null&&e!==void 0?e:!1,this.signal=t.signal,this.isMaybeSingle=(n=t.isMaybeSingle)!==null&&n!==void 0?n:!1,this.urlLengthLimit=(s=t.urlLengthLimit)!==null&&s!==void 0?s:8e3,t.fetch?this.fetch=t.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,e){return this.headers=new Headers(this.headers),this.headers.set(t,e),this}then(t,e){var n=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const s=this.fetch;let r=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async a=>{let l=null,c=null,d=null,f=a.status,m=a.statusText;if(a.ok){var g,y;if(n.method!=="HEAD"){var x;const k=await a.text();k===""||(n.headers.get("Accept")==="text/csv"||n.headers.get("Accept")&&(!((x=n.headers.get("Accept"))===null||x===void 0)&&x.includes("application/vnd.pgrst.plan+text"))?c=k:c=JSON.parse(k))}const S=(g=n.headers.get("Prefer"))===null||g===void 0?void 0:g.match(/count=(exact|planned|estimated)/),b=(y=a.headers.get("content-range"))===null||y===void 0?void 0:y.split("/");S&&b&&b.length>1&&(d=parseInt(b[1])),n.isMaybeSingle&&n.method==="GET"&&Array.isArray(c)&&(c.length>1?(l={code:"PGRST116",details:`Results contain ${c.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},c=null,d=null,f=406,m="Not Acceptable"):c.length===1?c=c[0]:c=null)}else{var _;const S=await a.text();try{l=JSON.parse(S),Array.isArray(l)&&a.status===404&&(c=[],l=null,f=200,m="OK")}catch{a.status===404&&S===""?(f=204,m="No Content"):l={message:S}}if(l&&n.isMaybeSingle&&(!(l==null||(_=l.details)===null||_===void 0)&&_.includes("0 rows"))&&(l=null,f=200,m="OK"),l&&n.shouldThrowOnError)throw new X_(l)}return{error:l,data:c,count:d,status:f,statusText:m}});return this.shouldThrowOnError||(r=r.catch(a=>{var l;let c="",d="",f="";const m=a?.cause;if(m){var g,y,x,_;const k=(g=m?.message)!==null&&g!==void 0?g:"",I=(y=m?.code)!==null&&y!==void 0?y:"";c=`${(x=a?.name)!==null&&x!==void 0?x:"FetchError"}: ${a?.message}`,c+=`

Caused by: ${(_=m?.name)!==null&&_!==void 0?_:"Error"}: ${k}`,I&&(c+=` (${I})`),m?.stack&&(c+=`
${m.stack}`)}else{var S;c=(S=a?.stack)!==null&&S!==void 0?S:""}const b=this.url.toString().length;return a?.name==="AbortError"||a?.code==="ABORT_ERR"?(f="",d="Request was aborted (timeout or manual cancellation)",b>this.urlLengthLimit&&(d+=`. Note: Your request URL is ${b} characters, which may exceed server limits. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [many IDs])), consider using an RPC function to pass values server-side.`)):(m?.name==="HeadersOverflowError"||m?.code==="UND_ERR_HEADERS_OVERFLOW")&&(f="",d="HTTP headers exceeded server limits (typically 16KB)",b>this.urlLengthLimit&&(d+=`. Your request URL is ${b} characters. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [200+ IDs])), consider using an RPC function instead.`)),{error:{message:`${(l=a?.name)!==null&&l!==void 0?l:"FetchError"}: ${a?.message}`,details:c,hint:d,code:f},data:null,count:null,status:0,statusText:""}})),r.then(t,e)}returns(){return this}overrideTypes(){return this}},Z_=class extends Q_{select(t){let e=!1;const n=(t??"*").split("").map(s=>/\s/.test(s)&&!e?"":(s==='"'&&(e=!e),s)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:e=!0,nullsFirst:n,foreignTable:s,referencedTable:r=s}={}){const a=r?`${r}.order`:"order",l=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${l?`${l},`:""}${t}.${e?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:e,referencedTable:n=e}={}){const s=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(s,`${t}`),this}range(t,e,{foreignTable:n,referencedTable:s=n}={}){const r=typeof s>"u"?"offset":`${s}.offset`,a=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(r,`${t}`),this.url.searchParams.set(a,`${e-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:e=!1,settings:n=!1,buffers:s=!1,wal:r=!1,format:a="text"}={}){var l;const c=[t?"analyze":null,e?"verbose":null,n?"settings":null,s?"buffers":null,r?"wal":null].filter(Boolean).join("|"),d=(l=this.headers.get("Accept"))!==null&&l!==void 0?l:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${a}; for="${d}"; options=${c};`),a==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};const bg=new RegExp("[,()]");var Ii=class extends Z_{eq(t,e){return this.url.searchParams.append(t,`eq.${e}`),this}neq(t,e){return this.url.searchParams.append(t,`neq.${e}`),this}gt(t,e){return this.url.searchParams.append(t,`gt.${e}`),this}gte(t,e){return this.url.searchParams.append(t,`gte.${e}`),this}lt(t,e){return this.url.searchParams.append(t,`lt.${e}`),this}lte(t,e){return this.url.searchParams.append(t,`lte.${e}`),this}like(t,e){return this.url.searchParams.append(t,`like.${e}`),this}likeAllOf(t,e){return this.url.searchParams.append(t,`like(all).{${e.join(",")}}`),this}likeAnyOf(t,e){return this.url.searchParams.append(t,`like(any).{${e.join(",")}}`),this}ilike(t,e){return this.url.searchParams.append(t,`ilike.${e}`),this}ilikeAllOf(t,e){return this.url.searchParams.append(t,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(t,e){return this.url.searchParams.append(t,`ilike(any).{${e.join(",")}}`),this}regexMatch(t,e){return this.url.searchParams.append(t,`match.${e}`),this}regexIMatch(t,e){return this.url.searchParams.append(t,`imatch.${e}`),this}is(t,e){return this.url.searchParams.append(t,`is.${e}`),this}isDistinct(t,e){return this.url.searchParams.append(t,`isdistinct.${e}`),this}in(t,e){const n=Array.from(new Set(e)).map(s=>typeof s=="string"&&bg.test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}notIn(t,e){const n=Array.from(new Set(e)).map(s=>typeof s=="string"&&bg.test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`not.in.(${n})`),this}contains(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cs.{${e.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(e)}`),this}containedBy(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cd.{${e.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(e)}`),this}rangeGt(t,e){return this.url.searchParams.append(t,`sr.${e}`),this}rangeGte(t,e){return this.url.searchParams.append(t,`nxl.${e}`),this}rangeLt(t,e){return this.url.searchParams.append(t,`sl.${e}`),this}rangeLte(t,e){return this.url.searchParams.append(t,`nxr.${e}`),this}rangeAdjacent(t,e){return this.url.searchParams.append(t,`adj.${e}`),this}overlaps(t,e){return typeof e=="string"?this.url.searchParams.append(t,`ov.${e}`):this.url.searchParams.append(t,`ov.{${e.join(",")}}`),this}textSearch(t,e,{config:n,type:s}={}){let r="";s==="plain"?r="pl":s==="phrase"?r="ph":s==="websearch"&&(r="w");const a=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${r}fts${a}.${e}`),this}match(t){return Object.entries(t).forEach(([e,n])=>{this.url.searchParams.append(e,`eq.${n}`)}),this}not(t,e,n){return this.url.searchParams.append(t,`not.${e}.${n}`),this}or(t,{foreignTable:e,referencedTable:n=e}={}){const s=n?`${n}.or`:"or";return this.url.searchParams.append(s,`(${t})`),this}filter(t,e,n){return this.url.searchParams.append(t,`${e}.${n}`),this}},eS=class{constructor(t,{headers:e={},schema:n,fetch:s,urlLengthLimit:r=8e3}){this.url=t,this.headers=new Headers(e),this.schema=n,this.fetch=s,this.urlLengthLimit=r}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(t,e){const{head:n=!1,count:s}=e??{},r=n?"HEAD":"GET";let a=!1;const l=(t??"*").split("").map(f=>/\s/.test(f)&&!a?"":(f==='"'&&(a=!a),f)).join(""),{url:c,headers:d}=this.cloneRequestState();return c.searchParams.set("select",l),s&&d.append("Prefer",`count=${s}`),new Ii({method:r,url:c,headers:d,schema:this.schema,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}insert(t,{count:e,defaultToNull:n=!0}={}){var s;const r="POST",{url:a,headers:l}=this.cloneRequestState();if(e&&l.append("Prefer",`count=${e}`),n||l.append("Prefer","missing=default"),Array.isArray(t)){const c=t.reduce((d,f)=>d.concat(Object.keys(f)),[]);if(c.length>0){const d=[...new Set(c)].map(f=>`"${f}"`);a.searchParams.set("columns",d.join(","))}}return new Ii({method:r,url:a,headers:l,schema:this.schema,body:t,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch,urlLengthLimit:this.urlLengthLimit})}upsert(t,{onConflict:e,ignoreDuplicates:n=!1,count:s,defaultToNull:r=!0}={}){var a;const l="POST",{url:c,headers:d}=this.cloneRequestState();if(d.append("Prefer",`resolution=${n?"ignore":"merge"}-duplicates`),e!==void 0&&c.searchParams.set("on_conflict",e),s&&d.append("Prefer",`count=${s}`),r||d.append("Prefer","missing=default"),Array.isArray(t)){const f=t.reduce((m,g)=>m.concat(Object.keys(g)),[]);if(f.length>0){const m=[...new Set(f)].map(g=>`"${g}"`);c.searchParams.set("columns",m.join(","))}}return new Ii({method:l,url:c,headers:d,schema:this.schema,body:t,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch,urlLengthLimit:this.urlLengthLimit})}update(t,{count:e}={}){var n;const s="PATCH",{url:r,headers:a}=this.cloneRequestState();return e&&a.append("Prefer",`count=${e}`),new Ii({method:s,url:r,headers:a,schema:this.schema,body:t,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch,urlLengthLimit:this.urlLengthLimit})}delete({count:t}={}){var e;const n="DELETE",{url:s,headers:r}=this.cloneRequestState();return t&&r.append("Prefer",`count=${t}`),new Ii({method:n,url:s,headers:r,schema:this.schema,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch,urlLengthLimit:this.urlLengthLimit})}};function Ka(t){"@babel/helpers - typeof";return Ka=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ka(t)}function tS(t,e){if(Ka(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(Ka(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nS(t){var e=tS(t,"string");return Ka(e)=="symbol"?e:e+""}function sS(t,e,n){return(e=nS(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wg(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function Pl(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?wg(Object(n),!0).forEach(function(s){sS(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):wg(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}var rS=class Fv{constructor(e,{headers:n={},schema:s,fetch:r,timeout:a,urlLengthLimit:l=8e3}={}){this.url=e,this.headers=new Headers(n),this.schemaName=s,this.urlLengthLimit=l;const c=r??globalThis.fetch;a!==void 0&&a>0?this.fetch=(d,f)=>{const m=new AbortController,g=setTimeout(()=>m.abort(),a),y=f?.signal;if(y){if(y.aborted)return clearTimeout(g),c(d,f);const x=()=>{clearTimeout(g),m.abort()};return y.addEventListener("abort",x,{once:!0}),c(d,Pl(Pl({},f),{},{signal:m.signal})).finally(()=>{clearTimeout(g),y.removeEventListener("abort",x)})}return c(d,Pl(Pl({},f),{},{signal:m.signal})).finally(()=>clearTimeout(g))}:this.fetch=c}from(e){if(!e||typeof e!="string"||e.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new eS(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}schema(e){return new Fv(this.url,{headers:this.headers,schema:e,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}rpc(e,n={},{head:s=!1,get:r=!1,count:a}={}){var l;let c;const d=new URL(`${this.url}/rpc/${e}`);let f;const m=x=>x!==null&&typeof x=="object"&&(!Array.isArray(x)||x.some(m)),g=s&&Object.values(n).some(m);g?(c="POST",f=n):s||r?(c=s?"HEAD":"GET",Object.entries(n).filter(([x,_])=>_!==void 0).map(([x,_])=>[x,Array.isArray(_)?`{${_.join(",")}}`:`${_}`]).forEach(([x,_])=>{d.searchParams.append(x,_)})):(c="POST",f=n);const y=new Headers(this.headers);return g?y.set("Prefer",a?`count=${a},return=minimal`:"return=minimal"):a&&y.set("Prefer",`count=${a}`),new Ii({method:c,url:d,headers:y,schema:this.schemaName,body:f,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch,urlLengthLimit:this.urlLengthLimit})}};class iS{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const n=globalThis.process;if(n){const s=n.versions;if(s&&s.node){const r=s.node,a=parseInt(r.replace(/^v/,"").split(".")[0]);return a>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${a} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${a} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let n=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(n+=`

Suggested solution: ${e.workaround}`),new Error(n)}static createWebSocket(e,n){const s=this.getWebSocketConstructor();return new s(e,n)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const aS="2.95.3",oS=`realtime-js/${aS}`,lS="1.0.0",Bv="2.0.0",_g=Bv,mh=1e4,cS=1e3,uS=100;var nr;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(nr||(nr={}));var wt;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(wt||(wt={}));var zn;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(zn||(zn={}));var gh;(function(t){t.websocket="websocket"})(gh||(gh={}));var zr;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(zr||(zr={}));class dS{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,n){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return n(this._binaryEncodeUserBroadcastPush(e));let s=[e.join_ref,e.ref,e.topic,e.event,e.payload];return n(JSON.stringify(s))}_binaryEncodeUserBroadcastPush(e){var n;return this._isArrayBuffer((n=e.payload)===null||n===void 0?void 0:n.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var n,s;const r=(s=(n=e.payload)===null||n===void 0?void 0:n.payload)!==null&&s!==void 0?s:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,r)}_encodeJsonUserBroadcastPush(e){var n,s;const r=(s=(n=e.payload)===null||n===void 0?void 0:n.payload)!==null&&s!==void 0?s:{},l=new TextEncoder().encode(JSON.stringify(r)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,l)}_encodeUserBroadcastPush(e,n,s){var r,a;const l=e.topic,c=(r=e.ref)!==null&&r!==void 0?r:"",d=(a=e.join_ref)!==null&&a!==void 0?a:"",f=e.payload.event,m=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},g=Object.keys(m).length===0?"":JSON.stringify(m);if(d.length>255)throw new Error(`joinRef length ${d.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`ref length ${c.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`topic length ${l.length} exceeds maximum of 255`);if(f.length>255)throw new Error(`userEvent length ${f.length} exceeds maximum of 255`);if(g.length>255)throw new Error(`metadata length ${g.length} exceeds maximum of 255`);const y=this.USER_BROADCAST_PUSH_META_LENGTH+d.length+c.length+l.length+f.length+g.length,x=new ArrayBuffer(this.HEADER_LENGTH+y);let _=new DataView(x),S=0;_.setUint8(S++,this.KINDS.userBroadcastPush),_.setUint8(S++,d.length),_.setUint8(S++,c.length),_.setUint8(S++,l.length),_.setUint8(S++,f.length),_.setUint8(S++,g.length),_.setUint8(S++,n),Array.from(d,k=>_.setUint8(S++,k.charCodeAt(0))),Array.from(c,k=>_.setUint8(S++,k.charCodeAt(0))),Array.from(l,k=>_.setUint8(S++,k.charCodeAt(0))),Array.from(f,k=>_.setUint8(S++,k.charCodeAt(0))),Array.from(g,k=>_.setUint8(S++,k.charCodeAt(0)));var b=new Uint8Array(x.byteLength+s.byteLength);return b.set(new Uint8Array(x),0),b.set(new Uint8Array(s),x.byteLength),b.buffer}decode(e,n){if(this._isArrayBuffer(e)){let s=this._binaryDecode(e);return n(s)}if(typeof e=="string"){const s=JSON.parse(e),[r,a,l,c,d]=s;return n({join_ref:r,ref:a,topic:l,event:c,payload:d})}return n({})}_binaryDecode(e){const n=new DataView(e),s=n.getUint8(0),r=new TextDecoder;if(s===this.KINDS.userBroadcast)return this._decodeUserBroadcast(e,n,r)}_decodeUserBroadcast(e,n,s){const r=n.getUint8(1),a=n.getUint8(2),l=n.getUint8(3),c=n.getUint8(4);let d=this.HEADER_LENGTH+4;const f=s.decode(e.slice(d,d+r));d=d+r;const m=s.decode(e.slice(d,d+a));d=d+a;const g=s.decode(e.slice(d,d+l));d=d+l;const y=e.slice(d,e.byteLength),x=c===this.JSON_ENCODING?JSON.parse(s.decode(y)):y,_={type:this.BROADCAST_EVENT,event:m,payload:x};return l>0&&(_.meta=JSON.parse(g)),{join_ref:null,ref:null,topic:f,event:this.BROADCAST_EVENT,payload:_}}_isArrayBuffer(e){var n;return e instanceof ArrayBuffer||((n=e?.constructor)===null||n===void 0?void 0:n.name)==="ArrayBuffer"}_pick(e,n){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([s])=>n.includes(s)))}}class $v{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ge;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(Ge||(Ge={}));const Sg=(t,e,n={})=>{var s;const r=(s=n.skipTypes)!==null&&s!==void 0?s:[];return e?Object.keys(e).reduce((a,l)=>(a[l]=hS(l,t,e,r),a),{}):{}},hS=(t,e,n,s)=>{const r=e.find(c=>c.name===t),a=r?.type,l=n[t];return a&&!s.includes(a)?zv(a,l):yh(l)},zv=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return gS(e,n)}switch(t){case Ge.bool:return fS(e);case Ge.float4:case Ge.float8:case Ge.int2:case Ge.int4:case Ge.int8:case Ge.numeric:case Ge.oid:return pS(e);case Ge.json:case Ge.jsonb:return mS(e);case Ge.timestamp:return yS(e);case Ge.abstime:case Ge.date:case Ge.daterange:case Ge.int4range:case Ge.int8range:case Ge.money:case Ge.reltime:case Ge.text:case Ge.time:case Ge.timestamptz:case Ge.timetz:case Ge.tsrange:case Ge.tstzrange:return yh(e);default:return yh(e)}},yh=t=>t,fS=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},pS=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},mS=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch{return t}return t},gS=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,s=t[n];if(t[0]==="{"&&s==="}"){let a;const l=t.slice(1,n);try{a=JSON.parse("["+l+"]")}catch{a=l?l.split(","):[]}return a.map(c=>zv(e,c))}return t},yS=t=>typeof t=="string"?t.replace(" ","T"):t,Uv=t=>{const e=new URL(t);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class Cd{constructor(e,n,s={},r=mh){this.channel=e,this.event=n,this.payload=s,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var s;return this._hasReceived(e)&&n((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var kg;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(kg||(kg={}));class Ba{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=n?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},r=>{const{onJoin:a,onLeave:l,onSync:c}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Ba.syncState(this.state,r,a,l),this.pendingDiffs.forEach(d=>{this.state=Ba.syncDiff(this.state,d,a,l)}),this.pendingDiffs=[],c()}),this.channel._on(s.diff,{},r=>{const{onJoin:a,onLeave:l,onSync:c}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(r):(this.state=Ba.syncDiff(this.state,r,a,l),c())}),this.onJoin((r,a,l)=>{this.channel._trigger("presence",{event:"join",key:r,currentPresences:a,newPresences:l})}),this.onLeave((r,a,l)=>{this.channel._trigger("presence",{event:"leave",key:r,currentPresences:a,leftPresences:l})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,s,r){const a=this.cloneDeep(e),l=this.transformState(n),c={},d={};return this.map(a,(f,m)=>{l[f]||(d[f]=m)}),this.map(l,(f,m)=>{const g=a[f];if(g){const y=m.map(b=>b.presence_ref),x=g.map(b=>b.presence_ref),_=m.filter(b=>x.indexOf(b.presence_ref)<0),S=g.filter(b=>y.indexOf(b.presence_ref)<0);_.length>0&&(c[f]=_),S.length>0&&(d[f]=S)}else c[f]=m}),this.syncDiff(a,{joins:c,leaves:d},s,r)}static syncDiff(e,n,s,r){const{joins:a,leaves:l}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return s||(s=()=>{}),r||(r=()=>{}),this.map(a,(c,d)=>{var f;const m=(f=e[c])!==null&&f!==void 0?f:[];if(e[c]=this.cloneDeep(d),m.length>0){const g=e[c].map(x=>x.presence_ref),y=m.filter(x=>g.indexOf(x.presence_ref)<0);e[c].unshift(...y)}s(c,m,d)}),this.map(l,(c,d)=>{let f=e[c];if(!f)return;const m=d.map(g=>g.presence_ref);f=f.filter(g=>m.indexOf(g.presence_ref)<0),e[c]=f,r(c,f,d),f.length===0&&delete e[c]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(s=>n(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,s)=>{const r=e[s];return"metas"in r?n[s]=r.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):n[s]=r,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var jg;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(jg||(jg={}));var $a;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})($a||($a={}));var Ss;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(Ss||(Ss={}));class Ni{constructor(e,n={config:{}},s){var r,a;if(this.topic=e,this.params=n,this.socket=s,this.bindings={},this.state=wt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new Cd(this,zn.join,this.params,this.timeout),this.rejoinTimer=new $v(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=wt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(l=>l.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=wt.closed,this.socket._remove(this)}),this._onError(l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=wt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=wt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=wt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(zn.reply,{},(l,c)=>{this._trigger(this._replyEventName(c),l)}),this.presence=new Ba(this),this.broadcastEndpointURL=Uv(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((a=(r=this.params.config)===null||r===void 0?void 0:r.broadcast)===null||a===void 0)&&a.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,n=this.timeout){var s,r,a;if(this.socket.isConnected()||this.socket.connect(),this.state==wt.closed){const{config:{broadcast:l,presence:c,private:d}}=this.params,f=(r=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(x=>x.filter))!==null&&r!==void 0?r:[],m=!!this.bindings[$a.PRESENCE]&&this.bindings[$a.PRESENCE].length>0||((a=this.params.config.presence)===null||a===void 0?void 0:a.enabled)===!0,g={},y={broadcast:l,presence:Object.assign(Object.assign({},c),{enabled:m}),postgres_changes:f,private:d};this.socket.accessTokenValue&&(g.access_token=this.socket.accessTokenValue),this._onError(x=>e?.(Ss.CHANNEL_ERROR,x)),this._onClose(()=>e?.(Ss.CLOSED)),this.updateJoinPayload(Object.assign({config:y},g)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:x})=>{var _;if(this.socket._isManualToken()||this.socket.setAuth(),x===void 0){e?.(Ss.SUBSCRIBED);return}else{const S=this.bindings.postgres_changes,b=(_=S?.length)!==null&&_!==void 0?_:0,k=[];for(let I=0;I<b;I++){const C=S[I],{filter:{event:N,schema:O,table:U,filter:E}}=C,L=x&&x[I];if(L&&L.event===N&&Ni.isFilterValueEqual(L.schema,O)&&Ni.isFilterValueEqual(L.table,U)&&Ni.isFilterValueEqual(L.filter,E))k.push(Object.assign(Object.assign({},C),{id:L.id}));else{this.unsubscribe(),this.state=wt.errored,e?.(Ss.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=k,e&&e(Ss.SUBSCRIBED);return}}).receive("error",x=>{this.state=wt.errored,e?.(Ss.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(x).join(", ")||"error")))}).receive("timeout",()=>{e?.(Ss.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,s){return this.state===wt.joined&&e===$a.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,n,s)}async httpSend(e,n,s={}){var r;if(n==null)return Promise.reject("Payload is required for httpSend()");const a={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(a.Authorization=`Bearer ${this.socket.accessTokenValue}`);const l={method:"POST",headers:a,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:n,private:this.private}]})},c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(r=s.timeout)!==null&&r!==void 0?r:this.timeout);if(c.status===202)return{success:!0};let d=c.statusText;try{const f=await c.json();d=f.error||f.message||d}catch{}return Promise.reject(new Error(d))}async send(e,n={}){var s,r;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:a,payload:l}=e,c={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(c.Authorization=`Bearer ${this.socket.accessTokenValue}`);const d={method:"POST",headers:c,body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:l,private:this.private}]})};try{const f=await this._fetchWithTimeout(this.broadcastEndpointURL,d,(s=n.timeout)!==null&&s!==void 0?s:this.timeout);return await((r=f.body)===null||r===void 0?void 0:r.cancel()),f.ok?"ok":"error"}catch(f){return f.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var l,c,d;const f=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((d=(c=(l=this.params)===null||l===void 0?void 0:l.config)===null||c===void 0?void 0:c.broadcast)===null||d===void 0)&&d.ack)&&a("ok"),f.receive("ok",()=>a("ok")),f.receive("error",()=>a("error")),f.receive("timeout",()=>a("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=wt.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(zn.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(r=>{s=new Cd(this,zn.leave,{},e),s.receive("ok",()=>{n(),r("ok")}).receive("timeout",()=>{n(),r("timed out")}).receive("error",()=>{r("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=wt.closed,this.bindings={}}async _fetchWithTimeout(e,n,s){const r=new AbortController,a=setTimeout(()=>r.abort(),s),l=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:r.signal}));return clearTimeout(a),l}_push(e,n,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new Cd(this,e,n,s);return this._canPush()?r.send():this._addToPushBuffer(r),r}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>uS){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(e,n,s){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,s){var r,a;const l=e.toLocaleLowerCase(),{close:c,error:d,leave:f,join:m}=zn;if(s&&[c,d,f,m].indexOf(l)>=0&&s!==this._joinRef())return;let y=this._onMessage(l,n,s);if(n&&!y)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(l)?(r=this.bindings.postgres_changes)===null||r===void 0||r.filter(x=>{var _,S,b;return((_=x.filter)===null||_===void 0?void 0:_.event)==="*"||((b=(S=x.filter)===null||S===void 0?void 0:S.event)===null||b===void 0?void 0:b.toLocaleLowerCase())===l}).map(x=>x.callback(y,s)):(a=this.bindings[l])===null||a===void 0||a.filter(x=>{var _,S,b,k,I,C;if(["broadcast","presence","postgres_changes"].includes(l))if("id"in x){const N=x.id,O=(_=x.filter)===null||_===void 0?void 0:_.event;return N&&((S=n.ids)===null||S===void 0?void 0:S.includes(N))&&(O==="*"||O?.toLocaleLowerCase()===((b=n.data)===null||b===void 0?void 0:b.type.toLocaleLowerCase()))}else{const N=(I=(k=x?.filter)===null||k===void 0?void 0:k.event)===null||I===void 0?void 0:I.toLocaleLowerCase();return N==="*"||N===((C=n?.event)===null||C===void 0?void 0:C.toLocaleLowerCase())}else return x.type.toLocaleLowerCase()===l}).map(x=>{if(typeof y=="object"&&"ids"in y){const _=y.data,{schema:S,table:b,commit_timestamp:k,type:I,errors:C}=_;y=Object.assign(Object.assign({},{schema:S,table:b,commit_timestamp:k,eventType:I,new:{},old:{},errors:C}),this._getPayloadRecords(_))}x.callback(y,s)})}_isClosed(){return this.state===wt.closed}_isJoined(){return this.state===wt.joined}_isJoining(){return this.state===wt.joining}_isLeaving(){return this.state===wt.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,s){const r=e.toLocaleLowerCase(),a={type:r,filter:n,callback:s};return this.bindings[r]?this.bindings[r].push(a):this.bindings[r]=[a],this}_off(e,n){const s=e.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(r=>{var a;return!(((a=r.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===s&&Ni.isEqual(r.filter,n))})),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const s in e)if(e[s]!==n[s])return!1;return!0}static isFilterValueEqual(e,n){return(e??void 0)===(n??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(zn.close,{},e)}_onError(e){this._on(zn.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=wt.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=Sg(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=Sg(e.columns,e.old_record)),n}}const Pd=()=>{},Il={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},vS=[1e3,2e3,5e3,1e4],xS=1e4,bS=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class wS{constructor(e,n){var s;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=mh,this.transport=null,this.heartbeatIntervalMs=Il.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Pd,this.ref=0,this.reconnectTimer=null,this.vsn=_g,this.logger=Pd,this.conn=null,this.sendBuffer=[],this.serializer=new dS,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=r=>r?(...a)=>r(...a):(...a)=>fetch(...a),!(!((s=n?.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${e}/${gh.websocket}`,this.httpEndpoint=Uv(e),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=iS.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const n=e.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,n??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return n==="ok"&&this._remove(e),this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,n,s){this.logger(e,n,s)}connectionState(){switch(this.conn&&this.conn.readyState){case nr.connecting:return zr.Connecting;case nr.open:return zr.Open;case nr.closing:return zr.Closing;default:return zr.Closed}}isConnected(){return this.connectionState()===zr.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,n={config:{}}){const s=`realtime:${e}`,r=this.getChannels().find(a=>a.topic===s);if(r)return r;{const a=new Ni(`realtime:${e}`,n,this);return this.channels.push(a),a}}push(e){const{topic:n,event:s,payload:r,ref:a}=e,l=()=>{this.encode(e,c=>{var d;(d=this.conn)===null||d===void 0||d.send(c)})};this.log("push",`${n} ${s} (${a})`,r),this.isConnected()?l():this.sendBuffer.push(l)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(n){this.log("error","error in heartbeat callback",n)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(n){this.log("error","error in heartbeat callback",n)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(cS,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},Il.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(n){this.log("error","error in heartbeat callback",n)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,n=>{if(n.topic==="phoenix"&&n.event==="phx_reply"&&n.ref&&n.ref===this.pendingHeartbeatRef){const f=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(n.payload.status==="ok"?"ok":"error",f)}catch(m){this.log("error","error in heartbeat callback",m)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:s,event:r,payload:a,ref:l}=n,c=l?`(${l})`:"",d=a.status||"";this.log("receive",`${d} ${s} ${r} ${c}`.trim(),a),this.channels.filter(f=>f._isMember(s)).forEach(f=>f._trigger(r,a,l)),this._triggerStateCallbacks("message",n)})}_clearTimer(e){var n;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===nr.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===nr.open||this.conn.readyState===nr.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(n=>{this.log("error","error waiting for auth on connect",n),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this._terminateWorker()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var n;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e);try{this.heartbeatCallback("error")}catch(n){this.log("error","error in heartbeat callback",n)}}_triggerChanError(){this.channels.forEach(e=>e._trigger(zn.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const s=e.match(/\?/)?"&":"?",r=new URLSearchParams(n);return`${e}${s}${r}`}_workerObjectUrl(e){let n;if(e)n=e;else{const s=new Blob([bS],{type:"application/javascript"});n=URL.createObjectURL(s)}return n}_setConnectionState(e,n=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(e=null){let n,s=!1;if(e)n=e,s=!0;else if(this.accessToken)try{n=await this.accessToken()}catch(r){this.log("error","Error fetching access token from callback",r),n=this.accessTokenValue}else n=this.accessTokenValue;s?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(r=>{const a={access_token:n,version:oS};n&&r.updateJoinPayload(a),r.joinedOnce&&r._isJoined()&&r._push(zn.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(n=>{this.log("error",`Error setting auth in ${e}`,n)})}_triggerStateCallbacks(e,n){try{this.stateChangeCallbacks[e].forEach(s=>{try{s(n)}catch(r){this.log("error",`error in ${e} callback`,r)}})}catch(s){this.log("error",`error triggering ${e} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new $v(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Il.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var n,s,r,a,l,c,d,f,m,g,y,x;switch(this.transport=(n=e?.transport)!==null&&n!==void 0?n:null,this.timeout=(s=e?.timeout)!==null&&s!==void 0?s:mh,this.heartbeatIntervalMs=(r=e?.heartbeatIntervalMs)!==null&&r!==void 0?r:Il.HEARTBEAT_INTERVAL,this.worker=(a=e?.worker)!==null&&a!==void 0?a:!1,this.accessToken=(l=e?.accessToken)!==null&&l!==void 0?l:null,this.heartbeatCallback=(c=e?.heartbeatCallback)!==null&&c!==void 0?c:Pd,this.vsn=(d=e?.vsn)!==null&&d!==void 0?d:_g,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(f=e?.reconnectAfterMs)!==null&&f!==void 0?f:(_=>vS[_-1]||xS),this.vsn){case lS:this.encode=(m=e?.encode)!==null&&m!==void 0?m:((_,S)=>S(JSON.stringify(_))),this.decode=(g=e?.decode)!==null&&g!==void 0?g:((_,S)=>S(JSON.parse(_)));break;case Bv:this.encode=(y=e?.encode)!==null&&y!==void 0?y:this.serializer.encode.bind(this.serializer),this.decode=(x=e?.decode)!==null&&x!==void 0?x:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}var Ga=class extends Error{constructor(t,e){super(t),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&e.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function _S(t,e,n){const s=new URL(e,t);if(n)for(const[r,a]of Object.entries(n))a!==void 0&&s.searchParams.set(r,a);return s.toString()}async function SS(t){return!t||t.type==="none"?{}:t.type==="bearer"?{Authorization:`Bearer ${t.token}`}:t.type==="header"?{[t.name]:t.value}:t.type==="custom"?await t.getHeaders():{}}function kS(t){const e=t.fetchImpl??globalThis.fetch;return{async request({method:n,path:s,query:r,body:a,headers:l}){const c=_S(t.baseUrl,s,r),d=await SS(t.auth),f=await e(c,{method:n,headers:{...a?{"Content-Type":"application/json"}:{},...d,...l},body:a?JSON.stringify(a):void 0}),m=await f.text(),g=(f.headers.get("content-type")||"").includes("application/json"),y=g&&m?JSON.parse(m):m;if(!f.ok){const x=g?y:void 0,_=x?.error;throw new Ga(_?.message??`Request failed with status ${f.status}`,{status:f.status,icebergType:_?.type,icebergCode:_?.code,details:x})}return{status:f.status,headers:f.headers,data:y}}}}function El(t){return t.join("")}var jS=class{constructor(t,e=""){this.client=t,this.prefix=e}async listNamespaces(t){const e=t?{parent:El(t.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(s=>({namespace:s}))}async createNamespace(t,e){const n={namespace:t.namespace,properties:e?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:n})).data}async dropNamespace(t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${El(t.namespace)}`})}async loadNamespaceMetadata(t){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${El(t.namespace)}`})).data.properties}}async namespaceExists(t){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${El(t.namespace)}`}),!0}catch(e){if(e instanceof Ga&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(t,e){try{return await this.createNamespace(t,e)}catch(n){if(n instanceof Ga&&n.status===409)return;throw n}}};function bi(t){return t.join("")}var CS=class{constructor(t,e="",n){this.client=t,this.prefix=e,this.accessDelegation=n}async listTables(t){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${bi(t.namespace)}/tables`})).data.identifiers}async createTable(t,e){const n={};return this.accessDelegation&&(n["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${bi(t.namespace)}/tables`,body:e,headers:n})).data.metadata}async updateTable(t,e){const n=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${bi(t.namespace)}/tables/${t.name}`,body:e});return{"metadata-location":n.data["metadata-location"],metadata:n.data.metadata}}async dropTable(t,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${bi(t.namespace)}/tables/${t.name}`,query:{purgeRequested:String(e?.purge??!1)}})}async loadTable(t){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${bi(t.namespace)}/tables/${t.name}`,headers:e})).data.metadata}async tableExists(t){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${bi(t.namespace)}/tables/${t.name}`,headers:e}),!0}catch(n){if(n instanceof Ga&&n.status===404)return!1;throw n}}async createTableIfNotExists(t,e){try{return await this.createTable(t,e)}catch(n){if(n instanceof Ga&&n.status===409)return await this.loadTable({namespace:t.namespace,name:e.name});throw n}}},PS=class{constructor(t){let e="v1";t.catalogName&&(e+=`/${t.catalogName}`);const n=t.baseUrl.endsWith("/")?t.baseUrl:`${t.baseUrl}/`;this.client=kS({baseUrl:n,auth:t.auth,fetchImpl:t.fetch}),this.accessDelegation=t.accessDelegation?.join(","),this.namespaceOps=new jS(this.client,e),this.tableOps=new CS(this.client,e,this.accessDelegation)}async listNamespaces(t){return this.namespaceOps.listNamespaces(t)}async createNamespace(t,e){return this.namespaceOps.createNamespace(t,e)}async dropNamespace(t){await this.namespaceOps.dropNamespace(t)}async loadNamespaceMetadata(t){return this.namespaceOps.loadNamespaceMetadata(t)}async listTables(t){return this.tableOps.listTables(t)}async createTable(t,e){return this.tableOps.createTable(t,e)}async updateTable(t,e){return this.tableOps.updateTable(t,e)}async dropTable(t,e){await this.tableOps.dropTable(t,e)}async loadTable(t){return this.tableOps.loadTable(t)}async namespaceExists(t){return this.namespaceOps.namespaceExists(t)}async tableExists(t){return this.tableOps.tableExists(t)}async createNamespaceIfNotExists(t,e){return this.namespaceOps.createNamespaceIfNotExists(t,e)}async createTableIfNotExists(t,e){return this.tableOps.createTableIfNotExists(t,e)}},wc=class extends Error{constructor(t,e="storage",n,s){super(t),this.__isStorageError=!0,this.namespace=e,this.name=e==="vectors"?"StorageVectorsError":"StorageError",this.status=n,this.statusCode=s}};function _c(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}var Tl=class extends wc{constructor(t,e,n,s="storage"){super(t,s,e,n),this.name=s==="vectors"?"StorageVectorsApiError":"StorageApiError",this.status=e,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Wv=class extends wc{constructor(t,e,n="storage"){super(t,n),this.name=n==="vectors"?"StorageVectorsUnknownError":"StorageUnknownError",this.originalError=e}};const IS=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),ES=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},vh=t=>{if(Array.isArray(t))return t.map(n=>vh(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,s])=>{const r=n.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));e[r]=vh(s)}),e},TS=t=>!t||typeof t!="string"||t.length===0||t.length>100||t.trim()!==t||t.includes("/")||t.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(t);function Ya(t){"@babel/helpers - typeof";return Ya=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ya(t)}function NS(t,e){if(Ya(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(Ya(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function AS(t){var e=NS(t,"string");return Ya(e)=="symbol"?e:e+""}function OS(t,e,n){return(e=AS(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cg(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function ke(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Cg(Object(n),!0).forEach(function(s){OS(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Cg(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}const Pg=t=>{var e;return t.msg||t.message||t.error_description||(typeof t.error=="string"?t.error:(e=t.error)===null||e===void 0?void 0:e.message)||JSON.stringify(t)},RS=async(t,e,n,s)=>{if(t&&typeof t=="object"&&"status"in t&&"ok"in t&&typeof t.status=="number"&&!n?.noResolveJson){const r=t,a=r.status||500;if(typeof r.json=="function")r.json().then(l=>{const c=l?.statusCode||l?.code||a+"";e(new Tl(Pg(l),a,c,s))}).catch(()=>{if(s==="vectors"){const l=a+"";e(new Tl(r.statusText||`HTTP ${a} error`,a,l,s))}else{const l=a+"";e(new Tl(r.statusText||`HTTP ${a} error`,a,l,s))}});else{const l=a+"";e(new Tl(r.statusText||`HTTP ${a} error`,a,l,s))}}else e(new Wv(Pg(t),t,s))},MS=(t,e,n,s)=>{const r={method:t,headers:e?.headers||{}};return t==="GET"||t==="HEAD"||!s?ke(ke({},r),n):(ES(s)?(r.headers=ke({"Content-Type":"application/json"},e?.headers),r.body=JSON.stringify(s)):r.body=s,e?.duplex&&(r.duplex=e.duplex),ke(ke({},r),n))};async function Sa(t,e,n,s,r,a,l){return new Promise((c,d)=>{t(n,MS(e,s,r,a)).then(f=>{if(!f.ok)throw f;if(s?.noResolveJson)return f;if(l==="vectors"){const m=f.headers.get("content-type");if(f.headers.get("content-length")==="0"||f.status===204)return{};if(!m||!m.includes("application/json"))return{}}return f.json()}).then(f=>c(f)).catch(f=>RS(f,d,s,l))})}function Vv(t="storage"){return{get:async(e,n,s,r)=>Sa(e,"GET",n,s,r,void 0,t),post:async(e,n,s,r,a)=>Sa(e,"POST",n,r,a,s,t),put:async(e,n,s,r,a)=>Sa(e,"PUT",n,r,a,s,t),head:async(e,n,s,r)=>Sa(e,"HEAD",n,ke(ke({},s),{},{noResolveJson:!0}),r,void 0,t),remove:async(e,n,s,r,a)=>Sa(e,"DELETE",n,r,a,s,t)}}const LS=Vv("storage"),{get:Ja,post:$n,put:xh,head:DS,remove:Vh}=LS,fn=Vv("vectors");var Ui=class{constructor(t,e={},n,s="storage"){this.shouldThrowOnError=!1,this.url=t,this.headers=e,this.fetch=IS(n),this.namespace=s}throwOnError(){return this.shouldThrowOnError=!0,this}async handleOperation(t){var e=this;try{return{data:await t(),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(_c(n))return{data:null,error:n};throw n}}},FS=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e}then(t,e){return this.execute().then(t,e)}async execute(){var t=this;try{return{data:(await t.downloadFn()).body,error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(_c(e))return{data:null,error:e};throw e}}};let qv;qv=Symbol.toStringTag;var BS=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e,this[qv]="BlobDownloadBuilder",this.promise=null}asStream(){return new FS(this.downloadFn,this.shouldThrowOnError)}then(t,e){return this.getPromise().then(t,e)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var t=this;try{return{data:await(await t.downloadFn()).blob(),error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(_c(e))return{data:null,error:e};throw e}}};const $S={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Ig={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var zS=class extends Ui{constructor(t,e={},n,s){super(t,e,s,"storage"),this.bucketId=n}async uploadOrUpdate(t,e,n,s){var r=this;return r.handleOperation(async()=>{let a;const l=ke(ke({},Ig),s);let c=ke(ke({},r.headers),t==="POST"&&{"x-upsert":String(l.upsert)});const d=l.metadata;typeof Blob<"u"&&n instanceof Blob?(a=new FormData,a.append("cacheControl",l.cacheControl),d&&a.append("metadata",r.encodeMetadata(d)),a.append("",n)):typeof FormData<"u"&&n instanceof FormData?(a=n,a.has("cacheControl")||a.append("cacheControl",l.cacheControl),d&&!a.has("metadata")&&a.append("metadata",r.encodeMetadata(d))):(a=n,c["cache-control"]=`max-age=${l.cacheControl}`,c["content-type"]=l.contentType,d&&(c["x-metadata"]=r.toBase64(r.encodeMetadata(d))),(typeof ReadableStream<"u"&&a instanceof ReadableStream||a&&typeof a=="object"&&"pipe"in a&&typeof a.pipe=="function")&&!l.duplex&&(l.duplex="half")),s?.headers&&(c=ke(ke({},c),s.headers));const f=r._removeEmptyFolders(e),m=r._getFinalPath(f),g=await(t=="PUT"?xh:$n)(r.fetch,`${r.url}/object/${m}`,a,ke({headers:c},l?.duplex?{duplex:l.duplex}:{}));return{path:f,id:g.Id,fullPath:g.Key}})}async upload(t,e,n){return this.uploadOrUpdate("POST",t,e,n)}async uploadToSignedUrl(t,e,n,s){var r=this;const a=r._removeEmptyFolders(t),l=r._getFinalPath(a),c=new URL(r.url+`/object/upload/sign/${l}`);return c.searchParams.set("token",e),r.handleOperation(async()=>{let d;const f=ke({upsert:Ig.upsert},s),m=ke(ke({},r.headers),{"x-upsert":String(f.upsert)});return typeof Blob<"u"&&n instanceof Blob?(d=new FormData,d.append("cacheControl",f.cacheControl),d.append("",n)):typeof FormData<"u"&&n instanceof FormData?(d=n,d.append("cacheControl",f.cacheControl)):(d=n,m["cache-control"]=`max-age=${f.cacheControl}`,m["content-type"]=f.contentType),{path:a,fullPath:(await xh(r.fetch,c.toString(),d,{headers:m})).Key}})}async createSignedUploadUrl(t,e){var n=this;return n.handleOperation(async()=>{let s=n._getFinalPath(t);const r=ke({},n.headers);e?.upsert&&(r["x-upsert"]="true");const a=await $n(n.fetch,`${n.url}/object/upload/sign/${s}`,{},{headers:r}),l=new URL(n.url+a.url),c=l.searchParams.get("token");if(!c)throw new wc("No token returned by API");return{signedUrl:l.toString(),path:t,token:c}})}async update(t,e,n){return this.uploadOrUpdate("PUT",t,e,n)}async move(t,e,n){var s=this;return s.handleOperation(async()=>await $n(s.fetch,`${s.url}/object/move`,{bucketId:s.bucketId,sourceKey:t,destinationKey:e,destinationBucket:n?.destinationBucket},{headers:s.headers}))}async copy(t,e,n){var s=this;return s.handleOperation(async()=>({path:(await $n(s.fetch,`${s.url}/object/copy`,{bucketId:s.bucketId,sourceKey:t,destinationKey:e,destinationBucket:n?.destinationBucket},{headers:s.headers})).Key}))}async createSignedUrl(t,e,n){var s=this;return s.handleOperation(async()=>{let r=s._getFinalPath(t),a=await $n(s.fetch,`${s.url}/object/sign/${r}`,ke({expiresIn:e},n?.transform?{transform:n.transform}:{}),{headers:s.headers});const l=n?.download?`&download=${n.download===!0?"":n.download}`:"";return{signedUrl:encodeURI(`${s.url}${a.signedURL}${l}`)}})}async createSignedUrls(t,e,n){var s=this;return s.handleOperation(async()=>{const r=await $n(s.fetch,`${s.url}/object/sign/${s.bucketId}`,{expiresIn:e,paths:t},{headers:s.headers}),a=n?.download?`&download=${n.download===!0?"":n.download}`:"";return r.map(l=>ke(ke({},l),{},{signedUrl:l.signedURL?encodeURI(`${s.url}${l.signedURL}${a}`):null}))})}download(t,e,n){const s=typeof e?.transform<"u"?"render/image/authenticated":"object",r=this.transformOptsToQueryString(e?.transform||{}),a=r?`?${r}`:"",l=this._getFinalPath(t),c=()=>Ja(this.fetch,`${this.url}/${s}/${l}${a}`,{headers:this.headers,noResolveJson:!0},n);return new BS(c,this.shouldThrowOnError)}async info(t){var e=this;const n=e._getFinalPath(t);return e.handleOperation(async()=>vh(await Ja(e.fetch,`${e.url}/object/info/${n}`,{headers:e.headers})))}async exists(t){var e=this;const n=e._getFinalPath(t);try{return await DS(e.fetch,`${e.url}/object/${n}`,{headers:e.headers}),{data:!0,error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(_c(s)&&s instanceof Wv){const r=s.originalError;if([400,404].includes(r?.status))return{data:!1,error:s}}throw s}}getPublicUrl(t,e){const n=this._getFinalPath(t),s=[],r=e?.download?`download=${e.download===!0?"":e.download}`:"";r!==""&&s.push(r);const a=typeof e?.transform<"u"?"render/image":"object",l=this.transformOptsToQueryString(e?.transform||{});l!==""&&s.push(l);let c=s.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${n}${c}`)}}}async remove(t){var e=this;return e.handleOperation(async()=>await Vh(e.fetch,`${e.url}/object/${e.bucketId}`,{prefixes:t},{headers:e.headers}))}async list(t,e,n){var s=this;return s.handleOperation(async()=>{const r=ke(ke(ke({},$S),e),{},{prefix:t||""});return await $n(s.fetch,`${s.url}/object/list/${s.bucketId}`,r,{headers:s.headers},n)})}async listV2(t,e){var n=this;return n.handleOperation(async()=>{const s=ke({},t);return await $n(n.fetch,`${n.url}/object/list-v2/${n.bucketId}`,s,{headers:n.headers},e)})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const e=[];return t.width&&e.push(`width=${t.width}`),t.height&&e.push(`height=${t.height}`),t.resize&&e.push(`resize=${t.resize}`),t.format&&e.push(`format=${t.format}`),t.quality&&e.push(`quality=${t.quality}`),e.join("&")}};const US="2.95.3",ho={"X-Client-Info":`storage-js/${US}`};var WS=class extends Ui{constructor(t,e={},n,s){const r=new URL(t);s?.useNewHostname&&/supabase\.(co|in|red)$/.test(r.hostname)&&!r.hostname.includes("storage.supabase.")&&(r.hostname=r.hostname.replace("supabase.","storage.supabase."));const a=r.href.replace(/\/$/,""),l=ke(ke({},ho),e);super(a,l,n,"storage")}async listBuckets(t){var e=this;return e.handleOperation(async()=>{const n=e.listBucketOptionsToQueryString(t);return await Ja(e.fetch,`${e.url}/bucket${n}`,{headers:e.headers})})}async getBucket(t){var e=this;return e.handleOperation(async()=>await Ja(e.fetch,`${e.url}/bucket/${t}`,{headers:e.headers}))}async createBucket(t,e={public:!1}){var n=this;return n.handleOperation(async()=>await $n(n.fetch,`${n.url}/bucket`,{id:t,name:t,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:n.headers}))}async updateBucket(t,e){var n=this;return n.handleOperation(async()=>await xh(n.fetch,`${n.url}/bucket/${t}`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:n.headers}))}async emptyBucket(t){var e=this;return e.handleOperation(async()=>await $n(e.fetch,`${e.url}/bucket/${t}/empty`,{},{headers:e.headers}))}async deleteBucket(t){var e=this;return e.handleOperation(async()=>await Vh(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}))}listBucketOptionsToQueryString(t){const e={};return t&&("limit"in t&&(e.limit=String(t.limit)),"offset"in t&&(e.offset=String(t.offset)),t.search&&(e.search=t.search),t.sortColumn&&(e.sortColumn=t.sortColumn),t.sortOrder&&(e.sortOrder=t.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}},VS=class extends Ui{constructor(t,e={},n){const s=t.replace(/\/$/,""),r=ke(ke({},ho),e);super(s,r,n,"storage")}async createBucket(t){var e=this;return e.handleOperation(async()=>await $n(e.fetch,`${e.url}/bucket`,{name:t},{headers:e.headers}))}async listBuckets(t){var e=this;return e.handleOperation(async()=>{const n=new URLSearchParams;t?.limit!==void 0&&n.set("limit",t.limit.toString()),t?.offset!==void 0&&n.set("offset",t.offset.toString()),t?.sortColumn&&n.set("sortColumn",t.sortColumn),t?.sortOrder&&n.set("sortOrder",t.sortOrder),t?.search&&n.set("search",t.search);const s=n.toString(),r=s?`${e.url}/bucket?${s}`:`${e.url}/bucket`;return await Ja(e.fetch,r,{headers:e.headers})})}async deleteBucket(t){var e=this;return e.handleOperation(async()=>await Vh(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}))}from(t){var e=this;if(!TS(t))throw new wc("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const n=new PS({baseUrl:this.url,catalogName:t,auth:{type:"custom",getHeaders:async()=>e.headers},fetch:this.fetch}),s=this.shouldThrowOnError;return new Proxy(n,{get(r,a){const l=r[a];return typeof l!="function"?l:async(...c)=>{try{return{data:await l.apply(r,c),error:null}}catch(d){if(s)throw d;return{data:null,error:d}}}}})}},qS=class extends Ui{constructor(t,e={},n){const s=t.replace(/\/$/,""),r=ke(ke({},ho),{},{"Content-Type":"application/json"},e);super(s,r,n,"vectors")}async createIndex(t){var e=this;return e.handleOperation(async()=>await fn.post(e.fetch,`${e.url}/CreateIndex`,t,{headers:e.headers})||{})}async getIndex(t,e){var n=this;return n.handleOperation(async()=>await fn.post(n.fetch,`${n.url}/GetIndex`,{vectorBucketName:t,indexName:e},{headers:n.headers}))}async listIndexes(t){var e=this;return e.handleOperation(async()=>await fn.post(e.fetch,`${e.url}/ListIndexes`,t,{headers:e.headers}))}async deleteIndex(t,e){var n=this;return n.handleOperation(async()=>await fn.post(n.fetch,`${n.url}/DeleteIndex`,{vectorBucketName:t,indexName:e},{headers:n.headers})||{})}},HS=class extends Ui{constructor(t,e={},n){const s=t.replace(/\/$/,""),r=ke(ke({},ho),{},{"Content-Type":"application/json"},e);super(s,r,n,"vectors")}async putVectors(t){var e=this;if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return e.handleOperation(async()=>await fn.post(e.fetch,`${e.url}/PutVectors`,t,{headers:e.headers})||{})}async getVectors(t){var e=this;return e.handleOperation(async()=>await fn.post(e.fetch,`${e.url}/GetVectors`,t,{headers:e.headers}))}async listVectors(t){var e=this;if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return e.handleOperation(async()=>await fn.post(e.fetch,`${e.url}/ListVectors`,t,{headers:e.headers}))}async queryVectors(t){var e=this;return e.handleOperation(async()=>await fn.post(e.fetch,`${e.url}/QueryVectors`,t,{headers:e.headers}))}async deleteVectors(t){var e=this;if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return e.handleOperation(async()=>await fn.post(e.fetch,`${e.url}/DeleteVectors`,t,{headers:e.headers})||{})}},KS=class extends Ui{constructor(t,e={},n){const s=t.replace(/\/$/,""),r=ke(ke({},ho),{},{"Content-Type":"application/json"},e);super(s,r,n,"vectors")}async createBucket(t){var e=this;return e.handleOperation(async()=>await fn.post(e.fetch,`${e.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{})}async getBucket(t){var e=this;return e.handleOperation(async()=>await fn.post(e.fetch,`${e.url}/GetVectorBucket`,{vectorBucketName:t},{headers:e.headers}))}async listBuckets(t={}){var e=this;return e.handleOperation(async()=>await fn.post(e.fetch,`${e.url}/ListVectorBuckets`,t,{headers:e.headers}))}async deleteBucket(t){var e=this;return e.handleOperation(async()=>await fn.post(e.fetch,`${e.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{})}},GS=class extends KS{constructor(t,e={}){super(t,e.headers||{},e.fetch)}from(t){return new YS(this.url,this.headers,t,this.fetch)}async createBucket(t){var e=()=>super.createBucket,n=this;return e().call(n,t)}async getBucket(t){var e=()=>super.getBucket,n=this;return e().call(n,t)}async listBuckets(t={}){var e=()=>super.listBuckets,n=this;return e().call(n,t)}async deleteBucket(t){var e=()=>super.deleteBucket,n=this;return e().call(n,t)}},YS=class extends qS{constructor(t,e,n,s){super(t,e,s),this.vectorBucketName=n}async createIndex(t){var e=()=>super.createIndex,n=this;return e().call(n,ke(ke({},t),{},{vectorBucketName:n.vectorBucketName}))}async listIndexes(t={}){var e=()=>super.listIndexes,n=this;return e().call(n,ke(ke({},t),{},{vectorBucketName:n.vectorBucketName}))}async getIndex(t){var e=()=>super.getIndex,n=this;return e().call(n,n.vectorBucketName,t)}async deleteIndex(t){var e=()=>super.deleteIndex,n=this;return e().call(n,n.vectorBucketName,t)}index(t){return new JS(this.url,this.headers,this.vectorBucketName,t,this.fetch)}},JS=class extends HS{constructor(t,e,n,s,r){super(t,e,r),this.vectorBucketName=n,this.indexName=s}async putVectors(t){var e=()=>super.putVectors,n=this;return e().call(n,ke(ke({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async getVectors(t){var e=()=>super.getVectors,n=this;return e().call(n,ke(ke({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async listVectors(t={}){var e=()=>super.listVectors,n=this;return e().call(n,ke(ke({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async queryVectors(t){var e=()=>super.queryVectors,n=this;return e().call(n,ke(ke({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async deleteVectors(t){var e=()=>super.deleteVectors,n=this;return e().call(n,ke(ke({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}},XS=class extends WS{constructor(t,e={},n,s){super(t,e,n,s)}from(t){return new zS(this.url,this.headers,t,this.fetch)}get vectors(){return new GS(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new VS(this.url+"/iceberg",this.headers,this.fetch)}};const Hv="2.95.3",Ei=30*1e3,bh=3,Id=bh*Ei,QS="http://localhost:9999",ZS="supabase.auth.token",ek={"X-Client-Info":`gotrue-js/${Hv}`},wh="X-Supabase-Api-Version",Kv={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},tk=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,nk=600*1e3;class Xa extends Error{constructor(e,n,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=s}}function ve(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class sk extends Xa{constructor(e,n,s){super(e,n,s),this.name="AuthApiError",this.status=n,this.code=s}}function rk(t){return ve(t)&&t.name==="AuthApiError"}class Ur extends Xa{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class Ns extends Xa{constructor(e,n,s,r){super(e,s,r),this.name=n,this.status=s}}class dn extends Ns{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Ed(t){return ve(t)&&t.name==="AuthSessionMissingError"}class wi extends Ns{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Nl extends Ns{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Al extends Ns{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function ik(t){return ve(t)&&t.name==="AuthImplicitGrantRedirectError"}class Eg extends Ns{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class ak extends Ns{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class _h extends Ns{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function Td(t){return ve(t)&&t.name==="AuthRetryableFetchError"}class Tg extends Ns{constructor(e,n,s){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=s}}class Sh extends Ns{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const sc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Ng=` 	
\r=`.split(""),ok=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<Ng.length;e+=1)t[Ng[e].charCodeAt(0)]=-2;for(let e=0;e<sc.length;e+=1)t[sc[e].charCodeAt(0)]=e;return t})();function Ag(t,e,n){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;n(sc[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;n(sc[s]),e.queuedBits-=6}}function Gv(t,e,n){const s=ok[t];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)n(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function Og(t){const e=[],n=l=>{e.push(String.fromCodePoint(l))},s={utf8seq:0,codepoint:0},r={queue:0,queuedBits:0},a=l=>{uk(l,s,n)};for(let l=0;l<t.length;l+=1)Gv(t.charCodeAt(l),r,a);return e.join("")}function lk(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function ck(t,e){for(let n=0;n<t.length;n+=1){let s=t.charCodeAt(n);if(s>55295&&s<=56319){const r=(s-55296)*1024&65535;s=(t.charCodeAt(n+1)-56320&65535|r)+65536,n+=1}lk(s,e)}}function uk(t,e,n){if(e.utf8seq===0){if(t<=127){n(t);return}for(let s=1;s<6;s+=1)if((t>>7-s&1)===0){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&n(e.codepoint)}}function Ai(t){const e=[],n={queue:0,queuedBits:0},s=r=>{e.push(r)};for(let r=0;r<t.length;r+=1)Gv(t.charCodeAt(r),n,s);return new Uint8Array(e)}function dk(t){const e=[];return ck(t,n=>e.push(n)),new Uint8Array(e)}function Wr(t){const e=[],n={queue:0,queuedBits:0},s=r=>{e.push(r)};return t.forEach(r=>Ag(r,n,s)),Ag(null,n,s),e.join("")}function hk(t){return Math.round(Date.now()/1e3)+t}function fk(){return Symbol("auth-callback")}const Nt=()=>typeof window<"u"&&typeof document<"u",Ar={tested:!1,writable:!1},Yv=()=>{if(!Nt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ar.tested)return Ar.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Ar.tested=!0,Ar.writable=!0}catch{Ar.tested=!0,Ar.writable=!1}return Ar.writable};function pk(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((r,a)=>{e[a]=r})}catch{}return n.searchParams.forEach((s,r)=>{e[r]=s}),e}const Jv=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),mk=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",Ti=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},Or=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},Tt=async(t,e)=>{await t.removeItem(e)};class Sc{constructor(){this.promise=new Sc.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}Sc.promiseConstructor=Promise;function Ol(t){const e=t.split(".");if(e.length!==3)throw new Sh("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!tk.test(e[s]))throw new Sh("JWT not in base64url format");return{header:JSON.parse(Og(e[0])),payload:JSON.parse(Og(e[1])),signature:Ai(e[2]),raw:{header:e[0],payload:e[1]}}}async function gk(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function yk(t,e){return new Promise((s,r)=>{(async()=>{for(let a=0;a<1/0;a++)try{const l=await t(a);if(!e(a,null,l)){s(l);return}}catch(l){if(!e(a,l)){r(l);return}}})()})}function vk(t){return("0"+t.toString(16)).substr(-2)}function xk(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=n.length;let r="";for(let a=0;a<56;a++)r+=n.charAt(Math.floor(Math.random()*s));return r}return crypto.getRandomValues(e),Array.from(e,vk).join("")}async function bk(t){const n=new TextEncoder().encode(t),s=await crypto.subtle.digest("SHA-256",n),r=new Uint8Array(s);return Array.from(r).map(a=>String.fromCharCode(a)).join("")}async function wk(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await bk(t);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function _i(t,e,n=!1){const s=xk();let r=s;n&&(r+="/PASSWORD_RECOVERY"),await Ti(t,`${e}-code-verifier`,r);const a=await wk(s);return[a,s===a?"plain":"s256"]}const _k=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Sk(t){const e=t.headers.get(wh);if(!e||!e.match(_k))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function kk(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function jk(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Ck=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Si(t){if(!Ck.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Nd(){const t={};return new Proxy(t,{get:(e,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const s=n.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Pk(t,e){return new Proxy(t,{get:(n,s,r)=>{if(s==="__isInsecureUserWarningProxy")return!0;if(typeof s=="symbol"){const a=s.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)"||a==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(n,s,r)}return!e.value&&typeof s=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(n,s,r)}})}function Rg(t){return JSON.parse(JSON.stringify(t))}const Fr=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Ik=[502,503,504];async function Mg(t){var e;if(!mk(t))throw new _h(Fr(t),0);if(Ik.includes(t.status))throw new _h(Fr(t),t.status);let n;try{n=await t.json()}catch(a){throw new Ur(Fr(a),a)}let s;const r=Sk(t);if(r&&r.getTime()>=Kv["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?s=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(s=n.error_code),s){if(s==="weak_password")throw new Tg(Fr(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new dn}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((a,l)=>a&&typeof l=="string",!0))throw new Tg(Fr(n),t.status,n.weak_password.reasons);throw new sk(Fr(n),t.status||500,s)}const Ek=(t,e,n,s)=>{const r={method:t,headers:e?.headers||{}};return t==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),r.body=JSON.stringify(s),Object.assign(Object.assign({},r),n))};async function Se(t,e,n,s){var r;const a=Object.assign({},s?.headers);a[wh]||(a[wh]=Kv["2024-01-01"].name),s?.jwt&&(a.Authorization=`Bearer ${s.jwt}`);const l=(r=s?.query)!==null&&r!==void 0?r:{};s?.redirectTo&&(l.redirect_to=s.redirectTo);const c=Object.keys(l).length?"?"+new URLSearchParams(l).toString():"",d=await Tk(t,e,n+c,{headers:a,noResolveJson:s?.noResolveJson},{},s?.body);return s?.xform?s?.xform(d):{data:Object.assign({},d),error:null}}async function Tk(t,e,n,s,r,a){const l=Ek(e,s,r,a);let c;try{c=await t(n,Object.assign({},l))}catch(d){throw console.error(d),new _h(Fr(d),0)}if(c.ok||await Mg(c),s?.noResolveJson)return c;try{return await c.json()}catch(d){await Mg(d)}}function Bn(t){var e;let n=null;Ok(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=hk(t.expires_in)));const s=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:s},error:null}}function Lg(t){const e=Bn(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,s)=>n&&typeof s=="string",!0)&&(e.data.weak_password=t.weak_password),e}function sr(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function Nk(t){return{data:t,error:null}}function Ak(t){const{action_link:e,email_otp:n,hashed_token:s,redirect_to:r,verification_type:a}=t,l=bc(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),c={action_link:e,email_otp:n,hashed_token:s,redirect_to:r,verification_type:a},d=Object.assign({},l);return{data:{properties:c,user:d},error:null}}function Dg(t){return t}function Ok(t){return t.access_token&&t.refresh_token&&t.expires_in}const Ad=["global","local","others"];class Rk{constructor({url:e="",headers:n={},fetch:s}){this.url=e,this.headers=n,this.fetch=Jv(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,n=Ad[0]){if(Ad.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Ad.join(", ")}`);try{return await Se(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(ve(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,n={}){try{return await Se(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:sr})}catch(s){if(ve(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:n}=e,s=bc(e,["options"]),r=Object.assign(Object.assign({},s),n);return"newEmail"in s&&(r.new_email=s?.newEmail,delete r.newEmail),await Se(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:Ak,redirectTo:n?.redirectTo})}catch(n){if(ve(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await Se(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:sr})}catch(n){if(ve(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,s,r,a,l,c,d;try{const f={nextPage:null,lastPage:0,total:0},m=await Se(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(n=e?.page)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:"",per_page:(a=(r=e?.perPage)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:""},xform:Dg});if(m.error)throw m.error;const g=await m.json(),y=(l=m.headers.get("x-total-count"))!==null&&l!==void 0?l:0,x=(d=(c=m.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&d!==void 0?d:[];return x.length>0&&(x.forEach(_=>{const S=parseInt(_.split(";")[0].split("=")[1].substring(0,1)),b=JSON.parse(_.split(";")[1].split("=")[1]);f[`${b}Page`]=S}),f.total=parseInt(y)),{data:Object.assign(Object.assign({},g),f),error:null}}catch(f){if(ve(f))return{data:{users:[]},error:f};throw f}}async getUserById(e){Si(e);try{return await Se(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:sr})}catch(n){if(ve(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){Si(e);try{return await Se(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:sr})}catch(s){if(ve(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,n=!1){Si(e);try{return await Se(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:sr})}catch(s){if(ve(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){Si(e.userId);try{const{data:n,error:s}=await Se(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:r=>({data:{factors:r},error:null})});return{data:n,error:s}}catch(n){if(ve(n))return{data:null,error:n};throw n}}async _deleteFactor(e){Si(e.userId),Si(e.id);try{return{data:await Se(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(ve(n))return{data:null,error:n};throw n}}async _listOAuthClients(e){var n,s,r,a,l,c,d;try{const f={nextPage:null,lastPage:0,total:0},m=await Se(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(n=e?.page)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:"",per_page:(a=(r=e?.perPage)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:""},xform:Dg});if(m.error)throw m.error;const g=await m.json(),y=(l=m.headers.get("x-total-count"))!==null&&l!==void 0?l:0,x=(d=(c=m.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&d!==void 0?d:[];return x.length>0&&(x.forEach(_=>{const S=parseInt(_.split(";")[0].split("=")[1].substring(0,1)),b=JSON.parse(_.split(";")[1].split("=")[1]);f[`${b}Page`]=S}),f.total=parseInt(y)),{data:Object.assign(Object.assign({},g),f),error:null}}catch(f){if(ve(f))return{data:{clients:[]},error:f};throw f}}async _createOAuthClient(e){try{return await Se(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(ve(n))return{data:null,error:n};throw n}}async _getOAuthClient(e){try{return await Se(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(ve(n))return{data:null,error:n};throw n}}async _updateOAuthClient(e,n){try{return await Se(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:n,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(ve(s))return{data:null,error:s};throw s}}async _deleteOAuthClient(e){try{return await Se(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(n){if(ve(n))return{data:null,error:n};throw n}}async _regenerateOAuthClientSecret(e){try{return await Se(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(ve(n))return{data:null,error:n};throw n}}}function Fg(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}const ki={debug:!!(globalThis&&Yv()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Xv extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Mk extends Xv{}async function Lk(t,e,n){ki.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),ki.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async r=>{if(r){ki.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,r.name);try{return await n()}finally{ki.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,r.name)}}else{if(e===0)throw ki.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new Mk(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(ki.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}function Dk(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Qv(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function Fk(t){return parseInt(t,16)}function Bk(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,s=>s.toString(16).padStart(2,"0")).join("")}function $k(t){var e;const{chainId:n,domain:s,expirationTime:r,issuedAt:a=new Date,nonce:l,notBefore:c,requestId:d,resources:f,scheme:m,uri:g,version:y}=t;{if(!Number.isInteger(n))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${n}`);if(!s)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(l&&l.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${l}`);if(!g)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(y!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${y}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const x=Qv(t.address),_=m?`${m}://${s}`:s,S=t.statement?`${t.statement}
`:"",b=`${_} wants you to sign in with your Ethereum account:
${x}

${S}`;let k=`URI: ${g}
Version: ${y}
Chain ID: ${n}${l?`
Nonce: ${l}`:""}
Issued At: ${a.toISOString()}`;if(r&&(k+=`
Expiration Time: ${r.toISOString()}`),c&&(k+=`
Not Before: ${c.toISOString()}`),d&&(k+=`
Request ID: ${d}`),f){let I=`
Resources:`;for(const C of f){if(!C||typeof C!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${C}`);I+=`
- ${C}`}k+=I}return`${b}
${k}`}class vt extends Error{constructor({message:e,code:n,cause:s,name:r}){var a;super(e,{cause:s}),this.__isWebAuthnError=!0,this.name=(a=r??(s instanceof Error?s.name:void 0))!==null&&a!==void 0?a:"Unknown Error",this.code=n}}class rc extends vt{constructor(e,n){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n,message:e}),this.name="WebAuthnUnknownError",this.originalError=n}}function zk({error:t,options:e}){var n,s,r;const{publicKey:a}=e;if(!a)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new vt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((n=a.authenticatorSelection)===null||n===void 0?void 0:n.requireResidentKey)===!0)return new vt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(e.mediation==="conditional"&&((s=a.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new vt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((r=a.authenticatorSelection)===null||r===void 0?void 0:r.userVerification)==="required")return new vt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new vt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new vt({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return a.pubKeyCredParams.filter(c=>c.type==="public-key").length===0?new vt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new vt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const l=window.location.hostname;if(Zv(l)){if(a.rp.id!==l)return new vt({message:`The RP ID "${a.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new vt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(a.user.id.byteLength<1||a.user.id.byteLength>64)return new vt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new vt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new vt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function Uk({error:t,options:e}){const{publicKey:n}=e;if(!n)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new vt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new vt({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const s=window.location.hostname;if(Zv(s)){if(n.rpId!==s)return new vt({message:`The RP ID "${n.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new vt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new vt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new vt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}class Wk{createNewAbortSignal(){if(this.controller){const n=new Error("Cancelling existing WebAuthn API call for new one");n.name="AbortError",this.controller.abort(n)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const Vk=new Wk;function qk(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:e,user:n,excludeCredentials:s}=t,r=bc(t,["challenge","user","excludeCredentials"]),a=Ai(e).buffer,l=Object.assign(Object.assign({},n),{id:Ai(n.id).buffer}),c=Object.assign(Object.assign({},r),{challenge:a,user:l});if(s&&s.length>0){c.excludeCredentials=new Array(s.length);for(let d=0;d<s.length;d++){const f=s[d];c.excludeCredentials[d]=Object.assign(Object.assign({},f),{id:Ai(f.id).buffer,type:f.type||"public-key",transports:f.transports})}}return c}function Hk(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:e,allowCredentials:n}=t,s=bc(t,["challenge","allowCredentials"]),r=Ai(e).buffer,a=Object.assign(Object.assign({},s),{challenge:r});if(n&&n.length>0){a.allowCredentials=new Array(n.length);for(let l=0;l<n.length;l++){const c=n[l];a.allowCredentials[l]=Object.assign(Object.assign({},c),{id:Ai(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return a}function Kk(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const n=t;return{id:t.id,rawId:t.id,response:{attestationObject:Wr(new Uint8Array(t.response.attestationObject)),clientDataJSON:Wr(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(e=n.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function Gk(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const n=t,s=t.getClientExtensionResults(),r=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:Wr(new Uint8Array(r.authenticatorData)),clientDataJSON:Wr(new Uint8Array(r.clientDataJSON)),signature:Wr(new Uint8Array(r.signature)),userHandle:r.userHandle?Wr(new Uint8Array(r.userHandle)):void 0},type:"public-key",clientExtensionResults:s,authenticatorAttachment:(e=n.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function Zv(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function Bg(){var t,e;return!!(Nt()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator?.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.get)=="function")}async function Yk(t){try{const e=await navigator.credentials.create(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new rc("Browser returned unexpected credential type",e)}:{data:null,error:new rc("Empty credential response",e)}}catch(e){return{data:null,error:zk({error:e,options:t})}}}async function Jk(t){try{const e=await navigator.credentials.get(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new rc("Browser returned unexpected credential type",e)}:{data:null,error:new rc("Empty credential response",e)}}catch(e){return{data:null,error:Uk({error:e,options:t})}}}const Xk={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},Qk={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function ic(...t){const e=r=>r!==null&&typeof r=="object"&&!Array.isArray(r),n=r=>r instanceof ArrayBuffer||ArrayBuffer.isView(r),s={};for(const r of t)if(r)for(const a in r){const l=r[a];if(l!==void 0)if(Array.isArray(l))s[a]=l;else if(n(l))s[a]=l;else if(e(l)){const c=s[a];e(c)?s[a]=ic(c,l):s[a]=ic(l)}else s[a]=l}return s}function Zk(t,e){return ic(Xk,t,e||{})}function ej(t,e){return ic(Qk,t,e||{})}class tj{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:n,friendlyName:s,signal:r},a){var l;try{const{data:c,error:d}=await this.client.mfa.challenge({factorId:e,webauthn:n});if(!c)return{data:null,error:d};const f=r??Vk.createNewAbortSignal();if(c.webauthn.type==="create"){const{user:m}=c.webauthn.credential_options.publicKey;if(!m.name){const g=s;if(g)m.name=`${m.id}:${g}`;else{const x=(await this.client.getUser()).data.user,_=((l=x?.user_metadata)===null||l===void 0?void 0:l.name)||x?.email||x?.id||"User";m.name=`${m.id}:${_}`}}m.displayName||(m.displayName=m.name)}switch(c.webauthn.type){case"create":{const m=Zk(c.webauthn.credential_options.publicKey,a?.create),{data:g,error:y}=await Yk({publicKey:m,signal:f});return g?{data:{factorId:e,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:g}},error:null}:{data:null,error:y}}case"request":{const m=ej(c.webauthn.credential_options.publicKey,a?.request),{data:g,error:y}=await Jk(Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:m,signal:f}));return g?{data:{factorId:e,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:g}},error:null}:{data:null,error:y}}}}catch(c){return ve(c)?{data:null,error:c}:{data:null,error:new Ur("Unexpected error in challenge",c)}}}async _verify({challengeId:e,factorId:n,webauthn:s}){return this.client.mfa.verify({factorId:n,challengeId:e,webauthn:s})}async _authenticate({factorId:e,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:r}={}},a){if(!n)return{data:null,error:new Xa("rpId is required for WebAuthn authentication")};try{if(!Bg())return{data:null,error:new Ur("Browser does not support WebAuthn",null)};const{data:l,error:c}=await this.challenge({factorId:e,webauthn:{rpId:n,rpOrigins:s},signal:r},{request:a});if(!l)return{data:null,error:c};const{webauthn:d}=l;return this._verify({factorId:e,challengeId:l.challengeId,webauthn:{type:d.type,rpId:n,rpOrigins:s,credential_response:d.credential_response}})}catch(l){return ve(l)?{data:null,error:l}:{data:null,error:new Ur("Unexpected error in authenticate",l)}}}async _register({friendlyName:e,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:r}={}},a){if(!n)return{data:null,error:new Xa("rpId is required for WebAuthn registration")};try{if(!Bg())return{data:null,error:new Ur("Browser does not support WebAuthn",null)};const{data:l,error:c}=await this._enroll({friendlyName:e});if(!l)return await this.client.mfa.listFactors().then(m=>{var g;return(g=m.data)===null||g===void 0?void 0:g.all.find(y=>y.factor_type==="webauthn"&&y.friendly_name===e&&y.status!=="unverified")}).then(m=>m?this.client.mfa.unenroll({factorId:m?.id}):void 0),{data:null,error:c};const{data:d,error:f}=await this._challenge({factorId:l.id,friendlyName:l.friendly_name,webauthn:{rpId:n,rpOrigins:s},signal:r},{create:a});return d?this._verify({factorId:l.id,challengeId:d.challengeId,webauthn:{rpId:n,rpOrigins:s,type:d.webauthn.type,credential_response:d.webauthn.credential_response}}):{data:null,error:f}}catch(l){return ve(l)?{data:null,error:l}:{data:null,error:new Ur("Unexpected error in register",l)}}}}Dk();const nj={url:QS,storageKey:ZS,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:ek,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function $g(t,e,n){return await n()}const ji={};class Qa{get jwks(){var e,n;return(n=(e=ji[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(e){ji[this.storageKey]=Object.assign(Object.assign({},ji[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,n;return(n=(e=ji[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){ji[this.storageKey]=Object.assign(Object.assign({},ji[this.storageKey]),{cachedAt:e})}constructor(e){var n,s,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const a=Object.assign(Object.assign({},nj),e);if(this.storageKey=a.storageKey,this.instanceID=(n=Qa.nextInstanceID[this.storageKey])!==null&&n!==void 0?n:0,Qa.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.instanceID>0&&Nt()){const l=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(l),this.logDebugMessages&&console.trace(l)}if(this.persistSession=a.persistSession,this.autoRefreshToken=a.autoRefreshToken,this.admin=new Rk({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=Jv(a.fetch),this.lock=a.lock||$g,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,this.throwOnError=a.throwOnError,this.lockAcquireTimeout=a.lockAcquireTimeout,a.lock?this.lock=a.lock:this.persistSession&&Nt()&&(!((s=globalThis?.navigator)===null||s===void 0)&&s.locks)?this.lock=Lk:this.lock=$g,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new tj(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:Yv()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Fg(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=Fg(this.memoryStorage)),Nt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l);try{await this._notifyAllSubscribers(l.data.event,l.data.session,!1)}catch(c){this._debug("#broadcastChannel","error",c)}})}this.initialize().catch(l=>{this._debug("#initialize()","error",l)})}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${Hv}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let n={},s="none";if(Nt()&&(n=pk(window.location.href),this._isImplicitGrantCallback(n)?s="implicit":await this._isPKCECallback(n)&&(s="pkce")),Nt()&&this.detectSessionInUrl&&s!=="none"){const{data:r,error:a}=await this._getSessionFromURL(n,s);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),ik(a)){const d=(e=a.details)===null||e===void 0?void 0:e.code;if(d==="identity_already_exists"||d==="identity_not_found"||d==="single_identity_not_deletable")return{error:a}}return{error:a}}const{session:l,redirectType:c}=r;return this._debug("#_initialize()","detected session in URL",l,"redirect type",c),await this._saveSession(l),setTimeout(async()=>{c==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",l):await this._notifyAllSubscribers("SIGNED_IN",l)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return ve(n)?this._returnResult({error:n}):this._returnResult({error:new Ur("Unexpected error during initialization",n)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,s,r;try{const a=await Se(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(n=e?.options)===null||n===void 0?void 0:n.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(r=e?.options)===null||r===void 0?void 0:r.captchaToken}},xform:Bn}),{data:l,error:c}=a;if(c||!l)return this._returnResult({data:{user:null,session:null},error:c});const d=l.session,f=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",d)),this._returnResult({data:{user:f,session:d},error:null})}catch(a){if(ve(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signUp(e){var n,s,r;try{let a;if("email"in e){const{email:m,password:g,options:y}=e;let x=null,_=null;this.flowType==="pkce"&&([x,_]=await _i(this.storage,this.storageKey)),a=await Se(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:y?.emailRedirectTo,body:{email:m,password:g,data:(n=y?.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:y?.captchaToken},code_challenge:x,code_challenge_method:_},xform:Bn})}else if("phone"in e){const{phone:m,password:g,options:y}=e;a=await Se(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:m,password:g,data:(s=y?.data)!==null&&s!==void 0?s:{},channel:(r=y?.channel)!==null&&r!==void 0?r:"sms",gotrue_meta_security:{captcha_token:y?.captchaToken}},xform:Bn})}else throw new Nl("You must provide either an email or phone number and a password");const{data:l,error:c}=a;if(c||!l)return await Tt(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:c});const d=l.session,f=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",d)),this._returnResult({data:{user:f,session:d},error:null})}catch(a){if(await Tt(this.storage,`${this.storageKey}-code-verifier`),ve(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithPassword(e){try{let n;if("email"in e){const{email:a,password:l,options:c}=e;n=await Se(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:l,gotrue_meta_security:{captcha_token:c?.captchaToken}},xform:Lg})}else if("phone"in e){const{phone:a,password:l,options:c}=e;n=await Se(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:l,gotrue_meta_security:{captcha_token:c?.captchaToken}},xform:Lg})}else throw new Nl("You must provide either an email or phone number and a password");const{data:s,error:r}=n;if(r)return this._returnResult({data:{user:null,session:null},error:r});if(!s||!s.session||!s.user){const a=new wi;return this._returnResult({data:{user:null,session:null},error:a})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:r})}catch(n){if(ve(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithOAuth(e){var n,s,r,a;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(r=e.options)===null||r===void 0?void 0:r.queryParams,skipBrowserRedirect:(a=e.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:n}=e;switch(n){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}}async signInWithEthereum(e){var n,s,r,a,l,c,d,f,m,g,y;let x,_;if("message"in e)x=e.message,_=e.signature;else{const{chain:S,wallet:b,statement:k,options:I}=e;let C;if(Nt())if(typeof b=="object")C=b;else{const R=window;if("ethereum"in R&&typeof R.ethereum=="object"&&"request"in R.ethereum&&typeof R.ethereum.request=="function")C=R.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof b!="object"||!I?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");C=b}const N=new URL((n=I?.url)!==null&&n!==void 0?n:window.location.href),O=await C.request({method:"eth_requestAccounts"}).then(R=>R).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!O||O.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const U=Qv(O[0]);let E=(s=I?.signInWithEthereum)===null||s===void 0?void 0:s.chainId;if(!E){const R=await C.request({method:"eth_chainId"});E=Fk(R)}const L={domain:N.host,address:U,statement:k,uri:N.href,version:"1",chainId:E,nonce:(r=I?.signInWithEthereum)===null||r===void 0?void 0:r.nonce,issuedAt:(l=(a=I?.signInWithEthereum)===null||a===void 0?void 0:a.issuedAt)!==null&&l!==void 0?l:new Date,expirationTime:(c=I?.signInWithEthereum)===null||c===void 0?void 0:c.expirationTime,notBefore:(d=I?.signInWithEthereum)===null||d===void 0?void 0:d.notBefore,requestId:(f=I?.signInWithEthereum)===null||f===void 0?void 0:f.requestId,resources:(m=I?.signInWithEthereum)===null||m===void 0?void 0:m.resources};x=$k(L),_=await C.request({method:"personal_sign",params:[Bk(x),U]})}try{const{data:S,error:b}=await Se(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:x,signature:_},!((g=e.options)===null||g===void 0)&&g.captchaToken?{gotrue_meta_security:{captcha_token:(y=e.options)===null||y===void 0?void 0:y.captchaToken}}:null),xform:Bn});if(b)throw b;if(!S||!S.session||!S.user){const k=new wi;return this._returnResult({data:{user:null,session:null},error:k})}return S.session&&(await this._saveSession(S.session),await this._notifyAllSubscribers("SIGNED_IN",S.session)),this._returnResult({data:Object.assign({},S),error:b})}catch(S){if(ve(S))return this._returnResult({data:{user:null,session:null},error:S});throw S}}async signInWithSolana(e){var n,s,r,a,l,c,d,f,m,g,y,x;let _,S;if("message"in e)_=e.message,S=e.signature;else{const{chain:b,wallet:k,statement:I,options:C}=e;let N;if(Nt())if(typeof k=="object")N=k;else{const U=window;if("solana"in U&&typeof U.solana=="object"&&("signIn"in U.solana&&typeof U.solana.signIn=="function"||"signMessage"in U.solana&&typeof U.solana.signMessage=="function"))N=U.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof k!="object"||!C?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");N=k}const O=new URL((n=C?.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in N&&N.signIn){const U=await N.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},C?.signInWithSolana),{version:"1",domain:O.host,uri:O.href}),I?{statement:I}:null));let E;if(Array.isArray(U)&&U[0]&&typeof U[0]=="object")E=U[0];else if(U&&typeof U=="object"&&"signedMessage"in U&&"signature"in U)E=U;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in E&&"signature"in E&&(typeof E.signedMessage=="string"||E.signedMessage instanceof Uint8Array)&&E.signature instanceof Uint8Array)_=typeof E.signedMessage=="string"?E.signedMessage:new TextDecoder().decode(E.signedMessage),S=E.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in N)||typeof N.signMessage!="function"||!("publicKey"in N)||typeof N!="object"||!N.publicKey||!("toBase58"in N.publicKey)||typeof N.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");_=[`${O.host} wants you to sign in with your Solana account:`,N.publicKey.toBase58(),...I?["",I,""]:[""],"Version: 1",`URI: ${O.href}`,`Issued At: ${(r=(s=C?.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&r!==void 0?r:new Date().toISOString()}`,...!((a=C?.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${C.signInWithSolana.notBefore}`]:[],...!((l=C?.signInWithSolana)===null||l===void 0)&&l.expirationTime?[`Expiration Time: ${C.signInWithSolana.expirationTime}`]:[],...!((c=C?.signInWithSolana)===null||c===void 0)&&c.chainId?[`Chain ID: ${C.signInWithSolana.chainId}`]:[],...!((d=C?.signInWithSolana)===null||d===void 0)&&d.nonce?[`Nonce: ${C.signInWithSolana.nonce}`]:[],...!((f=C?.signInWithSolana)===null||f===void 0)&&f.requestId?[`Request ID: ${C.signInWithSolana.requestId}`]:[],...!((g=(m=C?.signInWithSolana)===null||m===void 0?void 0:m.resources)===null||g===void 0)&&g.length?["Resources",...C.signInWithSolana.resources.map(E=>`- ${E}`)]:[]].join(`
`);const U=await N.signMessage(new TextEncoder().encode(_),"utf8");if(!U||!(U instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");S=U}}try{const{data:b,error:k}=await Se(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:_,signature:Wr(S)},!((y=e.options)===null||y===void 0)&&y.captchaToken?{gotrue_meta_security:{captcha_token:(x=e.options)===null||x===void 0?void 0:x.captchaToken}}:null),xform:Bn});if(k)throw k;if(!b||!b.session||!b.user){const I=new wi;return this._returnResult({data:{user:null,session:null},error:I})}return b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("SIGNED_IN",b.session)),this._returnResult({data:Object.assign({},b),error:k})}catch(b){if(ve(b))return this._returnResult({data:{user:null,session:null},error:b});throw b}}async _exchangeCodeForSession(e){const n=await Or(this.storage,`${this.storageKey}-code-verifier`),[s,r]=(n??"").split("/");try{if(!s&&this.flowType==="pkce")throw new ak;const{data:a,error:l}=await Se(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:Bn});if(await Tt(this.storage,`${this.storageKey}-code-verifier`),l)throw l;if(!a||!a.session||!a.user){const c=new wi;return this._returnResult({data:{user:null,session:null,redirectType:null},error:c})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign(Object.assign({},a),{redirectType:r??null}),error:l})}catch(a){if(await Tt(this.storage,`${this.storageKey}-code-verifier`),ve(a))return this._returnResult({data:{user:null,session:null,redirectType:null},error:a});throw a}}async signInWithIdToken(e){try{const{options:n,provider:s,token:r,access_token:a,nonce:l}=e,c=await Se(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:r,access_token:a,nonce:l,gotrue_meta_security:{captcha_token:n?.captchaToken}},xform:Bn}),{data:d,error:f}=c;if(f)return this._returnResult({data:{user:null,session:null},error:f});if(!d||!d.session||!d.user){const m=new wi;return this._returnResult({data:{user:null,session:null},error:m})}return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),this._returnResult({data:d,error:f})}catch(n){if(ve(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithOtp(e){var n,s,r,a,l;try{if("email"in e){const{email:c,options:d}=e;let f=null,m=null;this.flowType==="pkce"&&([f,m]=await _i(this.storage,this.storageKey));const{error:g}=await Se(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:c,data:(n=d?.data)!==null&&n!==void 0?n:{},create_user:(s=d?.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:d?.captchaToken},code_challenge:f,code_challenge_method:m},redirectTo:d?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:g})}if("phone"in e){const{phone:c,options:d}=e,{data:f,error:m}=await Se(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:c,data:(r=d?.data)!==null&&r!==void 0?r:{},create_user:(a=d?.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:d?.captchaToken},channel:(l=d?.channel)!==null&&l!==void 0?l:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:f?.message_id},error:m})}throw new Nl("You must provide either an email or phone number.")}catch(c){if(await Tt(this.storage,`${this.storageKey}-code-verifier`),ve(c))return this._returnResult({data:{user:null,session:null},error:c});throw c}}async verifyOtp(e){var n,s;try{let r,a;"options"in e&&(r=(n=e.options)===null||n===void 0?void 0:n.redirectTo,a=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:l,error:c}=await Se(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:r,xform:Bn});if(c)throw c;if(!l)throw new Error("An error occurred on token verification.");const d=l.session,f=l.user;return d?.access_token&&(await this._saveSession(d),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",d)),this._returnResult({data:{user:f,session:d},error:null})}catch(r){if(ve(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithSSO(e){var n,s,r,a,l;try{let c=null,d=null;this.flowType==="pkce"&&([c,d]=await _i(this.storage,this.storageKey));const f=await Se(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&s!==void 0?s:void 0}),!((r=e?.options)===null||r===void 0)&&r.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:c,code_challenge_method:d}),headers:this.headers,xform:Nk});return!((a=f.data)===null||a===void 0)&&a.url&&Nt()&&!(!((l=e.options)===null||l===void 0)&&l.skipBrowserRedirect)&&window.location.assign(f.data.url),this._returnResult(f)}catch(c){if(await Tt(this.storage,`${this.storageKey}-code-verifier`),ve(c))return this._returnResult({data:null,error:c});throw c}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:s}=e;if(s)throw s;if(!n)throw new dn;const{error:r}=await Se(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return this._returnResult({data:{user:null,session:null},error:r})})}catch(e){if(ve(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:s,type:r,options:a}=e,{error:l}=await Se(this.fetch,"POST",n,{headers:this.headers,body:{email:s,type:r,gotrue_meta_security:{captcha_token:a?.captchaToken}},redirectTo:a?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:l})}else if("phone"in e){const{phone:s,type:r,options:a}=e,{data:l,error:c}=await Se(this.fetch,"POST",n,{headers:this.headers,body:{phone:s,type:r,gotrue_meta_security:{captcha_token:a?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:l?.message_id},error:c})}throw new Nl("You must provide either an email or phone number and a type")}catch(n){if(ve(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await s,await n()))();return this.pendingInLock.push((async()=>{try{await r}catch{}})()),r}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=n();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const r=[...this.pendingInLock];await Promise.all(r),this.pendingInLock.splice(0,r.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await Or(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<Id:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.userStorage){const l=await Or(this.userStorage,this.storageKey+"-user");l?.user?e.user=l.user:e.user=Nd()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const l={value:this.suppressGetSessionWarning};e.user=Pk(e.user,l),l.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:r,error:a}=await this._callRefreshToken(e.refresh_token);return a?this._returnResult({data:{session:null},error:a}):this._returnResult({data:{session:r},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const n=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return n.data.user&&(this.suppressGetSessionWarning=!0),n}async _getUser(e){try{return e?await Se(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:sr}):await this._useSession(async n=>{var s,r,a;const{data:l,error:c}=n;if(c)throw c;return!(!((s=l.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new dn}:await Se(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(r=l.session)===null||r===void 0?void 0:r.access_token)!==null&&a!==void 0?a:void 0,xform:sr})})}catch(n){if(ve(n))return Ed(n)&&(await this._removeSession(),await Tt(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:n});throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async s=>{const{data:r,error:a}=s;if(a)throw a;if(!r.session)throw new dn;const l=r.session;let c=null,d=null;this.flowType==="pkce"&&e.email!=null&&([c,d]=await _i(this.storage,this.storageKey));const{data:f,error:m}=await Se(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:c,code_challenge_method:d}),jwt:l.access_token,xform:sr});if(m)throw m;return l.user=f.user,await this._saveSession(l),await this._notifyAllSubscribers("USER_UPDATED",l),this._returnResult({data:{user:l.user},error:null})})}catch(s){if(await Tt(this.storage,`${this.storageKey}-code-verifier`),ve(s))return this._returnResult({data:{user:null},error:s});throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new dn;const n=Date.now()/1e3;let s=n,r=!0,a=null;const{payload:l}=Ol(e.access_token);if(l.exp&&(s=l.exp,r=s<=n),r){const{data:c,error:d}=await this._callRefreshToken(e.refresh_token);if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!c)return{data:{user:null,session:null},error:null};a=c}else{const{data:c,error:d}=await this._getUser(e.access_token);if(d)return this._returnResult({data:{user:null,session:null},error:d});a={access_token:e.access_token,refresh_token:e.refresh_token,user:c.user,token_type:"bearer",expires_in:s-n,expires_at:s},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return this._returnResult({data:{user:a.user,session:a},error:null})}catch(n){if(ve(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var s;if(!e){const{data:l,error:c}=n;if(c)throw c;e=(s=l.session)!==null&&s!==void 0?s:void 0}if(!e?.refresh_token)throw new dn;const{data:r,error:a}=await this._callRefreshToken(e.refresh_token);return a?this._returnResult({data:{user:null,session:null},error:a}):r?this._returnResult({data:{user:r.user,session:r},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(n){if(ve(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async _getSessionFromURL(e,n){try{if(!Nt())throw new Al("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Al(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new Eg("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Al("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Eg("No code detected.");const{data:I,error:C}=await this._exchangeCodeForSession(e.code);if(C)throw C;const N=new URL(window.location.href);return N.searchParams.delete("code"),window.history.replaceState(window.history.state,"",N.toString()),{data:{session:I.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:r,access_token:a,refresh_token:l,expires_in:c,expires_at:d,token_type:f}=e;if(!a||!c||!l||!f)throw new Al("No session defined in URL");const m=Math.round(Date.now()/1e3),g=parseInt(c);let y=m+g;d&&(y=parseInt(d));const x=y-m;x*1e3<=Ei&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${x}s, should have been closer to ${g}s`);const _=y-g;m-_>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",_,y,m):m-_<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",_,y,m);const{data:S,error:b}=await this._getUser(a);if(b)throw b;const k={provider_token:s,provider_refresh_token:r,access_token:a,expires_in:g,expires_at:y,refresh_token:l,token_type:f,user:S.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:k,redirectType:e.type},error:null})}catch(s){if(ve(s))return this._returnResult({data:{session:null,redirectType:null},error:s});throw s}}_isImplicitGrantCallback(e){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){const n=await Or(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var s;const{data:r,error:a}=n;if(a&&!Ed(a))return this._returnResult({error:a});const l=(s=r.session)===null||s===void 0?void 0:s.access_token;if(l){const{error:c}=await this.admin.signOut(l,e);if(c&&!(rk(c)&&(c.status===404||c.status===401||c.status===403)||Ed(c)))return this._returnResult({error:c})}return e!=="others"&&(await this._removeSession(),await Tt(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const n=fk(),s={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,s),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async n=>{var s,r;try{const{data:{session:a},error:l}=n;if(l)throw l;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",e,"session",a)}catch(a){await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",a),console.error(a)}})}async resetPasswordForEmail(e,n={}){let s=null,r=null;this.flowType==="pkce"&&([s,r]=await _i(this.storage,this.storageKey,!0));try{return await Se(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:r,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(a){if(await Tt(this.storage,`${this.storageKey}-code-verifier`),ve(a))return this._returnResult({data:null,error:a});throw a}}async getUserIdentities(){var e;try{const{data:n,error:s}=await this.getUser();if(s)throw s;return this._returnResult({data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(n){if(ve(n))return this._returnResult({data:null,error:n});throw n}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var n;try{const{data:s,error:r}=await this._useSession(async a=>{var l,c,d,f,m;const{data:g,error:y}=a;if(y)throw y;const x=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(l=e.options)===null||l===void 0?void 0:l.redirectTo,scopes:(c=e.options)===null||c===void 0?void 0:c.scopes,queryParams:(d=e.options)===null||d===void 0?void 0:d.queryParams,skipBrowserRedirect:!0});return await Se(this.fetch,"GET",x,{headers:this.headers,jwt:(m=(f=g.session)===null||f===void 0?void 0:f.access_token)!==null&&m!==void 0?m:void 0})});if(r)throw r;return Nt()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(s?.url),this._returnResult({data:{provider:e.provider,url:s?.url},error:null})}catch(s){if(ve(s))return this._returnResult({data:{provider:e.provider,url:null},error:s});throw s}}async linkIdentityIdToken(e){return await this._useSession(async n=>{var s;try{const{error:r,data:{session:a}}=n;if(r)throw r;const{options:l,provider:c,token:d,access_token:f,nonce:m}=e,g=await Se(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(s=a?.access_token)!==null&&s!==void 0?s:void 0,body:{provider:c,id_token:d,access_token:f,nonce:m,link_identity:!0,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:Bn}),{data:y,error:x}=g;return x?this._returnResult({data:{user:null,session:null},error:x}):!y||!y.session||!y.user?this._returnResult({data:{user:null,session:null},error:new wi}):(y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("USER_UPDATED",y.session)),this._returnResult({data:y,error:x}))}catch(r){if(await Tt(this.storage,`${this.storageKey}-code-verifier`),ve(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}})}async unlinkIdentity(e){try{return await this._useSession(async n=>{var s,r;const{data:a,error:l}=n;if(l)throw l;return await Se(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(r=(s=a.session)===null||s===void 0?void 0:s.access_token)!==null&&r!==void 0?r:void 0})})}catch(n){if(ve(n))return this._returnResult({data:null,error:n});throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const s=Date.now();return await yk(async r=>(r>0&&await gk(200*Math.pow(2,r-1)),this._debug(n,"refreshing attempt",r),await Se(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Bn})),(r,a)=>{const l=200*Math.pow(2,r);return a&&Td(a)&&Date.now()+l-s<Ei})}catch(s){if(this._debug(n,"error",s),ve(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",s),Nt()&&!n.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,n;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const r=await Or(this.storage,this.storageKey);if(r&&this.userStorage){let l=await Or(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!l&&(l={user:r.user},await Ti(this.userStorage,this.storageKey+"-user",l)),r.user=(e=l?.user)!==null&&e!==void 0?e:Nd()}else if(r&&!r.user&&!r.user){const l=await Or(this.storage,this.storageKey+"-user");l&&l?.user?(r.user=l.user,await Tt(this.storage,this.storageKey+"-user"),await Ti(this.storage,this.storageKey,r)):r.user=Nd()}if(this._debug(s,"session from storage",r),!this._isValidSession(r)){this._debug(s,"session is not valid"),r!==null&&await this._removeSession();return}const a=((n=r.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<Id;if(this._debug(s,`session has${a?"":" not"} expired with margin of ${Id}s`),a){if(this.autoRefreshToken&&r.refresh_token){const{error:l}=await this._callRefreshToken(r.refresh_token);l&&(console.error(l),Td(l)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",l),await this._removeSession()))}}else if(r.user&&r.user.__isUserNotAvailableProxy===!0)try{const{data:l,error:c}=await this._getUser(r.access_token);!c&&l?.user?(r.user=l.user,await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(l){console.error("Error getting user data:",l),this._debug(s,"error getting user data, skipping SIGNED_IN notification",l)}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(s,"error",r),console.error(r);return}finally{this._debug(s,"end")}}async _callRefreshToken(e){var n,s;if(!e)throw new dn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new Sc;const{data:a,error:l}=await this._refreshAccessToken(e);if(l)throw l;if(!a.session)throw new dn;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const c={data:a.session,error:null};return this.refreshingDeferred.resolve(c),c}catch(a){if(this._debug(r,"error",a),ve(a)){const l={data:null,error:a};return Td(a)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(l),l}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(a),a}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,n,s=!0){const r=`#_notifyAllSubscribers(${e})`;this._debug(r,"begin",n,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:n});const a=[],l=Array.from(this.stateChangeEmitters.values()).map(async c=>{try{await c.callback(e,n)}catch(d){a.push(d)}});if(await Promise.all(l),a.length>0){for(let c=0;c<a.length;c+=1)console.error(a[c]);throw a[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await Tt(this.storage,`${this.storageKey}-code-verifier`);const n=Object.assign({},e),s=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&n.user&&await Ti(this.userStorage,this.storageKey+"-user",{user:n.user});const r=Object.assign({},n);delete r.user;const a=Rg(r);await Ti(this.storage,this.storageKey,a)}else{const r=Rg(n);await Ti(this.storage,this.storageKey,r)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await Tt(this.storage,this.storageKey),await Tt(this.storage,this.storageKey+"-code-verifier"),await Tt(this.storage,this.storageKey+"-user"),this.userStorage&&await Tt(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Nt()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Ei);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e);const n=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=n,n&&typeof n=="object"&&typeof n.unref=="function"?n.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(n)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e);const n=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,n&&clearTimeout(n)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:s}}=n;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const r=Math.floor((s.expires_at*1e3-e)/Ei);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts ${Ei}ms, refresh threshold is ${bh} ticks`),r<=bh&&await this._callRefreshToken(s.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Xv)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Nt()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>{try{await this._onVisibilityChanged(!1)}catch(e){this._debug("#visibilityChangedCallback","error",e)}},window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,s){const r=[`provider=${encodeURIComponent(n)}`];if(s?.redirectTo&&r.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s?.scopes&&r.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[a,l]=await _i(this.storage,this.storageKey),c=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(l)}`});r.push(c.toString())}if(s?.queryParams){const a=new URLSearchParams(s.queryParams);r.push(a.toString())}return s?.skipBrowserRedirect&&r.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${r.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var s;const{data:r,error:a}=n;return a?this._returnResult({data:null,error:a}):await Se(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=r?.session)===null||s===void 0?void 0:s.access_token})})}catch(n){if(ve(n))return this._returnResult({data:null,error:n});throw n}}async _enroll(e){try{return await this._useSession(async n=>{var s,r;const{data:a,error:l}=n;if(l)return this._returnResult({data:null,error:l});const c=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:d,error:f}=await Se(this.fetch,"POST",`${this.url}/factors`,{body:c,headers:this.headers,jwt:(s=a?.session)===null||s===void 0?void 0:s.access_token});return f?this._returnResult({data:null,error:f}):(e.factorType==="totp"&&d.type==="totp"&&(!((r=d?.totp)===null||r===void 0)&&r.qr_code)&&(d.totp.qr_code=`data:image/svg+xml;utf-8,${d.totp.qr_code}`),this._returnResult({data:d,error:null}))})}catch(n){if(ve(n))return this._returnResult({data:null,error:n});throw n}}async _verify(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async n=>{var s;const{data:r,error:a}=n;if(a)return this._returnResult({data:null,error:a});const l=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?Kk(e.webauthn.credential_response):Gk(e.webauthn.credential_response)})}:{code:e.code}),{data:c,error:d}=await Se(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:l,headers:this.headers,jwt:(s=r?.session)===null||s===void 0?void 0:s.access_token});return d?this._returnResult({data:null,error:d}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+c.expires_in},c)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",c),this._returnResult({data:c,error:d}))})}catch(n){if(ve(n))return this._returnResult({data:null,error:n});throw n}})}async _challenge(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async n=>{var s;const{data:r,error:a}=n;if(a)return this._returnResult({data:null,error:a});const l=await Se(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(s=r?.session)===null||s===void 0?void 0:s.access_token});if(l.error)return l;const{data:c}=l;if(c.type!=="webauthn")return{data:c,error:null};switch(c.webauthn.type){case"create":return{data:Object.assign(Object.assign({},c),{webauthn:Object.assign(Object.assign({},c.webauthn),{credential_options:Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:qk(c.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},c),{webauthn:Object.assign(Object.assign({},c.webauthn),{credential_options:Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:Hk(c.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(n){if(ve(n))return this._returnResult({data:null,error:n});throw n}})}async _challengeAndVerify(e){const{data:n,error:s}=await this._challenge({factorId:e.factorId});return s?this._returnResult({data:null,error:s}):await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){var e;const{data:{user:n},error:s}=await this.getUser();if(s)return{data:null,error:s};const r={all:[],phone:[],totp:[],webauthn:[]};for(const a of(e=n?.factors)!==null&&e!==void 0?e:[])r.all.push(a),a.status==="verified"&&r[a.factor_type].push(a);return{data:r,error:null}}async _getAuthenticatorAssuranceLevel(e){var n,s,r,a;if(e)try{const{payload:x}=Ol(e);let _=null;x.aal&&(_=x.aal);let S=_;const{data:{user:b},error:k}=await this.getUser(e);if(k)return this._returnResult({data:null,error:k});((s=(n=b?.factors)===null||n===void 0?void 0:n.filter(N=>N.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(S="aal2");const C=x.amr||[];return{data:{currentLevel:_,nextLevel:S,currentAuthenticationMethods:C},error:null}}catch(x){if(ve(x))return this._returnResult({data:null,error:x});throw x}const{data:{session:l},error:c}=await this.getSession();if(c)return this._returnResult({data:null,error:c});if(!l)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:d}=Ol(l.access_token);let f=null;d.aal&&(f=d.aal);let m=f;((a=(r=l.user.factors)===null||r===void 0?void 0:r.filter(x=>x.status==="verified"))!==null&&a!==void 0?a:[]).length>0&&(m="aal2");const y=d.amr||[];return{data:{currentLevel:f,nextLevel:m,currentAuthenticationMethods:y},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async n=>{const{data:{session:s},error:r}=n;return r?this._returnResult({data:null,error:r}):s?await Se(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:s.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new dn})})}catch(n){if(ve(n))return this._returnResult({data:null,error:n});throw n}}async _approveAuthorization(e,n){try{return await this._useSession(async s=>{const{data:{session:r},error:a}=s;if(a)return this._returnResult({data:null,error:a});if(!r)return this._returnResult({data:null,error:new dn});const l=await Se(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:r.access_token,body:{action:"approve"},xform:c=>({data:c,error:null})});return l.data&&l.data.redirect_url&&Nt()&&!n?.skipBrowserRedirect&&window.location.assign(l.data.redirect_url),l})}catch(s){if(ve(s))return this._returnResult({data:null,error:s});throw s}}async _denyAuthorization(e,n){try{return await this._useSession(async s=>{const{data:{session:r},error:a}=s;if(a)return this._returnResult({data:null,error:a});if(!r)return this._returnResult({data:null,error:new dn});const l=await Se(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:r.access_token,body:{action:"deny"},xform:c=>({data:c,error:null})});return l.data&&l.data.redirect_url&&Nt()&&!n?.skipBrowserRedirect&&window.location.assign(l.data.redirect_url),l})}catch(s){if(ve(s))return this._returnResult({data:null,error:s});throw s}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:n},error:s}=e;return s?this._returnResult({data:null,error:s}):n?await Se(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,xform:r=>({data:r,error:null})}):this._returnResult({data:null,error:new dn})})}catch(e){if(ve(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async n=>{const{data:{session:s},error:r}=n;return r?this._returnResult({data:null,error:r}):s?(await Se(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:s.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new dn})})}catch(n){if(ve(n))return this._returnResult({data:null,error:n});throw n}}async fetchJwk(e,n={keys:[]}){let s=n.keys.find(c=>c.kid===e);if(s)return s;const r=Date.now();if(s=this.jwks.keys.find(c=>c.kid===e),s&&this.jwks_cached_at+nk>r)return s;const{data:a,error:l}=await Se(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(l)throw l;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=r,s=a.keys.find(c=>c.kid===e),!s)?null:s}async getClaims(e,n={}){try{let s=e;if(!s){const{data:x,error:_}=await this.getSession();if(_||!x.session)return this._returnResult({data:null,error:_});s=x.session.access_token}const{header:r,payload:a,signature:l,raw:{header:c,payload:d}}=Ol(s);n?.allowExpired||kk(a.exp);const f=!r.alg||r.alg.startsWith("HS")||!r.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(r.kid,n?.keys?{keys:n.keys}:n?.jwks);if(!f){const{error:x}=await this.getUser(s);if(x)throw x;return{data:{claims:a,header:r,signature:l},error:null}}const m=jk(r.alg),g=await crypto.subtle.importKey("jwk",f,m,!0,["verify"]);if(!await crypto.subtle.verify(m,g,l,dk(`${c}.${d}`)))throw new Sh("Invalid JWT signature");return{data:{claims:a,header:r,signature:l},error:null}}catch(s){if(ve(s))return this._returnResult({data:null,error:s});throw s}}}Qa.nextInstanceID={};const sj=Qa,rj="2.95.3";let Aa="";typeof Deno<"u"?Aa="deno":typeof document<"u"?Aa="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Aa="react-native":Aa="node";const ij={"X-Client-Info":`supabase-js-${Aa}/${rj}`},aj={headers:ij},oj={schema:"public"},lj={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},cj={};function Za(t){"@babel/helpers - typeof";return Za=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Za(t)}function uj(t,e){if(Za(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(Za(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dj(t){var e=uj(t,"string");return Za(e)=="symbol"?e:e+""}function hj(t,e,n){return(e=dj(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zg(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function ct(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?zg(Object(n),!0).forEach(function(s){hj(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):zg(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}const fj=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),pj=()=>Headers,mj=(t,e,n)=>{const s=fj(n),r=pj();return async(a,l)=>{var c;const d=(c=await e())!==null&&c!==void 0?c:t;let f=new r(l?.headers);return f.has("apikey")||f.set("apikey",t),f.has("Authorization")||f.set("Authorization",`Bearer ${d}`),s(a,ct(ct({},l),{},{headers:f}))}};function gj(t){return t.endsWith("/")?t:t+"/"}function yj(t,e){var n,s;const{db:r,auth:a,realtime:l,global:c}=t,{db:d,auth:f,realtime:m,global:g}=e,y={db:ct(ct({},d),r),auth:ct(ct({},f),a),realtime:ct(ct({},m),l),storage:{},global:ct(ct(ct({},g),c),{},{headers:ct(ct({},(n=g?.headers)!==null&&n!==void 0?n:{}),(s=c?.headers)!==null&&s!==void 0?s:{})}),accessToken:async()=>""};return t.accessToken?y.accessToken=t.accessToken:delete y.accessToken,y}function vj(t){const e=t?.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(gj(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var xj=class extends sj{constructor(t){super(t)}},bj=class{constructor(t,e,n){var s,r;this.supabaseUrl=t,this.supabaseKey=e;const a=vj(t);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",a),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",a),this.storageUrl=new URL("storage/v1",a),this.functionsUrl=new URL("functions/v1",a);const l=`sb-${a.hostname.split(".")[0]}-auth-token`,c={db:oj,realtime:cj,auth:ct(ct({},lj),{},{storageKey:l}),global:aj},d=yj(n??{},c);if(this.storageKey=(s=d.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(r=d.global.headers)!==null&&r!==void 0?r:{},d.accessToken)this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(m,g)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(g)} is not possible`)}});else{var f;this.auth=this._initSupabaseAuthClient((f=d.auth)!==null&&f!==void 0?f:{},this.headers,d.global.fetch)}this.fetch=mj(e,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(ct({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(m=>this.realtime.setAuth(m)).catch(m=>console.warn("Failed to set initial Realtime auth token:",m)),this.rest=new rS(new URL("rest/v1",a).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch,timeout:d.db.timeout,urlLengthLimit:d.db.urlLengthLimit}),this.storage=new XS(this.storageUrl.href,this.headers,this.fetch,n?.storage),d.accessToken||this._listenForAuthEvents()}get functions(){return new J_(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,e={},n={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,e,n)}channel(t,e={config:{}}){return this.realtime.channel(t,e)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t=this,e,n;if(t.accessToken)return await t.accessToken();const{data:s}=await t.auth.getSession();return(e=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&e!==void 0?e:t.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:e,detectSessionInUrl:n,storage:s,userStorage:r,storageKey:a,flowType:l,lock:c,debug:d,throwOnError:f},m,g){const y={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new xj({url:this.authUrl.href,headers:ct(ct({},y),m),storageKey:a,autoRefreshToken:t,persistSession:e,detectSessionInUrl:n,storage:s,userStorage:r,flowType:l,lock:c,debug:d,throwOnError:f,fetch:g,hasCustomAuthorizationHeader:Object.keys(this.headers).some(x=>x.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new wS(this.realtimeUrl.href,ct(ct({},t),{},{params:ct(ct({},{apikey:this.supabaseKey}),t?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,e)=>{this._handleTokenChanged(t,"CLIENT",e?.access_token)})}_handleTokenChanged(t,e,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?(this.changedAccessToken=n,this.realtime.setAuth(n)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const wj=(t,e,n)=>new bj(t,e,n);function _j(){if(typeof window<"u")return!1;const t=globalThis.process;if(!t)return!1;const e=t.version;if(e==null)return!1;const n=e.match(/^v(\d+)\./);return n?parseInt(n[1],10)<=18:!1}_j()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Sj="https://vpbokueczoylouivgnin.supabase.co",kj="sb_publishable_qnne91NTAXswisfSQlObFg_NnwBiV9d",G=wj(Sj,kj);async function jj({email:t,password:e}){const{data:n,error:s}=await G.auth.signInWithPassword({email:t,password:e});if(s)throw s;return n}async function Cj({email:t,password:e,fullName:n,companyName:s,countryCode:r,invitationId:a}){const{data:l,error:c}=await G.auth.signUp({email:t,password:e,options:{data:{full_name:n,company_name:s,country_code:r,invitation_id:a||null}}});if(c)throw c;return l}async function Pj(){const{error:t}=await G.auth.signOut();if(t)throw t}async function Ij(){const{data:t,error:e}=await G.auth.getSession();if(e)throw e;return t.session}async function Ej(t){const{data:e}=G.auth.onAuthStateChange((n,s)=>{t(s)});return e.subscription}async function Tj(t){const{data:e,error:n}=await G.from("usersToAccounts").select('accountId, accounts(id, name, "createdById", "billingStatus", "trialEndsAt", "subscriptionCurrentPeriodEnd")').eq("userId",t).order("accountId",{ascending:!0});if(n)throw n;return(e??[]).map(s=>({accountId:s.accountId,accountName:s.accounts?.name??"",isOriginalAccount:s.accounts?.createdById===t,billingStatus:s.accounts?.billingStatus??"trialing",trialEndsAt:s.accounts?.trialEndsAt??null,subscriptionCurrentPeriodEnd:s.accounts?.subscriptionCurrentPeriodEnd??null}))}async function Nj(t){const{data:e,error:n}=await G.from("accounts").select('id, name, email, phone, address, "reportRetentionDays", "createdById"').eq("id",t).single();if(n)throw n;return e}async function Aj(t,e){const{data:n,error:s}=await G.from("accounts").update(e).eq("id",t).select('id, name, email, phone, address, "reportRetentionDays", "createdById"').single();if(s)throw s;return n}const ex=j.createContext(null);function Oj({children:t}){const[e,n]=j.useState(null),[s,r]=j.useState(null),[a,l]=j.useState([]),[c,d]=j.useState(!0);j.useEffect(()=>{let x=!0;async function _(){const b=await Ij();x&&(n(b),b?.user?.id&&await f(b.user.id,x),d(!1))}_().catch(()=>{x&&d(!1)});let S;return Ej(async b=>{n(b),b?.user?.id?await f(b.user.id,!0):(r(null),l([]),localStorage.removeItem("activeAccountId")),d(!1)}).then(b=>{S=b}),()=>{x=!1,S?.unsubscribe()}},[]);async function f(x,_=!0){const S=await Tj(x);if(!_)return;l(S);const b=localStorage.getItem("activeAccountId"),k=b?Number(b):null,I=S.find(C=>C.accountId===k)??S[0]??null;r(I),I?.accountId?localStorage.setItem("activeAccountId",String(I.accountId)):localStorage.removeItem("activeAccountId")}const m=x=>{const _=Number(x),S=a.find(b=>b.accountId===_)??null;S&&(r(S),localStorage.setItem("activeAccountId",String(S.accountId)))},g=async()=>{e?.user?.id&&await f(e.user.id,!0)},y=j.useMemo(()=>({session:e,user:e?.user??null,account:s,accounts:a,isLoading:c,switchAccount:m,refreshAccounts:g,login:jj,register:Cj,logout:Pj}),[e,s,a,c]);return u.jsx(ex.Provider,{value:y,children:t})}function Oe(){const t=j.useContext(ex);if(!t)throw new Error("useAuth must be used inside AuthProvider");return t}const Rj={es:{common:{appName:"Financiera",account:"Cuenta",loading:"Cargando...",save:"Guardar",cancel:"Cancelar",logout:"Cerrar sesin",language:"Idioma",searchPlaceholder:"Buscar",workspace:"Workspace",create:"Crear",update:"Actualizar",delete:"Eliminar",edit:"Editar",backToList:"Volver al listado",actions:"Acciones",name:"Nombre",phone:"Telfono",email:"Correo",address:"Direccin",type:"Tipo",yes:"S",no:"No",empty:"Sin registros",previous:"Anterior",next:"Siguiente",page:"Pgina",of:"de",more:"Ms",expand:"Expandir men",collapse:"Colapsar men",clearFilters:"Limpiar filtros",requiredFields:"Completa los campos obligatorios.",searching:"Buscando...",searchTypeToStart:"Escribe al menos 2 caracteres para buscar",searchNoResults:"No hay resultados",genericLoadError:"No fue posible cargar los datos",genericSaveError:"No fue posible guardar los cambios"},topbar:{apps:"Aplicaciones",theme:"Cambiar tema",notifications:"Notificaciones",userMenu:"Men de usuario",noNotifications:"Sin notificaciones",pendingInvitations:"Tienes invitaciones pendientes de aceptar",goToInvitations:"Ir a invitaciones",account:"Cuenta",currentAccount:"Cuenta actual",manageAccount:"Gestionar cuenta",textSize:"Tamao de letra",density:"Espaciado",small:"Pequeo",medium:"Mediano",large:"Grande",compact:"Compacto",comfortable:"Confortable"},onboarding:{welcomeTitle:"Bienvenido al mdulo",welcomeDescription:"Te mostraremos rpidamente dnde est cada men en",start:"Comenzar gua",skip:"Omitir",finish:"Finalizar",sidebarTitle:"Men principal",sidebarText:"Aqu cambias entre grupos principales del sistema.",appMenuTitle:"Men del mdulo",appMenuText:"Aqu navegas las opciones especficas del mdulo.",actionsMenuTitle:"Acciones rpidas",actionsMenuText:"Aqu tienes acciones como crear y refrescar.",tableTitle:"Tabla del mdulo",tableText:"La tabla muestra los ltimos registros incluidos en este mdulo.",workspaceTitle:"rea de trabajo",workspaceText:"Aqu se muestra el listado, formulario o reporte del mdulo.",accountSwitchTitle:"Cambio de cuenta",accountSwitchText:"Desde aqu puedes cambiar entre cuentas con acceso.",userMenuTitle:"Men de usuario",userMenuText:"Aqu encontrars configuracin, preferencias y cierre de sesin."},sidebar:{expand:"Expandir men",collapse:"Colapsar men",core:"General",concepts:"Conceptos",transactions:"Transacciones",security:"Seguridad"},actions:{refresh:"Refrescar",newPerson:"Nuevo cliente/proveedor",newClient:"Nuevo cliente",newProvider:"Nuevo proveedor",newEmployee:"Nuevo empleado",newConcept:"Nuevo concepto",newProduct:"Nuevo producto",newIncomeConcept:"Nuevo concepto de ingreso",newExpenseConcept:"Nuevo concepto de gasto",newConceptGroup:"Nuevo grupo",newSale:"Nueva venta",newPurchase:"Nueva compra",newExpense:"Nuevo gasto",newIncome:"Nuevo ingreso",newOutgoingPayment:"Nuevo pago saliente",newIncomingPayment:"Nuevo pago entrante",newPaymentForm:"Nueva cuenta/tarjeta",newBankDeposit:"Nuevo depsito",newBankTransfer:"Nuevo traslado",newInternalObligation:"Nueva obligacin interna",newPayableConcept:"Nuevo concepto de cuentas por pagar",newProject:"Nuevo proyecto",newBudget:"Nuevo presupuesto"},auth:{loginTitle:"Iniciar sesin",registerTitle:"Crear cuenta",email:"Correo",password:"Contrasea",fullName:"Nombre completo",companyName:"Nombre de cuenta",createAccount:"Crear cuenta",login:"Entrar",goToRegister:"Crear nueva cuenta",goToLogin:"Ya tengo una cuenta",registrationSuccess:"Cuenta creada. Si tu proyecto requiere confirmacin por correo, revisa tu bandeja antes de iniciar sesin.",invalidCredentials:"Credenciales invlidas",genericError:"Ocurri un error, intenta nuevamente"},nav:{dashboard:"Dashboard",clients:"Clientes",providers:"Proveedores",persons:"Clientes/Proveedores",employees:"Empleados",planning:"Planeacin",projects:"Proyectos",budgets:"Presupuestos",products:"Productos",incomeConcepts:"Conceptos ingreso",expenseConcepts:"Conceptos gasto",conceptGroups:"Grupos",concepts:"Conceptos",sales:"Ventas",purchases:"Compras",expenses:"Gastos",incomes:"Ingresos",outgoingPayments:"Pagos salientes",incomingPayments:"Pagos entrantes",paymentForms:"Cuentas y tarjetas",internalObligations:"Obligaciones internas",bankDeposits:"Depsitos bancarios",bankTransfers:"Traslados bancarios",bankReconciliation:"Conciliacin bancaria",payableConcepts:"Conceptos CxP",reports:"Reportes",profiles:"Perfiles",admin:"Administracin"},dashboard:{title:"Panel principal",subtitle:"Base inicial lista. Contina con mdulos de negocio.",bankBalances:"Cuentas bancarias y saldos",salesMonthBar:"Ventas del mes",expensesByConceptDonut:"Gastos por concepto",incomesByConceptDonut:"Ingresos por concepto",incomeVsExpenseLine:"Ingresos vs gastos",internalObligationsByPaymentForm:"Obligaciones internas por forma de pago",incomesLine:"Ingresos",expensesLine:"Gastos"},persons:{title:"Clientes y proveedores",empty:"An no hay registros",client:"Cliente",supplier:"Proveedor"},clients:{title:"Clientes"},providers:{title:"Proveedores"},employees:{title:"Empleados",sensitiveHint:"El salario debe mostrarse slo a perfiles autorizados",isPartner:"Es socio"},concepts:{title:"Conceptos, productos y formas de pago",parentConceptId:"ID concepto padre",group:"Grupo",noGroup:"Sin grupo",groupType:"Tipo de grupo",groupTypeIncome:"Grupo de ingreso",groupTypeExpense:"Grupo de gasto",taxPercentage:"% impuesto",flags:"Clasificacin",isGroup:"Es grupo",isIncome:"Es ingreso",isExpense:"Es gasto",isProduct:"Es producto/servicio",isPaymentForm:"Es forma de pago"},conceptModules:{products:"Productos",income:"Conceptos de ingreso",expense:"Conceptos de gasto",payable:"Conceptos cuentas por pagar",groups:"Grupos de conceptos"},paymentForms:{title:"Cuentas bancarias y tarjetas",kind:"Tipo",provider:"Banco / emisor",reference:"Referencia",employee:"Empleado relacionado",createInternalPayableOnOutgoingPayment:"Crear cuenta por pagar interna al registrar pago saliente",createInternalPayableOnOutgoingPaymentShort:"Genera CxP interna",kinds:{bank_account:"Cuenta bancaria",credit_card:"Tarjeta de crdito",cashbox:"Caja / efectivo"}},internalObligations:{title:"Obligaciones internas",totalLowerThanPayments:"El total no puede ser menor a los pagos ya registrados."},bankDeposits:{title:"Registrar depsito bancario",fromCash:"Caja origen",toBankAccount:"Cuenta bancaria destino",saved:"Depsito registrado correctamente."},bankTransfers:{title:"Registrar traslado bancario",sourceTransactionId:"ID transaccin origen",fromBankAccount:"Cuenta bancaria origen",toBankAccount:"Cuenta bancaria destino",sameAccountError:"La cuenta origen y destino deben ser diferentes.",saved:"Traslado registrado correctamente."},reports:{title:"Reportes",sales:"Ventas",expenses:"Gastos",incomes:"Ingresos",budgetExecution:"Ejecucin de presupuesto",projectExecution:"Ejecucin de proyecto",budget:"Presupuesto",selectBudget:"Seleccionar presupuesto",selectProject:"Seleccionar proyecto",budgetRequired:"Selecciona un presupuesto.",projectRequired:"Selecciona un proyecto.",executed:"Ejecutado",variance:"Variacin",availableReports:"Reportes disponibles",applicableFilters:"Filtros aplicables",accountsReceivable:"Cuentas por cobrar",accountsPayable:"Cuentas por pagar",internalObligations:"Obligaciones internas",cashflow:"Flujo de caja",step1:"1. Selecciona el reporte",step2:"2. Define filtros",step3:"3. Resultado",run:"Ejecutar reporte",dateFrom:"Desde",dateTo:"Hasta",currencyFilter:"Moneda",currencyFilterHint:"Todas las monedas",totalRecords:"Total de registros",changeReportFilters:"Cambiar reporte y filtros",exportExcel:"Exportar a Excel"},projects:{title:"Proyectos",project:"Proyecto",optionalProject:"Sin proyecto",startDate:"Inicio",endDate:"Fin"},budgets:{title:"Presupuestos",periodType:"Perodo",lines:"Lneas de presupuesto",addLine:"Agregar lnea",budgetAmount:"Monto presupuestado",totalBudget:"Presupuesto total",periods:{daily:"Diario",weekly:"Semanal",monthly:"Mensual",yearly:"Anual"}},profiles:{title:"Perfiles",newProfile:"Nuevo perfil",createProfile:"Crear perfil",editProfile:"Editar perfil",duplicate:"Duplicar",canCreateUsers:"Crear usuarios",canCreateProfiles:"Crear perfiles",canVoidTransactions:"Anular transacciones",module:"Mdulo",read:"Lectura",write:"Escritura",update:"Modificacin",modules:{transactions:"Transacciones",concepts:"Conceptos",clients:"Clientes",providers:"Proveedores"}},admin:{title:"Administracin",inviteUser:"Invitar usuario existente",profile:"Perfil",selectProfile:"Seleccionar perfil",createInvite:"Crear invitacin",resendInvite:"Reenviar",invitationSent:"Invitacin enviada correctamente.",invitationResent:"Invitacin reenviada correctamente.",activeInvitationExists:"Ya existe una invitacin activa en estado enviado para este correo.",deactivateUser:"Dar de baja",userId:"Usuario",status:"Estado",expiresAt:"Vigencia hasta",processInvitation:"Procesar invitacin",invitationId:"ID de invitacin",completeSignupFromInvitation:"Completa el registro usando la invitacin.",processingInvitation:"Procesando invitacin...",invitationEmailMismatch:"El correo del usuario autenticado no coincide con la invitacin."},accountManage:{security:"Seguridad",account:"Cuenta",billing:"Membresa",users:"Usuarios",profiles:"Perfiles",invitations:"Invitaciones",settings:"Datos de cuenta",pendingInvitationsTitle:"Invitaciones pendientes",acceptInvitation:"Aceptar invitacin",invitationAccepted:"Invitacin aceptada correctamente.",accountSettingsTitle:"Configuracin de la cuenta",adminOnly:"Slo el perfil administrador puede modificar los datos de la cuenta.",accountSaved:"Datos de la cuenta actualizados.",reportRetentionDays:"Retencin de reportes (das)",reportRetentionHint:"Los archivos exportados se eliminan automticamente cada da segn esta retencin.",onboardingTextsTitle:"Textos de onboarding",onboardingTextsHint:"Puedes personalizar los textos que se muestran en la gua de bienvenida.",saveOnboardingTexts:"Guardar textos onboarding",resetOnboardingTexts:"Restablecer textos onboarding",resetOnboardingTours:"Reiniciar tours vistos",onboardingTextsSaved:"Textos de onboarding guardados.",onboardingTextsReset:"Textos de onboarding restablecidos.",onboardingToursReset:"Se reinici el estado de tours vistos."},billing:{title:"Membresa",description:"Plan base con prueba gratuita de 5 das y cobro mensual por usuario.",priceHint:"Precio estimado: USD $5 por usuario / mes.",status:"Estado",trialEndsAt:"Fin de prueba",trialDaysLeft:"Das restantes de prueba",startMembership:"Activar membresa",manageSubscription:"Gestionar suscripcin",syncSeats:"Sincronizar usuarios con PayPal",addPaymentMethod:"Gestionar mtodo de pago",cardBrand:"Proveedor",cardLast4:"Tarjeta",cardExpiry:"Vencimiento",defaultMethod:"Predeterminado",setDefaultMethod:"Definir como predeterminado",seatsSynced:"Usuarios sincronizados en PayPal.",paypalManageHint:"La gestin de mtodos de pago se realiza directamente en PayPal."},reconciliation:{title:"Conciliacin bancaria",bankAccount:"Cuenta bancaria",reportDate:"Fecha de corte",reconcileDate:"Fecha de conciliacin",reconcileDateHelp:"Se usar como la fecha para marcar el movimiento como conciliado.",currentBalance:"Saldo actual",previousBalance:"Saldo anterior (conciliado antes del rango)",periodMovementsSum:"Suma de los movimientos en el perodo seleccionado",reconcile:"Conciliar",reconciled:"Conciliada",changeReconcileDate:"Cambiar fecha conciliacin",unreconcile:"Desmarcar como conciliado"},transactions:{salesTitle:"Registro de ventas",purchasesTitle:"Registro de compras",expensesTitle:"Registro de gastos",incomesTitle:"Registro de ingresos",outgoingPaymentsTitle:"Registro de pagos salientes",incomingPaymentsTitle:"Registro de pagos entrantes",salesCreateTitle:"Crear venta",purchasesCreateTitle:"Crear compra",expensesCreateTitle:"Crear gasto",incomesCreateTitle:"Crear ingreso",outgoingPaymentsCreateTitle:"Crear pago saliente",incomingPaymentsCreateTitle:"Crear pago entrante",cash:"Contado",credit:"Crdito",optionalPerson:"Cliente/Proveedor (opcional)",providerRequired:"Selecciona un proveedor.",selectProvider:"Seleccionar proveedor",selectConcept:"Seleccionar concepto",optionalSeller:"Vendedor (opcional)",concept:"Concepto",currency:"Moneda",selectCurrency:"Seleccionar moneda",paymentMode:"Tipo de pago",paymentMethod:"Mtodo de pago",selectPaymentMethod:"Seleccionar mtodo de pago",accountPaymentForm:"Cuenta bancaria / tarjeta",selectAccountPaymentForm:"Seleccionar cuenta o tarjeta",paymentMethodRequired:"Selecciona mtodo de pago.",accountPaymentFormRequired:"Selecciona la cuenta bancaria o tarjeta utilizada.",sectionGeneral:"Datos generales",sectionPayment:"Pago",sectionAmounts:"Montos",sectionDetail:"Detalle",referenceNumber:"Nmero de referencia",viewDetail:"Ver detalle",detailTitle:"Detalle de transaccin",detailLines:"Detalle",paymentsApplied:"Pagos aplicados",newIncomingPayment:"Registrar pago entrante",newOutgoingPayment:"Registrar pago saliente",invalidPaymentAmount:"Monto de pago invlido.",invalidTransactionAmount:"Ingresa un monto mayor a cero.",missingSystemPaymentConcept:"No existe el concepto de sistema para registrar pagos.",seller:"Vendedor",description:"Descripcin",clientLookup:"Cliente",lookupPlaceholder:"Buscar cliente por nombre...",productLookup:"Producto",productLookupPlaceholder:"Buscar producto por nombre...",product:"Producto",lineTotal:"Total lnea",noLines:"No hay lneas agregadas",saleValidationError:"Selecciona un cliente y agrega al menos una lnea de detalle.",quantity:"Cantidad",amount:"Monto",minAmount:"Monto mnimo",maxAmount:"Monto mximo",price:"Precio unitario",taxPercentage:"% impuesto",discountPercentage:"% descuento",additionalCharges:"Cargos adicionales",summary:"Total calculado:",date:"Fecha",person:"Cliente/Proveedor",employee:"Empleado",total:"Total",balance:"Saldo",status:"Estado",active:"Activa",inactive:"Inactiva",deactivate:"Desactivar"}},en:{common:{appName:"Financiera",account:"Account",loading:"Loading...",save:"Save",cancel:"Cancel",logout:"Sign out",language:"Language",searchPlaceholder:"Search",workspace:"Workspace",create:"Create",update:"Update",delete:"Delete",edit:"Edit",backToList:"Back to list",actions:"Actions",name:"Name",phone:"Phone",email:"Email",address:"Address",type:"Type",yes:"Yes",no:"No",empty:"No records",previous:"Previous",next:"Next",page:"Page",of:"of",more:"More",expand:"Expand menu",collapse:"Collapse menu",clearFilters:"Clear filters",requiredFields:"Complete required fields.",searching:"Searching...",searchTypeToStart:"Type at least 2 characters to search",searchNoResults:"No results found",genericLoadError:"Could not load data",genericSaveError:"Could not save changes"},topbar:{apps:"Applications",theme:"Toggle theme",notifications:"Notifications",userMenu:"User menu",noNotifications:"No notifications",pendingInvitations:"You have pending invitations to accept",goToInvitations:"Go to invitations",account:"Account",currentAccount:"Current account",manageAccount:"Manage account",textSize:"Text size",density:"Density",small:"Small",medium:"Medium",large:"Large",compact:"Compact",comfortable:"Comfortable"},onboarding:{welcomeTitle:"Welcome to module",welcomeDescription:"We will quickly show you where each menu is in",start:"Start guide",skip:"Skip",finish:"Finish",sidebarTitle:"Main menu",sidebarText:"Switch between the main system groups here.",appMenuTitle:"Module menu",appMenuText:"Navigate module-specific options here.",actionsMenuTitle:"Quick actions",actionsMenuText:"Use quick actions like create and refresh here.",tableTitle:"Module table",tableText:"This table shows the latest records included in this module.",workspaceTitle:"Workspace",workspaceText:"The module list, form, or report is displayed here.",accountSwitchTitle:"Account switch",accountSwitchText:"Switch between accounts you can access from here.",userMenuTitle:"User menu",userMenuText:"Find settings, preferences and sign out here."},sidebar:{expand:"Expand menu",collapse:"Collapse menu",core:"Core",concepts:"Concepts",transactions:"Transactions",security:"Security"},actions:{refresh:"Refresh",newPerson:"New client/supplier",newClient:"New client",newProvider:"New supplier",newEmployee:"New employee",newConcept:"New concept",newProduct:"New product",newIncomeConcept:"New income concept",newExpenseConcept:"New expense concept",newConceptGroup:"New group",newSale:"New sale",newPurchase:"New purchase",newExpense:"New expense",newIncome:"New income",newOutgoingPayment:"New outgoing payment",newIncomingPayment:"New incoming payment",newPaymentForm:"New bank/card account",newBankDeposit:"New bank deposit",newBankTransfer:"New transfer",newInternalObligation:"New internal obligation",newPayableConcept:"New accounts payable concept",newProject:"New project",newBudget:"New budget"},auth:{loginTitle:"Sign in",registerTitle:"Create account",email:"Email",password:"Password",fullName:"Full name",companyName:"Account name",createAccount:"Create account",login:"Sign in",goToRegister:"Create new account",goToLogin:"I already have an account",registrationSuccess:"Account created. If email confirmation is enabled, confirm your email first.",invalidCredentials:"Invalid credentials",genericError:"Something went wrong, please try again"},nav:{dashboard:"Dashboard",clients:"Clients",providers:"Suppliers",persons:"Clients/Suppliers",employees:"Employees",planning:"Planning",projects:"Projects",budgets:"Budgets",products:"Products",incomeConcepts:"Income concepts",expenseConcepts:"Expense concepts",conceptGroups:"Groups",concepts:"Concepts",sales:"Sales",purchases:"Purchases",expenses:"Expenses",incomes:"Incomes",outgoingPayments:"Outgoing payments",incomingPayments:"Incoming payments",paymentForms:"Bank accounts & cards",internalObligations:"Internal obligations",bankDeposits:"Bank deposits",bankTransfers:"Bank transfers",bankReconciliation:"Bank reconciliation",payableConcepts:"AP concepts",reports:"Reports",profiles:"Profiles",admin:"Administration"},dashboard:{title:"Main dashboard",subtitle:"Initial foundation is ready. Continue building business modules.",bankBalances:"Bank accounts and balances",salesMonthBar:"Monthly sales",expensesByConceptDonut:"Expenses by concept",incomesByConceptDonut:"Incomes by concept",incomeVsExpenseLine:"Income vs expenses",internalObligationsByPaymentForm:"Internal obligations by payment form",incomesLine:"Incomes",expensesLine:"Expenses"},persons:{title:"Clients and suppliers",empty:"No records yet",client:"Client",supplier:"Supplier"},clients:{title:"Clients"},providers:{title:"Suppliers"},employees:{title:"Employees",sensitiveHint:"Salary must be visible only for authorized roles",isPartner:"Is partner"},concepts:{title:"Concepts, products and payment methods",parentConceptId:"Parent concept ID",group:"Group",noGroup:"No group",groupType:"Group type",groupTypeIncome:"Income group",groupTypeExpense:"Expense group",taxPercentage:"Tax %",flags:"Classification",isGroup:"Is group",isIncome:"Is income",isExpense:"Is expense",isProduct:"Is product/service",isPaymentForm:"Is payment form"},conceptModules:{products:"Products",income:"Income concepts",expense:"Expense concepts",payable:"Accounts payable concepts",groups:"Concept groups"},paymentForms:{title:"Bank accounts and credit cards",kind:"Type",provider:"Bank / issuer",reference:"Reference",employee:"Related employee",createInternalPayableOnOutgoingPayment:"Create internal payable when recording outgoing payment",createInternalPayableOnOutgoingPaymentShort:"Create internal AP",kinds:{bank_account:"Bank account",credit_card:"Credit card",cashbox:"Cashbox"}},internalObligations:{title:"Internal obligations",totalLowerThanPayments:"Total cannot be lower than already registered payments."},bankDeposits:{title:"Register bank deposit",fromCash:"Source cashbox",toBankAccount:"Destination bank account",saved:"Deposit registered successfully."},bankTransfers:{title:"Register bank transfer",sourceTransactionId:"Source transaction ID",fromBankAccount:"Source bank account",toBankAccount:"Destination bank account",sameAccountError:"Source and destination accounts must be different.",saved:"Transfer registered successfully."},reports:{title:"Reports",sales:"Sales",expenses:"Expenses",incomes:"Incomes",budgetExecution:"Budget execution",projectExecution:"Project execution",budget:"Budget",selectBudget:"Select budget",selectProject:"Select project",budgetRequired:"Select a budget.",projectRequired:"Select a project.",executed:"Executed",variance:"Variance",availableReports:"Available reports",applicableFilters:"Applicable filters",accountsReceivable:"Accounts receivable",accountsPayable:"Accounts payable",internalObligations:"Internal obligations",cashflow:"Cashflow",step1:"1. Select report",step2:"2. Set filters",step3:"3. Result",run:"Run report",dateFrom:"From",dateTo:"To",currencyFilter:"Currency",currencyFilterHint:"All currencies",totalRecords:"Total records",changeReportFilters:"Change report and filters",exportExcel:"Export to Excel"},projects:{title:"Projects",project:"Project",optionalProject:"No project",startDate:"Start",endDate:"End"},budgets:{title:"Budgets",periodType:"Period",lines:"Budget lines",addLine:"Add line",budgetAmount:"Budgeted amount",totalBudget:"Total budget",periods:{daily:"Daily",weekly:"Weekly",monthly:"Monthly",yearly:"Yearly"}},profiles:{title:"Profiles",newProfile:"New profile",createProfile:"Create profile",editProfile:"Edit profile",duplicate:"Duplicate",canCreateUsers:"Create users",canCreateProfiles:"Create profiles",canVoidTransactions:"Void transactions",module:"Module",read:"Read",write:"Write",update:"Update",modules:{transactions:"Transactions",concepts:"Concepts",clients:"Clients",providers:"Suppliers"}},admin:{title:"Administration",inviteUser:"Invite existing user",profile:"Profile",selectProfile:"Select profile",createInvite:"Create invitation",resendInvite:"Resend",invitationSent:"Invitation sent successfully.",invitationResent:"Invitation resent successfully.",activeInvitationExists:"An active sent invitation already exists for this email.",deactivateUser:"Deactivate",userId:"User",status:"Status",expiresAt:"Expires at",processInvitation:"Process invitation",invitationId:"Invitation ID",completeSignupFromInvitation:"Complete signup using the invitation link.",processingInvitation:"Processing invitation...",invitationEmailMismatch:"Authenticated user email does not match invitation email."},accountManage:{security:"Security",account:"Account",billing:"Membership",users:"Users",profiles:"Profiles",invitations:"Invitations",settings:"Account details",pendingInvitationsTitle:"Pending invitations",acceptInvitation:"Accept invitation",invitationAccepted:"Invitation accepted successfully.",accountSettingsTitle:"Account settings",adminOnly:"Only system admin profile can update account details.",accountSaved:"Account details updated.",reportRetentionDays:"Report retention (days)",reportRetentionHint:"Exported files are automatically deleted every day based on this retention.",onboardingTextsTitle:"Onboarding texts",onboardingTextsHint:"You can customize texts shown in the welcome guide.",saveOnboardingTexts:"Save onboarding texts",resetOnboardingTexts:"Reset onboarding texts",resetOnboardingTours:"Reset viewed tours",onboardingTextsSaved:"Onboarding texts saved.",onboardingTextsReset:"Onboarding texts reset.",onboardingToursReset:"Viewed tours state has been reset."},billing:{title:"Membership",description:"Base plan with 5-day free trial and monthly per-user billing.",priceHint:"Estimated price: USD $5 per user / month.",status:"Status",trialEndsAt:"Trial ends at",trialDaysLeft:"Trial days left",startMembership:"Start membership",manageSubscription:"Manage subscription",syncSeats:"Sync seats with PayPal",addPaymentMethod:"Manage payment method",cardBrand:"Provider",cardLast4:"Card",cardExpiry:"Expiry",defaultMethod:"Default",setDefaultMethod:"Set as default",seatsSynced:"Seats synced with PayPal.",paypalManageHint:"Payment methods are managed directly in PayPal."},reconciliation:{title:"Bank reconciliation",bankAccount:"Bank account",reportDate:"As-of date",reconcileDate:"Reconciliation date",reconcileDateHelp:"This date will be used when marking the movement as reconciled.",currentBalance:"Current balance",previousBalance:"Previous balance (reconciled before range)",periodMovementsSum:"Sum of movements in the selected period",reconcile:"Reconcile",reconciled:"Reconciled",changeReconcileDate:"Change reconciliation date",unreconcile:"Unmark as reconciled"},transactions:{salesTitle:"Sales entries",purchasesTitle:"Purchase entries",expensesTitle:"Expense entries",incomesTitle:"Income entries",outgoingPaymentsTitle:"Outgoing payments",incomingPaymentsTitle:"Incoming payments",salesCreateTitle:"Create sale",purchasesCreateTitle:"Create purchase",expensesCreateTitle:"Create expense",incomesCreateTitle:"Create income",outgoingPaymentsCreateTitle:"Create outgoing payment",incomingPaymentsCreateTitle:"Create incoming payment",cash:"Cash",credit:"Credit",optionalPerson:"Client/Supplier (optional)",providerRequired:"Select a supplier.",selectProvider:"Select supplier",selectConcept:"Select concept",optionalSeller:"Seller (optional)",concept:"Concept",currency:"Currency",selectCurrency:"Select currency",paymentMode:"Payment mode",paymentMethod:"Payment method",selectPaymentMethod:"Select payment method",accountPaymentForm:"Bank account / card",selectAccountPaymentForm:"Select bank account or card",paymentMethodRequired:"Select a payment method.",accountPaymentFormRequired:"Select the bank account or card used.",sectionGeneral:"General data",sectionPayment:"Payment",sectionAmounts:"Amounts",sectionDetail:"Detail",referenceNumber:"Reference number",viewDetail:"View detail",detailTitle:"Transaction detail",detailLines:"Detail lines",paymentsApplied:"Applied payments",newIncomingPayment:"Register incoming payment",newOutgoingPayment:"Register outgoing payment",invalidPaymentAmount:"Invalid payment amount.",invalidTransactionAmount:"Enter an amount greater than zero.",missingSystemPaymentConcept:"Missing system concept for payment registration.",seller:"Seller",description:"Description",clientLookup:"Client",lookupPlaceholder:"Search client by name...",productLookup:"Product",productLookupPlaceholder:"Search product by name...",product:"Product",lineTotal:"Line total",noLines:"No detail lines yet",saleValidationError:"Select a client and add at least one detail line.",quantity:"Quantity",amount:"Amount",minAmount:"Minimum amount",maxAmount:"Maximum amount",price:"Unit price",taxPercentage:"Tax %",discountPercentage:"Discount %",additionalCharges:"Additional charges",summary:"Calculated total:",date:"Date",person:"Client/Supplier",employee:"Employee",total:"Total",balance:"Balance",status:"Status",active:"Active",inactive:"Inactive",deactivate:"Deactivate"}}},tx=j.createContext(null);function Mj(t,e){return e.split(".").reduce((n,s)=>n?.[s],Rj[t])}function Lj({children:t}){const[e,n]=j.useState("es"),s=j.useMemo(()=>({t:a=>Mj(e,a)??a,language:e,setLanguage:n}),[e]);return u.jsx(tx.Provider,{value:s,children:t})}function Ee(){const t=j.useContext(tx);if(!t)throw new Error("useI18n must be used inside I18nProvider");return t}function Ug(t){return`name.ilike.%${t}%,referenceNumber.ilike.%${t}%,deliverTo.ilike.%${t}%,deliveryAddress.ilike.%${t}%`}function Wg(t){return`name.ilike.%${t}%,phone.ilike.%${t}%,address.ilike.%${t}%`}async function Dj({accountId:t,term:e,limit:n=8}){const s=String(e||"").trim();if(!t||s.length<2)return{transactions:[],clients:[],providers:[],products:[],concepts:[],deposits:[]};const[r,a,l,c,d,f]=await Promise.allSettled([G.from("transactions").select('id, type, date, name, "referenceNumber", "isDeposit"').eq("accountId",t).eq("isActive",!0).eq("isDeposit",!1).or(Ug(s)).order("id",{ascending:!1}).limit(n),G.from("persons").select("id, type, name, phone, address").eq("accountId",t).eq("type",1).or(Wg(s)).order("id",{ascending:!1}).limit(n),G.from("persons").select("id, type, name, phone, address").eq("accountId",t).eq("type",2).or(Wg(s)).order("id",{ascending:!1}).limit(n),G.from("concepts").select("id, name, isProduct").eq("accountId",t).eq("isGroup",!1).eq("isProduct",!0).ilike("name",`%${s}%`).order("id",{ascending:!1}).limit(n),G.from("concepts").select("id, name, isProduct").eq("accountId",t).eq("isProduct",!1).ilike("name",`%${s}%`).order("id",{ascending:!1}).limit(n),G.from("transactions").select('id, date, name, "referenceNumber", total').eq("accountId",t).eq("isActive",!0).eq("isDeposit",!0).or(Ug(s)).order("id",{ascending:!1}).limit(n)]),m=g=>g.status!=="fulfilled"?[]:g.value.error?[]:g.value.data??[];return{transactions:m(r),clients:m(a),providers:m(l),products:m(c),concepts:m(d),deposits:m(f)}}async function nx({invitationId:t,email:e}){let{data:{session:n}}=await G.auth.getSession();if(n?.access_token||(n=(await G.auth.refreshSession()).data.session),!n?.access_token)throw new Error("Missing auth session for invitation accept request.");const{data:s,error:r}=await G.functions.invoke("accept-shared-invitation",{body:{invitationId:t,email:e},headers:{Authorization:`Bearer ${n.access_token}`}});if(r)throw new Error(`Accept invitation function error: ${r.message??"unknown error"}`);if(s?.success===!1)throw new Error(`Accept invitation failed: ${s.error??"unknown function error"}`);return s}async function sx(){async function t(r){return G.functions.invoke("list-pending-invitations",{headers:{Authorization:`Bearer ${r}`}})}let{data:{session:e}}=await G.auth.getSession();if(e?.access_token||(e=(await G.auth.refreshSession()).data.session),!e?.access_token)throw new Error("Missing auth session for pending invitations request.");let{data:n,error:s}=await t(e.access_token);if(s?.message?.includes?.("401")){const a=(await G.auth.refreshSession()).data.session?.access_token;if(a){const l=await t(a);n=l.data,s=l.error}}if(s)throw new Error(`Pending invitations function error: ${s.message??"unknown error"}`);if(n?.success===!1)throw new Error(`Pending invitations failed: ${n.error??"unknown function error"}`);return n?.invitations??[]}function rx(t){return t==="en"?"en-US":"es-HN"}function dt(t,e="es"){if(!t)return"-";const n=rx(e),s=String(t).trim();if(/^\d{4}-\d{2}-\d{2}$/.test(s)){const[a,l,c]=s.split("-").map(Number),d=new Date(a,l-1,c);return Number.isNaN(d.getTime())?"-":new Intl.DateTimeFormat(n,{day:"2-digit",month:"2-digit",year:"numeric"}).format(d)}const r=new Date(s);return Number.isNaN(r.getTime())?"-":new Intl.DateTimeFormat(n,{day:"2-digit",month:"2-digit",year:"numeric"}).format(r)}function qh(t,e="es"){if(!t)return"-";const n=String(t).trim();if(/^\d{4}-\d{2}-\d{2}$/.test(n))return dt(n,e);const s=new Date(n);return Number.isNaN(s.getTime())?"-":new Intl.DateTimeFormat(rx(e),{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(s)}const Fj={dashboard:{intro:"Este mdulo te da una vista general del negocio.",sidebarTitle:"Men principal",sidebarText:"Aqu cambias entre grupos principales del sistema.",actionsTitle:"Acciones rpidas",actionsText:"Aqu encontrars acciones como crear o refrescar.",workspaceTitle:"rea de trabajo",workspaceText:"Aqu se muestran listados, formularios y reportes.",appMenuTitle:"Accesos del app-menu",appMenuText:"Desde aqu navegas los accesos del mdulo General.",appMenuOptions:[{name:"Dashboard",description:"Resumen general y mtricas clave."},{name:"Clientes",description:"Consulta y gestin de clientes."},{name:"Proveedores",description:"Consulta y gestin de proveedores."},{name:"Empleados",description:"Consulta y gestin de empleados."}]},clients:{intro:"En este mdulo administras la base de clientes.",appMenuTitle:"Accesos del app-menu",appMenuText:"Opciones disponibles para clientes.",appMenuOptions:[{name:"Clientes",description:"Listado principal con filtros y acciones."}]},providers:{intro:"En este mdulo administras la base de proveedores.",appMenuTitle:"Accesos del app-menu",appMenuText:"Opciones disponibles para proveedores.",appMenuOptions:[{name:"Proveedores",description:"Listado principal con filtros y acciones."}]},employees:{intro:"En este mdulo gestionas empleados y datos relacionados.",appMenuTitle:"Accesos del app-menu",appMenuText:"Opciones disponibles para empleados.",appMenuOptions:[{name:"Empleados",description:"Listado y mantenimiento de empleados."}]},products:{intro:"En este mdulo administras el catlogo de productos.",appMenuTitle:"Accesos del app-menu",appMenuText:"Opciones disponibles para productos.",appMenuOptions:[{name:"Productos",description:"Listado y mantenimiento del catlogo."}]},transactions:{intro:"En este mdulo registras y consultas movimientos de negocio.",appMenuTitle:"Accesos del app-menu",appMenuText:"Opciones disponibles en transacciones.",appMenuOptions:[{name:"Ventas",description:"Registro y control de ventas."},{name:"Compras",description:"Registro y control de compras."},{name:"Gastos",description:"Registro de gastos operativos."},{name:"Ingresos",description:"Registro de ingresos adicionales."}]},concepts:{intro:"En este mdulo defines conceptos y su clasificacin.",appMenuTitle:"Accesos del app-menu",appMenuText:"Opciones disponibles para conceptos.",appMenuOptions:[{name:"Conceptos ingreso",description:"Conceptos para ingresos."},{name:"Conceptos gasto",description:"Conceptos para gastos."},{name:"Conceptos CxP",description:"Conceptos para cuentas por pagar."},{name:"Grupos",description:"Agrupadores para organizar conceptos."}]},payments:{intro:"En este mdulo gestionas pagos, bancos y conciliaciones.",appMenuTitle:"Accesos del app-menu",appMenuText:"Opciones disponibles para pagos y bancos.",appMenuOptions:[{name:"Cuentas y tarjetas",description:"Mantenimiento de cuentas y tarjetas."},{name:"Depsitos bancarios",description:"Registro de depsitos entre formas de pago."},{name:"Traslados bancarios",description:"Traslado entre cuentas bancarias con registro de doble detalle."},{name:"Obligaciones internas",description:"Control de obligaciones internas."},{name:"Conciliacin bancaria",description:"Conciliacin y saldos por fecha de corte."}]},planning:{intro:"En este mdulo gestionas proyectos y presupuestos.",appMenuTitle:"Accesos del app-menu",appMenuText:"Opciones disponibles para planeacin.",appMenuOptions:[{name:"Proyectos",description:"Creacin y seguimiento de proyectos."},{name:"Presupuestos",description:"Definicin y ejecucin presupuestaria."}]},reports:{intro:"En este mdulo ejecutas reportes financieros y operativos.",appMenuTitle:"Accesos del app-menu",appMenuText:"Opciones disponibles para reportes.",appMenuOptions:[{name:"Reportes",description:"Seleccin, filtros y ejecucin de reportes."}]},account:{intro:"En este mdulo administras usuarios, perfiles y datos de cuenta.",appMenuTitle:"Accesos del mdulo",appMenuText:"Opciones disponibles en gestionar cuenta.",appMenuOptions:[{name:"Usuarios",description:"Alta, baja e invitacin de usuarios."},{name:"Perfiles",description:"Definicin de permisos y roles."},{name:"Invitaciones",description:"Aceptacin y estado de invitaciones."},{name:"Datos de cuenta",description:"Configuracin general de la cuenta."}]}},Bj={dashboard:{intro:"This module gives you a general overview of the business.",sidebarTitle:"Main menu",sidebarText:"Switch between main system groups here.",actionsTitle:"Quick actions",actionsText:"Find quick actions like create and refresh here.",workspaceTitle:"Workspace",workspaceText:"Lists, forms and reports are displayed here.",appMenuTitle:"App-menu entries",appMenuText:"Use these entries to navigate General module options.",appMenuOptions:[{name:"Dashboard",description:"General summary and key metrics."},{name:"Clients",description:"Client list and management."},{name:"Suppliers",description:"Supplier list and management."},{name:"Employees",description:"Employee list and management."}]},clients:{intro:"This module manages your client master data.",appMenuTitle:"App-menu entries",appMenuText:"Available options for clients.",appMenuOptions:[{name:"Clients",description:"Main list with filters and actions."}]},providers:{intro:"This module manages your supplier master data.",appMenuTitle:"App-menu entries",appMenuText:"Available options for suppliers.",appMenuOptions:[{name:"Suppliers",description:"Main list with filters and actions."}]},employees:{intro:"This module manages employees and related data.",appMenuTitle:"App-menu entries",appMenuText:"Available options for employees.",appMenuOptions:[{name:"Employees",description:"Employee list and maintenance."}]},products:{intro:"This module manages your product catalog.",appMenuTitle:"App-menu entries",appMenuText:"Available options for products.",appMenuOptions:[{name:"Products",description:"Catalog list and maintenance."}]},transactions:{intro:"This module records and tracks business transactions.",appMenuTitle:"App-menu entries",appMenuText:"Available transaction options.",appMenuOptions:[{name:"Sales",description:"Sales registration and control."},{name:"Purchases",description:"Purchase registration and control."},{name:"Expenses",description:"Operational expense registration."},{name:"Incomes",description:"Additional income registration."}]},concepts:{intro:"This module defines concepts and their classification.",appMenuTitle:"App-menu entries",appMenuText:"Available concept options.",appMenuOptions:[{name:"Income concepts",description:"Concepts used for income."},{name:"Expense concepts",description:"Concepts used for expenses."},{name:"A/P concepts",description:"Concepts used for accounts payable."},{name:"Groups",description:"Groupers to organize concepts."}]},payments:{intro:"This module manages payments, banks and reconciliations.",appMenuTitle:"App-menu entries",appMenuText:"Available payment and bank options.",appMenuOptions:[{name:"Accounts and cards",description:"Maintain bank accounts and cards."},{name:"Bank deposits",description:"Record deposits between payment forms."},{name:"Bank transfers",description:"Transfer between bank accounts with two-detail registration."},{name:"Internal obligations",description:"Track internal obligations."},{name:"Bank reconciliation",description:"Reconcile balances by cutoff date."}]},planning:{intro:"This module manages projects and budgets.",appMenuTitle:"App-menu entries",appMenuText:"Available planning options.",appMenuOptions:[{name:"Projects",description:"Project creation and tracking."},{name:"Budgets",description:"Budget definition and execution."}]},reports:{intro:"This module runs financial and operational reports.",appMenuTitle:"App-menu entries",appMenuText:"Available report options.",appMenuOptions:[{name:"Reports",description:"Select, filter and run reports."}]},account:{intro:"This module manages users, profiles and account data.",appMenuTitle:"Module entries",appMenuText:"Available manage-account options.",appMenuOptions:[{name:"Users",description:"Invite, activate and deactivate users."},{name:"Profiles",description:"Define roles and permissions."},{name:"Invitations",description:"Review and accept invitations."},{name:"Account details",description:"Maintain account configuration."}]}},Vg={es:Fj,en:Bj},$j=[{id:"dashboard",match:t=>t==="/"||t==="/dashboard",titleKey:"nav.dashboard"},{id:"clients",match:t=>t.startsWith("/clients"),titleKey:"nav.clients"},{id:"providers",match:t=>t.startsWith("/providers"),titleKey:"nav.providers"},{id:"employees",match:t=>t.startsWith("/employees"),titleKey:"nav.employees"},{id:"products",match:t=>t.startsWith("/products"),titleKey:"nav.products"},{id:"transactions",match:t=>t.startsWith("/sales")||t.startsWith("/purchases")||t.startsWith("/expenses")||t.startsWith("/incomes"),titleKey:"sidebar.transactions"},{id:"concepts",match:t=>t.startsWith("/income-concepts")||t.startsWith("/expense-concepts")||t.startsWith("/payable-concepts")||t.startsWith("/concept-groups"),titleKey:"sidebar.concepts"},{id:"payments",match:t=>t.startsWith("/payment-forms")||t.startsWith("/bank-deposits")||t.startsWith("/bank-transfers")||t.startsWith("/internal-obligations")||t.startsWith("/bank-reconciliation"),titleKey:"nav.paymentForms"},{id:"planning",match:t=>t.startsWith("/projects")||t.startsWith("/budgets"),titleKey:"nav.planning"},{id:"reports",match:t=>t.startsWith("/reports"),titleKey:"nav.reports"},{id:"account",match:t=>t.startsWith("/account"),titleKey:"topbar.manageAccount"}];function qg(t){return`module-onboarding:${t}:done`}function zj(t){return $j.find(e=>e.match(t))??null}function Od(t){return u.jsxs("div",{children:[u.jsx("p",{children:t?.appMenuText||""}),Array.isArray(t?.appMenuOptions)&&t.appMenuOptions.length>0?u.jsx("ul",{className:"onboarding-option-list",children:t.appMenuOptions.map(e=>u.jsxs("li",{children:[u.jsxs("strong",{children:[e.name,":"]})," ",e.description]},`${e.name}-${e.description}`))}):null]})}function Uj(t,e,n,s){const r=s?.sidebarTitle||n("onboarding.sidebarTitle"),a=s?.sidebarText||n("onboarding.sidebarText"),l=s?.appMenuTitle||n("onboarding.appMenuTitle"),c=s?.actionsTitle||n("onboarding.actionsMenuTitle"),d=s?.actionsText||`${n("onboarding.actionsMenuText")} ${e?`(${e})`:""}`.trim(),f=s?.workspaceTitle||n("onboarding.tableTitle"),m=s?.workspaceText||n("onboarding.tableText");return t==="dashboard"?[{selector:'[data-tour="sidebar-icons"]',title:r,body:u.jsx("p",{children:a})},{selector:'[data-tour="app-menu"]',title:l,body:Od(s)},{selector:'[data-tour="actions-menu"]',title:c,body:u.jsx("p",{children:d})},{selector:'[data-tour="workspace"]',title:f,body:u.jsx("p",{children:m})}]:t==="account"?[{selector:'[data-tour="workspace"]',title:l,body:Od(s)}]:[{selector:'[data-tour="app-menu"]',title:l,body:Od(s)},{selector:'[data-tour="actions-menu"]',title:c,body:u.jsx("p",{children:d})},{selector:'[data-tour="workspace"]',title:f,body:u.jsx("p",{children:m})}]}function Wj(){const{pathname:t}=Wn(),{t:e,language:n}=Ee(),[s,r]=j.useState("closed"),[a,l]=j.useState(0),[c,d]=j.useState(null),f=Vg?.[n]?n:"es",m=c?.id?Vg?.[f]?.[c.id]:null,g=c?e(c.titleKey):"",y=j.useMemo(()=>Uj(c?.id,g,e,m),[c?.id,g,e,m]);j.useEffect(()=>{const I=zj(t);if(d(I),!I){r("closed");return}localStorage.getItem(qg(I.id))==="1"?r("closed"):(l(0),r("welcome"))},[t]),j.useEffect(()=>{if(s!=="steps")return;const I=y[a];if(!I)return;const C=document.querySelector(I.selector);C&&C.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})},[s,a,y]);const x=()=>{c?.id&&localStorage.setItem(qg(c.id),"1"),r("closed")},_=s==="steps"?y[a]:null,b=(_?document.querySelector(_.selector):null)?.getBoundingClientRect?.()??null,k=b?{top:`${Math.min(window.innerHeight-170,b.bottom+10)}px`,left:`${Math.max(10,Math.min(window.innerWidth-360,b.left))}px`}:{top:"50%",left:"50%",transform:"translate(-50%, -50%)"};return s==="closed"||!c?null:u.jsx("div",{className:"onboarding-overlay",role:"dialog","aria-modal":"true",children:s==="welcome"?u.jsxs("div",{className:"onboarding-card",children:[u.jsxs("h3",{children:[e("onboarding.welcomeTitle")," ",e(c.titleKey)]}),u.jsx("p",{children:m?.intro||`${e("onboarding.welcomeDescription")} ${e(c.titleKey)}.`}),u.jsxs("div",{className:"onboarding-actions",children:[u.jsx("button",{type:"button",className:"button-secondary",onClick:x,children:e("onboarding.skip")}),u.jsx("button",{type:"button",className:"button-link-primary",onClick:()=>r("steps"),children:e("onboarding.start")})]})]}):u.jsxs(u.Fragment,{children:[b?u.jsx("div",{className:"onboarding-highlight",style:{top:`${b.top-6}px`,left:`${b.left-6}px`,width:`${b.width+12}px`,height:`${b.height+12}px`}}):null,u.jsxs("div",{className:"onboarding-card onboarding-step",style:k,children:[u.jsx("h4",{children:_?.title}),_?.body,u.jsxs("small",{children:[a+1," / ",y.length]}),u.jsxs("div",{className:"onboarding-actions",children:[u.jsx("button",{type:"button",className:"button-secondary",onClick:x,children:e("onboarding.finish")}),u.jsx("button",{type:"button",className:"button-secondary",onClick:()=>l(I=>Math.max(0,I-1)),disabled:a===0,children:e("common.previous")}),u.jsx("button",{type:"button",className:"button-link-primary",onClick:()=>{if(a+1>=y.length){x();return}l(I=>I+1)},children:a+1>=y.length?e("onboarding.finish"):e("common.next")})]})]})]})})}const Yl=[{id:"core",titleKey:"sidebar.core",icon:hg,items:[{path:"/",key:"nav.dashboard",icon:hg},{path:"/clients",key:"nav.clients",icon:H_},{path:"/providers",key:"nav.providers",icon:Cl},{path:"/employees",key:"nav.employees",icon:W_}]},{id:"products",titleKey:"nav.products",icon:Cl,items:[{path:"/products",key:"nav.products",icon:Cl}]},{id:"transactions",titleKey:"sidebar.transactions",icon:Sd,items:[{path:"/sales",key:"nav.sales",icon:kd},{path:"/purchases",key:"nav.purchases",icon:Cl},{path:"/expenses",key:"nav.expenses",icon:yg},{path:"/incomes",key:"nav.incomes",icon:Sd}]},{id:"concepts",titleKey:"sidebar.concepts",icon:mg,items:[{path:"/income-concepts",key:"nav.incomeConcepts",icon:U_},{path:"/expense-concepts",key:"nav.expenseConcepts",icon:yg},{path:"/concept-groups",key:"nav.conceptGroups",icon:mg}]},{id:"payments",titleKey:"nav.paymentForms",icon:fh,items:[{path:"/payment-forms",key:"nav.paymentForms",icon:fh},{path:"/bank-deposits",key:"nav.bankDeposits",icon:Sd},{path:"/bank-transfers",key:"nav.bankTransfers",icon:Dv},{path:"/internal-obligations",key:"nav.internalObligations",icon:kd},{path:"/bank-reconciliation",key:"nav.bankReconciliation",icon:O_}]},{id:"planning",titleKey:"nav.planning",icon:pg,items:[{path:"/projects",key:"nav.projects",icon:pg},{path:"/budgets",key:"nav.budgets",icon:kd}]},{id:"reports",titleKey:"nav.reports",icon:dg,items:[{path:"/reports",key:"nav.reports",icon:dg}]}];function Hg(t){if(t==="/")return"core";for(const e of Yl)for(const n of e.items)if(n.path!=="/"&&t.startsWith(n.path))return e.id;return null}function Vj(t){return t.type===1?`/sales/${t.id}`:t.type===4?`/purchases/${t.id}`:t.type===2?"/expenses":t.type===3?"/incomes":t.type===5?"/purchases":t.type===6?"/sales":"/"}function qj(){const{logout:t,user:e,account:n,accounts:s,switchAccount:r}=Oe(),{t:a,language:l,setLanguage:c}=Ee(),{pathname:d}=Wn(),f=Ht(),[m,g]=j.useState(()=>localStorage.getItem("theme")==="dark"),[y,x]=j.useState(()=>localStorage.getItem("textSize")||"md"),[_,S]=j.useState(()=>localStorage.getItem("density")||"comfortable"),[b,k]=j.useState(()=>Hg(window.location.pathname)),[I,C]=j.useState(null),[N,O]=j.useState(null),[U,E]=j.useState({}),[L,R]=j.useState({}),[T,D]=j.useState({}),[Y,se]=j.useState({}),[H,J]=j.useState({}),[ee,he]=j.useState([]),[Z,oe]=j.useState(""),[ie,W]=j.useState({transactions:[],clients:[],providers:[],products:[],concepts:[],deposits:[]}),[B,le]=j.useState(!1),[ae,ge]=j.useState(window.matchMedia("(max-width: 980px)").matches),[_e,De]=j.useState(window.matchMedia("(max-width: 620px)").matches),[Te,Fe]=j.useState(!1),[mt,Kt]=j.useState(!1),[gn,os]=j.useState(!1),We=j.useRef(null),ls=j.useRef(null),cs=j.useRef(null),Hn=j.useRef(null),Tn=j.useRef(null),Ut=j.useRef(null),rn=j.useRef(null),yn=j.useRef(null),us=j.useRef(null),vn=j.useRef(null);j.useEffect(()=>{document.documentElement.setAttribute("data-theme",m?"dark":"light"),localStorage.setItem("theme",m?"dark":"light")},[m]),j.useEffect(()=>{document.documentElement.setAttribute("data-text-size",y),localStorage.setItem("textSize",y)},[y]),j.useEffect(()=>{document.documentElement.setAttribute("data-density",_),localStorage.setItem("density",_)},[_]),j.useEffect(()=>{let z=!0;return(async()=>{if(!e?.id){he([]);return}try{const Be=await sx();z&&he(Be)}catch{z&&he([])}})(),()=>{z=!1}},[e?.id]),j.useEffect(()=>{let z=!0;const xe=Z.trim();if(!n?.accountId||xe.length<2)return le(!1),W({transactions:[],clients:[],providers:[],products:[],concepts:[],deposits:[]}),()=>{z=!1};const Be=window.setTimeout(async()=>{try{le(!0);const Ve=await Dj({accountId:n.accountId,term:xe,limit:8});z&&W(Ve)}catch{z&&W({transactions:[],clients:[],providers:[],products:[],concepts:[],deposits:[]})}finally{z&&le(!1)}},280);return()=>{z=!1,window.clearTimeout(Be)}},[n?.accountId,Z]);const Gt=Yl.find(z=>z.id===b)??null,St=d.startsWith("/account"),Ot=j.useMemo(()=>d.startsWith("/clients")?{createPath:"/clients?create=1",createLabel:a("actions.newClient")}:d.startsWith("/providers")?{createPath:"/providers?create=1",createLabel:a("actions.newProvider")}:d.startsWith("/employees")?{createPath:"/employees?create=1",createLabel:a("actions.newEmployee")}:d.startsWith("/products")?{createPath:"/products?create=1",createLabel:a("actions.newProduct")}:d.startsWith("/payment-forms")?{createPath:"/payment-forms?create=1",createLabel:a("actions.newPaymentForm")}:d.startsWith("/bank-deposits")?{createPath:"/bank-deposits?create=1",createLabel:a("actions.newBankDeposit")}:d.startsWith("/bank-transfers")?{createPath:"/bank-transfers?create=1",createLabel:a("actions.newBankTransfer")}:d.startsWith("/internal-obligations")?{createPath:"/internal-obligations?create=1",createLabel:a("actions.newInternalObligation")}:d.startsWith("/income-concepts")?{createPath:"/income-concepts?create=1",createLabel:a("actions.newIncomeConcept")}:d.startsWith("/expense-concepts")?{createPath:"/expense-concepts?create=1",createLabel:a("actions.newExpenseConcept")}:d.startsWith("/concept-groups")?{createPath:"/concept-groups?create=1",createLabel:a("actions.newConceptGroup")}:d.startsWith("/sales")?{createPath:"/sales?create=1",createLabel:a("actions.newSale")}:d.startsWith("/purchases")?{createPath:"/purchases?create=1",createLabel:a("actions.newPurchase")}:d.startsWith("/expenses")?{createPath:"/expenses?create=1",createLabel:a("actions.newExpense")}:d.startsWith("/incomes")?{createPath:"/incomes?create=1",createLabel:a("actions.newIncome")}:d.startsWith("/projects")?{createPath:"/projects?create=1",createLabel:a("actions.newProject")}:d.startsWith("/budgets")?{createPath:"/budgets?create=1",createLabel:a("actions.newBudget")}:d.startsWith("/account")?{createPath:null,createLabel:null}:d.startsWith("/reports")?{createPath:null,createLabel:null}:{createPath:null,createLabel:null},[d,a]),xn=j.useMemo(()=>{const z=[];return Ot.createPath&&z.push({key:"create",label:Ot.createLabel,type:"link",to:Ot.createPath,main:!0,overflowable:!1}),z.push({key:"refresh",label:a("actions.refresh"),type:"button",onClick:()=>window.location.reload(),overflowable:!0}),z},[Ot,a]),bn=j.useMemo(()=>Gt?Gt.items.filter((z,xe)=>xe>0):[],[Gt]),gr=j.useMemo(()=>xn.filter(z=>z.overflowable),[xn]),an=!St&&!!Gt,Kn=Z.trim().length>=2,Os=j.useMemo(()=>[{key:"transactions",title:a("sidebar.transactions"),rows:(ie.transactions??[]).map(z=>({id:`tx-${z.id}`,title:z.name||`${a("sidebar.transactions")} #${z.id}`,subtitle:`${dt(z.date,l)}  ${z.referenceNumber||"-"}`,to:Vj(z)}))},{key:"clients",title:a("nav.clients"),rows:(ie.clients??[]).map(z=>({id:`client-${z.id}`,title:z.name||`#${z.id}`,subtitle:z.phone||z.address||"-",to:"/clients"}))},{key:"providers",title:a("nav.providers"),rows:(ie.providers??[]).map(z=>({id:`provider-${z.id}`,title:z.name||`#${z.id}`,subtitle:z.phone||z.address||"-",to:"/providers"}))},{key:"products",title:a("nav.products"),rows:(ie.products??[]).map(z=>({id:`product-${z.id}`,title:z.name||`#${z.id}`,subtitle:`ID ${z.id}`,to:"/products"}))},{key:"concepts",title:a("sidebar.concepts"),rows:(ie.concepts??[]).map(z=>({id:`concept-${z.id}`,title:z.name||`#${z.id}`,subtitle:`ID ${z.id}`,to:"/concept-groups"}))},{key:"deposits",title:a("nav.bankDeposits"),rows:(ie.deposits??[]).map(z=>({id:`deposit-${z.id}`,title:z.name||`${a("nav.bankDeposits")} #${z.id}`,subtitle:`${dt(z.date,l)}  ${z.referenceNumber||"-"}`,to:"/bank-deposits"}))}],[ie,a,l]),Jr=j.useMemo(()=>Os.reduce((z,xe)=>z+xe.rows.length,0),[Os]),gt=z=>{if(!z)return{};const xe=z.getBoundingClientRect(),Be=Math.min(320,window.innerWidth-16);let Ve=xe.left;Ve+Be>window.innerWidth-8&&(Ve=window.innerWidth-Be-8),Ve=Math.max(8,Ve);const wn=Math.max(8,Math.min(window.innerHeight-220,xe.bottom+8)),yr=xe.left+xe.width/2,Xr=Math.max(14,Math.min(Be-20,yr-Ve-7));return{left:`${Ve}px`,right:"auto",top:`${wn}px`,width:`${Be}px`,"--arrow-left":`${Xr}px`}},Rs=(z,xe)=>{if(N===z){O(null);return}E(gt(xe)),O(z)};j.useEffect(()=>{const z=()=>{const xe=window.matchMedia("(max-width: 980px)").matches,Be=window.matchMedia("(max-width: 620px)").matches;if(ge(xe),De(Be),We.current){const Ve=We.current.scrollWidth>We.current.clientWidth+4;Fe(Be||Ve)}else Fe(Be);if(ls.current){const Ve=ls.current.scrollWidth>ls.current.clientWidth+4;Kt(Be||Ve)}else Kt(Be);if(N==="sidebar-mobile"&&E(gt(cs.current)),N==="appmenu-overflow"&&E(gt(Hn.current)),N==="actions-overflow"&&E(gt(Tn.current)),I==="account-switch"&&R(gt(yn.current)),I==="notifications"&&D(gt(us.current)),I==="search"){const Ve=ae?rn.current:Ut.current;J(gt(Ve))}I==="user"&&se(gt(vn.current))};return z(),window.addEventListener("resize",z),window.addEventListener("scroll",z,!0),()=>{window.removeEventListener("resize",z),window.removeEventListener("scroll",z,!0)}},[N,I,Gt,ae]),j.useEffect(()=>{const z=Hg(d);z&&k(z)},[d]),j.useEffect(()=>{const z=()=>{C(null),O(null)};window.addEventListener("click",z);const xe=Be=>{Be.key==="Escape"&&z()};return document.addEventListener("keydown",xe),()=>{window.removeEventListener("click",z),document.removeEventListener("keydown",xe)}},[]);const Ms=async()=>{await t()},Gn=(z,xe)=>{if(xe.stopPropagation(),z==="account-switch"&&R(gt(yn.current)),z==="notifications"&&D(gt(us.current)),z==="search"){const Be=ae?rn.current:Ut.current;J(gt(Be))}z==="user"&&se(gt(vn.current)),C(Be=>Be===z?null:z),O(null)};return u.jsxs("div",{className:"app-shell",children:[u.jsxs("header",{className:"topbar",children:[u.jsx("div",{className:"topbar-left",children:u.jsx(st,{to:"/",className:"product-name",children:a("common.appName")})}),u.jsxs("label",{className:"search-wrap",htmlFor:"global-search",ref:Ut,onClick:z=>{z.stopPropagation();const xe=ae?rn.current:Ut.current;J(gt(xe)),C("search"),O(null)},children:[u.jsx("span",{className:"search-icon",children:u.jsx(jd,{})}),u.jsx("input",{id:"global-search",type:"text",placeholder:a("common.searchPlaceholder"),value:Z,onChange:z=>oe(z.target.value),onFocus:z=>{z.stopPropagation();const xe=ae?rn.current:Ut.current;J(gt(xe)),C("search"),O(null)}})]}),u.jsxs("div",{className:"topbar-right",children:[u.jsx("button",{className:"icon-btn mobile-search-btn",ref:rn,onClick:z=>Gn("search",z),"aria-label":a("common.searchPlaceholder"),children:u.jsx(jd,{})}),u.jsx("button",{className:"icon-btn",onClick:()=>f("/"),"aria-label":a("nav.dashboard"),children:u.jsx(R_,{})}),u.jsx("button",{className:"account-switch-btn",ref:yn,"data-tour":"topbar-account-switch",onClick:z=>Gn("account-switch",z),"aria-label":a("topbar.currentAccount"),title:a("topbar.currentAccount"),children:n?.accountName||a("topbar.currentAccount")}),u.jsxs("button",{className:"icon-btn",ref:us,onClick:z=>Gn("notifications",z),"aria-label":a("topbar.notifications"),children:[u.jsx(T_,{}),ee.length>0?u.jsx("span",{className:"notification-dot"}):null]}),u.jsx("div",{className:"user-menu-wrap",children:u.jsx("button",{className:"avatar-btn",ref:vn,"data-tour":"user-menu-button",onClick:z=>Gn("user",z),"aria-label":a("topbar.userMenu"),children:u.jsx(q_,{})})})]})]}),u.jsxs("div",{className:`floating-panel panel-right panel-anchor search-results-panel ${I==="search"?"open":""}`,style:H,onClick:z=>z.stopPropagation(),children:[u.jsx("h3",{children:a("common.searchPlaceholder")}),ae?u.jsxs("label",{className:"search-wrap search-wrap-panel",htmlFor:"global-search-mobile",children:[u.jsx("span",{className:"search-icon",children:u.jsx(jd,{})}),u.jsx("input",{id:"global-search-mobile",type:"text",placeholder:a("common.searchPlaceholder"),value:Z,onChange:z=>oe(z.target.value)})]}):null,u.jsx("div",{className:"search-results-content",children:Kn?B?u.jsx("p",{className:"search-empty-state",children:a("common.searching")}):Jr===0?u.jsx("p",{className:"search-empty-state",children:a("common.searchNoResults")}):Os.map(z=>z.rows.length>0?u.jsxs("section",{className:"search-result-group",children:[u.jsx("h4",{children:z.title}),u.jsx("div",{className:"search-result-list",children:z.rows.map(xe=>u.jsxs("button",{type:"button",className:"search-result-item",onClick:()=>{f(xe.to),C(null)},children:[u.jsx("span",{className:"search-result-title",children:xe.title}),u.jsx("span",{className:"search-result-subtitle",children:xe.subtitle})]},xe.id))})]},z.key):null):u.jsx("p",{className:"search-empty-state",children:a("common.searchTypeToStart")})})]}),u.jsxs("div",{className:`floating-panel panel-right panel-anchor ${I==="notifications"?"open":""}`,style:T,onClick:z=>z.stopPropagation(),children:[u.jsx("h3",{children:a("topbar.notifications")}),u.jsx("ul",{className:"panel-list",children:ee.length>0?u.jsxs(u.Fragment,{children:[u.jsxs("li",{children:[a("topbar.pendingInvitations")," (",ee.length,")"]}),u.jsx("li",{children:u.jsxs("button",{type:"button",className:"panel-action",onClick:()=>{f("/account/invitations"),C(null)},children:[u.jsx(gg,{})," ",a("topbar.goToInvitations")]})})]}):u.jsx("li",{children:a("topbar.noNotifications")})})]}),u.jsxs("div",{className:`floating-panel panel-right panel-anchor ${I==="account-switch"?"open":""}`,style:L,onClick:z=>z.stopPropagation(),children:[u.jsx("h3",{children:a("topbar.currentAccount")}),u.jsx("div",{className:"panel-list",children:s.length===0?u.jsx("span",{className:"panel-action disabled",children:a("common.empty")}):s.map(z=>u.jsxs("button",{type:"button",className:`panel-action ${n?.accountId===z.accountId?"active":""}`,onClick:()=>{r(z.accountId),C(null),window.location.assign("/")},children:[z.isOriginalAccount?null:u.jsx(Dv,{}),z.accountName||`${a("topbar.currentAccount")} #${z.accountId}`]},z.accountId))})]}),u.jsxs("div",{className:`floating-panel panel-right panel-anchor ${I==="user"?"open":""}`,style:Y,onClick:z=>z.stopPropagation(),children:[u.jsx("h3",{children:a("topbar.account")}),u.jsxs("ul",{className:"panel-list",children:[u.jsx("li",{children:e?.email}),n?.isOriginalAccount?u.jsx("li",{className:"panel-section-separator",children:u.jsxs("button",{type:"button",className:"panel-action",onClick:()=>{f("/account"),C(null)},children:[u.jsx(gg,{})," ",a("topbar.manageAccount")]})}):null,u.jsx("li",{children:u.jsxs("button",{type:"button",className:"panel-action",onClick:()=>g(z=>!z),"aria-label":a("topbar.theme"),children:[m?u.jsx(z_,{}):u.jsx(L_,{})," ",a("topbar.theme")]})}),u.jsx("li",{children:u.jsxs("label",{className:"field-block",children:[u.jsx("span",{children:a("common.language")}),u.jsxs("select",{id:"language-select",value:l,onChange:z=>c(z.target.value),children:[u.jsx("option",{value:"es",children:"ES"}),u.jsx("option",{value:"en",children:"EN"})]})]})}),u.jsx("li",{children:u.jsxs("label",{className:"field-block",children:[u.jsx("span",{children:a("topbar.textSize")}),u.jsxs("select",{value:y,onChange:z=>x(z.target.value),children:[u.jsx("option",{value:"sm",children:a("topbar.small")}),u.jsx("option",{value:"md",children:a("topbar.medium")}),u.jsx("option",{value:"lg",children:a("topbar.large")})]})]})}),u.jsx("li",{children:u.jsxs("label",{className:"field-block",children:[u.jsx("span",{children:a("topbar.density")}),u.jsxs("select",{value:_,onChange:z=>S(z.target.value),children:[u.jsx("option",{value:"compact",children:a("topbar.compact")}),u.jsx("option",{value:"comfortable",children:a("topbar.comfortable")})]})]})}),u.jsx("li",{children:u.jsx("button",{type:"button",className:"panel-action",onClick:Ms,children:a("common.logout")})})]})]}),u.jsxs("main",{className:"content",children:[!St&&u.jsxs("aside",{className:`sidebar-icons ${gn?"force-collapsed":""}`,"data-tour":"sidebar-icons",children:[u.jsxs("button",{type:"button",className:"sidebar-collapse-btn",onClick:()=>os(z=>!z),"aria-label":a(gn?"common.expand":"common.collapse"),title:a(gn?"common.expand":"common.collapse"),children:[u.jsx("span",{className:"side-icon-glyph",children:gn?u.jsx(A_,{}):u.jsx(N_,{})}),u.jsx("span",{className:"side-icon-label",children:a(gn?"common.expand":"common.collapse")})]}),Yl.map(z=>{const xe=b===z.id,Be=z.items?.[0]?.path??"/";return u.jsx("div",{className:"sidebar-group",children:u.jsxs(Fa,{to:Be,end:Be==="/",className:`side-icon group-root ${xe?"active":""}`,onClick:()=>{k(z.id)},children:[u.jsx("span",{className:"side-icon-glyph",children:u.jsx(z.icon,{})}),u.jsx("span",{className:"side-icon-label",children:a(z.titleKey)})]})},z.id)})]}),u.jsxs("section",{className:`workspace ${St?"account-mode":""}`,children:[an&&u.jsxs("div",{className:"app-menu","data-tour":"app-menu",children:[ae?u.jsx("button",{type:"button",className:"action-btn icon-only mobile-only",ref:cs,onClick:z=>{z.stopPropagation(),Rs("sidebar-mobile",cs.current)},"aria-label":"Mdulos",children:""}):null,u.jsx("div",{className:"app-menu-primary",ref:We,children:Gt?.items.map((z,xe)=>{const Be=xe>0;return Te&&Be&&!ae?null:u.jsx(Fa,{to:z.path,end:z.path==="/",className:({isActive:wn})=>`app-menu-entry ${wn?"active":""}`,children:a(z.key)},z.path)})}),u.jsx("button",{type:"button",className:"action-btn overflow-trigger-btn",ref:Hn,onClick:z=>{z.stopPropagation(),Rs("appmenu-overflow",Hn.current)},"aria-label":"Ms opciones de men",style:{display:!ae&&Te&&bn.length>0?"inline-flex":"none"},children:u.jsxs("span",{className:"overflow-more-btn",children:[a("common.more")," ",u.jsx(fg,{})]})})]}),!St&&u.jsxs("div",{className:"actions-menu","data-tour":"actions-menu",children:[u.jsx("div",{className:"actions-primary",ref:ls,children:xn.map(z=>mt&&z.overflowable?null:z.type==="link"?u.jsxs(st,{to:z.to,className:`action-btn ${z.main?"main":""}`,children:[z.main?u.jsx(F_,{}):null,z.label]},z.key):u.jsx("button",{type:"button",className:"action-btn overflowable",onClick:z.onClick,children:z.label},z.key))}),u.jsx("button",{type:"button",className:"action-btn overflow-trigger-btn",ref:Tn,onClick:z=>{z.stopPropagation(),Rs("actions-overflow",Tn.current)},"aria-label":"Ms acciones",style:{display:mt&&gr.length>0?"inline-flex":"none"},children:u.jsxs("span",{className:"overflow-more-btn",children:[a("common.more")," ",u.jsx(fg,{})]})})]}),u.jsxs("div",{className:`floating-panel panel-toolbar panel-anchor ${N==="sidebar-mobile"?"open":""}`,style:U,onClick:z=>z.stopPropagation(),children:[u.jsx("h3",{children:"Mdulos"}),u.jsx("nav",{className:"panel-list",children:Yl.map(z=>u.jsx("button",{type:"button",className:`panel-action ${b===z.id?"active":""}`,onClick:()=>{k(z.id);const xe=z.items?.[0]?.path;xe&&d!==xe&&f(xe),O(null)},children:a(z.titleKey)},z.id))})]}),u.jsxs("div",{className:`floating-panel panel-toolbar panel-anchor ${N==="appmenu-overflow"?"open":""}`,style:U,onClick:z=>z.stopPropagation(),children:[u.jsx("h3",{children:"Men"}),u.jsx("div",{className:"panel-list",children:bn.map(z=>u.jsx(Fa,{to:z.path,end:z.path==="/",className:({isActive:xe})=>`panel-action ${xe?"active":""}`,onClick:()=>O(null),children:a(z.key)},z.path))})]}),!St&&u.jsxs("div",{className:`floating-panel panel-toolbar panel-anchor ${N==="actions-overflow"?"open":""}`,style:U,onClick:z=>z.stopPropagation(),children:[u.jsx("h3",{children:"Acciones"}),u.jsx("div",{className:"panel-list",children:gr.map(z=>u.jsx("button",{type:"button",className:"panel-action",onClick:()=>{z.onClick?.(),O(null)},children:z.label},z.key))})]}),u.jsx("div",{className:"workspace-body single-column","data-tour":"workspace",children:St?u.jsx(ch,{}):u.jsx("section",{className:"generic-panel",children:u.jsx(ch,{})})})]})]}),u.jsx(Wj,{})]})}function Hj({children:t}){const{user:e,account:n,isLoading:s}=Oe(),{t:r}=Ee(),a=Wn();if(s)return u.jsx("p",{className:"screen-message",children:r("common.loading")});if(!e)return u.jsx(js,{to:"/login",replace:!0});const l=n?.trialEndsAt?new Date(n.trialEndsAt).getTime():null,c=l?Date.now()>l:!1,d=n?.billingStatus==="active",f=a.pathname.startsWith("/account");return c&&!d&&!f?u.jsx(js,{to:"/account/billing",replace:!0}):t}function Kj(){const{login:t,user:e}=Oe(),{t:n}=Ee(),[s,r]=j.useState({email:"",password:""}),[a,l]=j.useState(""),[c,d]=j.useState(!1);if(e)return u.jsx(js,{to:"/",replace:!0});const f=g=>{const{name:y,value:x}=g.target;r(_=>({..._,[y]:x}))},m=async g=>{g.preventDefault(),l(""),d(!0);try{await t(s)}catch{l(n("auth.invalidCredentials"))}finally{d(!1)}};return u.jsx("div",{className:"auth-page",children:u.jsxs("form",{className:"auth-card",onSubmit:m,children:[u.jsx("h1",{children:n("auth.loginTitle")}),u.jsx("label",{htmlFor:"email",children:n("auth.email")}),u.jsx("input",{id:"email",name:"email",type:"email",value:s.email,onChange:f,required:!0}),u.jsx("label",{htmlFor:"password",children:n("auth.password")}),u.jsx("input",{id:"password",name:"password",type:"password",value:s.password,onChange:f,required:!0}),a&&u.jsx("p",{className:"error-text",children:a}),u.jsx("button",{type:"submit",disabled:c,children:n("auth.login")}),u.jsx(st,{to:"/register",children:n("auth.goToRegister")})]})})}const Kg={fullName:"",companyName:"",email:"",password:"",countryCode:"",invitationId:""};function Gj(){const{register:t,user:e}=Oe(),{t:n}=Ee(),[s,r]=j.useState(Kg),[a,l]=j.useState(""),[c,d]=j.useState(""),[f,m]=j.useState(!1),[g,y]=j.useState(!1);if(j.useEffect(()=>{const S=navigator.language||"en-US",b=S.includes("-")?S.split("-")[1].toUpperCase():"US",k=new URLSearchParams(window.location.search),I=k.get("invitationId")||"",C=k.get("email")||"";y(!!(I&&C)),r(N=>({...N,countryCode:b,invitationId:I,email:C||N.email}))},[]),e)return u.jsx(js,{to:"/",replace:!0});const x=S=>{const{name:b,value:k}=S.target;r(I=>({...I,[b]:k}))},_=async S=>{S.preventDefault(),l(""),d(""),m(!0);try{await t(s),d(n("auth.registrationSuccess")),r(Kg)}catch{l(n("auth.genericError"))}finally{m(!1)}};return u.jsx("div",{className:"auth-page",children:u.jsxs("form",{className:"auth-card",onSubmit:_,children:[u.jsx("h1",{children:n("auth.registerTitle")}),u.jsx("label",{htmlFor:"fullName",children:n("auth.fullName")}),u.jsx("input",{id:"fullName",name:"fullName",value:s.fullName,onChange:x,required:!0}),u.jsx("label",{htmlFor:"companyName",children:n("auth.companyName")}),u.jsx("input",{id:"companyName",name:"companyName",value:s.companyName,onChange:x,required:!0}),u.jsx("label",{htmlFor:"email",children:n("auth.email")}),u.jsx("input",{id:"email",name:"email",type:"email",value:s.email,onChange:x,readOnly:g,required:!0}),u.jsx("label",{htmlFor:"password",children:n("auth.password")}),u.jsx("input",{id:"password",name:"password",type:"password",minLength:8,value:s.password,onChange:x,required:!0}),a&&u.jsx("p",{className:"error-text",children:a}),c&&u.jsx("p",{className:"success-text",children:c}),u.jsx("button",{type:"submit",disabled:f,children:n("auth.createAccount")}),u.jsx(st,{to:"/login",children:n("auth.goToLogin")})]})})}async function Yj(){let{data:{session:t}}=await G.auth.getSession();if((!t?.access_token||!t?.expires_at||t.expires_at*1e3<=Date.now()+6e4)&&(t=(await G.auth.refreshSession()).data.session),!t?.access_token)throw new Error("Missing auth session.");return t.access_token}async function Hh(t,e){const n="https://vpbokueczoylouivgnin.supabase.co",s="sb_publishable_qnne91NTAXswisfSQlObFg_NnwBiV9d",r=await Yj(),a=await fetch(`${n}/functions/v1/${t}`,{method:"POST",headers:{"Content-Type":"application/json",apikey:s,Authorization:`Bearer ${r}`},body:JSON.stringify(e)});let l;try{l=await a.json()}catch{l=null}if(!a.ok)throw new Error(l?.error??`Billing request failed (${a.status})`);if(!l?.success)throw new Error(l?.error??"Billing request failed.");return l}function Jj({accountId:t,appUrl:e}){return Hh("create-billing-checkout",{accountId:t,appUrl:e})}function Xj({accountId:t,appUrl:e}){return Hh("create-billing-portal",{accountId:t,appUrl:e})}function Kh({accountId:t}){return Hh("sync-billing-seats",{accountId:t})}function Qj(){const{t}=Ee(),{invitationId:e}=Vn(),{user:n,account:s,switchAccount:r,refreshAccounts:a}=Oe(),l=Ht(),[c,d]=j.useState(""),[f,m]=j.useState(!1),y=new URLSearchParams(window.location.search).get("email")||"";j.useEffect(()=>{if(!(!n?.email||!e||!y)){if(n.email.toLowerCase()!==y.toLowerCase()){d(t("admin.invitationEmailMismatch"));return}x()}},[n?.email,e,y]);const x=async()=>{try{m(!0);const _=await nx({invitationId:Number(e),email:y.toLowerCase()}),S=Number(_?.accountId||0);S&&(await Kh({accountId:S}).catch(()=>null),await a?.(),r?.(S)),l("/")}catch{d(t("common.genericSaveError"))}finally{m(!1)}};return u.jsx("div",{className:"auth-page",children:u.jsxs("div",{className:"auth-card",children:[u.jsx("h1",{children:t("admin.processInvitation")}),u.jsxs("p",{children:[t("admin.invitationId"),": ",u.jsx("strong",{children:e})]}),u.jsxs("p",{children:[t("common.email"),": ",u.jsx("strong",{children:y||"-"})]}),c&&u.jsx("p",{className:"error-text",children:c}),n?u.jsx("p",{children:t(f?"common.loading":"admin.processingInvitation")}):u.jsxs(u.Fragment,{children:[u.jsx("p",{children:t("admin.completeSignupFromInvitation")}),u.jsx(st,{to:`/register?invitationId=${e}&email=${encodeURIComponent(y)}`,children:t("auth.createAccount")})]})]})})}function fo(t){return t+.5|0}const ir=(t,e,n)=>Math.max(Math.min(t,n),e);function Oa(t){return ir(fo(t*2.55),0,255)}function ur(t){return ir(fo(t*255),0,255)}function ks(t){return ir(fo(t/2.55)/100,0,1)}function Gg(t){return ir(fo(t*100),0,100)}const In={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},kh=[..."0123456789ABCDEF"],Zj=t=>kh[t&15],eC=t=>kh[(t&240)>>4]+kh[t&15],Rl=t=>(t&240)>>4===(t&15),tC=t=>Rl(t.r)&&Rl(t.g)&&Rl(t.b)&&Rl(t.a);function nC(t){var e=t.length,n;return t[0]==="#"&&(e===4||e===5?n={r:255&In[t[1]]*17,g:255&In[t[2]]*17,b:255&In[t[3]]*17,a:e===5?In[t[4]]*17:255}:(e===7||e===9)&&(n={r:In[t[1]]<<4|In[t[2]],g:In[t[3]]<<4|In[t[4]],b:In[t[5]]<<4|In[t[6]],a:e===9?In[t[7]]<<4|In[t[8]]:255})),n}const sC=(t,e)=>t<255?e(t):"";function rC(t){var e=tC(t)?Zj:eC;return t?"#"+e(t.r)+e(t.g)+e(t.b)+sC(t.a,e):void 0}const iC=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function ix(t,e,n){const s=e*Math.min(n,1-n),r=(a,l=(a+t/30)%12)=>n-s*Math.max(Math.min(l-3,9-l,1),-1);return[r(0),r(8),r(4)]}function aC(t,e,n){const s=(r,a=(r+t/60)%6)=>n-n*e*Math.max(Math.min(a,4-a,1),0);return[s(5),s(3),s(1)]}function oC(t,e,n){const s=ix(t,1,.5);let r;for(e+n>1&&(r=1/(e+n),e*=r,n*=r),r=0;r<3;r++)s[r]*=1-e-n,s[r]+=e;return s}function lC(t,e,n,s,r){return t===r?(e-n)/s+(e<n?6:0):e===r?(n-t)/s+2:(t-e)/s+4}function Gh(t){const n=t.r/255,s=t.g/255,r=t.b/255,a=Math.max(n,s,r),l=Math.min(n,s,r),c=(a+l)/2;let d,f,m;return a!==l&&(m=a-l,f=c>.5?m/(2-a-l):m/(a+l),d=lC(n,s,r,m,a),d=d*60+.5),[d|0,f||0,c]}function Yh(t,e,n,s){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,n,s)).map(ur)}function Jh(t,e,n){return Yh(ix,t,e,n)}function cC(t,e,n){return Yh(oC,t,e,n)}function uC(t,e,n){return Yh(aC,t,e,n)}function ax(t){return(t%360+360)%360}function dC(t){const e=iC.exec(t);let n=255,s;if(!e)return;e[5]!==s&&(n=e[6]?Oa(+e[5]):ur(+e[5]));const r=ax(+e[2]),a=+e[3]/100,l=+e[4]/100;return e[1]==="hwb"?s=cC(r,a,l):e[1]==="hsv"?s=uC(r,a,l):s=Jh(r,a,l),{r:s[0],g:s[1],b:s[2],a:n}}function hC(t,e){var n=Gh(t);n[0]=ax(n[0]+e),n=Jh(n),t.r=n[0],t.g=n[1],t.b=n[2]}function fC(t){if(!t)return;const e=Gh(t),n=e[0],s=Gg(e[1]),r=Gg(e[2]);return t.a<255?`hsla(${n}, ${s}%, ${r}%, ${ks(t.a)})`:`hsl(${n}, ${s}%, ${r}%)`}const Yg={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},Jg={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function pC(){const t={},e=Object.keys(Jg),n=Object.keys(Yg);let s,r,a,l,c;for(s=0;s<e.length;s++){for(l=c=e[s],r=0;r<n.length;r++)a=n[r],c=c.replace(a,Yg[a]);a=parseInt(Jg[l],16),t[c]=[a>>16&255,a>>8&255,a&255]}return t}let Ml;function mC(t){Ml||(Ml=pC(),Ml.transparent=[0,0,0,0]);const e=Ml[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const gC=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function yC(t){const e=gC.exec(t);let n=255,s,r,a;if(e){if(e[7]!==s){const l=+e[7];n=e[8]?Oa(l):ir(l*255,0,255)}return s=+e[1],r=+e[3],a=+e[5],s=255&(e[2]?Oa(s):ir(s,0,255)),r=255&(e[4]?Oa(r):ir(r,0,255)),a=255&(e[6]?Oa(a):ir(a,0,255)),{r:s,g:r,b:a,a:n}}}function vC(t){return t&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${ks(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`)}const Rd=t=>t<=.0031308?t*12.92:Math.pow(t,1/2.4)*1.055-.055,Ci=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function xC(t,e,n){const s=Ci(ks(t.r)),r=Ci(ks(t.g)),a=Ci(ks(t.b));return{r:ur(Rd(s+n*(Ci(ks(e.r))-s))),g:ur(Rd(r+n*(Ci(ks(e.g))-r))),b:ur(Rd(a+n*(Ci(ks(e.b))-a))),a:t.a+n*(e.a-t.a)}}function Ll(t,e,n){if(t){let s=Gh(t);s[e]=Math.max(0,Math.min(s[e]+s[e]*n,e===0?360:1)),s=Jh(s),t.r=s[0],t.g=s[1],t.b=s[2]}}function ox(t,e){return t&&Object.assign(e||{},t)}function Xg(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=ur(t[3]))):(e=ox(t,{r:0,g:0,b:0,a:1}),e.a=ur(e.a)),e}function bC(t){return t.charAt(0)==="r"?yC(t):dC(t)}class eo{constructor(e){if(e instanceof eo)return e;const n=typeof e;let s;n==="object"?s=Xg(e):n==="string"&&(s=nC(e)||mC(e)||bC(e)),this._rgb=s,this._valid=!!s}get valid(){return this._valid}get rgb(){var e=ox(this._rgb);return e&&(e.a=ks(e.a)),e}set rgb(e){this._rgb=Xg(e)}rgbString(){return this._valid?vC(this._rgb):void 0}hexString(){return this._valid?rC(this._rgb):void 0}hslString(){return this._valid?fC(this._rgb):void 0}mix(e,n){if(e){const s=this.rgb,r=e.rgb;let a;const l=n===a?.5:n,c=2*l-1,d=s.a-r.a,f=((c*d===-1?c:(c+d)/(1+c*d))+1)/2;a=1-f,s.r=255&f*s.r+a*r.r+.5,s.g=255&f*s.g+a*r.g+.5,s.b=255&f*s.b+a*r.b+.5,s.a=l*s.a+(1-l)*r.a,this.rgb=s}return this}interpolate(e,n){return e&&(this._rgb=xC(this._rgb,e._rgb,n)),this}clone(){return new eo(this.rgb)}alpha(e){return this._rgb.a=ur(e),this}clearer(e){const n=this._rgb;return n.a*=1-e,this}greyscale(){const e=this._rgb,n=fo(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=n,this}opaquer(e){const n=this._rgb;return n.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return Ll(this._rgb,2,e),this}darken(e){return Ll(this._rgb,2,-e),this}saturate(e){return Ll(this._rgb,1,e),this}desaturate(e){return Ll(this._rgb,1,-e),this}rotate(e){return hC(this._rgb,e),this}}function bs(){}const wC=(()=>{let t=0;return()=>t++})();function Ae(t){return t==null}function et(t){if(Array.isArray&&Array.isArray(t))return!0;const e=Object.prototype.toString.call(t);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function Re(t){return t!==null&&Object.prototype.toString.call(t)==="[object Object]"}function ut(t){return(typeof t=="number"||t instanceof Number)&&isFinite(+t)}function hn(t,e){return ut(t)?t:e}function Pe(t,e){return typeof t>"u"?e:t}const _C=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100:+t/e,lx=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100*e:+t;function Ye(t,e,n){if(t&&typeof t.call=="function")return t.apply(n,e)}function He(t,e,n,s){let r,a,l;if(et(t))for(a=t.length,r=0;r<a;r++)e.call(n,t[r],r);else if(Re(t))for(l=Object.keys(t),a=l.length,r=0;r<a;r++)e.call(n,t[l[r]],l[r])}function ac(t,e){let n,s,r,a;if(!t||!e||t.length!==e.length)return!1;for(n=0,s=t.length;n<s;++n)if(r=t[n],a=e[n],r.datasetIndex!==a.datasetIndex||r.index!==a.index)return!1;return!0}function oc(t){if(et(t))return t.map(oc);if(Re(t)){const e=Object.create(null),n=Object.keys(t),s=n.length;let r=0;for(;r<s;++r)e[n[r]]=oc(t[n[r]]);return e}return t}function cx(t){return["__proto__","prototype","constructor"].indexOf(t)===-1}function SC(t,e,n,s){if(!cx(t))return;const r=e[t],a=n[t];Re(r)&&Re(a)?to(r,a,s):e[t]=oc(a)}function to(t,e,n){const s=et(e)?e:[e],r=s.length;if(!Re(t))return t;n=n||{};const a=n.merger||SC;let l;for(let c=0;c<r;++c){if(l=s[c],!Re(l))continue;const d=Object.keys(l);for(let f=0,m=d.length;f<m;++f)a(d[f],t,l,n)}return t}function za(t,e){return to(t,e,{merger:kC})}function kC(t,e,n){if(!cx(t))return;const s=e[t],r=n[t];Re(s)&&Re(r)?za(s,r):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=oc(r))}const Qg={"":t=>t,x:t=>t.x,y:t=>t.y};function jC(t){const e=t.split("."),n=[];let s="";for(const r of e)s+=r,s.endsWith("\\")?s=s.slice(0,-1)+".":(n.push(s),s="");return n}function CC(t){const e=jC(t);return n=>{for(const s of e){if(s==="")break;n=n&&n[s]}return n}}function dr(t,e){return(Qg[e]||(Qg[e]=CC(e)))(t)}function Xh(t){return t.charAt(0).toUpperCase()+t.slice(1)}const no=t=>typeof t<"u",hr=t=>typeof t=="function",Zg=(t,e)=>{if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0};function PC(t){return t.type==="mouseup"||t.type==="click"||t.type==="contextmenu"}const ze=Math.PI,Qe=2*ze,IC=Qe+ze,lc=Number.POSITIVE_INFINITY,EC=ze/180,pt=ze/2,Rr=ze/4,ey=ze*2/3,ar=Math.log10,rs=Math.sign;function Ua(t,e,n){return Math.abs(t-e)<n}function ty(t){const e=Math.round(t);t=Ua(t,e,t/1e3)?e:t;const n=Math.pow(10,Math.floor(ar(t))),s=t/n;return(s<=1?1:s<=2?2:s<=5?5:10)*n}function TC(t){const e=[],n=Math.sqrt(t);let s;for(s=1;s<n;s++)t%s===0&&(e.push(s),e.push(t/s));return n===(n|0)&&e.push(n),e.sort((r,a)=>r-a).pop(),e}function NC(t){return typeof t=="symbol"||typeof t=="object"&&t!==null&&!(Symbol.toPrimitive in t||"toString"in t||"valueOf"in t)}function Li(t){return!NC(t)&&!isNaN(parseFloat(t))&&isFinite(t)}function AC(t,e){const n=Math.round(t);return n-e<=t&&n+e>=t}function ux(t,e,n){let s,r,a;for(s=0,r=t.length;s<r;s++)a=t[s][n],isNaN(a)||(e.min=Math.min(e.min,a),e.max=Math.max(e.max,a))}function Un(t){return t*(ze/180)}function Qh(t){return t*(180/ze)}function ny(t){if(!ut(t))return;let e=1,n=0;for(;Math.round(t*e)/e!==t;)e*=10,n++;return n}function dx(t,e){const n=e.x-t.x,s=e.y-t.y,r=Math.sqrt(n*n+s*s);let a=Math.atan2(s,n);return a<-.5*ze&&(a+=Qe),{angle:a,distance:r}}function jh(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function OC(t,e){return(t-e+IC)%Qe-ze}function Bt(t){return(t%Qe+Qe)%Qe}function so(t,e,n,s){const r=Bt(t),a=Bt(e),l=Bt(n),c=Bt(a-r),d=Bt(l-r),f=Bt(r-a),m=Bt(r-l);return r===a||r===l||s&&a===l||c>d&&f<m}function Pt(t,e,n){return Math.max(e,Math.min(n,t))}function RC(t){return Pt(t,-32768,32767)}function Cs(t,e,n,s=1e-6){return t>=Math.min(e,n)-s&&t<=Math.max(e,n)+s}function Zh(t,e,n){n=n||(l=>t[l]<e);let s=t.length-1,r=0,a;for(;s-r>1;)a=r+s>>1,n(a)?r=a:s=a;return{lo:r,hi:s}}const Ps=(t,e,n,s)=>Zh(t,n,s?r=>{const a=t[r][e];return a<n||a===n&&t[r+1][e]===n}:r=>t[r][e]<n),MC=(t,e,n)=>Zh(t,n,s=>t[s][e]>=n);function LC(t,e,n){let s=0,r=t.length;for(;s<r&&t[s]<e;)s++;for(;r>s&&t[r-1]>n;)r--;return s>0||r<t.length?t.slice(s,r):t}const hx=["push","pop","shift","splice","unshift"];function DC(t,e){if(t._chartjs){t._chartjs.listeners.push(e);return}Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),hx.forEach(n=>{const s="_onData"+Xh(n),r=t[n];Object.defineProperty(t,n,{configurable:!0,enumerable:!1,value(...a){const l=r.apply(this,a);return t._chartjs.listeners.forEach(c=>{typeof c[s]=="function"&&c[s](...a)}),l}})})}function sy(t,e){const n=t._chartjs;if(!n)return;const s=n.listeners,r=s.indexOf(e);r!==-1&&s.splice(r,1),!(s.length>0)&&(hx.forEach(a=>{delete t[a]}),delete t._chartjs)}function fx(t){const e=new Set(t);return e.size===t.length?t:Array.from(e)}const px=(function(){return typeof window>"u"?function(t){return t()}:window.requestAnimationFrame})();function mx(t,e){let n=[],s=!1;return function(...r){n=r,s||(s=!0,px.call(window,()=>{s=!1,t.apply(e,n)}))}}function FC(t,e){let n;return function(...s){return e?(clearTimeout(n),n=setTimeout(t,e,s)):t.apply(this,s),e}}const ef=t=>t==="start"?"left":t==="end"?"right":"center",Ft=(t,e,n)=>t==="start"?e:t==="end"?n:(e+n)/2,BC=(t,e,n,s)=>t===(s?"left":"right")?n:t==="center"?(e+n)/2:e;function gx(t,e,n){const s=e.length;let r=0,a=s;if(t._sorted){const{iScale:l,vScale:c,_parsed:d}=t,f=t.dataset&&t.dataset.options?t.dataset.options.spanGaps:null,m=l.axis,{min:g,max:y,minDefined:x,maxDefined:_}=l.getUserBounds();if(x){if(r=Math.min(Ps(d,m,g).lo,n?s:Ps(e,m,l.getPixelForValue(g)).lo),f){const S=d.slice(0,r+1).reverse().findIndex(b=>!Ae(b[c.axis]));r-=Math.max(0,S)}r=Pt(r,0,s-1)}if(_){let S=Math.max(Ps(d,l.axis,y,!0).hi+1,n?0:Ps(e,m,l.getPixelForValue(y),!0).hi+1);if(f){const b=d.slice(S-1).findIndex(k=>!Ae(k[c.axis]));S+=Math.max(0,b)}a=Pt(S,r,s)-r}else a=s-r}return{start:r,count:a}}function yx(t){const{xScale:e,yScale:n,_scaleRanges:s}=t,r={xmin:e.min,xmax:e.max,ymin:n.min,ymax:n.max};if(!s)return t._scaleRanges=r,!0;const a=s.xmin!==e.min||s.xmax!==e.max||s.ymin!==n.min||s.ymax!==n.max;return Object.assign(s,r),a}const Dl=t=>t===0||t===1,ry=(t,e,n)=>-(Math.pow(2,10*(t-=1))*Math.sin((t-e)*Qe/n)),iy=(t,e,n)=>Math.pow(2,-10*t)*Math.sin((t-e)*Qe/n)+1,Wa={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>-Math.cos(t*pt)+1,easeOutSine:t=>Math.sin(t*pt),easeInOutSine:t=>-.5*(Math.cos(ze*t)-1),easeInExpo:t=>t===0?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>t===1?1:-Math.pow(2,-10*t)+1,easeInOutExpo:t=>Dl(t)?t:t<.5?.5*Math.pow(2,10*(t*2-1)):.5*(-Math.pow(2,-10*(t*2-1))+2),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>Dl(t)?t:ry(t,.075,.3),easeOutElastic:t=>Dl(t)?t:iy(t,.075,.3),easeInOutElastic(t){return Dl(t)?t:t<.5?.5*ry(t*2,.1125,.45):.5+.5*iy(t*2-1,.1125,.45)},easeInBack(t){return t*t*((1.70158+1)*t-1.70158)},easeOutBack(t){return(t-=1)*t*((1.70158+1)*t+1.70158)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?.5*(t*t*(((e*=1.525)+1)*t-e)):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},easeInBounce:t=>1-Wa.easeOutBounce(1-t),easeOutBounce(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInOutBounce:t=>t<.5?Wa.easeInBounce(t*2)*.5:Wa.easeOutBounce(t*2-1)*.5+.5};function tf(t){if(t&&typeof t=="object"){const e=t.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function ay(t){return tf(t)?t:new eo(t)}function Md(t){return tf(t)?t:new eo(t).saturate(.5).darken(.1).hexString()}const $C=["x","y","borderWidth","radius","tension"],zC=["color","borderColor","backgroundColor"];function UC(t){t.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),t.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),t.set("animations",{colors:{type:"color",properties:zC},numbers:{type:"number",properties:$C}}),t.describe("animations",{_fallback:"animation"}),t.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function WC(t){t.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const oy=new Map;function VC(t,e){e=e||{};const n=t+JSON.stringify(e);let s=oy.get(n);return s||(s=new Intl.NumberFormat(t,e),oy.set(n,s)),s}function po(t,e,n){return VC(e,n).format(t)}const vx={values(t){return et(t)?t:""+t},numeric(t,e,n){if(t===0)return"0";const s=this.chart.options.locale;let r,a=t;if(n.length>1){const f=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(f<1e-4||f>1e15)&&(r="scientific"),a=qC(t,n)}const l=ar(Math.abs(a)),c=isNaN(l)?1:Math.max(Math.min(-1*Math.floor(l),20),0),d={notation:r,minimumFractionDigits:c,maximumFractionDigits:c};return Object.assign(d,this.options.ticks.format),po(t,s,d)},logarithmic(t,e,n){if(t===0)return"0";const s=n[e].significand||t/Math.pow(10,Math.floor(ar(t)));return[1,2,3,5,10,15].includes(s)||e>.8*n.length?vx.numeric.call(this,t,e,n):""}};function qC(t,e){let n=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(n)>=1&&t!==Math.floor(t)&&(n=t-Math.floor(t)),n}var kc={formatters:vx};function HC(t){t.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,n)=>n.lineWidth,tickColor:(e,n)=>n.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:kc.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),t.route("scale.ticks","color","","color"),t.route("scale.grid","color","","borderColor"),t.route("scale.border","color","","borderColor"),t.route("scale.title","color","","color"),t.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),t.describe("scales",{_fallback:"scale"}),t.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const Kr=Object.create(null),Ch=Object.create(null);function Va(t,e){if(!e)return t;const n=e.split(".");for(let s=0,r=n.length;s<r;++s){const a=n[s];t=t[a]||(t[a]=Object.create(null))}return t}function Ld(t,e,n){return typeof e=="string"?to(Va(t,e),n):to(Va(t,""),e)}class KC{constructor(e,n){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=s=>s.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(s,r)=>Md(r.backgroundColor),this.hoverBorderColor=(s,r)=>Md(r.borderColor),this.hoverColor=(s,r)=>Md(r.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(n)}set(e,n){return Ld(this,e,n)}get(e){return Va(this,e)}describe(e,n){return Ld(Ch,e,n)}override(e,n){return Ld(Kr,e,n)}route(e,n,s,r){const a=Va(this,e),l=Va(this,s),c="_"+n;Object.defineProperties(a,{[c]:{value:a[n],writable:!0},[n]:{enumerable:!0,get(){const d=this[c],f=l[r];return Re(d)?Object.assign({},f,d):Pe(d,f)},set(d){this[c]=d}}})}apply(e){e.forEach(n=>n(this))}}var tt=new KC({_scriptable:t=>!t.startsWith("on"),_indexable:t=>t!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[UC,WC,HC]);function GC(t){return!t||Ae(t.size)||Ae(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}function cc(t,e,n,s,r){let a=e[r];return a||(a=e[r]=t.measureText(r).width,n.push(r)),a>s&&(s=a),s}function YC(t,e,n,s){s=s||{};let r=s.data=s.data||{},a=s.garbageCollect=s.garbageCollect||[];s.font!==e&&(r=s.data={},a=s.garbageCollect=[],s.font=e),t.save(),t.font=e;let l=0;const c=n.length;let d,f,m,g,y;for(d=0;d<c;d++)if(g=n[d],g!=null&&!et(g))l=cc(t,r,a,l,g);else if(et(g))for(f=0,m=g.length;f<m;f++)y=g[f],y!=null&&!et(y)&&(l=cc(t,r,a,l,y));t.restore();const x=a.length/2;if(x>n.length){for(d=0;d<x;d++)delete r[a[d]];a.splice(0,x)}return l}function Mr(t,e,n){const s=t.currentDevicePixelRatio,r=n!==0?Math.max(n/2,.5):0;return Math.round((e-r)*s)/s+r}function ly(t,e){!e&&!t||(e=e||t.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore())}function Ph(t,e,n,s){xx(t,e,n,s,null)}function xx(t,e,n,s,r){let a,l,c,d,f,m,g,y;const x=e.pointStyle,_=e.rotation,S=e.radius;let b=(_||0)*EC;if(x&&typeof x=="object"&&(a=x.toString(),a==="[object HTMLImageElement]"||a==="[object HTMLCanvasElement]")){t.save(),t.translate(n,s),t.rotate(b),t.drawImage(x,-x.width/2,-x.height/2,x.width,x.height),t.restore();return}if(!(isNaN(S)||S<=0)){switch(t.beginPath(),x){default:r?t.ellipse(n,s,r/2,S,0,0,Qe):t.arc(n,s,S,0,Qe),t.closePath();break;case"triangle":m=r?r/2:S,t.moveTo(n+Math.sin(b)*m,s-Math.cos(b)*S),b+=ey,t.lineTo(n+Math.sin(b)*m,s-Math.cos(b)*S),b+=ey,t.lineTo(n+Math.sin(b)*m,s-Math.cos(b)*S),t.closePath();break;case"rectRounded":f=S*.516,d=S-f,l=Math.cos(b+Rr)*d,g=Math.cos(b+Rr)*(r?r/2-f:d),c=Math.sin(b+Rr)*d,y=Math.sin(b+Rr)*(r?r/2-f:d),t.arc(n-g,s-c,f,b-ze,b-pt),t.arc(n+y,s-l,f,b-pt,b),t.arc(n+g,s+c,f,b,b+pt),t.arc(n-y,s+l,f,b+pt,b+ze),t.closePath();break;case"rect":if(!_){d=Math.SQRT1_2*S,m=r?r/2:d,t.rect(n-m,s-d,2*m,2*d);break}b+=Rr;case"rectRot":g=Math.cos(b)*(r?r/2:S),l=Math.cos(b)*S,c=Math.sin(b)*S,y=Math.sin(b)*(r?r/2:S),t.moveTo(n-g,s-c),t.lineTo(n+y,s-l),t.lineTo(n+g,s+c),t.lineTo(n-y,s+l),t.closePath();break;case"crossRot":b+=Rr;case"cross":g=Math.cos(b)*(r?r/2:S),l=Math.cos(b)*S,c=Math.sin(b)*S,y=Math.sin(b)*(r?r/2:S),t.moveTo(n-g,s-c),t.lineTo(n+g,s+c),t.moveTo(n+y,s-l),t.lineTo(n-y,s+l);break;case"star":g=Math.cos(b)*(r?r/2:S),l=Math.cos(b)*S,c=Math.sin(b)*S,y=Math.sin(b)*(r?r/2:S),t.moveTo(n-g,s-c),t.lineTo(n+g,s+c),t.moveTo(n+y,s-l),t.lineTo(n-y,s+l),b+=Rr,g=Math.cos(b)*(r?r/2:S),l=Math.cos(b)*S,c=Math.sin(b)*S,y=Math.sin(b)*(r?r/2:S),t.moveTo(n-g,s-c),t.lineTo(n+g,s+c),t.moveTo(n+y,s-l),t.lineTo(n-y,s+l);break;case"line":l=r?r/2:Math.cos(b)*S,c=Math.sin(b)*S,t.moveTo(n-l,s-c),t.lineTo(n+l,s+c);break;case"dash":t.moveTo(n,s),t.lineTo(n+Math.cos(b)*(r?r/2:S),s+Math.sin(b)*S);break;case!1:t.closePath();break}t.fill(),e.borderWidth>0&&t.stroke()}}function Is(t,e,n){return n=n||.5,!e||t&&t.x>e.left-n&&t.x<e.right+n&&t.y>e.top-n&&t.y<e.bottom+n}function jc(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function Cc(t){t.restore()}function JC(t,e,n,s,r){if(!e)return t.lineTo(n.x,n.y);if(r==="middle"){const a=(e.x+n.x)/2;t.lineTo(a,e.y),t.lineTo(a,n.y)}else r==="after"!=!!s?t.lineTo(e.x,n.y):t.lineTo(n.x,e.y);t.lineTo(n.x,n.y)}function XC(t,e,n,s){if(!e)return t.lineTo(n.x,n.y);t.bezierCurveTo(s?e.cp1x:e.cp2x,s?e.cp1y:e.cp2y,s?n.cp2x:n.cp1x,s?n.cp2y:n.cp1y,n.x,n.y)}function QC(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]),Ae(e.rotation)||t.rotate(e.rotation),e.color&&(t.fillStyle=e.color),e.textAlign&&(t.textAlign=e.textAlign),e.textBaseline&&(t.textBaseline=e.textBaseline)}function ZC(t,e,n,s,r){if(r.strikethrough||r.underline){const a=t.measureText(s),l=e-a.actualBoundingBoxLeft,c=e+a.actualBoundingBoxRight,d=n-a.actualBoundingBoxAscent,f=n+a.actualBoundingBoxDescent,m=r.strikethrough?(d+f)/2:f;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=r.decorationWidth||2,t.moveTo(l,m),t.lineTo(c,m),t.stroke()}}function eP(t,e){const n=t.fillStyle;t.fillStyle=e.color,t.fillRect(e.left,e.top,e.width,e.height),t.fillStyle=n}function Gr(t,e,n,s,r,a={}){const l=et(e)?e:[e],c=a.strokeWidth>0&&a.strokeColor!=="";let d,f;for(t.save(),t.font=r.string,QC(t,a),d=0;d<l.length;++d)f=l[d],a.backdrop&&eP(t,a.backdrop),c&&(a.strokeColor&&(t.strokeStyle=a.strokeColor),Ae(a.strokeWidth)||(t.lineWidth=a.strokeWidth),t.strokeText(f,n,s,a.maxWidth)),t.fillText(f,n,s,a.maxWidth),ZC(t,n,s,f,a),s+=Number(r.lineHeight);t.restore()}function ro(t,e){const{x:n,y:s,w:r,h:a,radius:l}=e;t.arc(n+l.topLeft,s+l.topLeft,l.topLeft,1.5*ze,ze,!0),t.lineTo(n,s+a-l.bottomLeft),t.arc(n+l.bottomLeft,s+a-l.bottomLeft,l.bottomLeft,ze,pt,!0),t.lineTo(n+r-l.bottomRight,s+a),t.arc(n+r-l.bottomRight,s+a-l.bottomRight,l.bottomRight,pt,0,!0),t.lineTo(n+r,s+l.topRight),t.arc(n+r-l.topRight,s+l.topRight,l.topRight,0,-pt,!0),t.lineTo(n+l.topLeft,s)}const tP=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,nP=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function sP(t,e){const n=(""+t).match(tP);if(!n||n[1]==="normal")return e*1.2;switch(t=+n[2],n[3]){case"px":return t;case"%":t/=100;break}return e*t}const rP=t=>+t||0;function nf(t,e){const n={},s=Re(e),r=s?Object.keys(e):e,a=Re(t)?s?l=>Pe(t[l],t[e[l]]):l=>t[l]:()=>t;for(const l of r)n[l]=rP(a(l));return n}function bx(t){return nf(t,{top:"y",right:"x",bottom:"y",left:"x"})}function qr(t){return nf(t,["topLeft","topRight","bottomLeft","bottomRight"])}function zt(t){const e=bx(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function _t(t,e){t=t||{},e=e||tt.font;let n=Pe(t.size,e.size);typeof n=="string"&&(n=parseInt(n,10));let s=Pe(t.style,e.style);s&&!(""+s).match(nP)&&(console.warn('Invalid font style specified: "'+s+'"'),s=void 0);const r={family:Pe(t.family,e.family),lineHeight:sP(Pe(t.lineHeight,e.lineHeight),n),size:n,style:s,weight:Pe(t.weight,e.weight),string:""};return r.string=GC(r),r}function Ra(t,e,n,s){let r,a,l;for(r=0,a=t.length;r<a;++r)if(l=t[r],l!==void 0&&l!==void 0)return l}function iP(t,e,n){const{min:s,max:r}=t,a=lx(e,(r-s)/2),l=(c,d)=>n&&c===0?0:c+d;return{min:l(s,-Math.abs(a)),max:l(r,a)}}function pr(t,e){return Object.assign(Object.create(t),e)}function sf(t,e=[""],n,s,r=()=>t[0]){const a=n||t;typeof s>"u"&&(s=kx("_fallback",t));const l={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:a,_fallback:s,_getTarget:r,override:c=>sf([c,...t],e,a,s)};return new Proxy(l,{deleteProperty(c,d){return delete c[d],delete c._keys,delete t[0][d],!0},get(c,d){return _x(c,d,()=>fP(d,e,t,c))},getOwnPropertyDescriptor(c,d){return Reflect.getOwnPropertyDescriptor(c._scopes[0],d)},getPrototypeOf(){return Reflect.getPrototypeOf(t[0])},has(c,d){return uy(c).includes(d)},ownKeys(c){return uy(c)},set(c,d,f){const m=c._storage||(c._storage=r());return c[d]=m[d]=f,delete c._keys,!0}})}function Di(t,e,n,s){const r={_cacheable:!1,_proxy:t,_context:e,_subProxy:n,_stack:new Set,_descriptors:wx(t,s),setContext:a=>Di(t,a,n,s),override:a=>Di(t.override(a),e,n,s)};return new Proxy(r,{deleteProperty(a,l){return delete a[l],delete t[l],!0},get(a,l,c){return _x(a,l,()=>oP(a,l,c))},getOwnPropertyDescriptor(a,l){return a._descriptors.allKeys?Reflect.has(t,l)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,l)},getPrototypeOf(){return Reflect.getPrototypeOf(t)},has(a,l){return Reflect.has(t,l)},ownKeys(){return Reflect.ownKeys(t)},set(a,l,c){return t[l]=c,delete a[l],!0}})}function wx(t,e={scriptable:!0,indexable:!0}){const{_scriptable:n=e.scriptable,_indexable:s=e.indexable,_allKeys:r=e.allKeys}=t;return{allKeys:r,scriptable:n,indexable:s,isScriptable:hr(n)?n:()=>n,isIndexable:hr(s)?s:()=>s}}const aP=(t,e)=>t?t+Xh(e):e,rf=(t,e)=>Re(e)&&t!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function _x(t,e,n){if(Object.prototype.hasOwnProperty.call(t,e)||e==="constructor")return t[e];const s=n();return t[e]=s,s}function oP(t,e,n){const{_proxy:s,_context:r,_subProxy:a,_descriptors:l}=t;let c=s[e];return hr(c)&&l.isScriptable(e)&&(c=lP(e,c,t,n)),et(c)&&c.length&&(c=cP(e,c,t,l.isIndexable)),rf(e,c)&&(c=Di(c,r,a&&a[e],l)),c}function lP(t,e,n,s){const{_proxy:r,_context:a,_subProxy:l,_stack:c}=n;if(c.has(t))throw new Error("Recursion detected: "+Array.from(c).join("->")+"->"+t);c.add(t);let d=e(a,l||s);return c.delete(t),rf(t,d)&&(d=af(r._scopes,r,t,d)),d}function cP(t,e,n,s){const{_proxy:r,_context:a,_subProxy:l,_descriptors:c}=n;if(typeof a.index<"u"&&s(t))return e[a.index%e.length];if(Re(e[0])){const d=e,f=r._scopes.filter(m=>m!==d);e=[];for(const m of d){const g=af(f,r,t,m);e.push(Di(g,a,l&&l[t],c))}}return e}function Sx(t,e,n){return hr(t)?t(e,n):t}const uP=(t,e)=>t===!0?e:typeof t=="string"?dr(e,t):void 0;function dP(t,e,n,s,r){for(const a of e){const l=uP(n,a);if(l){t.add(l);const c=Sx(l._fallback,n,r);if(typeof c<"u"&&c!==n&&c!==s)return c}else if(l===!1&&typeof s<"u"&&n!==s)return null}return!1}function af(t,e,n,s){const r=e._rootScopes,a=Sx(e._fallback,n,s),l=[...t,...r],c=new Set;c.add(s);let d=cy(c,l,n,a||n,s);return d===null||typeof a<"u"&&a!==n&&(d=cy(c,l,a,d,s),d===null)?!1:sf(Array.from(c),[""],r,a,()=>hP(e,n,s))}function cy(t,e,n,s,r){for(;n;)n=dP(t,e,n,s,r);return n}function hP(t,e,n){const s=t._getTarget();e in s||(s[e]={});const r=s[e];return et(r)&&Re(n)?n:r||{}}function fP(t,e,n,s){let r;for(const a of e)if(r=kx(aP(a,t),n),typeof r<"u")return rf(t,r)?af(n,s,t,r):r}function kx(t,e){for(const n of e){if(!n)continue;const s=n[t];if(typeof s<"u")return s}}function uy(t){let e=t._keys;return e||(e=t._keys=pP(t._scopes)),e}function pP(t){const e=new Set;for(const n of t)for(const s of Object.keys(n).filter(r=>!r.startsWith("_")))e.add(s);return Array.from(e)}function jx(t,e,n,s){const{iScale:r}=t,{key:a="r"}=this._parsing,l=new Array(s);let c,d,f,m;for(c=0,d=s;c<d;++c)f=c+n,m=e[f],l[c]={r:r.parse(dr(m,a),f)};return l}const mP=Number.EPSILON||1e-14,Fi=(t,e)=>e<t.length&&!t[e].skip&&t[e],Cx=t=>t==="x"?"y":"x";function gP(t,e,n,s){const r=t.skip?e:t,a=e,l=n.skip?e:n,c=jh(a,r),d=jh(l,a);let f=c/(c+d),m=d/(c+d);f=isNaN(f)?0:f,m=isNaN(m)?0:m;const g=s*f,y=s*m;return{previous:{x:a.x-g*(l.x-r.x),y:a.y-g*(l.y-r.y)},next:{x:a.x+y*(l.x-r.x),y:a.y+y*(l.y-r.y)}}}function yP(t,e,n){const s=t.length;let r,a,l,c,d,f=Fi(t,0);for(let m=0;m<s-1;++m)if(d=f,f=Fi(t,m+1),!(!d||!f)){if(Ua(e[m],0,mP)){n[m]=n[m+1]=0;continue}r=n[m]/e[m],a=n[m+1]/e[m],c=Math.pow(r,2)+Math.pow(a,2),!(c<=9)&&(l=3/Math.sqrt(c),n[m]=r*l*e[m],n[m+1]=a*l*e[m])}}function vP(t,e,n="x"){const s=Cx(n),r=t.length;let a,l,c,d=Fi(t,0);for(let f=0;f<r;++f){if(l=c,c=d,d=Fi(t,f+1),!c)continue;const m=c[n],g=c[s];l&&(a=(m-l[n])/3,c[`cp1${n}`]=m-a,c[`cp1${s}`]=g-a*e[f]),d&&(a=(d[n]-m)/3,c[`cp2${n}`]=m+a,c[`cp2${s}`]=g+a*e[f])}}function xP(t,e="x"){const n=Cx(e),s=t.length,r=Array(s).fill(0),a=Array(s);let l,c,d,f=Fi(t,0);for(l=0;l<s;++l)if(c=d,d=f,f=Fi(t,l+1),!!d){if(f){const m=f[e]-d[e];r[l]=m!==0?(f[n]-d[n])/m:0}a[l]=c?f?rs(r[l-1])!==rs(r[l])?0:(r[l-1]+r[l])/2:r[l-1]:r[l]}yP(t,r,a),vP(t,a,e)}function Fl(t,e,n){return Math.max(Math.min(t,n),e)}function bP(t,e){let n,s,r,a,l,c=Is(t[0],e);for(n=0,s=t.length;n<s;++n)l=a,a=c,c=n<s-1&&Is(t[n+1],e),a&&(r=t[n],l&&(r.cp1x=Fl(r.cp1x,e.left,e.right),r.cp1y=Fl(r.cp1y,e.top,e.bottom)),c&&(r.cp2x=Fl(r.cp2x,e.left,e.right),r.cp2y=Fl(r.cp2y,e.top,e.bottom)))}function wP(t,e,n,s,r){let a,l,c,d;if(e.spanGaps&&(t=t.filter(f=>!f.skip)),e.cubicInterpolationMode==="monotone")xP(t,r);else{let f=s?t[t.length-1]:t[0];for(a=0,l=t.length;a<l;++a)c=t[a],d=gP(f,c,t[Math.min(a+1,l-(s?0:1))%l],e.tension),c.cp1x=d.previous.x,c.cp1y=d.previous.y,c.cp2x=d.next.x,c.cp2y=d.next.y,f=c}e.capBezierPoints&&bP(t,n)}function of(){return typeof window<"u"&&typeof document<"u"}function lf(t){let e=t.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function uc(t,e,n){let s;return typeof t=="string"?(s=parseInt(t,10),t.indexOf("%")!==-1&&(s=s/100*e.parentNode[n])):s=t,s}const Pc=t=>t.ownerDocument.defaultView.getComputedStyle(t,null);function _P(t,e){return Pc(t).getPropertyValue(e)}const SP=["top","right","bottom","left"];function Hr(t,e,n){const s={};n=n?"-"+n:"";for(let r=0;r<4;r++){const a=SP[r];s[a]=parseFloat(t[e+"-"+a+n])||0}return s.width=s.left+s.right,s.height=s.top+s.bottom,s}const kP=(t,e,n)=>(t>0||e>0)&&(!n||!n.shadowRoot);function jP(t,e){const n=t.touches,s=n&&n.length?n[0]:t,{offsetX:r,offsetY:a}=s;let l=!1,c,d;if(kP(r,a,t.target))c=r,d=a;else{const f=e.getBoundingClientRect();c=s.clientX-f.left,d=s.clientY-f.top,l=!0}return{x:c,y:d,box:l}}function Br(t,e){if("native"in t)return t;const{canvas:n,currentDevicePixelRatio:s}=e,r=Pc(n),a=r.boxSizing==="border-box",l=Hr(r,"padding"),c=Hr(r,"border","width"),{x:d,y:f,box:m}=jP(t,n),g=l.left+(m&&c.left),y=l.top+(m&&c.top);let{width:x,height:_}=e;return a&&(x-=l.width+c.width,_-=l.height+c.height),{x:Math.round((d-g)/x*n.width/s),y:Math.round((f-y)/_*n.height/s)}}function CP(t,e,n){let s,r;if(e===void 0||n===void 0){const a=t&&lf(t);if(!a)e=t.clientWidth,n=t.clientHeight;else{const l=a.getBoundingClientRect(),c=Pc(a),d=Hr(c,"border","width"),f=Hr(c,"padding");e=l.width-f.width-d.width,n=l.height-f.height-d.height,s=uc(c.maxWidth,a,"clientWidth"),r=uc(c.maxHeight,a,"clientHeight")}}return{width:e,height:n,maxWidth:s||lc,maxHeight:r||lc}}const or=t=>Math.round(t*10)/10;function PP(t,e,n,s){const r=Pc(t),a=Hr(r,"margin"),l=uc(r.maxWidth,t,"clientWidth")||lc,c=uc(r.maxHeight,t,"clientHeight")||lc,d=CP(t,e,n);let{width:f,height:m}=d;if(r.boxSizing==="content-box"){const y=Hr(r,"border","width"),x=Hr(r,"padding");f-=x.width+y.width,m-=x.height+y.height}return f=Math.max(0,f-a.width),m=Math.max(0,s?f/s:m-a.height),f=or(Math.min(f,l,d.maxWidth)),m=or(Math.min(m,c,d.maxHeight)),f&&!m&&(m=or(f/2)),(e!==void 0||n!==void 0)&&s&&d.height&&m>d.height&&(m=d.height,f=or(Math.floor(m*s))),{width:f,height:m}}function dy(t,e,n){const s=e||1,r=or(t.height*s),a=or(t.width*s);t.height=or(t.height),t.width=or(t.width);const l=t.canvas;return l.style&&(n||!l.style.height&&!l.style.width)&&(l.style.height=`${t.height}px`,l.style.width=`${t.width}px`),t.currentDevicePixelRatio!==s||l.height!==r||l.width!==a?(t.currentDevicePixelRatio=s,l.height=r,l.width=a,t.ctx.setTransform(s,0,0,s,0,0),!0):!1}const IP=(function(){let t=!1;try{const e={get passive(){return t=!0,!1}};of()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return t})();function hy(t,e){const n=_P(t,e),s=n&&n.match(/^(\d+)(\.\d+)?px$/);return s?+s[1]:void 0}function $r(t,e,n,s){return{x:t.x+n*(e.x-t.x),y:t.y+n*(e.y-t.y)}}function EP(t,e,n,s){return{x:t.x+n*(e.x-t.x),y:s==="middle"?n<.5?t.y:e.y:s==="after"?n<1?t.y:e.y:n>0?e.y:t.y}}function TP(t,e,n,s){const r={x:t.cp2x,y:t.cp2y},a={x:e.cp1x,y:e.cp1y},l=$r(t,r,n),c=$r(r,a,n),d=$r(a,e,n),f=$r(l,c,n),m=$r(c,d,n);return $r(f,m,n)}const NP=function(t,e){return{x(n){return t+t+e-n},setWidth(n){e=n},textAlign(n){return n==="center"?n:n==="right"?"left":"right"},xPlus(n,s){return n-s},leftForLtr(n,s){return n-s}}},AP=function(){return{x(t){return t},setWidth(t){},textAlign(t){return t},xPlus(t,e){return t+e},leftForLtr(t,e){return t}}};function Oi(t,e,n){return t?NP(e,n):AP()}function Px(t,e){let n,s;(e==="ltr"||e==="rtl")&&(n=t.canvas.style,s=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",e,"important"),t.prevTextDirection=s)}function Ix(t,e){e!==void 0&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}function Ex(t){return t==="angle"?{between:so,compare:OC,normalize:Bt}:{between:Cs,compare:(e,n)=>e-n,normalize:e=>e}}function fy({start:t,end:e,count:n,loop:s,style:r}){return{start:t%n,end:e%n,loop:s&&(e-t+1)%n===0,style:r}}function OP(t,e,n){const{property:s,start:r,end:a}=n,{between:l,normalize:c}=Ex(s),d=e.length;let{start:f,end:m,loop:g}=t,y,x;if(g){for(f+=d,m+=d,y=0,x=d;y<x&&l(c(e[f%d][s]),r,a);++y)f--,m--;f%=d,m%=d}return m<f&&(m+=d),{start:f,end:m,loop:g,style:t.style}}function Tx(t,e,n){if(!n)return[t];const{property:s,start:r,end:a}=n,l=e.length,{compare:c,between:d,normalize:f}=Ex(s),{start:m,end:g,loop:y,style:x}=OP(t,e,n),_=[];let S=!1,b=null,k,I,C;const N=()=>d(r,C,k)&&c(r,C)!==0,O=()=>c(a,k)===0||d(a,C,k),U=()=>S||N(),E=()=>!S||O();for(let L=m,R=m;L<=g;++L)I=e[L%l],!I.skip&&(k=f(I[s]),k!==C&&(S=d(k,r,a),b===null&&U()&&(b=c(k,r)===0?L:R),b!==null&&E()&&(_.push(fy({start:b,end:L,loop:y,count:l,style:x})),b=null),R=L,C=k));return b!==null&&_.push(fy({start:b,end:g,loop:y,count:l,style:x})),_}function Nx(t,e){const n=[],s=t.segments;for(let r=0;r<s.length;r++){const a=Tx(s[r],t.points,e);a.length&&n.push(...a)}return n}function RP(t,e,n,s){let r=0,a=e-1;if(n&&!s)for(;r<e&&!t[r].skip;)r++;for(;r<e&&t[r].skip;)r++;for(r%=e,n&&(a+=r);a>r&&t[a%e].skip;)a--;return a%=e,{start:r,end:a}}function MP(t,e,n,s){const r=t.length,a=[];let l=e,c=t[e],d;for(d=e+1;d<=n;++d){const f=t[d%r];f.skip||f.stop?c.skip||(s=!1,a.push({start:e%r,end:(d-1)%r,loop:s}),e=l=f.stop?d:null):(l=d,c.skip&&(e=d)),c=f}return l!==null&&a.push({start:e%r,end:l%r,loop:s}),a}function LP(t,e){const n=t.points,s=t.options.spanGaps,r=n.length;if(!r)return[];const a=!!t._loop,{start:l,end:c}=RP(n,r,a,s);if(s===!0)return py(t,[{start:l,end:c,loop:a}],n,e);const d=c<l?c+r:c,f=!!t._fullLoop&&l===0&&c===r-1;return py(t,MP(n,l,d,f),n,e)}function py(t,e,n,s){return!s||!s.setContext||!n?e:DP(t,e,n,s)}function DP(t,e,n,s){const r=t._chart.getContext(),a=my(t.options),{_datasetIndex:l,options:{spanGaps:c}}=t,d=n.length,f=[];let m=a,g=e[0].start,y=g;function x(_,S,b,k){const I=c?-1:1;if(_!==S){for(_+=d;n[_%d].skip;)_-=I;for(;n[S%d].skip;)S+=I;_%d!==S%d&&(f.push({start:_%d,end:S%d,loop:b,style:k}),m=k,g=S%d)}}for(const _ of e){g=c?g:_.start;let S=n[g%d],b;for(y=g+1;y<=_.end;y++){const k=n[y%d];b=my(s.setContext(pr(r,{type:"segment",p0:S,p1:k,p0DataIndex:(y-1)%d,p1DataIndex:y%d,datasetIndex:l}))),FP(b,m)&&x(g,y-1,_.loop,m),S=k,m=b}g<y-1&&x(g,y-1,_.loop,m)}return f}function my(t){return{backgroundColor:t.backgroundColor,borderCapStyle:t.borderCapStyle,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderJoinStyle:t.borderJoinStyle,borderWidth:t.borderWidth,borderColor:t.borderColor}}function FP(t,e){if(!e)return!1;const n=[],s=function(r,a){return tf(a)?(n.includes(a)||n.push(a),n.indexOf(a)):a};return JSON.stringify(t,s)!==JSON.stringify(e,s)}function Bl(t,e,n){return t.options.clip?t[n]:e[n]}function BP(t,e){const{xScale:n,yScale:s}=t;return n&&s?{left:Bl(n,e,"left"),right:Bl(n,e,"right"),top:Bl(s,e,"top"),bottom:Bl(s,e,"bottom")}:e}function Ax(t,e){const n=e._clip;if(n.disabled)return!1;const s=BP(e,t.chartArea);return{left:n.left===!1?0:s.left-(n.left===!0?0:n.left),right:n.right===!1?t.width:s.right+(n.right===!0?0:n.right),top:n.top===!1?0:s.top-(n.top===!0?0:n.top),bottom:n.bottom===!1?t.height:s.bottom+(n.bottom===!0?0:n.bottom)}}class $P{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,n,s,r){const a=n.listeners[r],l=n.duration;a.forEach(c=>c({chart:e,initial:n.initial,numSteps:l,currentStep:Math.min(s-n.start,l)}))}_refresh(){this._request||(this._running=!0,this._request=px.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let n=0;this._charts.forEach((s,r)=>{if(!s.running||!s.items.length)return;const a=s.items;let l=a.length-1,c=!1,d;for(;l>=0;--l)d=a[l],d._active?(d._total>s.duration&&(s.duration=d._total),d.tick(e),c=!0):(a[l]=a[a.length-1],a.pop());c&&(r.draw(),this._notify(r,s,e,"progress")),a.length||(s.running=!1,this._notify(r,s,e,"complete"),s.initial=!1),n+=a.length}),this._lastDate=e,n===0&&(this._running=!1)}_getAnims(e){const n=this._charts;let s=n.get(e);return s||(s={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},n.set(e,s)),s}listen(e,n,s){this._getAnims(e).listeners[n].push(s)}add(e,n){!n||!n.length||this._getAnims(e).items.push(...n)}has(e){return this._getAnims(e).items.length>0}start(e){const n=this._charts.get(e);n&&(n.running=!0,n.start=Date.now(),n.duration=n.items.reduce((s,r)=>Math.max(s,r._duration),0),this._refresh())}running(e){if(!this._running)return!1;const n=this._charts.get(e);return!(!n||!n.running||!n.items.length)}stop(e){const n=this._charts.get(e);if(!n||!n.items.length)return;const s=n.items;let r=s.length-1;for(;r>=0;--r)s[r].cancel();n.items=[],this._notify(e,n,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var ws=new $P;const gy="transparent",zP={boolean(t,e,n){return n>.5?e:t},color(t,e,n){const s=ay(t||gy),r=s.valid&&ay(e||gy);return r&&r.valid?r.mix(s,n).hexString():e},number(t,e,n){return t+(e-t)*n}};class UP{constructor(e,n,s,r){const a=n[s];r=Ra([e.to,r,a,e.from]);const l=Ra([e.from,a,r]);this._active=!0,this._fn=e.fn||zP[e.type||typeof l],this._easing=Wa[e.easing]||Wa.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=n,this._prop=s,this._from=l,this._to=r,this._promises=void 0}active(){return this._active}update(e,n,s){if(this._active){this._notify(!1);const r=this._target[this._prop],a=s-this._start,l=this._duration-a;this._start=s,this._duration=Math.floor(Math.max(l,e.duration)),this._total+=a,this._loop=!!e.loop,this._to=Ra([e.to,n,r,e.from]),this._from=Ra([e.from,r,n])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const n=e-this._start,s=this._duration,r=this._prop,a=this._from,l=this._loop,c=this._to;let d;if(this._active=a!==c&&(l||n<s),!this._active){this._target[r]=c,this._notify(!0);return}if(n<0){this._target[r]=a;return}d=n/s%2,d=l&&d>1?2-d:d,d=this._easing(Math.min(1,Math.max(0,d))),this._target[r]=this._fn(a,c,d)}wait(){const e=this._promises||(this._promises=[]);return new Promise((n,s)=>{e.push({res:n,rej:s})})}_notify(e){const n=e?"res":"rej",s=this._promises||[];for(let r=0;r<s.length;r++)s[r][n]()}}class Ox{constructor(e,n){this._chart=e,this._properties=new Map,this.configure(n)}configure(e){if(!Re(e))return;const n=Object.keys(tt.animation),s=this._properties;Object.getOwnPropertyNames(e).forEach(r=>{const a=e[r];if(!Re(a))return;const l={};for(const c of n)l[c]=a[c];(et(a.properties)&&a.properties||[r]).forEach(c=>{(c===r||!s.has(c))&&s.set(c,l)})})}_animateOptions(e,n){const s=n.options,r=VP(e,s);if(!r)return[];const a=this._createAnimations(r,s);return s.$shared&&WP(e.options.$animations,s).then(()=>{e.options=s},()=>{}),a}_createAnimations(e,n){const s=this._properties,r=[],a=e.$animations||(e.$animations={}),l=Object.keys(n),c=Date.now();let d;for(d=l.length-1;d>=0;--d){const f=l[d];if(f.charAt(0)==="$")continue;if(f==="options"){r.push(...this._animateOptions(e,n));continue}const m=n[f];let g=a[f];const y=s.get(f);if(g)if(y&&g.active()){g.update(y,m,c);continue}else g.cancel();if(!y||!y.duration){e[f]=m;continue}a[f]=g=new UP(y,e,f,m),r.push(g)}return r}update(e,n){if(this._properties.size===0){Object.assign(e,n);return}const s=this._createAnimations(e,n);if(s.length)return ws.add(this._chart,s),!0}}function WP(t,e){const n=[],s=Object.keys(e);for(let r=0;r<s.length;r++){const a=t[s[r]];a&&a.active()&&n.push(a.wait())}return Promise.all(n)}function VP(t,e){if(!e)return;let n=t.options;if(!n){t.options=e;return}return n.$shared&&(t.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n}function yy(t,e){const n=t&&t.options||{},s=n.reverse,r=n.min===void 0?e:0,a=n.max===void 0?e:0;return{start:s?a:r,end:s?r:a}}function qP(t,e,n){if(n===!1)return!1;const s=yy(t,n),r=yy(e,n);return{top:r.end,right:s.end,bottom:r.start,left:s.start}}function HP(t){let e,n,s,r;return Re(t)?(e=t.top,n=t.right,s=t.bottom,r=t.left):e=n=s=r=t,{top:e,right:n,bottom:s,left:r,disabled:t===!1}}function Rx(t,e){const n=[],s=t._getSortedDatasetMetas(e);let r,a;for(r=0,a=s.length;r<a;++r)n.push(s[r].index);return n}function vy(t,e,n,s={}){const r=t.keys,a=s.mode==="single";let l,c,d,f;if(e===null)return;let m=!1;for(l=0,c=r.length;l<c;++l){if(d=+r[l],d===n){if(m=!0,s.all)continue;break}f=t.values[d],ut(f)&&(a||e===0||rs(e)===rs(f))&&(e+=f)}return!m&&!s.all?0:e}function KP(t,e){const{iScale:n,vScale:s}=e,r=n.axis==="x"?"x":"y",a=s.axis==="x"?"x":"y",l=Object.keys(t),c=new Array(l.length);let d,f,m;for(d=0,f=l.length;d<f;++d)m=l[d],c[d]={[r]:m,[a]:t[m]};return c}function Dd(t,e){const n=t&&t.options.stacked;return n||n===void 0&&e.stack!==void 0}function GP(t,e,n){return`${t.id}.${e.id}.${n.stack||n.type}`}function YP(t){const{min:e,max:n,minDefined:s,maxDefined:r}=t.getUserBounds();return{min:s?e:Number.NEGATIVE_INFINITY,max:r?n:Number.POSITIVE_INFINITY}}function JP(t,e,n){const s=t[e]||(t[e]={});return s[n]||(s[n]={})}function xy(t,e,n,s){for(const r of e.getMatchingVisibleMetas(s).reverse()){const a=t[r.index];if(n&&a>0||!n&&a<0)return r.index}return null}function by(t,e){const{chart:n,_cachedMeta:s}=t,r=n._stacks||(n._stacks={}),{iScale:a,vScale:l,index:c}=s,d=a.axis,f=l.axis,m=GP(a,l,s),g=e.length;let y;for(let x=0;x<g;++x){const _=e[x],{[d]:S,[f]:b}=_,k=_._stacks||(_._stacks={});y=k[f]=JP(r,m,S),y[c]=b,y._top=xy(y,l,!0,s.type),y._bottom=xy(y,l,!1,s.type);const I=y._visualValues||(y._visualValues={});I[c]=b}}function Fd(t,e){const n=t.scales;return Object.keys(n).filter(s=>n[s].axis===e).shift()}function XP(t,e){return pr(t,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function QP(t,e,n){return pr(t,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:n,index:e,mode:"default",type:"data"})}function ka(t,e){const n=t.controller.index,s=t.vScale&&t.vScale.axis;if(s){e=e||t._parsed;for(const r of e){const a=r._stacks;if(!a||a[s]===void 0||a[s][n]===void 0)return;delete a[s][n],a[s]._visualValues!==void 0&&a[s]._visualValues[n]!==void 0&&delete a[s]._visualValues[n]}}}const Bd=t=>t==="reset"||t==="none",wy=(t,e)=>e?t:Object.assign({},t),ZP=(t,e,n)=>t&&!e.hidden&&e._stacked&&{keys:Rx(n,!0),values:null};class mr{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(e,n){this.chart=e,this._ctx=e.ctx,this.index=n,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=Dd(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&ka(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,n=this._cachedMeta,s=this.getDataset(),r=(g,y,x,_)=>g==="x"?y:g==="r"?_:x,a=n.xAxisID=Pe(s.xAxisID,Fd(e,"x")),l=n.yAxisID=Pe(s.yAxisID,Fd(e,"y")),c=n.rAxisID=Pe(s.rAxisID,Fd(e,"r")),d=n.indexAxis,f=n.iAxisID=r(d,a,l,c),m=n.vAxisID=r(d,l,a,c);n.xScale=this.getScaleForId(a),n.yScale=this.getScaleForId(l),n.rScale=this.getScaleForId(c),n.iScale=this.getScaleForId(f),n.vScale=this.getScaleForId(m)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const n=this._cachedMeta;return e===n.iScale?n.vScale:n.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&sy(this._data,this),e._stacked&&ka(e)}_dataCheck(){const e=this.getDataset(),n=e.data||(e.data=[]),s=this._data;if(Re(n)){const r=this._cachedMeta;this._data=KP(n,r)}else if(s!==n){if(s){sy(s,this);const r=this._cachedMeta;ka(r),r._parsed=[]}n&&Object.isExtensible(n)&&DC(n,this),this._syncList=[],this._data=n}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const n=this._cachedMeta,s=this.getDataset();let r=!1;this._dataCheck();const a=n._stacked;n._stacked=Dd(n.vScale,n),n.stack!==s.stack&&(r=!0,ka(n),n.stack=s.stack),this._resyncElements(e),(r||a!==n._stacked)&&(by(this,n._parsed),n._stacked=Dd(n.vScale,n))}configure(){const e=this.chart.config,n=e.datasetScopeKeys(this._type),s=e.getOptionScopes(this.getDataset(),n,!0);this.options=e.createResolver(s,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,n){const{_cachedMeta:s,_data:r}=this,{iScale:a,_stacked:l}=s,c=a.axis;let d=e===0&&n===r.length?!0:s._sorted,f=e>0&&s._parsed[e-1],m,g,y;if(this._parsing===!1)s._parsed=r,s._sorted=!0,y=r;else{et(r[e])?y=this.parseArrayData(s,r,e,n):Re(r[e])?y=this.parseObjectData(s,r,e,n):y=this.parsePrimitiveData(s,r,e,n);const x=()=>g[c]===null||f&&g[c]<f[c];for(m=0;m<n;++m)s._parsed[m+e]=g=y[m],d&&(x()&&(d=!1),f=g);s._sorted=d}l&&by(this,y)}parsePrimitiveData(e,n,s,r){const{iScale:a,vScale:l}=e,c=a.axis,d=l.axis,f=a.getLabels(),m=a===l,g=new Array(r);let y,x,_;for(y=0,x=r;y<x;++y)_=y+s,g[y]={[c]:m||a.parse(f[_],_),[d]:l.parse(n[_],_)};return g}parseArrayData(e,n,s,r){const{xScale:a,yScale:l}=e,c=new Array(r);let d,f,m,g;for(d=0,f=r;d<f;++d)m=d+s,g=n[m],c[d]={x:a.parse(g[0],m),y:l.parse(g[1],m)};return c}parseObjectData(e,n,s,r){const{xScale:a,yScale:l}=e,{xAxisKey:c="x",yAxisKey:d="y"}=this._parsing,f=new Array(r);let m,g,y,x;for(m=0,g=r;m<g;++m)y=m+s,x=n[y],f[m]={x:a.parse(dr(x,c),y),y:l.parse(dr(x,d),y)};return f}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,n,s){const r=this.chart,a=this._cachedMeta,l=n[e.axis],c={keys:Rx(r,!0),values:n._stacks[e.axis]._visualValues};return vy(c,l,a.index,{mode:s})}updateRangeFromParsed(e,n,s,r){const a=s[n.axis];let l=a===null?NaN:a;const c=r&&s._stacks[n.axis];r&&c&&(r.values=c,l=vy(r,a,this._cachedMeta.index)),e.min=Math.min(e.min,l),e.max=Math.max(e.max,l)}getMinMax(e,n){const s=this._cachedMeta,r=s._parsed,a=s._sorted&&e===s.iScale,l=r.length,c=this._getOtherScale(e),d=ZP(n,s,this.chart),f={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:m,max:g}=YP(c);let y,x;function _(){x=r[y];const S=x[c.axis];return!ut(x[e.axis])||m>S||g<S}for(y=0;y<l&&!(!_()&&(this.updateRangeFromParsed(f,e,x,d),a));++y);if(a){for(y=l-1;y>=0;--y)if(!_()){this.updateRangeFromParsed(f,e,x,d);break}}return f}getAllParsedValues(e){const n=this._cachedMeta._parsed,s=[];let r,a,l;for(r=0,a=n.length;r<a;++r)l=n[r][e.axis],ut(l)&&s.push(l);return s}getMaxOverflow(){return!1}getLabelAndValue(e){const n=this._cachedMeta,s=n.iScale,r=n.vScale,a=this.getParsed(e);return{label:s?""+s.getLabelForValue(a[s.axis]):"",value:r?""+r.getLabelForValue(a[r.axis]):""}}_update(e){const n=this._cachedMeta;this.update(e||"default"),n._clip=HP(Pe(this.options.clip,qP(n.xScale,n.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,n=this.chart,s=this._cachedMeta,r=s.data||[],a=n.chartArea,l=[],c=this._drawStart||0,d=this._drawCount||r.length-c,f=this.options.drawActiveElementsOnTop;let m;for(s.dataset&&s.dataset.draw(e,a,c,d),m=c;m<c+d;++m){const g=r[m];g.hidden||(g.active&&f?l.push(g):g.draw(e,a))}for(m=0;m<l.length;++m)l[m].draw(e,a)}getStyle(e,n){const s=n?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(s):this.resolveDataElementOptions(e||0,s)}getContext(e,n,s){const r=this.getDataset();let a;if(e>=0&&e<this._cachedMeta.data.length){const l=this._cachedMeta.data[e];a=l.$context||(l.$context=QP(this.getContext(),e,l)),a.parsed=this.getParsed(e),a.raw=r.data[e],a.index=a.dataIndex=e}else a=this.$context||(this.$context=XP(this.chart.getContext(),this.index)),a.dataset=r,a.index=a.datasetIndex=this.index;return a.active=!!n,a.mode=s,a}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,n){return this._resolveElementOptions(this.dataElementType.id,n,e)}_resolveElementOptions(e,n="default",s){const r=n==="active",a=this._cachedDataOpts,l=e+"-"+n,c=a[l],d=this.enableOptionSharing&&no(s);if(c)return wy(c,d);const f=this.chart.config,m=f.datasetElementScopeKeys(this._type,e),g=r?[`${e}Hover`,"hover",e,""]:[e,""],y=f.getOptionScopes(this.getDataset(),m),x=Object.keys(tt.elements[e]),_=()=>this.getContext(s,r,n),S=f.resolveNamedOptions(y,x,_,g);return S.$shared&&(S.$shared=d,a[l]=Object.freeze(wy(S,d))),S}_resolveAnimations(e,n,s){const r=this.chart,a=this._cachedDataOpts,l=`animation-${n}`,c=a[l];if(c)return c;let d;if(r.options.animation!==!1){const m=this.chart.config,g=m.datasetAnimationScopeKeys(this._type,n),y=m.getOptionScopes(this.getDataset(),g);d=m.createResolver(y,this.getContext(e,s,n))}const f=new Ox(r,d&&d.animations);return d&&d._cacheable&&(a[l]=Object.freeze(f)),f}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,n){return!n||Bd(e)||this.chart._animationsDisabled}_getSharedOptions(e,n){const s=this.resolveDataElementOptions(e,n),r=this._sharedOptions,a=this.getSharedOptions(s),l=this.includeOptions(n,a)||a!==r;return this.updateSharedOptions(a,n,s),{sharedOptions:a,includeOptions:l}}updateElement(e,n,s,r){Bd(r)?Object.assign(e,s):this._resolveAnimations(n,r).update(e,s)}updateSharedOptions(e,n,s){e&&!Bd(n)&&this._resolveAnimations(void 0,n).update(e,s)}_setStyle(e,n,s,r){e.active=r;const a=this.getStyle(n,r);this._resolveAnimations(n,s,r).update(e,{options:!r&&this.getSharedOptions(a)||a})}removeHoverStyle(e,n,s){this._setStyle(e,s,"active",!1)}setHoverStyle(e,n,s){this._setStyle(e,s,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const n=this._data,s=this._cachedMeta.data;for(const[c,d,f]of this._syncList)this[c](d,f);this._syncList=[];const r=s.length,a=n.length,l=Math.min(a,r);l&&this.parse(0,l),a>r?this._insertElements(r,a-r,e):a<r&&this._removeElements(a,r-a)}_insertElements(e,n,s=!0){const r=this._cachedMeta,a=r.data,l=e+n;let c;const d=f=>{for(f.length+=n,c=f.length-1;c>=l;c--)f[c]=f[c-n]};for(d(a),c=e;c<l;++c)a[c]=new this.dataElementType;this._parsing&&d(r._parsed),this.parse(e,n),s&&this.updateElements(a,e,n,"reset")}updateElements(e,n,s,r){}_removeElements(e,n){const s=this._cachedMeta;if(this._parsing){const r=s._parsed.splice(e,n);s._stacked&&ka(s,r)}s.data.splice(e,n)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[n,s,r]=e;this[n](s,r)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,n){n&&this._sync(["_removeElements",e,n]);const s=arguments.length-2;s&&this._sync(["_insertElements",e,s])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function eI(t,e){if(!t._cache.$bar){const n=t.getMatchingVisibleMetas(e);let s=[];for(let r=0,a=n.length;r<a;r++)s=s.concat(n[r].controller.getAllParsedValues(t));t._cache.$bar=fx(s.sort((r,a)=>r-a))}return t._cache.$bar}function tI(t){const e=t.iScale,n=eI(e,t.type);let s=e._length,r,a,l,c;const d=()=>{l===32767||l===-32768||(no(c)&&(s=Math.min(s,Math.abs(l-c)||s)),c=l)};for(r=0,a=n.length;r<a;++r)l=e.getPixelForValue(n[r]),d();for(c=void 0,r=0,a=e.ticks.length;r<a;++r)l=e.getPixelForTick(r),d();return s}function nI(t,e,n,s){const r=n.barThickness;let a,l;return Ae(r)?(a=e.min*n.categoryPercentage,l=n.barPercentage):(a=r*s,l=1),{chunk:a/s,ratio:l,start:e.pixels[t]-a/2}}function sI(t,e,n,s){const r=e.pixels,a=r[t];let l=t>0?r[t-1]:null,c=t<r.length-1?r[t+1]:null;const d=n.categoryPercentage;l===null&&(l=a-(c===null?e.end-e.start:c-a)),c===null&&(c=a+a-l);const f=a-(a-Math.min(l,c))/2*d;return{chunk:Math.abs(c-l)/2*d/s,ratio:n.barPercentage,start:f}}function rI(t,e,n,s){const r=n.parse(t[0],s),a=n.parse(t[1],s),l=Math.min(r,a),c=Math.max(r,a);let d=l,f=c;Math.abs(l)>Math.abs(c)&&(d=c,f=l),e[n.axis]=f,e._custom={barStart:d,barEnd:f,start:r,end:a,min:l,max:c}}function Mx(t,e,n,s){return et(t)?rI(t,e,n,s):e[n.axis]=n.parse(t,s),e}function _y(t,e,n,s){const r=t.iScale,a=t.vScale,l=r.getLabels(),c=r===a,d=[];let f,m,g,y;for(f=n,m=n+s;f<m;++f)y=e[f],g={},g[r.axis]=c||r.parse(l[f],f),d.push(Mx(y,g,a,f));return d}function $d(t){return t&&t.barStart!==void 0&&t.barEnd!==void 0}function iI(t,e,n){return t!==0?rs(t):(e.isHorizontal()?1:-1)*(e.min>=n?1:-1)}function aI(t){let e,n,s,r,a;return t.horizontal?(e=t.base>t.x,n="left",s="right"):(e=t.base<t.y,n="bottom",s="top"),e?(r="end",a="start"):(r="start",a="end"),{start:n,end:s,reverse:e,top:r,bottom:a}}function oI(t,e,n,s){let r=e.borderSkipped;const a={};if(!r){t.borderSkipped=a;return}if(r===!0){t.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:l,end:c,reverse:d,top:f,bottom:m}=aI(t);r==="middle"&&n&&(t.enableBorderRadius=!0,(n._top||0)===s?r=f:(n._bottom||0)===s?r=m:(a[Sy(m,l,c,d)]=!0,r=f)),a[Sy(r,l,c,d)]=!0,t.borderSkipped=a}function Sy(t,e,n,s){return s?(t=lI(t,e,n),t=ky(t,n,e)):t=ky(t,e,n),t}function lI(t,e,n){return t===e?n:t===n?e:t}function ky(t,e,n){return t==="start"?e:t==="end"?n:t}function cI(t,{inflateAmount:e},n){t.inflateAmount=e==="auto"?n===1?.33:0:e}class uI extends mr{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(e,n,s,r){return _y(e,n,s,r)}parseArrayData(e,n,s,r){return _y(e,n,s,r)}parseObjectData(e,n,s,r){const{iScale:a,vScale:l}=e,{xAxisKey:c="x",yAxisKey:d="y"}=this._parsing,f=a.axis==="x"?c:d,m=l.axis==="x"?c:d,g=[];let y,x,_,S;for(y=s,x=s+r;y<x;++y)S=n[y],_={},_[a.axis]=a.parse(dr(S,f),y),g.push(Mx(dr(S,m),_,l,y));return g}updateRangeFromParsed(e,n,s,r){super.updateRangeFromParsed(e,n,s,r);const a=s._custom;a&&n===this._cachedMeta.vScale&&(e.min=Math.min(e.min,a.min),e.max=Math.max(e.max,a.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const n=this._cachedMeta,{iScale:s,vScale:r}=n,a=this.getParsed(e),l=a._custom,c=$d(l)?"["+l.start+", "+l.end+"]":""+r.getLabelForValue(a[r.axis]);return{label:""+s.getLabelForValue(a[s.axis]),value:c}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const n=this._cachedMeta;this.updateElements(n.data,0,n.data.length,e)}updateElements(e,n,s,r){const a=r==="reset",{index:l,_cachedMeta:{vScale:c}}=this,d=c.getBasePixel(),f=c.isHorizontal(),m=this._getRuler(),{sharedOptions:g,includeOptions:y}=this._getSharedOptions(n,r);for(let x=n;x<n+s;x++){const _=this.getParsed(x),S=a||Ae(_[c.axis])?{base:d,head:d}:this._calculateBarValuePixels(x),b=this._calculateBarIndexPixels(x,m),k=(_._stacks||{})[c.axis],I={horizontal:f,base:S.base,enableBorderRadius:!k||$d(_._custom)||l===k._top||l===k._bottom,x:f?S.head:b.center,y:f?b.center:S.head,height:f?b.size:Math.abs(S.size),width:f?Math.abs(S.size):b.size};y&&(I.options=g||this.resolveDataElementOptions(x,e[x].active?"active":r));const C=I.options||e[x].options;oI(I,C,k,l),cI(I,C,m.ratio),this.updateElement(e[x],x,I,r)}}_getStacks(e,n){const{iScale:s}=this._cachedMeta,r=s.getMatchingVisibleMetas(this._type).filter(m=>m.controller.options.grouped),a=s.options.stacked,l=[],c=this._cachedMeta.controller.getParsed(n),d=c&&c[s.axis],f=m=>{const g=m._parsed.find(x=>x[s.axis]===d),y=g&&g[m.vScale.axis];if(Ae(y)||isNaN(y))return!0};for(const m of r)if(!(n!==void 0&&f(m))&&((a===!1||l.indexOf(m.stack)===-1||a===void 0&&m.stack===void 0)&&l.push(m.stack),m.index===e))break;return l.length||l.push(void 0),l}_getStackCount(e){return this._getStacks(void 0,e).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const e=this.chart.scales,n=this.chart.options.indexAxis;return Object.keys(e).filter(s=>e[s].axis===n).shift()}_getAxis(){const e={},n=this.getFirstScaleIdForIndexAxis();for(const s of this.chart.data.datasets)e[Pe(this.chart.options.indexAxis==="x"?s.xAxisID:s.yAxisID,n)]=!0;return Object.keys(e)}_getStackIndex(e,n,s){const r=this._getStacks(e,s),a=n!==void 0?r.indexOf(n):-1;return a===-1?r.length-1:a}_getRuler(){const e=this.options,n=this._cachedMeta,s=n.iScale,r=[];let a,l;for(a=0,l=n.data.length;a<l;++a)r.push(s.getPixelForValue(this.getParsed(a)[s.axis],a));const c=e.barThickness;return{min:c||tI(n),pixels:r,start:s._startPixel,end:s._endPixel,stackCount:this._getStackCount(),scale:s,grouped:e.grouped,ratio:c?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:n,_stacked:s,index:r},options:{base:a,minBarLength:l}}=this,c=a||0,d=this.getParsed(e),f=d._custom,m=$d(f);let g=d[n.axis],y=0,x=s?this.applyStack(n,d,s):g,_,S;x!==g&&(y=x-g,x=g),m&&(g=f.barStart,x=f.barEnd-f.barStart,g!==0&&rs(g)!==rs(f.barEnd)&&(y=0),y+=g);const b=!Ae(a)&&!m?a:y;let k=n.getPixelForValue(b);if(this.chart.getDataVisibility(e)?_=n.getPixelForValue(y+x):_=k,S=_-k,Math.abs(S)<l){S=iI(S,n,c)*l,g===c&&(k-=S/2);const I=n.getPixelForDecimal(0),C=n.getPixelForDecimal(1),N=Math.min(I,C),O=Math.max(I,C);k=Math.max(Math.min(k,O),N),_=k+S,s&&!m&&(d._stacks[n.axis]._visualValues[r]=n.getValueForPixel(_)-n.getValueForPixel(k))}if(k===n.getPixelForValue(c)){const I=rs(S)*n.getLineWidthForValue(c)/2;k+=I,S-=I}return{size:S,base:k,head:_,center:_+S/2}}_calculateBarIndexPixels(e,n){const s=n.scale,r=this.options,a=r.skipNull,l=Pe(r.maxBarThickness,1/0);let c,d;const f=this._getAxisCount();if(n.grouped){const m=a?this._getStackCount(e):n.stackCount,g=r.barThickness==="flex"?sI(e,n,r,m*f):nI(e,n,r,m*f),y=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,x=this._getAxis().indexOf(Pe(y,this.getFirstScaleIdForIndexAxis())),_=this._getStackIndex(this.index,this._cachedMeta.stack,a?e:void 0)+x;c=g.start+g.chunk*_+g.chunk/2,d=Math.min(l,g.chunk*g.ratio)}else c=s.getPixelForValue(this.getParsed(e)[s.axis],e),d=Math.min(l,n.min*n.ratio);return{base:c-d/2,head:c+d/2,center:c,size:d}}draw(){const e=this._cachedMeta,n=e.vScale,s=e.data,r=s.length;let a=0;for(;a<r;++a)this.getParsed(a)[n.axis]!==null&&!s[a].hidden&&s[a].draw(this._ctx)}}class dI extends mr{static id="bubble";static defaults={datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}};static overrides={scales:{x:{type:"linear"},y:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(e,n,s,r){const a=super.parsePrimitiveData(e,n,s,r);for(let l=0;l<a.length;l++)a[l]._custom=this.resolveDataElementOptions(l+s).radius;return a}parseArrayData(e,n,s,r){const a=super.parseArrayData(e,n,s,r);for(let l=0;l<a.length;l++){const c=n[s+l];a[l]._custom=Pe(c[2],this.resolveDataElementOptions(l+s).radius)}return a}parseObjectData(e,n,s,r){const a=super.parseObjectData(e,n,s,r);for(let l=0;l<a.length;l++){const c=n[s+l];a[l]._custom=Pe(c&&c.r&&+c.r,this.resolveDataElementOptions(l+s).radius)}return a}getMaxOverflow(){const e=this._cachedMeta.data;let n=0;for(let s=e.length-1;s>=0;--s)n=Math.max(n,e[s].size(this.resolveDataElementOptions(s))/2);return n>0&&n}getLabelAndValue(e){const n=this._cachedMeta,s=this.chart.data.labels||[],{xScale:r,yScale:a}=n,l=this.getParsed(e),c=r.getLabelForValue(l.x),d=a.getLabelForValue(l.y),f=l._custom;return{label:s[e]||"",value:"("+c+", "+d+(f?", "+f:"")+")"}}update(e){const n=this._cachedMeta.data;this.updateElements(n,0,n.length,e)}updateElements(e,n,s,r){const a=r==="reset",{iScale:l,vScale:c}=this._cachedMeta,{sharedOptions:d,includeOptions:f}=this._getSharedOptions(n,r),m=l.axis,g=c.axis;for(let y=n;y<n+s;y++){const x=e[y],_=!a&&this.getParsed(y),S={},b=S[m]=a?l.getPixelForDecimal(.5):l.getPixelForValue(_[m]),k=S[g]=a?c.getBasePixel():c.getPixelForValue(_[g]);S.skip=isNaN(b)||isNaN(k),f&&(S.options=d||this.resolveDataElementOptions(y,x.active?"active":r),a&&(S.options.radius=0)),this.updateElement(x,y,S,r)}}resolveDataElementOptions(e,n){const s=this.getParsed(e);let r=super.resolveDataElementOptions(e,n);r.$shared&&(r=Object.assign({},r,{$shared:!1}));const a=r.radius;return n!=="active"&&(r.radius=0),r.radius+=Pe(s&&s._custom,a),r}}function hI(t,e,n){let s=1,r=1,a=0,l=0;if(e<Qe){const c=t,d=c+e,f=Math.cos(c),m=Math.sin(c),g=Math.cos(d),y=Math.sin(d),x=(C,N,O)=>so(C,c,d,!0)?1:Math.max(N,N*n,O,O*n),_=(C,N,O)=>so(C,c,d,!0)?-1:Math.min(N,N*n,O,O*n),S=x(0,f,g),b=x(pt,m,y),k=_(ze,f,g),I=_(ze+pt,m,y);s=(S-k)/2,r=(b-I)/2,a=-(S+k)/2,l=-(b+I)/2}return{ratioX:s,ratioY:r,offsetX:a,offsetY:l}}class cf extends mr{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const n=e.data,{labels:{pointStyle:s,textAlign:r,color:a,useBorderRadius:l,borderRadius:c}}=e.legend.options;return n.labels.length&&n.datasets.length?n.labels.map((d,f)=>{const g=e.getDatasetMeta(0).controller.getStyle(f);return{text:d,fillStyle:g.backgroundColor,fontColor:a,hidden:!e.getDataVisibility(f),lineDash:g.borderDash,lineDashOffset:g.borderDashOffset,lineJoin:g.borderJoinStyle,lineWidth:g.borderWidth,strokeStyle:g.borderColor,textAlign:r,pointStyle:s,borderRadius:l&&(c||g.borderRadius),index:f}}):[]}},onClick(e,n,s){s.chart.toggleDataVisibility(n.index),s.chart.update()}}}};constructor(e,n){super(e,n),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,n){const s=this.getDataset().data,r=this._cachedMeta;if(this._parsing===!1)r._parsed=s;else{let a=d=>+s[d];if(Re(s[e])){const{key:d="value"}=this._parsing;a=f=>+dr(s[f],d)}let l,c;for(l=e,c=e+n;l<c;++l)r._parsed[l]=a(l)}}_getRotation(){return Un(this.options.rotation-90)}_getCircumference(){return Un(this.options.circumference)}_getRotationExtents(){let e=Qe,n=-Qe;for(let s=0;s<this.chart.data.datasets.length;++s)if(this.chart.isDatasetVisible(s)&&this.chart.getDatasetMeta(s).type===this._type){const r=this.chart.getDatasetMeta(s).controller,a=r._getRotation(),l=r._getCircumference();e=Math.min(e,a),n=Math.max(n,a+l)}return{rotation:e,circumference:n-e}}update(e){const n=this.chart,{chartArea:s}=n,r=this._cachedMeta,a=r.data,l=this.getMaxBorderWidth()+this.getMaxOffset(a)+this.options.spacing,c=Math.max((Math.min(s.width,s.height)-l)/2,0),d=Math.min(_C(this.options.cutout,c),1),f=this._getRingWeight(this.index),{circumference:m,rotation:g}=this._getRotationExtents(),{ratioX:y,ratioY:x,offsetX:_,offsetY:S}=hI(g,m,d),b=(s.width-l)/y,k=(s.height-l)/x,I=Math.max(Math.min(b,k)/2,0),C=lx(this.options.radius,I),N=Math.max(C*d,0),O=(C-N)/this._getVisibleDatasetWeightTotal();this.offsetX=_*C,this.offsetY=S*C,r.total=this.calculateTotal(),this.outerRadius=C-O*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-O*f,0),this.updateElements(a,0,a.length,e)}_circumference(e,n){const s=this.options,r=this._cachedMeta,a=this._getCircumference();return n&&s.animation.animateRotate||!this.chart.getDataVisibility(e)||r._parsed[e]===null||r.data[e].hidden?0:this.calculateCircumference(r._parsed[e]*a/Qe)}updateElements(e,n,s,r){const a=r==="reset",l=this.chart,c=l.chartArea,f=l.options.animation,m=(c.left+c.right)/2,g=(c.top+c.bottom)/2,y=a&&f.animateScale,x=y?0:this.innerRadius,_=y?0:this.outerRadius,{sharedOptions:S,includeOptions:b}=this._getSharedOptions(n,r);let k=this._getRotation(),I;for(I=0;I<n;++I)k+=this._circumference(I,a);for(I=n;I<n+s;++I){const C=this._circumference(I,a),N=e[I],O={x:m+this.offsetX,y:g+this.offsetY,startAngle:k,endAngle:k+C,circumference:C,outerRadius:_,innerRadius:x};b&&(O.options=S||this.resolveDataElementOptions(I,N.active?"active":r)),k+=C,this.updateElement(N,I,O,r)}}calculateTotal(){const e=this._cachedMeta,n=e.data;let s=0,r;for(r=0;r<n.length;r++){const a=e._parsed[r];a!==null&&!isNaN(a)&&this.chart.getDataVisibility(r)&&!n[r].hidden&&(s+=Math.abs(a))}return s}calculateCircumference(e){const n=this._cachedMeta.total;return n>0&&!isNaN(e)?Qe*(Math.abs(e)/n):0}getLabelAndValue(e){const n=this._cachedMeta,s=this.chart,r=s.data.labels||[],a=po(n._parsed[e],s.options.locale);return{label:r[e]||"",value:a}}getMaxBorderWidth(e){let n=0;const s=this.chart;let r,a,l,c,d;if(!e){for(r=0,a=s.data.datasets.length;r<a;++r)if(s.isDatasetVisible(r)){l=s.getDatasetMeta(r),e=l.data,c=l.controller;break}}if(!e)return 0;for(r=0,a=e.length;r<a;++r)d=c.resolveDataElementOptions(r),d.borderAlign!=="inner"&&(n=Math.max(n,d.borderWidth||0,d.hoverBorderWidth||0));return n}getMaxOffset(e){let n=0;for(let s=0,r=e.length;s<r;++s){const a=this.resolveDataElementOptions(s);n=Math.max(n,a.offset||0,a.hoverOffset||0)}return n}_getRingWeightOffset(e){let n=0;for(let s=0;s<e;++s)this.chart.isDatasetVisible(s)&&(n+=this._getRingWeight(s));return n}_getRingWeight(e){return Math.max(Pe(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}class fI extends mr{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const n=this._cachedMeta,{dataset:s,data:r=[],_dataset:a}=n,l=this.chart._animationsDisabled;let{start:c,count:d}=gx(n,r,l);this._drawStart=c,this._drawCount=d,yx(n)&&(c=0,d=r.length),s._chart=this.chart,s._datasetIndex=this.index,s._decimated=!!a._decimated,s.points=r;const f=this.resolveDatasetElementOptions(e);this.options.showLine||(f.borderWidth=0),f.segment=this.options.segment,this.updateElement(s,void 0,{animated:!l,options:f},e),this.updateElements(r,c,d,e)}updateElements(e,n,s,r){const a=r==="reset",{iScale:l,vScale:c,_stacked:d,_dataset:f}=this._cachedMeta,{sharedOptions:m,includeOptions:g}=this._getSharedOptions(n,r),y=l.axis,x=c.axis,{spanGaps:_,segment:S}=this.options,b=Li(_)?_:Number.POSITIVE_INFINITY,k=this.chart._animationsDisabled||a||r==="none",I=n+s,C=e.length;let N=n>0&&this.getParsed(n-1);for(let O=0;O<C;++O){const U=e[O],E=k?U:{};if(O<n||O>=I){E.skip=!0;continue}const L=this.getParsed(O),R=Ae(L[x]),T=E[y]=l.getPixelForValue(L[y],O),D=E[x]=a||R?c.getBasePixel():c.getPixelForValue(d?this.applyStack(c,L,d):L[x],O);E.skip=isNaN(T)||isNaN(D)||R,E.stop=O>0&&Math.abs(L[y]-N[y])>b,S&&(E.parsed=L,E.raw=f.data[O]),g&&(E.options=m||this.resolveDataElementOptions(O,U.active?"active":r)),k||this.updateElement(U,O,E,r),N=L}}getMaxOverflow(){const e=this._cachedMeta,n=e.dataset,s=n.options&&n.options.borderWidth||0,r=e.data||[];if(!r.length)return s;const a=r[0].size(this.resolveDataElementOptions(0)),l=r[r.length-1].size(this.resolveDataElementOptions(r.length-1));return Math.max(s,a,l)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}class Lx extends mr{static id="polarArea";static defaults={dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const n=e.data;if(n.labels.length&&n.datasets.length){const{labels:{pointStyle:s,color:r}}=e.legend.options;return n.labels.map((a,l)=>{const d=e.getDatasetMeta(0).controller.getStyle(l);return{text:a,fillStyle:d.backgroundColor,strokeStyle:d.borderColor,fontColor:r,lineWidth:d.borderWidth,pointStyle:s,hidden:!e.getDataVisibility(l),index:l}})}return[]}},onClick(e,n,s){s.chart.toggleDataVisibility(n.index),s.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}};constructor(e,n){super(e,n),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(e){const n=this._cachedMeta,s=this.chart,r=s.data.labels||[],a=po(n._parsed[e].r,s.options.locale);return{label:r[e]||"",value:a}}parseObjectData(e,n,s,r){return jx.bind(this)(e,n,s,r)}update(e){const n=this._cachedMeta.data;this._updateRadius(),this.updateElements(n,0,n.length,e)}getMinMax(){const e=this._cachedMeta,n={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return e.data.forEach((s,r)=>{const a=this.getParsed(r).r;!isNaN(a)&&this.chart.getDataVisibility(r)&&(a<n.min&&(n.min=a),a>n.max&&(n.max=a))}),n}_updateRadius(){const e=this.chart,n=e.chartArea,s=e.options,r=Math.min(n.right-n.left,n.bottom-n.top),a=Math.max(r/2,0),l=Math.max(s.cutoutPercentage?a/100*s.cutoutPercentage:1,0),c=(a-l)/e.getVisibleDatasetCount();this.outerRadius=a-c*this.index,this.innerRadius=this.outerRadius-c}updateElements(e,n,s,r){const a=r==="reset",l=this.chart,d=l.options.animation,f=this._cachedMeta.rScale,m=f.xCenter,g=f.yCenter,y=f.getIndexAngle(0)-.5*ze;let x=y,_;const S=360/this.countVisibleElements();for(_=0;_<n;++_)x+=this._computeAngle(_,r,S);for(_=n;_<n+s;_++){const b=e[_];let k=x,I=x+this._computeAngle(_,r,S),C=l.getDataVisibility(_)?f.getDistanceFromCenterForValue(this.getParsed(_).r):0;x=I,a&&(d.animateScale&&(C=0),d.animateRotate&&(k=I=y));const N={x:m,y:g,innerRadius:0,outerRadius:C,startAngle:k,endAngle:I,options:this.resolveDataElementOptions(_,b.active?"active":r)};this.updateElement(b,_,N,r)}}countVisibleElements(){const e=this._cachedMeta;let n=0;return e.data.forEach((s,r)=>{!isNaN(this.getParsed(r).r)&&this.chart.getDataVisibility(r)&&n++}),n}_computeAngle(e,n,s){return this.chart.getDataVisibility(e)?Un(this.resolveDataElementOptions(e,n).angle||s):0}}class pI extends cf{static id="pie";static defaults={cutout:0,rotation:0,circumference:360,radius:"100%"}}class mI extends mr{static id="radar";static defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}};static overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};getLabelAndValue(e){const n=this._cachedMeta.vScale,s=this.getParsed(e);return{label:n.getLabels()[e],value:""+n.getLabelForValue(s[n.axis])}}parseObjectData(e,n,s,r){return jx.bind(this)(e,n,s,r)}update(e){const n=this._cachedMeta,s=n.dataset,r=n.data||[],a=n.iScale.getLabels();if(s.points=r,e!=="resize"){const l=this.resolveDatasetElementOptions(e);this.options.showLine||(l.borderWidth=0);const c={_loop:!0,_fullLoop:a.length===r.length,options:l};this.updateElement(s,void 0,c,e)}this.updateElements(r,0,r.length,e)}updateElements(e,n,s,r){const a=this._cachedMeta.rScale,l=r==="reset";for(let c=n;c<n+s;c++){const d=e[c],f=this.resolveDataElementOptions(c,d.active?"active":r),m=a.getPointPositionForValue(c,this.getParsed(c).r),g=l?a.xCenter:m.x,y=l?a.yCenter:m.y,x={x:g,y,angle:m.angle,skip:isNaN(g)||isNaN(y),options:f};this.updateElement(d,c,x,r)}}}class gI extends mr{static id="scatter";static defaults={datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1};static overrides={interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}};getLabelAndValue(e){const n=this._cachedMeta,s=this.chart.data.labels||[],{xScale:r,yScale:a}=n,l=this.getParsed(e),c=r.getLabelForValue(l.x),d=a.getLabelForValue(l.y);return{label:s[e]||"",value:"("+c+", "+d+")"}}update(e){const n=this._cachedMeta,{data:s=[]}=n,r=this.chart._animationsDisabled;let{start:a,count:l}=gx(n,s,r);if(this._drawStart=a,this._drawCount=l,yx(n)&&(a=0,l=s.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:c,_dataset:d}=n;c._chart=this.chart,c._datasetIndex=this.index,c._decimated=!!d._decimated,c.points=s;const f=this.resolveDatasetElementOptions(e);f.segment=this.options.segment,this.updateElement(c,void 0,{animated:!r,options:f},e)}else this.datasetElementType&&(delete n.dataset,this.datasetElementType=!1);this.updateElements(s,a,l,e)}addElements(){const{showLine:e}=this.options;!this.datasetElementType&&e&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(e,n,s,r){const a=r==="reset",{iScale:l,vScale:c,_stacked:d,_dataset:f}=this._cachedMeta,m=this.resolveDataElementOptions(n,r),g=this.getSharedOptions(m),y=this.includeOptions(r,g),x=l.axis,_=c.axis,{spanGaps:S,segment:b}=this.options,k=Li(S)?S:Number.POSITIVE_INFINITY,I=this.chart._animationsDisabled||a||r==="none";let C=n>0&&this.getParsed(n-1);for(let N=n;N<n+s;++N){const O=e[N],U=this.getParsed(N),E=I?O:{},L=Ae(U[_]),R=E[x]=l.getPixelForValue(U[x],N),T=E[_]=a||L?c.getBasePixel():c.getPixelForValue(d?this.applyStack(c,U,d):U[_],N);E.skip=isNaN(R)||isNaN(T)||L,E.stop=N>0&&Math.abs(U[x]-C[x])>k,b&&(E.parsed=U,E.raw=f.data[N]),y&&(E.options=g||this.resolveDataElementOptions(N,O.active?"active":r)),I||this.updateElement(O,N,E,r),C=U}this.updateSharedOptions(g,r,m)}getMaxOverflow(){const e=this._cachedMeta,n=e.data||[];if(!this.options.showLine){let c=0;for(let d=n.length-1;d>=0;--d)c=Math.max(c,n[d].size(this.resolveDataElementOptions(d))/2);return c>0&&c}const s=e.dataset,r=s.options&&s.options.borderWidth||0;if(!n.length)return r;const a=n[0].size(this.resolveDataElementOptions(0)),l=n[n.length-1].size(this.resolveDataElementOptions(n.length-1));return Math.max(r,a,l)/2}}var yI=Object.freeze({__proto__:null,BarController:uI,BubbleController:dI,DoughnutController:cf,LineController:fI,PieController:pI,PolarAreaController:Lx,RadarController:mI,ScatterController:gI});function Lr(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class uf{static override(e){Object.assign(uf.prototype,e)}options;constructor(e){this.options=e||{}}init(){}formats(){return Lr()}parse(){return Lr()}format(){return Lr()}add(){return Lr()}diff(){return Lr()}startOf(){return Lr()}endOf(){return Lr()}}var vI={_date:uf};function xI(t,e,n,s){const{controller:r,data:a,_sorted:l}=t,c=r._cachedMeta.iScale,d=t.dataset&&t.dataset.options?t.dataset.options.spanGaps:null;if(c&&e===c.axis&&e!=="r"&&l&&a.length){const f=c._reversePixels?MC:Ps;if(s){if(r._sharedOptions){const m=a[0],g=typeof m.getRange=="function"&&m.getRange(e);if(g){const y=f(a,e,n-g),x=f(a,e,n+g);return{lo:y.lo,hi:x.hi}}}}else{const m=f(a,e,n);if(d){const{vScale:g}=r._cachedMeta,{_parsed:y}=t,x=y.slice(0,m.lo+1).reverse().findIndex(S=>!Ae(S[g.axis]));m.lo-=Math.max(0,x);const _=y.slice(m.hi).findIndex(S=>!Ae(S[g.axis]));m.hi+=Math.max(0,_)}return m}}return{lo:0,hi:a.length-1}}function Ic(t,e,n,s,r){const a=t.getSortedVisibleDatasetMetas(),l=n[e];for(let c=0,d=a.length;c<d;++c){const{index:f,data:m}=a[c],{lo:g,hi:y}=xI(a[c],e,l,r);for(let x=g;x<=y;++x){const _=m[x];_.skip||s(_,f,x)}}}function bI(t){const e=t.indexOf("x")!==-1,n=t.indexOf("y")!==-1;return function(s,r){const a=e?Math.abs(s.x-r.x):0,l=n?Math.abs(s.y-r.y):0;return Math.sqrt(Math.pow(a,2)+Math.pow(l,2))}}function zd(t,e,n,s,r){const a=[];return!r&&!t.isPointInArea(e)||Ic(t,n,e,function(c,d,f){!r&&!Is(c,t.chartArea,0)||c.inRange(e.x,e.y,s)&&a.push({element:c,datasetIndex:d,index:f})},!0),a}function wI(t,e,n,s){let r=[];function a(l,c,d){const{startAngle:f,endAngle:m}=l.getProps(["startAngle","endAngle"],s),{angle:g}=dx(l,{x:e.x,y:e.y});so(g,f,m)&&r.push({element:l,datasetIndex:c,index:d})}return Ic(t,n,e,a),r}function _I(t,e,n,s,r,a){let l=[];const c=bI(n);let d=Number.POSITIVE_INFINITY;function f(m,g,y){const x=m.inRange(e.x,e.y,r);if(s&&!x)return;const _=m.getCenterPoint(r);if(!(!!a||t.isPointInArea(_))&&!x)return;const b=c(e,_);b<d?(l=[{element:m,datasetIndex:g,index:y}],d=b):b===d&&l.push({element:m,datasetIndex:g,index:y})}return Ic(t,n,e,f),l}function Ud(t,e,n,s,r,a){return!a&&!t.isPointInArea(e)?[]:n==="r"&&!s?wI(t,e,n,r):_I(t,e,n,s,r,a)}function jy(t,e,n,s,r){const a=[],l=n==="x"?"inXRange":"inYRange";let c=!1;return Ic(t,n,e,(d,f,m)=>{d[l]&&d[l](e[n],r)&&(a.push({element:d,datasetIndex:f,index:m}),c=c||d.inRange(e.x,e.y,r))}),s&&!c?[]:a}var SI={modes:{index(t,e,n,s){const r=Br(e,t),a=n.axis||"x",l=n.includeInvisible||!1,c=n.intersect?zd(t,r,a,s,l):Ud(t,r,a,!1,s,l),d=[];return c.length?(t.getSortedVisibleDatasetMetas().forEach(f=>{const m=c[0].index,g=f.data[m];g&&!g.skip&&d.push({element:g,datasetIndex:f.index,index:m})}),d):[]},dataset(t,e,n,s){const r=Br(e,t),a=n.axis||"xy",l=n.includeInvisible||!1;let c=n.intersect?zd(t,r,a,s,l):Ud(t,r,a,!1,s,l);if(c.length>0){const d=c[0].datasetIndex,f=t.getDatasetMeta(d).data;c=[];for(let m=0;m<f.length;++m)c.push({element:f[m],datasetIndex:d,index:m})}return c},point(t,e,n,s){const r=Br(e,t),a=n.axis||"xy",l=n.includeInvisible||!1;return zd(t,r,a,s,l)},nearest(t,e,n,s){const r=Br(e,t),a=n.axis||"xy",l=n.includeInvisible||!1;return Ud(t,r,a,n.intersect,s,l)},x(t,e,n,s){const r=Br(e,t);return jy(t,r,"x",n.intersect,s)},y(t,e,n,s){const r=Br(e,t);return jy(t,r,"y",n.intersect,s)}}};const Dx=["left","top","right","bottom"];function ja(t,e){return t.filter(n=>n.pos===e)}function Cy(t,e){return t.filter(n=>Dx.indexOf(n.pos)===-1&&n.box.axis===e)}function Ca(t,e){return t.sort((n,s)=>{const r=e?s:n,a=e?n:s;return r.weight===a.weight?r.index-a.index:r.weight-a.weight})}function kI(t){const e=[];let n,s,r,a,l,c;for(n=0,s=(t||[]).length;n<s;++n)r=t[n],{position:a,options:{stack:l,stackWeight:c=1}}=r,e.push({index:n,box:r,pos:a,horizontal:r.isHorizontal(),weight:r.weight,stack:l&&a+l,stackWeight:c});return e}function jI(t){const e={};for(const n of t){const{stack:s,pos:r,stackWeight:a}=n;if(!s||!Dx.includes(r))continue;const l=e[s]||(e[s]={count:0,placed:0,weight:0,size:0});l.count++,l.weight+=a}return e}function CI(t,e){const n=jI(t),{vBoxMaxWidth:s,hBoxMaxHeight:r}=e;let a,l,c;for(a=0,l=t.length;a<l;++a){c=t[a];const{fullSize:d}=c.box,f=n[c.stack],m=f&&c.stackWeight/f.weight;c.horizontal?(c.width=m?m*s:d&&e.availableWidth,c.height=r):(c.width=s,c.height=m?m*r:d&&e.availableHeight)}return n}function PI(t){const e=kI(t),n=Ca(e.filter(f=>f.box.fullSize),!0),s=Ca(ja(e,"left"),!0),r=Ca(ja(e,"right")),a=Ca(ja(e,"top"),!0),l=Ca(ja(e,"bottom")),c=Cy(e,"x"),d=Cy(e,"y");return{fullSize:n,leftAndTop:s.concat(a),rightAndBottom:r.concat(d).concat(l).concat(c),chartArea:ja(e,"chartArea"),vertical:s.concat(r).concat(d),horizontal:a.concat(l).concat(c)}}function Py(t,e,n,s){return Math.max(t[n],e[n])+Math.max(t[s],e[s])}function Fx(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function II(t,e,n,s){const{pos:r,box:a}=n,l=t.maxPadding;if(!Re(r)){n.size&&(t[r]-=n.size);const g=s[n.stack]||{size:0,count:1};g.size=Math.max(g.size,n.horizontal?a.height:a.width),n.size=g.size/g.count,t[r]+=n.size}a.getPadding&&Fx(l,a.getPadding());const c=Math.max(0,e.outerWidth-Py(l,t,"left","right")),d=Math.max(0,e.outerHeight-Py(l,t,"top","bottom")),f=c!==t.w,m=d!==t.h;return t.w=c,t.h=d,n.horizontal?{same:f,other:m}:{same:m,other:f}}function EI(t){const e=t.maxPadding;function n(s){const r=Math.max(e[s]-t[s],0);return t[s]+=r,r}t.y+=n("top"),t.x+=n("left"),n("right"),n("bottom")}function TI(t,e){const n=e.maxPadding;function s(r){const a={left:0,top:0,right:0,bottom:0};return r.forEach(l=>{a[l]=Math.max(e[l],n[l])}),a}return s(t?["left","right"]:["top","bottom"])}function Ma(t,e,n,s){const r=[];let a,l,c,d,f,m;for(a=0,l=t.length,f=0;a<l;++a){c=t[a],d=c.box,d.update(c.width||e.w,c.height||e.h,TI(c.horizontal,e));const{same:g,other:y}=II(e,n,c,s);f|=g&&r.length,m=m||y,d.fullSize||r.push(c)}return f&&Ma(r,e,n,s)||m}function $l(t,e,n,s,r){t.top=n,t.left=e,t.right=e+s,t.bottom=n+r,t.width=s,t.height=r}function Iy(t,e,n,s){const r=n.padding;let{x:a,y:l}=e;for(const c of t){const d=c.box,f=s[c.stack]||{placed:0,weight:1},m=c.stackWeight/f.weight||1;if(c.horizontal){const g=e.w*m,y=f.size||d.height;no(f.start)&&(l=f.start),d.fullSize?$l(d,r.left,l,n.outerWidth-r.right-r.left,y):$l(d,e.left+f.placed,l,g,y),f.start=l,f.placed+=g,l=d.bottom}else{const g=e.h*m,y=f.size||d.width;no(f.start)&&(a=f.start),d.fullSize?$l(d,a,r.top,y,n.outerHeight-r.bottom-r.top):$l(d,a,e.top+f.placed,y,g),f.start=a,f.placed+=g,a=d.right}}e.x=a,e.y=l}var $t={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(n){e.draw(n)}}]},t.boxes.push(e)},removeBox(t,e){const n=t.boxes?t.boxes.indexOf(e):-1;n!==-1&&t.boxes.splice(n,1)},configure(t,e,n){e.fullSize=n.fullSize,e.position=n.position,e.weight=n.weight},update(t,e,n,s){if(!t)return;const r=zt(t.options.layout.padding),a=Math.max(e-r.width,0),l=Math.max(n-r.height,0),c=PI(t.boxes),d=c.vertical,f=c.horizontal;He(t.boxes,S=>{typeof S.beforeLayout=="function"&&S.beforeLayout()});const m=d.reduce((S,b)=>b.box.options&&b.box.options.display===!1?S:S+1,0)||1,g=Object.freeze({outerWidth:e,outerHeight:n,padding:r,availableWidth:a,availableHeight:l,vBoxMaxWidth:a/2/m,hBoxMaxHeight:l/2}),y=Object.assign({},r);Fx(y,zt(s));const x=Object.assign({maxPadding:y,w:a,h:l,x:r.left,y:r.top},r),_=CI(d.concat(f),g);Ma(c.fullSize,x,g,_),Ma(d,x,g,_),Ma(f,x,g,_)&&Ma(d,x,g,_),EI(x),Iy(c.leftAndTop,x,g,_),x.x+=x.w,x.y+=x.h,Iy(c.rightAndBottom,x,g,_),t.chartArea={left:x.left,top:x.top,right:x.left+x.w,bottom:x.top+x.h,height:x.h,width:x.w},He(c.chartArea,S=>{const b=S.box;Object.assign(b,t.chartArea),b.update(x.w,x.h,{left:0,top:0,right:0,bottom:0})})}};class Bx{acquireContext(e,n){}releaseContext(e){return!1}addEventListener(e,n,s){}removeEventListener(e,n,s){}getDevicePixelRatio(){return 1}getMaximumSize(e,n,s,r){return n=Math.max(0,n||e.width),s=s||e.height,{width:n,height:Math.max(0,r?Math.floor(n/r):s)}}isAttached(e){return!0}updateConfig(e){}}class NI extends Bx{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const Jl="$chartjs",AI={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},Ey=t=>t===null||t==="";function OI(t,e){const n=t.style,s=t.getAttribute("height"),r=t.getAttribute("width");if(t[Jl]={initial:{height:s,width:r,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",Ey(r)){const a=hy(t,"width");a!==void 0&&(t.width=a)}if(Ey(s))if(t.style.height==="")t.height=t.width/(e||2);else{const a=hy(t,"height");a!==void 0&&(t.height=a)}return t}const $x=IP?{passive:!0}:!1;function RI(t,e,n){t&&t.addEventListener(e,n,$x)}function MI(t,e,n){t&&t.canvas&&t.canvas.removeEventListener(e,n,$x)}function LI(t,e){const n=AI[t.type]||t.type,{x:s,y:r}=Br(t,e);return{type:n,chart:e,native:t,x:s!==void 0?s:null,y:r!==void 0?r:null}}function dc(t,e){for(const n of t)if(n===e||n.contains(e))return!0}function DI(t,e,n){const s=t.canvas,r=new MutationObserver(a=>{let l=!1;for(const c of a)l=l||dc(c.addedNodes,s),l=l&&!dc(c.removedNodes,s);l&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}function FI(t,e,n){const s=t.canvas,r=new MutationObserver(a=>{let l=!1;for(const c of a)l=l||dc(c.removedNodes,s),l=l&&!dc(c.addedNodes,s);l&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}const io=new Map;let Ty=0;function zx(){const t=window.devicePixelRatio;t!==Ty&&(Ty=t,io.forEach((e,n)=>{n.currentDevicePixelRatio!==t&&e()}))}function BI(t,e){io.size||window.addEventListener("resize",zx),io.set(t,e)}function $I(t){io.delete(t),io.size||window.removeEventListener("resize",zx)}function zI(t,e,n){const s=t.canvas,r=s&&lf(s);if(!r)return;const a=mx((c,d)=>{const f=r.clientWidth;n(c,d),f<r.clientWidth&&n()},window),l=new ResizeObserver(c=>{const d=c[0],f=d.contentRect.width,m=d.contentRect.height;f===0&&m===0||a(f,m)});return l.observe(r),BI(t,a),l}function Wd(t,e,n){n&&n.disconnect(),e==="resize"&&$I(t)}function UI(t,e,n){const s=t.canvas,r=mx(a=>{t.ctx!==null&&n(LI(a,t))},t);return RI(s,e,r),r}class WI extends Bx{acquireContext(e,n){const s=e&&e.getContext&&e.getContext("2d");return s&&s.canvas===e?(OI(e,n),s):null}releaseContext(e){const n=e.canvas;if(!n[Jl])return!1;const s=n[Jl].initial;["height","width"].forEach(a=>{const l=s[a];Ae(l)?n.removeAttribute(a):n.setAttribute(a,l)});const r=s.style||{};return Object.keys(r).forEach(a=>{n.style[a]=r[a]}),n.width=n.width,delete n[Jl],!0}addEventListener(e,n,s){this.removeEventListener(e,n);const r=e.$proxies||(e.$proxies={}),l={attach:DI,detach:FI,resize:zI}[n]||UI;r[n]=l(e,n,s)}removeEventListener(e,n){const s=e.$proxies||(e.$proxies={}),r=s[n];if(!r)return;({attach:Wd,detach:Wd,resize:Wd}[n]||MI)(e,n,r),s[n]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,n,s,r){return PP(e,n,s,r)}isAttached(e){const n=e&&lf(e);return!!(n&&n.isConnected)}}function VI(t){return!of()||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas?NI:WI}class As{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(e){const{x:n,y:s}=this.getProps(["x","y"],e);return{x:n,y:s}}hasValue(){return Li(this.x)&&Li(this.y)}getProps(e,n){const s=this.$animations;if(!n||!s)return this;const r={};return e.forEach(a=>{r[a]=s[a]&&s[a].active()?s[a]._to:this[a]}),r}}function qI(t,e){const n=t.options.ticks,s=HI(t),r=Math.min(n.maxTicksLimit||s,s),a=n.major.enabled?GI(e):[],l=a.length,c=a[0],d=a[l-1],f=[];if(l>r)return YI(e,f,a,l/r),f;const m=KI(a,e,r);if(l>0){let g,y;const x=l>1?Math.round((d-c)/(l-1)):null;for(zl(e,f,m,Ae(x)?0:c-x,c),g=0,y=l-1;g<y;g++)zl(e,f,m,a[g],a[g+1]);return zl(e,f,m,d,Ae(x)?e.length:d+x),f}return zl(e,f,m),f}function HI(t){const e=t.options.offset,n=t._tickSize(),s=t._length/n+(e?0:1),r=t._maxLength/n;return Math.floor(Math.min(s,r))}function KI(t,e,n){const s=JI(t),r=e.length/n;if(!s)return Math.max(r,1);const a=TC(s);for(let l=0,c=a.length-1;l<c;l++){const d=a[l];if(d>r)return d}return Math.max(r,1)}function GI(t){const e=[];let n,s;for(n=0,s=t.length;n<s;n++)t[n].major&&e.push(n);return e}function YI(t,e,n,s){let r=0,a=n[0],l;for(s=Math.ceil(s),l=0;l<t.length;l++)l===a&&(e.push(t[l]),r++,a=n[r*s])}function zl(t,e,n,s,r){const a=Pe(s,0),l=Math.min(Pe(r,t.length),t.length);let c=0,d,f,m;for(n=Math.ceil(n),r&&(d=r-s,n=d/Math.floor(d/n)),m=a;m<0;)c++,m=Math.round(a+c*n);for(f=Math.max(a,0);f<l;f++)f===m&&(e.push(t[f]),c++,m=Math.round(a+c*n))}function JI(t){const e=t.length;let n,s;if(e<2)return!1;for(s=t[0],n=1;n<e;++n)if(t[n]-t[n-1]!==s)return!1;return s}const XI=t=>t==="left"?"right":t==="right"?"left":t,Ny=(t,e,n)=>e==="top"||e==="left"?t[e]+n:t[e]-n,Ay=(t,e)=>Math.min(e||t,t);function Oy(t,e){const n=[],s=t.length/e,r=t.length;let a=0;for(;a<r;a+=s)n.push(t[Math.floor(a)]);return n}function QI(t,e,n){const s=t.ticks.length,r=Math.min(e,s-1),a=t._startPixel,l=t._endPixel,c=1e-6;let d=t.getPixelForTick(r),f;if(!(n&&(s===1?f=Math.max(d-a,l-d):e===0?f=(t.getPixelForTick(1)-d)/2:f=(d-t.getPixelForTick(r-1))/2,d+=r<e?f:-f,d<a-c||d>l+c)))return d}function ZI(t,e){He(t,n=>{const s=n.gc,r=s.length/2;let a;if(r>e){for(a=0;a<r;++a)delete n.data[s[a]];s.splice(0,r)}})}function Pa(t){return t.drawTicks?t.tickLength:0}function Ry(t,e){if(!t.display)return 0;const n=_t(t.font,e),s=zt(t.padding);return(et(t.text)?t.text.length:1)*n.lineHeight+s.height}function e1(t,e){return pr(t,{scale:e,type:"scale"})}function t1(t,e,n){return pr(t,{tick:n,index:e,type:"tick"})}function n1(t,e,n){let s=ef(t);return(n&&e!=="right"||!n&&e==="right")&&(s=XI(s)),s}function s1(t,e,n,s){const{top:r,left:a,bottom:l,right:c,chart:d}=t,{chartArea:f,scales:m}=d;let g=0,y,x,_;const S=l-r,b=c-a;if(t.isHorizontal()){if(x=Ft(s,a,c),Re(n)){const k=Object.keys(n)[0],I=n[k];_=m[k].getPixelForValue(I)+S-e}else n==="center"?_=(f.bottom+f.top)/2+S-e:_=Ny(t,n,e);y=c-a}else{if(Re(n)){const k=Object.keys(n)[0],I=n[k];x=m[k].getPixelForValue(I)-b+e}else n==="center"?x=(f.left+f.right)/2-b+e:x=Ny(t,n,e);_=Ft(s,l,r),g=n==="left"?-pt:pt}return{titleX:x,titleY:_,maxWidth:y,rotation:g}}class Yr extends As{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,n){return e}getUserBounds(){let{_userMin:e,_userMax:n,_suggestedMin:s,_suggestedMax:r}=this;return e=hn(e,Number.POSITIVE_INFINITY),n=hn(n,Number.NEGATIVE_INFINITY),s=hn(s,Number.POSITIVE_INFINITY),r=hn(r,Number.NEGATIVE_INFINITY),{min:hn(e,s),max:hn(n,r),minDefined:ut(e),maxDefined:ut(n)}}getMinMax(e){let{min:n,max:s,minDefined:r,maxDefined:a}=this.getUserBounds(),l;if(r&&a)return{min:n,max:s};const c=this.getMatchingVisibleMetas();for(let d=0,f=c.length;d<f;++d)l=c[d].controller.getMinMax(this,e),r||(n=Math.min(n,l.min)),a||(s=Math.max(s,l.max));return n=a&&n>s?s:n,s=r&&n>s?n:s,{min:hn(n,hn(s,n)),max:hn(s,hn(n,s))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Ye(this.options.beforeUpdate,[this])}update(e,n,s){const{beginAtZero:r,grace:a,ticks:l}=this.options,c=l.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=n,this._margins=s=Object.assign({left:0,right:0,top:0,bottom:0},s),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+s.left+s.right:this.height+s.top+s.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=iP(this,a,r),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const d=c<this.ticks.length;this._convertTicksToLabels(d?Oy(this.ticks,c):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),l.display&&(l.autoSkip||l.source==="auto")&&(this.ticks=qI(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),d&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,n,s;this.isHorizontal()?(n=this.left,s=this.right):(n=this.top,s=this.bottom,e=!e),this._startPixel=n,this._endPixel=s,this._reversePixels=e,this._length=s-n,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Ye(this.options.afterUpdate,[this])}beforeSetDimensions(){Ye(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Ye(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),Ye(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Ye(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const n=this.options.ticks;let s,r,a;for(s=0,r=e.length;s<r;s++)a=e[s],a.label=Ye(n.callback,[a.value,s,e],this)}afterTickToLabelConversion(){Ye(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Ye(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,n=e.ticks,s=Ay(this.ticks.length,e.ticks.maxTicksLimit),r=n.minRotation||0,a=n.maxRotation;let l=r,c,d,f;if(!this._isVisible()||!n.display||r>=a||s<=1||!this.isHorizontal()){this.labelRotation=r;return}const m=this._getLabelSizes(),g=m.widest.width,y=m.highest.height,x=Pt(this.chart.width-g,0,this.maxWidth);c=e.offset?this.maxWidth/s:x/(s-1),g+6>c&&(c=x/(s-(e.offset?.5:1)),d=this.maxHeight-Pa(e.grid)-n.padding-Ry(e.title,this.chart.options.font),f=Math.sqrt(g*g+y*y),l=Qh(Math.min(Math.asin(Pt((m.highest.height+6)/c,-1,1)),Math.asin(Pt(d/f,-1,1))-Math.asin(Pt(y/f,-1,1)))),l=Math.max(r,Math.min(a,l))),this.labelRotation=l}afterCalculateLabelRotation(){Ye(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Ye(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:n,options:{ticks:s,title:r,grid:a}}=this,l=this._isVisible(),c=this.isHorizontal();if(l){const d=Ry(r,n.options.font);if(c?(e.width=this.maxWidth,e.height=Pa(a)+d):(e.height=this.maxHeight,e.width=Pa(a)+d),s.display&&this.ticks.length){const{first:f,last:m,widest:g,highest:y}=this._getLabelSizes(),x=s.padding*2,_=Un(this.labelRotation),S=Math.cos(_),b=Math.sin(_);if(c){const k=s.mirror?0:b*g.width+S*y.height;e.height=Math.min(this.maxHeight,e.height+k+x)}else{const k=s.mirror?0:S*g.width+b*y.height;e.width=Math.min(this.maxWidth,e.width+k+x)}this._calculatePadding(f,m,b,S)}}this._handleMargins(),c?(this.width=this._length=n.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=n.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,n,s,r){const{ticks:{align:a,padding:l},position:c}=this.options,d=this.labelRotation!==0,f=c!=="top"&&this.axis==="x";if(this.isHorizontal()){const m=this.getPixelForTick(0)-this.left,g=this.right-this.getPixelForTick(this.ticks.length-1);let y=0,x=0;d?f?(y=r*e.width,x=s*n.height):(y=s*e.height,x=r*n.width):a==="start"?x=n.width:a==="end"?y=e.width:a!=="inner"&&(y=e.width/2,x=n.width/2),this.paddingLeft=Math.max((y-m+l)*this.width/(this.width-m),0),this.paddingRight=Math.max((x-g+l)*this.width/(this.width-g),0)}else{let m=n.height/2,g=e.height/2;a==="start"?(m=0,g=e.height):a==="end"&&(m=n.height,g=0),this.paddingTop=m+l,this.paddingBottom=g+l}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Ye(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:n}=this.options;return n==="top"||n==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let n,s;for(n=0,s=e.length;n<s;n++)Ae(e[n].label)&&(e.splice(n,1),s--,n--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const n=this.options.ticks.sampleSize;let s=this.ticks;n<s.length&&(s=Oy(s,n)),this._labelSizes=e=this._computeLabelSizes(s,s.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,n,s){const{ctx:r,_longestTextCache:a}=this,l=[],c=[],d=Math.floor(n/Ay(n,s));let f=0,m=0,g,y,x,_,S,b,k,I,C,N,O;for(g=0;g<n;g+=d){if(_=e[g].label,S=this._resolveTickFontOptions(g),r.font=b=S.string,k=a[b]=a[b]||{data:{},gc:[]},I=S.lineHeight,C=N=0,!Ae(_)&&!et(_))C=cc(r,k.data,k.gc,C,_),N=I;else if(et(_))for(y=0,x=_.length;y<x;++y)O=_[y],!Ae(O)&&!et(O)&&(C=cc(r,k.data,k.gc,C,O),N+=I);l.push(C),c.push(N),f=Math.max(C,f),m=Math.max(N,m)}ZI(a,n);const U=l.indexOf(f),E=c.indexOf(m),L=R=>({width:l[R]||0,height:c[R]||0});return{first:L(0),last:L(n-1),widest:L(U),highest:L(E),widths:l,heights:c}}getLabelForValue(e){return e}getPixelForValue(e,n){return NaN}getValueForPixel(e){}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const n=this._startPixel+e*this._length;return RC(this._alignToPixels?Mr(this.chart,n,0):n)}getDecimalForPixel(e){const n=(e-this._startPixel)/this._length;return this._reversePixels?1-n:n}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:n}=this;return e<0&&n<0?n:e>0&&n>0?e:0}getContext(e){const n=this.ticks||[];if(e>=0&&e<n.length){const s=n[e];return s.$context||(s.$context=t1(this.getContext(),e,s))}return this.$context||(this.$context=e1(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,n=Un(this.labelRotation),s=Math.abs(Math.cos(n)),r=Math.abs(Math.sin(n)),a=this._getLabelSizes(),l=e.autoSkipPadding||0,c=a?a.widest.width+l:0,d=a?a.highest.height+l:0;return this.isHorizontal()?d*s>c*r?c/s:d/r:d*r<c*s?d/s:c/r}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const n=this.axis,s=this.chart,r=this.options,{grid:a,position:l,border:c}=r,d=a.offset,f=this.isHorizontal(),g=this.ticks.length+(d?1:0),y=Pa(a),x=[],_=c.setContext(this.getContext()),S=_.display?_.width:0,b=S/2,k=function(ee){return Mr(s,ee,S)};let I,C,N,O,U,E,L,R,T,D,Y,se;if(l==="top")I=k(this.bottom),E=this.bottom-y,R=I-b,D=k(e.top)+b,se=e.bottom;else if(l==="bottom")I=k(this.top),D=e.top,se=k(e.bottom)-b,E=I+b,R=this.top+y;else if(l==="left")I=k(this.right),U=this.right-y,L=I-b,T=k(e.left)+b,Y=e.right;else if(l==="right")I=k(this.left),T=e.left,Y=k(e.right)-b,U=I+b,L=this.left+y;else if(n==="x"){if(l==="center")I=k((e.top+e.bottom)/2+.5);else if(Re(l)){const ee=Object.keys(l)[0],he=l[ee];I=k(this.chart.scales[ee].getPixelForValue(he))}D=e.top,se=e.bottom,E=I+b,R=E+y}else if(n==="y"){if(l==="center")I=k((e.left+e.right)/2);else if(Re(l)){const ee=Object.keys(l)[0],he=l[ee];I=k(this.chart.scales[ee].getPixelForValue(he))}U=I-b,L=U-y,T=e.left,Y=e.right}const H=Pe(r.ticks.maxTicksLimit,g),J=Math.max(1,Math.ceil(g/H));for(C=0;C<g;C+=J){const ee=this.getContext(C),he=a.setContext(ee),Z=c.setContext(ee),oe=he.lineWidth,ie=he.color,W=Z.dash||[],B=Z.dashOffset,le=he.tickWidth,ae=he.tickColor,ge=he.tickBorderDash||[],_e=he.tickBorderDashOffset;N=QI(this,C,d),N!==void 0&&(O=Mr(s,N,oe),f?U=L=T=Y=O:E=R=D=se=O,x.push({tx1:U,ty1:E,tx2:L,ty2:R,x1:T,y1:D,x2:Y,y2:se,width:oe,color:ie,borderDash:W,borderDashOffset:B,tickWidth:le,tickColor:ae,tickBorderDash:ge,tickBorderDashOffset:_e}))}return this._ticksLength=g,this._borderValue=I,x}_computeLabelItems(e){const n=this.axis,s=this.options,{position:r,ticks:a}=s,l=this.isHorizontal(),c=this.ticks,{align:d,crossAlign:f,padding:m,mirror:g}=a,y=Pa(s.grid),x=y+m,_=g?-m:x,S=-Un(this.labelRotation),b=[];let k,I,C,N,O,U,E,L,R,T,D,Y,se="middle";if(r==="top")U=this.bottom-_,E=this._getXAxisLabelAlignment();else if(r==="bottom")U=this.top+_,E=this._getXAxisLabelAlignment();else if(r==="left"){const J=this._getYAxisLabelAlignment(y);E=J.textAlign,O=J.x}else if(r==="right"){const J=this._getYAxisLabelAlignment(y);E=J.textAlign,O=J.x}else if(n==="x"){if(r==="center")U=(e.top+e.bottom)/2+x;else if(Re(r)){const J=Object.keys(r)[0],ee=r[J];U=this.chart.scales[J].getPixelForValue(ee)+x}E=this._getXAxisLabelAlignment()}else if(n==="y"){if(r==="center")O=(e.left+e.right)/2-x;else if(Re(r)){const J=Object.keys(r)[0],ee=r[J];O=this.chart.scales[J].getPixelForValue(ee)}E=this._getYAxisLabelAlignment(y).textAlign}n==="y"&&(d==="start"?se="top":d==="end"&&(se="bottom"));const H=this._getLabelSizes();for(k=0,I=c.length;k<I;++k){C=c[k],N=C.label;const J=a.setContext(this.getContext(k));L=this.getPixelForTick(k)+a.labelOffset,R=this._resolveTickFontOptions(k),T=R.lineHeight,D=et(N)?N.length:1;const ee=D/2,he=J.color,Z=J.textStrokeColor,oe=J.textStrokeWidth;let ie=E;l?(O=L,E==="inner"&&(k===I-1?ie=this.options.reverse?"left":"right":k===0?ie=this.options.reverse?"right":"left":ie="center"),r==="top"?f==="near"||S!==0?Y=-D*T+T/2:f==="center"?Y=-H.highest.height/2-ee*T+T:Y=-H.highest.height+T/2:f==="near"||S!==0?Y=T/2:f==="center"?Y=H.highest.height/2-ee*T:Y=H.highest.height-D*T,g&&(Y*=-1),S!==0&&!J.showLabelBackdrop&&(O+=T/2*Math.sin(S))):(U=L,Y=(1-D)*T/2);let W;if(J.showLabelBackdrop){const B=zt(J.backdropPadding),le=H.heights[k],ae=H.widths[k];let ge=Y-B.top,_e=0-B.left;switch(se){case"middle":ge-=le/2;break;case"bottom":ge-=le;break}switch(E){case"center":_e-=ae/2;break;case"right":_e-=ae;break;case"inner":k===I-1?_e-=ae:k>0&&(_e-=ae/2);break}W={left:_e,top:ge,width:ae+B.width,height:le+B.height,color:J.backdropColor}}b.push({label:N,font:R,textOffset:Y,options:{rotation:S,color:he,strokeColor:Z,strokeWidth:oe,textAlign:ie,textBaseline:se,translation:[O,U],backdrop:W}})}return b}_getXAxisLabelAlignment(){const{position:e,ticks:n}=this.options;if(-Un(this.labelRotation))return e==="top"?"left":"right";let r="center";return n.align==="start"?r="left":n.align==="end"?r="right":n.align==="inner"&&(r="inner"),r}_getYAxisLabelAlignment(e){const{position:n,ticks:{crossAlign:s,mirror:r,padding:a}}=this.options,l=this._getLabelSizes(),c=e+a,d=l.widest.width;let f,m;return n==="left"?r?(m=this.right+a,s==="near"?f="left":s==="center"?(f="center",m+=d/2):(f="right",m+=d)):(m=this.right-c,s==="near"?f="right":s==="center"?(f="center",m-=d/2):(f="left",m=this.left)):n==="right"?r?(m=this.left+a,s==="near"?f="right":s==="center"?(f="center",m-=d/2):(f="left",m-=d)):(m=this.left+c,s==="near"?f="left":s==="center"?(f="center",m+=d/2):(f="right",m=this.right)):f="right",{textAlign:f,x:m}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,n=this.options.position;if(n==="left"||n==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(n==="top"||n==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:n},left:s,top:r,width:a,height:l}=this;n&&(e.save(),e.fillStyle=n,e.fillRect(s,r,a,l),e.restore())}getLineWidthForValue(e){const n=this.options.grid;if(!this._isVisible()||!n.display)return 0;const r=this.ticks.findIndex(a=>a.value===e);return r>=0?n.setContext(this.getContext(r)).lineWidth:0}drawGrid(e){const n=this.options.grid,s=this.ctx,r=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let a,l;const c=(d,f,m)=>{!m.width||!m.color||(s.save(),s.lineWidth=m.width,s.strokeStyle=m.color,s.setLineDash(m.borderDash||[]),s.lineDashOffset=m.borderDashOffset,s.beginPath(),s.moveTo(d.x,d.y),s.lineTo(f.x,f.y),s.stroke(),s.restore())};if(n.display)for(a=0,l=r.length;a<l;++a){const d=r[a];n.drawOnChartArea&&c({x:d.x1,y:d.y1},{x:d.x2,y:d.y2},d),n.drawTicks&&c({x:d.tx1,y:d.ty1},{x:d.tx2,y:d.ty2},{color:d.tickColor,width:d.tickWidth,borderDash:d.tickBorderDash,borderDashOffset:d.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:n,options:{border:s,grid:r}}=this,a=s.setContext(this.getContext()),l=s.display?a.width:0;if(!l)return;const c=r.setContext(this.getContext(0)).lineWidth,d=this._borderValue;let f,m,g,y;this.isHorizontal()?(f=Mr(e,this.left,l)-l/2,m=Mr(e,this.right,c)+c/2,g=y=d):(g=Mr(e,this.top,l)-l/2,y=Mr(e,this.bottom,c)+c/2,f=m=d),n.save(),n.lineWidth=a.width,n.strokeStyle=a.color,n.beginPath(),n.moveTo(f,g),n.lineTo(m,y),n.stroke(),n.restore()}drawLabels(e){if(!this.options.ticks.display)return;const s=this.ctx,r=this._computeLabelArea();r&&jc(s,r);const a=this.getLabelItems(e);for(const l of a){const c=l.options,d=l.font,f=l.label,m=l.textOffset;Gr(s,f,0,m,d,c)}r&&Cc(s)}drawTitle(){const{ctx:e,options:{position:n,title:s,reverse:r}}=this;if(!s.display)return;const a=_t(s.font),l=zt(s.padding),c=s.align;let d=a.lineHeight/2;n==="bottom"||n==="center"||Re(n)?(d+=l.bottom,et(s.text)&&(d+=a.lineHeight*(s.text.length-1))):d+=l.top;const{titleX:f,titleY:m,maxWidth:g,rotation:y}=s1(this,d,n,c);Gr(e,s.text,0,0,a,{color:s.color,maxWidth:g,rotation:y,textAlign:n1(c,n,r),textBaseline:"middle",translation:[f,m]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,n=e.ticks&&e.ticks.z||0,s=Pe(e.grid&&e.grid.z,-1),r=Pe(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==Yr.prototype.draw?[{z:n,draw:a=>{this.draw(a)}}]:[{z:s,draw:a=>{this.drawBackground(),this.drawGrid(a),this.drawTitle()}},{z:r,draw:()=>{this.drawBorder()}},{z:n,draw:a=>{this.drawLabels(a)}}]}getMatchingVisibleMetas(e){const n=this.chart.getSortedVisibleDatasetMetas(),s=this.axis+"AxisID",r=[];let a,l;for(a=0,l=n.length;a<l;++a){const c=n[a];c[s]===this.id&&(!e||c.type===e)&&r.push(c)}return r}_resolveTickFontOptions(e){const n=this.options.ticks.setContext(this.getContext(e));return _t(n.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class Ul{constructor(e,n,s){this.type=e,this.scope=n,this.override=s,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const n=Object.getPrototypeOf(e);let s;a1(n)&&(s=this.register(n));const r=this.items,a=e.id,l=this.scope+"."+a;if(!a)throw new Error("class does not have id: "+e);return a in r||(r[a]=e,r1(e,l,s),this.override&&tt.override(e.id,e.overrides)),l}get(e){return this.items[e]}unregister(e){const n=this.items,s=e.id,r=this.scope;s in n&&delete n[s],r&&s in tt[r]&&(delete tt[r][s],this.override&&delete Kr[s])}}function r1(t,e,n){const s=to(Object.create(null),[n?tt.get(n):{},tt.get(e),t.defaults]);tt.set(e,s),t.defaultRoutes&&i1(e,t.defaultRoutes),t.descriptors&&tt.describe(e,t.descriptors)}function i1(t,e){Object.keys(e).forEach(n=>{const s=n.split("."),r=s.pop(),a=[t].concat(s).join("."),l=e[n].split("."),c=l.pop(),d=l.join(".");tt.route(a,r,d,c)})}function a1(t){return"id"in t&&"defaults"in t}class o1{constructor(){this.controllers=new Ul(mr,"datasets",!0),this.elements=new Ul(As,"elements"),this.plugins=new Ul(Object,"plugins"),this.scales=new Ul(Yr,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,n,s){[...n].forEach(r=>{const a=s||this._getRegistryForType(r);s||a.isForType(r)||a===this.plugins&&r.id?this._exec(e,a,r):He(r,l=>{const c=s||this._getRegistryForType(l);this._exec(e,c,l)})})}_exec(e,n,s){const r=Xh(e);Ye(s["before"+r],[],s),n[e](s),Ye(s["after"+r],[],s)}_getRegistryForType(e){for(let n=0;n<this._typedRegistries.length;n++){const s=this._typedRegistries[n];if(s.isForType(e))return s}return this.plugins}_get(e,n,s){const r=n.get(e);if(r===void 0)throw new Error('"'+e+'" is not a registered '+s+".");return r}}var ss=new o1;class l1{constructor(){this._init=void 0}notify(e,n,s,r){if(n==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install")),this._init===void 0)return;const a=r?this._descriptors(e).filter(r):this._descriptors(e),l=this._notify(a,e,n,s);return n==="afterDestroy"&&(this._notify(a,e,"stop"),this._notify(this._init,e,"uninstall"),this._init=void 0),l}_notify(e,n,s,r){r=r||{};for(const a of e){const l=a.plugin,c=l[s],d=[n,r,a.options];if(Ye(c,d,l)===!1&&r.cancelable)return!1}return!0}invalidate(){Ae(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const n=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),n}_createDescriptors(e,n){const s=e&&e.config,r=Pe(s.options&&s.options.plugins,{}),a=c1(s);return r===!1&&!n?[]:d1(e,a,r,n)}_notifyStateChanges(e){const n=this._oldCache||[],s=this._cache,r=(a,l)=>a.filter(c=>!l.some(d=>c.plugin.id===d.plugin.id));this._notify(r(n,s),e,"stop"),this._notify(r(s,n),e,"start")}}function c1(t){const e={},n=[],s=Object.keys(ss.plugins.items);for(let a=0;a<s.length;a++)n.push(ss.getPlugin(s[a]));const r=t.plugins||[];for(let a=0;a<r.length;a++){const l=r[a];n.indexOf(l)===-1&&(n.push(l),e[l.id]=!0)}return{plugins:n,localIds:e}}function u1(t,e){return!e&&t===!1?null:t===!0?{}:t}function d1(t,{plugins:e,localIds:n},s,r){const a=[],l=t.getContext();for(const c of e){const d=c.id,f=u1(s[d],r);f!==null&&a.push({plugin:c,options:h1(t.config,{plugin:c,local:n[d]},f,l)})}return a}function h1(t,{plugin:e,local:n},s,r){const a=t.pluginScopeKeys(e),l=t.getOptionScopes(s,a);return n&&e.defaults&&l.push(e.defaults),t.createResolver(l,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Ih(t,e){const n=tt.datasets[t]||{};return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||n.indexAxis||"x"}function f1(t,e){let n=t;return t==="_index_"?n=e:t==="_value_"&&(n=e==="x"?"y":"x"),n}function p1(t,e){return t===e?"_index_":"_value_"}function My(t){if(t==="x"||t==="y"||t==="r")return t}function m1(t){if(t==="top"||t==="bottom")return"x";if(t==="left"||t==="right")return"y"}function Eh(t,...e){if(My(t))return t;for(const n of e){const s=n.axis||m1(n.position)||t.length>1&&My(t[0].toLowerCase());if(s)return s}throw new Error(`Cannot determine type of '${t}' axis. Please provide 'axis' or 'position' option.`)}function Ly(t,e,n){if(n[e+"AxisID"]===t)return{axis:e}}function g1(t,e){if(e.data&&e.data.datasets){const n=e.data.datasets.filter(s=>s.xAxisID===t||s.yAxisID===t);if(n.length)return Ly(t,"x",n[0])||Ly(t,"y",n[0])}return{}}function y1(t,e){const n=Kr[t.type]||{scales:{}},s=e.scales||{},r=Ih(t.type,e),a=Object.create(null);return Object.keys(s).forEach(l=>{const c=s[l];if(!Re(c))return console.error(`Invalid scale configuration for scale: ${l}`);if(c._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${l}`);const d=Eh(l,c,g1(l,t),tt.scales[c.type]),f=p1(d,r),m=n.scales||{};a[l]=za(Object.create(null),[{axis:d},c,m[d],m[f]])}),t.data.datasets.forEach(l=>{const c=l.type||t.type,d=l.indexAxis||Ih(c,e),m=(Kr[c]||{}).scales||{};Object.keys(m).forEach(g=>{const y=f1(g,d),x=l[y+"AxisID"]||y;a[x]=a[x]||Object.create(null),za(a[x],[{axis:y},s[x],m[g]])})}),Object.keys(a).forEach(l=>{const c=a[l];za(c,[tt.scales[c.type],tt.scale])}),a}function Ux(t){const e=t.options||(t.options={});e.plugins=Pe(e.plugins,{}),e.scales=y1(t,e)}function Wx(t){return t=t||{},t.datasets=t.datasets||[],t.labels=t.labels||[],t}function v1(t){return t=t||{},t.data=Wx(t.data),Ux(t),t}const Dy=new Map,Vx=new Set;function Wl(t,e){let n=Dy.get(t);return n||(n=e(),Dy.set(t,n),Vx.add(n)),n}const Ia=(t,e,n)=>{const s=dr(e,n);s!==void 0&&t.add(s)};class x1{constructor(e){this._config=v1(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=Wx(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),Ux(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return Wl(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,n){return Wl(`${e}.transition.${n}`,()=>[[`datasets.${e}.transitions.${n}`,`transitions.${n}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,n){return Wl(`${e}-${n}`,()=>[[`datasets.${e}.elements.${n}`,`datasets.${e}`,`elements.${n}`,""]])}pluginScopeKeys(e){const n=e.id,s=this.type;return Wl(`${s}-plugin-${n}`,()=>[[`plugins.${n}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,n){const s=this._scopeCache;let r=s.get(e);return(!r||n)&&(r=new Map,s.set(e,r)),r}getOptionScopes(e,n,s){const{options:r,type:a}=this,l=this._cachedScopes(e,s),c=l.get(n);if(c)return c;const d=new Set;n.forEach(m=>{e&&(d.add(e),m.forEach(g=>Ia(d,e,g))),m.forEach(g=>Ia(d,r,g)),m.forEach(g=>Ia(d,Kr[a]||{},g)),m.forEach(g=>Ia(d,tt,g)),m.forEach(g=>Ia(d,Ch,g))});const f=Array.from(d);return f.length===0&&f.push(Object.create(null)),Vx.has(n)&&l.set(n,f),f}chartOptionScopes(){const{options:e,type:n}=this;return[e,Kr[n]||{},tt.datasets[n]||{},{type:n},tt,Ch]}resolveNamedOptions(e,n,s,r=[""]){const a={$shared:!0},{resolver:l,subPrefixes:c}=Fy(this._resolverCache,e,r);let d=l;if(w1(l,n)){a.$shared=!1,s=hr(s)?s():s;const f=this.createResolver(e,s,c);d=Di(l,s,f)}for(const f of n)a[f]=d[f];return a}createResolver(e,n,s=[""],r){const{resolver:a}=Fy(this._resolverCache,e,s);return Re(n)?Di(a,n,void 0,r):a}}function Fy(t,e,n){let s=t.get(e);s||(s=new Map,t.set(e,s));const r=n.join();let a=s.get(r);return a||(a={resolver:sf(e,n),subPrefixes:n.filter(c=>!c.toLowerCase().includes("hover"))},s.set(r,a)),a}const b1=t=>Re(t)&&Object.getOwnPropertyNames(t).some(e=>hr(t[e]));function w1(t,e){const{isScriptable:n,isIndexable:s}=wx(t);for(const r of e){const a=n(r),l=s(r),c=(l||a)&&t[r];if(a&&(hr(c)||b1(c))||l&&et(c))return!0}return!1}var _1="4.5.1";const S1=["top","bottom","left","right","chartArea"];function By(t,e){return t==="top"||t==="bottom"||S1.indexOf(t)===-1&&e==="x"}function $y(t,e){return function(n,s){return n[t]===s[t]?n[e]-s[e]:n[t]-s[t]}}function zy(t){const e=t.chart,n=e.options.animation;e.notifyPlugins("afterRender"),Ye(n&&n.onComplete,[t],e)}function k1(t){const e=t.chart,n=e.options.animation;Ye(n&&n.onProgress,[t],e)}function qx(t){return of()&&typeof t=="string"?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const Xl={},Uy=t=>{const e=qx(t);return Object.values(Xl).filter(n=>n.canvas===e).pop()};function j1(t,e,n){const s=Object.keys(t);for(const r of s){const a=+r;if(a>=e){const l=t[r];delete t[r],(n>0||a>e)&&(t[a+n]=l)}}}function C1(t,e,n,s){return!n||t.type==="mouseout"?null:s?e:t}class df{static defaults=tt;static instances=Xl;static overrides=Kr;static registry=ss;static version=_1;static getChart=Uy;static register(...e){ss.add(...e),Wy()}static unregister(...e){ss.remove(...e),Wy()}constructor(e,n){const s=this.config=new x1(n),r=qx(e),a=Uy(r);if(a)throw new Error("Canvas is already in use. Chart with ID '"+a.id+"' must be destroyed before the canvas with ID '"+a.canvas.id+"' can be reused.");const l=s.createResolver(s.chartOptionScopes(),this.getContext());this.platform=new(s.platform||VI(r)),this.platform.updateConfig(s);const c=this.platform.acquireContext(r,l.aspectRatio),d=c&&c.canvas,f=d&&d.height,m=d&&d.width;if(this.id=wC(),this.ctx=c,this.canvas=d,this.width=m,this.height=f,this._options=l,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new l1,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=FC(g=>this.update(g),l.resizeDelay||0),this._dataChanges=[],Xl[this.id]=this,!c||!d){console.error("Failed to create chart: can't acquire context from the given item");return}ws.listen(this,"complete",zy),ws.listen(this,"progress",k1),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:n},width:s,height:r,_aspectRatio:a}=this;return Ae(e)?n&&a?a:r?s/r:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return ss}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():dy(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return ly(this.canvas,this.ctx),this}stop(){return ws.stop(this),this}resize(e,n){ws.running(this)?this._resizeBeforeDraw={width:e,height:n}:this._resize(e,n)}_resize(e,n){const s=this.options,r=this.canvas,a=s.maintainAspectRatio&&this.aspectRatio,l=this.platform.getMaximumSize(r,e,n,a),c=s.devicePixelRatio||this.platform.getDevicePixelRatio(),d=this.width?"resize":"attach";this.width=l.width,this.height=l.height,this._aspectRatio=this.aspectRatio,dy(this,c,!0)&&(this.notifyPlugins("resize",{size:l}),Ye(s.onResize,[this,l],this),this.attached&&this._doResize(d)&&this.render())}ensureScalesHaveIDs(){const n=this.options.scales||{};He(n,(s,r)=>{s.id=r})}buildOrUpdateScales(){const e=this.options,n=e.scales,s=this.scales,r=Object.keys(s).reduce((l,c)=>(l[c]=!1,l),{});let a=[];n&&(a=a.concat(Object.keys(n).map(l=>{const c=n[l],d=Eh(l,c),f=d==="r",m=d==="x";return{options:c,dposition:f?"chartArea":m?"bottom":"left",dtype:f?"radialLinear":m?"category":"linear"}}))),He(a,l=>{const c=l.options,d=c.id,f=Eh(d,c),m=Pe(c.type,l.dtype);(c.position===void 0||By(c.position,f)!==By(l.dposition))&&(c.position=l.dposition),r[d]=!0;let g=null;if(d in s&&s[d].type===m)g=s[d];else{const y=ss.getScale(m);g=new y({id:d,type:m,ctx:this.ctx,chart:this}),s[g.id]=g}g.init(c,e)}),He(r,(l,c)=>{l||delete s[c]}),He(s,l=>{$t.configure(this,l,l.options),$t.addBox(this,l)})}_updateMetasets(){const e=this._metasets,n=this.data.datasets.length,s=e.length;if(e.sort((r,a)=>r.index-a.index),s>n){for(let r=n;r<s;++r)this._destroyDatasetMeta(r);e.splice(n,s-n)}this._sortedMetasets=e.slice(0).sort($y("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:n}}=this;e.length>n.length&&delete this._stacks,e.forEach((s,r)=>{n.filter(a=>a===s._dataset).length===0&&this._destroyDatasetMeta(r)})}buildOrUpdateControllers(){const e=[],n=this.data.datasets;let s,r;for(this._removeUnreferencedMetasets(),s=0,r=n.length;s<r;s++){const a=n[s];let l=this.getDatasetMeta(s);const c=a.type||this.config.type;if(l.type&&l.type!==c&&(this._destroyDatasetMeta(s),l=this.getDatasetMeta(s)),l.type=c,l.indexAxis=a.indexAxis||Ih(c,this.options),l.order=a.order||0,l.index=s,l.label=""+a.label,l.visible=this.isDatasetVisible(s),l.controller)l.controller.updateIndex(s),l.controller.linkScales();else{const d=ss.getController(c),{datasetElementType:f,dataElementType:m}=tt.datasets[c];Object.assign(d,{dataElementType:ss.getElement(m),datasetElementType:f&&ss.getElement(f)}),l.controller=new d(this,s),e.push(l.controller)}}return this._updateMetasets(),e}_resetElements(){He(this.data.datasets,(e,n)=>{this.getDatasetMeta(n).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const n=this.config;n.update();const s=this._options=n.createResolver(n.chartOptionScopes(),this.getContext()),r=this._animationsDisabled=!s.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const a=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let l=0;for(let f=0,m=this.data.datasets.length;f<m;f++){const{controller:g}=this.getDatasetMeta(f),y=!r&&a.indexOf(g)===-1;g.buildOrUpdateElements(y),l=Math.max(+g.getMaxOverflow(),l)}l=this._minPadding=s.layout.autoPadding?l:0,this._updateLayout(l),r||He(a,f=>{f.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort($y("z","_idx"));const{_active:c,_lastEvent:d}=this;d?this._eventHandler(d,!0):c.length&&this._updateHoverStyles(c,c,!0),this.render()}_updateScales(){He(this.scales,e=>{$t.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,n=new Set(Object.keys(this._listeners)),s=new Set(e.events);(!Zg(n,s)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,n=this._getUniformDataChanges()||[];for(const{method:s,start:r,count:a}of n){const l=s==="_removeElements"?-a:a;j1(e,r,l)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const n=this.data.datasets.length,s=a=>new Set(e.filter(l=>l[0]===a).map((l,c)=>c+","+l.splice(1).join(","))),r=s(0);for(let a=1;a<n;a++)if(!Zg(r,s(a)))return;return Array.from(r).map(a=>a.split(",")).map(a=>({method:a[1],start:+a[2],count:+a[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;$t.update(this,this.width,this.height,e);const n=this.chartArea,s=n.width<=0||n.height<=0;this._layers=[],He(this.boxes,r=>{s&&r.position==="chartArea"||(r.configure&&r.configure(),this._layers.push(...r._layers()))},this),this._layers.forEach((r,a)=>{r._idx=a}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let n=0,s=this.data.datasets.length;n<s;++n)this.getDatasetMeta(n).controller.configure();for(let n=0,s=this.data.datasets.length;n<s;++n)this._updateDataset(n,hr(e)?e({datasetIndex:n}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,n){const s=this.getDatasetMeta(e),r={meta:s,index:e,mode:n,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",r)!==!1&&(s.controller._update(n),r.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",r))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(ws.has(this)?this.attached&&!ws.running(this)&&ws.start(this):(this.draw(),zy({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:s,height:r}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(s,r)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const n=this._layers;for(e=0;e<n.length&&n[e].z<=0;++e)n[e].draw(this.chartArea);for(this._drawDatasets();e<n.length;++e)n[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const n=this._sortedMetasets,s=[];let r,a;for(r=0,a=n.length;r<a;++r){const l=n[r];(!e||l.visible)&&s.push(l)}return s}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let n=e.length-1;n>=0;--n)this._drawDataset(e[n]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const n=this.ctx,s={meta:e,index:e.index,cancelable:!0},r=Ax(this,e);this.notifyPlugins("beforeDatasetDraw",s)!==!1&&(r&&jc(n,r),e.controller.draw(),r&&Cc(n),s.cancelable=!1,this.notifyPlugins("afterDatasetDraw",s))}isPointInArea(e){return Is(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,n,s,r){const a=SI.modes[n];return typeof a=="function"?a(this,e,s,r):[]}getDatasetMeta(e){const n=this.data.datasets[e],s=this._metasets;let r=s.filter(a=>a&&a._dataset===n).pop();return r||(r={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:n&&n.order||0,index:e,_dataset:n,_parsed:[],_sorted:!1},s.push(r)),r}getContext(){return this.$context||(this.$context=pr(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const n=this.data.datasets[e];if(!n)return!1;const s=this.getDatasetMeta(e);return typeof s.hidden=="boolean"?!s.hidden:!n.hidden}setDatasetVisibility(e,n){const s=this.getDatasetMeta(e);s.hidden=!n}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,n,s){const r=s?"show":"hide",a=this.getDatasetMeta(e),l=a.controller._resolveAnimations(void 0,r);no(n)?(a.data[n].hidden=!s,this.update()):(this.setDatasetVisibility(e,s),l.update(a,{visible:s}),this.update(c=>c.datasetIndex===e?r:void 0))}hide(e,n){this._updateVisibility(e,n,!1)}show(e,n){this._updateVisibility(e,n,!0)}_destroyDatasetMeta(e){const n=this._metasets[e];n&&n.controller&&n.controller._destroy(),delete this._metasets[e]}_stop(){let e,n;for(this.stop(),ws.remove(this),e=0,n=this.data.datasets.length;e<n;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:n}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),ly(e,n),this.platform.releaseContext(n),this.canvas=null,this.ctx=null),delete Xl[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,n=this.platform,s=(a,l)=>{n.addEventListener(this,a,l),e[a]=l},r=(a,l,c)=>{a.offsetX=l,a.offsetY=c,this._eventHandler(a)};He(this.options.events,a=>s(a,r))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,n=this.platform,s=(d,f)=>{n.addEventListener(this,d,f),e[d]=f},r=(d,f)=>{e[d]&&(n.removeEventListener(this,d,f),delete e[d])},a=(d,f)=>{this.canvas&&this.resize(d,f)};let l;const c=()=>{r("attach",c),this.attached=!0,this.resize(),s("resize",a),s("detach",l)};l=()=>{this.attached=!1,r("resize",a),this._stop(),this._resize(0,0),s("attach",c)},n.isAttached(this.canvas)?c():l()}unbindEvents(){He(this._listeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._listeners={},He(this._responsiveListeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,n,s){const r=s?"set":"remove";let a,l,c,d;for(n==="dataset"&&(a=this.getDatasetMeta(e[0].datasetIndex),a.controller["_"+r+"DatasetHoverStyle"]()),c=0,d=e.length;c<d;++c){l=e[c];const f=l&&this.getDatasetMeta(l.datasetIndex).controller;f&&f[r+"HoverStyle"](l.element,l.datasetIndex,l.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const n=this._active||[],s=e.map(({datasetIndex:a,index:l})=>{const c=this.getDatasetMeta(a);if(!c)throw new Error("No dataset found at index "+a);return{datasetIndex:a,element:c.data[l],index:l}});!ac(s,n)&&(this._active=s,this._lastEvent=null,this._updateHoverStyles(s,n))}notifyPlugins(e,n,s){return this._plugins.notify(this,e,n,s)}isPluginEnabled(e){return this._plugins._cache.filter(n=>n.plugin.id===e).length===1}_updateHoverStyles(e,n,s){const r=this.options.hover,a=(d,f)=>d.filter(m=>!f.some(g=>m.datasetIndex===g.datasetIndex&&m.index===g.index)),l=a(n,e),c=s?e:a(e,n);l.length&&this.updateHoverStyle(l,r.mode,!1),c.length&&r.mode&&this.updateHoverStyle(c,r.mode,!0)}_eventHandler(e,n){const s={event:e,replay:n,cancelable:!0,inChartArea:this.isPointInArea(e)},r=l=>(l.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",s,r)===!1)return;const a=this._handleEvent(e,n,s.inChartArea);return s.cancelable=!1,this.notifyPlugins("afterEvent",s,r),(a||s.changed)&&this.render(),this}_handleEvent(e,n,s){const{_active:r=[],options:a}=this,l=n,c=this._getActiveElements(e,r,s,l),d=PC(e),f=C1(e,this._lastEvent,s,d);s&&(this._lastEvent=null,Ye(a.onHover,[e,c,this],this),d&&Ye(a.onClick,[e,c,this],this));const m=!ac(c,r);return(m||n)&&(this._active=c,this._updateHoverStyles(c,r,n)),this._lastEvent=f,m}_getActiveElements(e,n,s,r){if(e.type==="mouseout")return[];if(!s)return n;const a=this.options.hover;return this.getElementsAtEventForMode(e,a.mode,a,r)}}function Wy(){return He(df.instances,t=>t._plugins.invalidate())}function P1(t,e,n){const{startAngle:s,x:r,y:a,outerRadius:l,innerRadius:c,options:d}=e,{borderWidth:f,borderJoinStyle:m}=d,g=Math.min(f/l,Bt(s-n));if(t.beginPath(),t.arc(r,a,l-f/2,s+g/2,n-g/2),c>0){const y=Math.min(f/c,Bt(s-n));t.arc(r,a,c+f/2,n-y/2,s+y/2,!0)}else{const y=Math.min(f/2,l*Bt(s-n));if(m==="round")t.arc(r,a,y,n-ze/2,s+ze/2,!0);else if(m==="bevel"){const x=2*y*y,_=-x*Math.cos(n+ze/2)+r,S=-x*Math.sin(n+ze/2)+a,b=x*Math.cos(s+ze/2)+r,k=x*Math.sin(s+ze/2)+a;t.lineTo(_,S),t.lineTo(b,k)}}t.closePath(),t.moveTo(0,0),t.rect(0,0,t.canvas.width,t.canvas.height),t.clip("evenodd")}function I1(t,e,n){const{startAngle:s,pixelMargin:r,x:a,y:l,outerRadius:c,innerRadius:d}=e;let f=r/c;t.beginPath(),t.arc(a,l,c,s-f,n+f),d>r?(f=r/d,t.arc(a,l,d,n+f,s-f,!0)):t.arc(a,l,r,n+pt,s-pt),t.closePath(),t.clip()}function E1(t){return nf(t,["outerStart","outerEnd","innerStart","innerEnd"])}function T1(t,e,n,s){const r=E1(t.options.borderRadius),a=(n-e)/2,l=Math.min(a,s*e/2),c=d=>{const f=(n-Math.min(a,d))*s/2;return Pt(d,0,Math.min(a,f))};return{outerStart:c(r.outerStart),outerEnd:c(r.outerEnd),innerStart:Pt(r.innerStart,0,l),innerEnd:Pt(r.innerEnd,0,l)}}function Pi(t,e,n,s){return{x:n+t*Math.cos(e),y:s+t*Math.sin(e)}}function hc(t,e,n,s,r,a){const{x:l,y:c,startAngle:d,pixelMargin:f,innerRadius:m}=e,g=Math.max(e.outerRadius+s+n-f,0),y=m>0?m+s+n+f:0;let x=0;const _=r-d;if(s){const J=m>0?m-s:0,ee=g>0?g-s:0,he=(J+ee)/2,Z=he!==0?_*he/(he+s):_;x=(_-Z)/2}const S=Math.max(.001,_*g-n/ze)/g,b=(_-S)/2,k=d+b+x,I=r-b-x,{outerStart:C,outerEnd:N,innerStart:O,innerEnd:U}=T1(e,y,g,I-k),E=g-C,L=g-N,R=k+C/E,T=I-N/L,D=y+O,Y=y+U,se=k+O/D,H=I-U/Y;if(t.beginPath(),a){const J=(R+T)/2;if(t.arc(l,c,g,R,J),t.arc(l,c,g,J,T),N>0){const oe=Pi(L,T,l,c);t.arc(oe.x,oe.y,N,T,I+pt)}const ee=Pi(Y,I,l,c);if(t.lineTo(ee.x,ee.y),U>0){const oe=Pi(Y,H,l,c);t.arc(oe.x,oe.y,U,I+pt,H+Math.PI)}const he=(I-U/y+(k+O/y))/2;if(t.arc(l,c,y,I-U/y,he,!0),t.arc(l,c,y,he,k+O/y,!0),O>0){const oe=Pi(D,se,l,c);t.arc(oe.x,oe.y,O,se+Math.PI,k-pt)}const Z=Pi(E,k,l,c);if(t.lineTo(Z.x,Z.y),C>0){const oe=Pi(E,R,l,c);t.arc(oe.x,oe.y,C,k-pt,R)}}else{t.moveTo(l,c);const J=Math.cos(R)*g+l,ee=Math.sin(R)*g+c;t.lineTo(J,ee);const he=Math.cos(T)*g+l,Z=Math.sin(T)*g+c;t.lineTo(he,Z)}t.closePath()}function N1(t,e,n,s,r){const{fullCircles:a,startAngle:l,circumference:c}=e;let d=e.endAngle;if(a){hc(t,e,n,s,d,r);for(let f=0;f<a;++f)t.fill();isNaN(c)||(d=l+(c%Qe||Qe))}return hc(t,e,n,s,d,r),t.fill(),d}function A1(t,e,n,s,r){const{fullCircles:a,startAngle:l,circumference:c,options:d}=e,{borderWidth:f,borderJoinStyle:m,borderDash:g,borderDashOffset:y,borderRadius:x}=d,_=d.borderAlign==="inner";if(!f)return;t.setLineDash(g||[]),t.lineDashOffset=y,_?(t.lineWidth=f*2,t.lineJoin=m||"round"):(t.lineWidth=f,t.lineJoin=m||"bevel");let S=e.endAngle;if(a){hc(t,e,n,s,S,r);for(let b=0;b<a;++b)t.stroke();isNaN(c)||(S=l+(c%Qe||Qe))}_&&I1(t,e,S),d.selfJoin&&S-l>=ze&&x===0&&m!=="miter"&&P1(t,e,S),a||(hc(t,e,n,s,S,r),t.stroke())}class O1 extends As{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:e=>e!=="borderDash"};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(e){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,n,s){const r=this.getProps(["x","y"],s),{angle:a,distance:l}=dx(r,{x:e,y:n}),{startAngle:c,endAngle:d,innerRadius:f,outerRadius:m,circumference:g}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],s),y=(this.options.spacing+this.options.borderWidth)/2,x=Pe(g,d-c),_=so(a,c,d)&&c!==d,S=x>=Qe||_,b=Cs(l,f+y,m+y);return S&&b}getCenterPoint(e){const{x:n,y:s,startAngle:r,endAngle:a,innerRadius:l,outerRadius:c}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],e),{offset:d,spacing:f}=this.options,m=(r+a)/2,g=(l+c+f+d)/2;return{x:n+Math.cos(m)*g,y:s+Math.sin(m)*g}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){const{options:n,circumference:s}=this,r=(n.offset||0)/4,a=(n.spacing||0)/2,l=n.circular;if(this.pixelMargin=n.borderAlign==="inner"?.33:0,this.fullCircles=s>Qe?Math.floor(s/Qe):0,s===0||this.innerRadius<0||this.outerRadius<0)return;e.save();const c=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(c)*r,Math.sin(c)*r);const d=1-Math.sin(Math.min(ze,s||0)),f=r*d;e.fillStyle=n.backgroundColor,e.strokeStyle=n.borderColor,N1(e,this,f,a,l),A1(e,this,f,a,l),e.restore()}}function Hx(t,e,n=e){t.lineCap=Pe(n.borderCapStyle,e.borderCapStyle),t.setLineDash(Pe(n.borderDash,e.borderDash)),t.lineDashOffset=Pe(n.borderDashOffset,e.borderDashOffset),t.lineJoin=Pe(n.borderJoinStyle,e.borderJoinStyle),t.lineWidth=Pe(n.borderWidth,e.borderWidth),t.strokeStyle=Pe(n.borderColor,e.borderColor)}function R1(t,e,n){t.lineTo(n.x,n.y)}function M1(t){return t.stepped?JC:t.tension||t.cubicInterpolationMode==="monotone"?XC:R1}function Kx(t,e,n={}){const s=t.length,{start:r=0,end:a=s-1}=n,{start:l,end:c}=e,d=Math.max(r,l),f=Math.min(a,c),m=r<l&&a<l||r>c&&a>c;return{count:s,start:d,loop:e.loop,ilen:f<d&&!m?s+f-d:f-d}}function L1(t,e,n,s){const{points:r,options:a}=e,{count:l,start:c,loop:d,ilen:f}=Kx(r,n,s),m=M1(a);let{move:g=!0,reverse:y}=s||{},x,_,S;for(x=0;x<=f;++x)_=r[(c+(y?f-x:x))%l],!_.skip&&(g?(t.moveTo(_.x,_.y),g=!1):m(t,S,_,y,a.stepped),S=_);return d&&(_=r[(c+(y?f:0))%l],m(t,S,_,y,a.stepped)),!!d}function D1(t,e,n,s){const r=e.points,{count:a,start:l,ilen:c}=Kx(r,n,s),{move:d=!0,reverse:f}=s||{};let m=0,g=0,y,x,_,S,b,k;const I=N=>(l+(f?c-N:N))%a,C=()=>{S!==b&&(t.lineTo(m,b),t.lineTo(m,S),t.lineTo(m,k))};for(d&&(x=r[I(0)],t.moveTo(x.x,x.y)),y=0;y<=c;++y){if(x=r[I(y)],x.skip)continue;const N=x.x,O=x.y,U=N|0;U===_?(O<S?S=O:O>b&&(b=O),m=(g*m+N)/++g):(C(),t.lineTo(N,O),_=U,g=0,S=b=O),k=O}C()}function Th(t){const e=t.options,n=e.borderDash&&e.borderDash.length;return!t._decimated&&!t._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!n?D1:L1}function F1(t){return t.stepped?EP:t.tension||t.cubicInterpolationMode==="monotone"?TP:$r}function B1(t,e,n,s){let r=e._path;r||(r=e._path=new Path2D,e.path(r,n,s)&&r.closePath()),Hx(t,e.options),t.stroke(r)}function $1(t,e,n,s){const{segments:r,options:a}=e,l=Th(e);for(const c of r)Hx(t,a,c.style),t.beginPath(),l(t,e,c,{start:n,end:n+s-1})&&t.closePath(),t.stroke()}const z1=typeof Path2D=="function";function U1(t,e,n,s){z1&&!e.options.segment?B1(t,e,n,s):$1(t,e,n,s)}class Ec extends As{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"};constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,n){const s=this.options;if((s.tension||s.cubicInterpolationMode==="monotone")&&!s.stepped&&!this._pointsUpdated){const r=s.spanGaps?this._loop:this._fullLoop;wP(this._points,s,e,r,n),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=LP(this,this.options.segment))}first(){const e=this.segments,n=this.points;return e.length&&n[e[0].start]}last(){const e=this.segments,n=this.points,s=e.length;return s&&n[e[s-1].end]}interpolate(e,n){const s=this.options,r=e[n],a=this.points,l=Nx(this,{property:n,start:r,end:r});if(!l.length)return;const c=[],d=F1(s);let f,m;for(f=0,m=l.length;f<m;++f){const{start:g,end:y}=l[f],x=a[g],_=a[y];if(x===_){c.push(x);continue}const S=Math.abs((r-x[n])/(_[n]-x[n])),b=d(x,_,S,s.stepped);b[n]=e[n],c.push(b)}return c.length===1?c[0]:c}pathSegment(e,n,s){return Th(this)(e,this,n,s)}path(e,n,s){const r=this.segments,a=Th(this);let l=this._loop;n=n||0,s=s||this.points.length-n;for(const c of r)l&=a(e,this,c,{start:n,end:n+s-1});return!!l}draw(e,n,s,r){const a=this.options||{};(this.points||[]).length&&a.borderWidth&&(e.save(),U1(e,this,s,r),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function Vy(t,e,n,s){const r=t.options,{[n]:a}=t.getProps([n],s);return Math.abs(e-a)<r.radius+r.hitRadius}class W1 extends As{static id="point";parsed;skip;stop;static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,n,s){const r=this.options,{x:a,y:l}=this.getProps(["x","y"],s);return Math.pow(e-a,2)+Math.pow(n-l,2)<Math.pow(r.hitRadius+r.radius,2)}inXRange(e,n){return Vy(this,e,"x",n)}inYRange(e,n){return Vy(this,e,"y",n)}getCenterPoint(e){const{x:n,y:s}=this.getProps(["x","y"],e);return{x:n,y:s}}size(e){e=e||this.options||{};let n=e.radius||0;n=Math.max(n,n&&e.hoverRadius||0);const s=n&&e.borderWidth||0;return(n+s)*2}draw(e,n){const s=this.options;this.skip||s.radius<.1||!Is(this,n,this.size(s)/2)||(e.strokeStyle=s.borderColor,e.lineWidth=s.borderWidth,e.fillStyle=s.backgroundColor,Ph(e,s,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}function Gx(t,e){const{x:n,y:s,base:r,width:a,height:l}=t.getProps(["x","y","base","width","height"],e);let c,d,f,m,g;return t.horizontal?(g=l/2,c=Math.min(n,r),d=Math.max(n,r),f=s-g,m=s+g):(g=a/2,c=n-g,d=n+g,f=Math.min(s,r),m=Math.max(s,r)),{left:c,top:f,right:d,bottom:m}}function lr(t,e,n,s){return t?0:Pt(e,n,s)}function V1(t,e,n){const s=t.options.borderWidth,r=t.borderSkipped,a=bx(s);return{t:lr(r.top,a.top,0,n),r:lr(r.right,a.right,0,e),b:lr(r.bottom,a.bottom,0,n),l:lr(r.left,a.left,0,e)}}function q1(t,e,n){const{enableBorderRadius:s}=t.getProps(["enableBorderRadius"]),r=t.options.borderRadius,a=qr(r),l=Math.min(e,n),c=t.borderSkipped,d=s||Re(r);return{topLeft:lr(!d||c.top||c.left,a.topLeft,0,l),topRight:lr(!d||c.top||c.right,a.topRight,0,l),bottomLeft:lr(!d||c.bottom||c.left,a.bottomLeft,0,l),bottomRight:lr(!d||c.bottom||c.right,a.bottomRight,0,l)}}function H1(t){const e=Gx(t),n=e.right-e.left,s=e.bottom-e.top,r=V1(t,n/2,s/2),a=q1(t,n/2,s/2);return{outer:{x:e.left,y:e.top,w:n,h:s,radius:a},inner:{x:e.left+r.l,y:e.top+r.t,w:n-r.l-r.r,h:s-r.t-r.b,radius:{topLeft:Math.max(0,a.topLeft-Math.max(r.t,r.l)),topRight:Math.max(0,a.topRight-Math.max(r.t,r.r)),bottomLeft:Math.max(0,a.bottomLeft-Math.max(r.b,r.l)),bottomRight:Math.max(0,a.bottomRight-Math.max(r.b,r.r))}}}}function Vd(t,e,n,s){const r=e===null,a=n===null,c=t&&!(r&&a)&&Gx(t,s);return c&&(r||Cs(e,c.left,c.right))&&(a||Cs(n,c.top,c.bottom))}function K1(t){return t.topLeft||t.topRight||t.bottomLeft||t.bottomRight}function G1(t,e){t.rect(e.x,e.y,e.w,e.h)}function qd(t,e,n={}){const s=t.x!==n.x?-e:0,r=t.y!==n.y?-e:0,a=(t.x+t.w!==n.x+n.w?e:0)-s,l=(t.y+t.h!==n.y+n.h?e:0)-r;return{x:t.x+s,y:t.y+r,w:t.w+a,h:t.h+l,radius:t.radius}}class Y1 extends As{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:n,options:{borderColor:s,backgroundColor:r}}=this,{inner:a,outer:l}=H1(this),c=K1(l.radius)?ro:G1;e.save(),(l.w!==a.w||l.h!==a.h)&&(e.beginPath(),c(e,qd(l,n,a)),e.clip(),c(e,qd(a,-n,l)),e.fillStyle=s,e.fill("evenodd")),e.beginPath(),c(e,qd(a,n)),e.fillStyle=r,e.fill(),e.restore()}inRange(e,n,s){return Vd(this,e,n,s)}inXRange(e,n){return Vd(this,e,null,n)}inYRange(e,n){return Vd(this,null,e,n)}getCenterPoint(e){const{x:n,y:s,base:r,horizontal:a}=this.getProps(["x","y","base","horizontal"],e);return{x:a?(n+r)/2:n,y:a?s:(s+r)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}var J1=Object.freeze({__proto__:null,ArcElement:O1,BarElement:Y1,LineElement:Ec,PointElement:W1});const Nh=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],qy=Nh.map(t=>t.replace("rgb(","rgba(").replace(")",", 0.5)"));function Yx(t){return Nh[t%Nh.length]}function Jx(t){return qy[t%qy.length]}function X1(t,e){return t.borderColor=Yx(e),t.backgroundColor=Jx(e),++e}function Q1(t,e){return t.backgroundColor=t.data.map(()=>Yx(e++)),e}function Z1(t,e){return t.backgroundColor=t.data.map(()=>Jx(e++)),e}function eE(t){let e=0;return(n,s)=>{const r=t.getDatasetMeta(s).controller;r instanceof cf?e=Q1(n,e):r instanceof Lx?e=Z1(n,e):r&&(e=X1(n,e))}}function Hy(t){let e;for(e in t)if(t[e].borderColor||t[e].backgroundColor)return!0;return!1}function tE(t){return t&&(t.borderColor||t.backgroundColor)}function nE(){return tt.borderColor!=="rgba(0,0,0,0.1)"||tt.backgroundColor!=="rgba(0,0,0,0.1)"}var sE={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(t,e,n){if(!n.enabled)return;const{data:{datasets:s},options:r}=t.config,{elements:a}=r,l=Hy(s)||tE(r)||a&&Hy(a)||nE();if(!n.forceOverride&&l)return;const c=eE(t);s.forEach(c)}};function rE(t,e,n,s,r){const a=r.samples||s;if(a>=n)return t.slice(e,e+n);const l=[],c=(n-2)/(a-2);let d=0;const f=e+n-1;let m=e,g,y,x,_,S;for(l[d++]=t[m],g=0;g<a-2;g++){let b=0,k=0,I;const C=Math.floor((g+1)*c)+1+e,N=Math.min(Math.floor((g+2)*c)+1,n)+e,O=N-C;for(I=C;I<N;I++)b+=t[I].x,k+=t[I].y;b/=O,k/=O;const U=Math.floor(g*c)+1+e,E=Math.min(Math.floor((g+1)*c)+1,n)+e,{x:L,y:R}=t[m];for(x=_=-1,I=U;I<E;I++)_=.5*Math.abs((L-b)*(t[I].y-R)-(L-t[I].x)*(k-R)),_>x&&(x=_,y=t[I],S=I);l[d++]=y,m=S}return l[d++]=t[f],l}function iE(t,e,n,s){let r=0,a=0,l,c,d,f,m,g,y,x,_,S;const b=[],k=e+n-1,I=t[e].x,N=t[k].x-I;for(l=e;l<e+n;++l){c=t[l],d=(c.x-I)/N*s,f=c.y;const O=d|0;if(O===m)f<_?(_=f,g=l):f>S&&(S=f,y=l),r=(a*r+c.x)/++a;else{const U=l-1;if(!Ae(g)&&!Ae(y)){const E=Math.min(g,y),L=Math.max(g,y);E!==x&&E!==U&&b.push({...t[E],x:r}),L!==x&&L!==U&&b.push({...t[L],x:r})}l>0&&U!==x&&b.push(t[U]),b.push(c),m=O,a=0,_=S=f,g=y=x=l}}return b}function Xx(t){if(t._decimated){const e=t._data;delete t._decimated,delete t._data,Object.defineProperty(t,"data",{configurable:!0,enumerable:!0,writable:!0,value:e})}}function Ky(t){t.data.datasets.forEach(e=>{Xx(e)})}function aE(t,e){const n=e.length;let s=0,r;const{iScale:a}=t,{min:l,max:c,minDefined:d,maxDefined:f}=a.getUserBounds();return d&&(s=Pt(Ps(e,a.axis,l).lo,0,n-1)),f?r=Pt(Ps(e,a.axis,c).hi+1,s,n)-s:r=n-s,{start:s,count:r}}var oE={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(t,e,n)=>{if(!n.enabled){Ky(t);return}const s=t.width;t.data.datasets.forEach((r,a)=>{const{_data:l,indexAxis:c}=r,d=t.getDatasetMeta(a),f=l||r.data;if(Ra([c,t.options.indexAxis])==="y"||!d.controller.supportsDecimation)return;const m=t.scales[d.xAxisID];if(m.type!=="linear"&&m.type!=="time"||t.options.parsing)return;let{start:g,count:y}=aE(d,f);const x=n.threshold||4*s;if(y<=x){Xx(r);return}Ae(l)&&(r._data=f,delete r.data,Object.defineProperty(r,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(S){this._data=S}}));let _;switch(n.algorithm){case"lttb":_=rE(f,g,y,s,n);break;case"min-max":_=iE(f,g,y,s);break;default:throw new Error(`Unsupported decimation algorithm '${n.algorithm}'`)}r._decimated=_})},destroy(t){Ky(t)}};function lE(t,e,n){const s=t.segments,r=t.points,a=e.points,l=[];for(const c of s){let{start:d,end:f}=c;f=Tc(d,f,r);const m=Ah(n,r[d],r[f],c.loop);if(!e.segments){l.push({source:c,target:m,start:r[d],end:r[f]});continue}const g=Nx(e,m);for(const y of g){const x=Ah(n,a[y.start],a[y.end],y.loop),_=Tx(c,r,x);for(const S of _)l.push({source:S,target:y,start:{[n]:Gy(m,x,"start",Math.max)},end:{[n]:Gy(m,x,"end",Math.min)}})}}return l}function Ah(t,e,n,s){if(s)return;let r=e[t],a=n[t];return t==="angle"&&(r=Bt(r),a=Bt(a)),{property:t,start:r,end:a}}function cE(t,e){const{x:n=null,y:s=null}=t||{},r=e.points,a=[];return e.segments.forEach(({start:l,end:c})=>{c=Tc(l,c,r);const d=r[l],f=r[c];s!==null?(a.push({x:d.x,y:s}),a.push({x:f.x,y:s})):n!==null&&(a.push({x:n,y:d.y}),a.push({x:n,y:f.y}))}),a}function Tc(t,e,n){for(;e>t;e--){const s=n[e];if(!isNaN(s.x)&&!isNaN(s.y))break}return e}function Gy(t,e,n,s){return t&&e?s(t[n],e[n]):t?t[n]:e?e[n]:0}function Qx(t,e){let n=[],s=!1;return et(t)?(s=!0,n=t):n=cE(t,e),n.length?new Ec({points:n,options:{tension:0},_loop:s,_fullLoop:s}):null}function Yy(t){return t&&t.fill!==!1}function uE(t,e,n){let r=t[e].fill;const a=[e];let l;if(!n)return r;for(;r!==!1&&a.indexOf(r)===-1;){if(!ut(r))return r;if(l=t[r],!l)return!1;if(l.visible)return r;a.push(r),r=l.fill}return!1}function dE(t,e,n){const s=mE(t);if(Re(s))return isNaN(s.value)?!1:s;let r=parseFloat(s);return ut(r)&&Math.floor(r)===r?hE(s[0],e,r,n):["origin","start","end","stack","shape"].indexOf(s)>=0&&s}function hE(t,e,n,s){return(t==="-"||t==="+")&&(n=e+n),n===e||n<0||n>=s?!1:n}function fE(t,e){let n=null;return t==="start"?n=e.bottom:t==="end"?n=e.top:Re(t)?n=e.getPixelForValue(t.value):e.getBasePixel&&(n=e.getBasePixel()),n}function pE(t,e,n){let s;return t==="start"?s=n:t==="end"?s=e.options.reverse?e.min:e.max:Re(t)?s=t.value:s=e.getBaseValue(),s}function mE(t){const e=t.options,n=e.fill;let s=Pe(n&&n.target,n);return s===void 0&&(s=!!e.backgroundColor),s===!1||s===null?!1:s===!0?"origin":s}function gE(t){const{scale:e,index:n,line:s}=t,r=[],a=s.segments,l=s.points,c=yE(e,n);c.push(Qx({x:null,y:e.bottom},s));for(let d=0;d<a.length;d++){const f=a[d];for(let m=f.start;m<=f.end;m++)vE(r,l[m],c)}return new Ec({points:r,options:{}})}function yE(t,e){const n=[],s=t.getMatchingVisibleMetas("line");for(let r=0;r<s.length;r++){const a=s[r];if(a.index===e)break;a.hidden||n.unshift(a.dataset)}return n}function vE(t,e,n){const s=[];for(let r=0;r<n.length;r++){const a=n[r],{first:l,last:c,point:d}=xE(a,e,"x");if(!(!d||l&&c)){if(l)s.unshift(d);else if(t.push(d),!c)break}}t.push(...s)}function xE(t,e,n){const s=t.interpolate(e,n);if(!s)return{};const r=s[n],a=t.segments,l=t.points;let c=!1,d=!1;for(let f=0;f<a.length;f++){const m=a[f],g=l[m.start][n],y=l[m.end][n];if(Cs(r,g,y)){c=r===g,d=r===y;break}}return{first:c,last:d,point:s}}class Zx{constructor(e){this.x=e.x,this.y=e.y,this.radius=e.radius}pathSegment(e,n,s){const{x:r,y:a,radius:l}=this;return n=n||{start:0,end:Qe},e.arc(r,a,l,n.end,n.start,!0),!s.bounds}interpolate(e){const{x:n,y:s,radius:r}=this,a=e.angle;return{x:n+Math.cos(a)*r,y:s+Math.sin(a)*r,angle:a}}}function bE(t){const{chart:e,fill:n,line:s}=t;if(ut(n))return wE(e,n);if(n==="stack")return gE(t);if(n==="shape")return!0;const r=_E(t);return r instanceof Zx?r:Qx(r,s)}function wE(t,e){const n=t.getDatasetMeta(e);return n&&t.isDatasetVisible(e)?n.dataset:null}function _E(t){return(t.scale||{}).getPointPositionForValue?kE(t):SE(t)}function SE(t){const{scale:e={},fill:n}=t,s=fE(n,e);if(ut(s)){const r=e.isHorizontal();return{x:r?s:null,y:r?null:s}}return null}function kE(t){const{scale:e,fill:n}=t,s=e.options,r=e.getLabels().length,a=s.reverse?e.max:e.min,l=pE(n,e,a),c=[];if(s.grid.circular){const d=e.getPointPositionForValue(0,a);return new Zx({x:d.x,y:d.y,radius:e.getDistanceFromCenterForValue(l)})}for(let d=0;d<r;++d)c.push(e.getPointPositionForValue(d,l));return c}function Hd(t,e,n){const s=bE(e),{chart:r,index:a,line:l,scale:c,axis:d}=e,f=l.options,m=f.fill,g=f.backgroundColor,{above:y=g,below:x=g}=m||{},_=r.getDatasetMeta(a),S=Ax(r,_);s&&l.points.length&&(jc(t,n),jE(t,{line:l,target:s,above:y,below:x,area:n,scale:c,axis:d,clip:S}),Cc(t))}function jE(t,e){const{line:n,target:s,above:r,below:a,area:l,scale:c,clip:d}=e,f=n._loop?"angle":e.axis;t.save();let m=a;a!==r&&(f==="x"?(Jy(t,s,l.top),Kd(t,{line:n,target:s,color:r,scale:c,property:f,clip:d}),t.restore(),t.save(),Jy(t,s,l.bottom)):f==="y"&&(Xy(t,s,l.left),Kd(t,{line:n,target:s,color:a,scale:c,property:f,clip:d}),t.restore(),t.save(),Xy(t,s,l.right),m=r)),Kd(t,{line:n,target:s,color:m,scale:c,property:f,clip:d}),t.restore()}function Jy(t,e,n){const{segments:s,points:r}=e;let a=!0,l=!1;t.beginPath();for(const c of s){const{start:d,end:f}=c,m=r[d],g=r[Tc(d,f,r)];a?(t.moveTo(m.x,m.y),a=!1):(t.lineTo(m.x,n),t.lineTo(m.x,m.y)),l=!!e.pathSegment(t,c,{move:l}),l?t.closePath():t.lineTo(g.x,n)}t.lineTo(e.first().x,n),t.closePath(),t.clip()}function Xy(t,e,n){const{segments:s,points:r}=e;let a=!0,l=!1;t.beginPath();for(const c of s){const{start:d,end:f}=c,m=r[d],g=r[Tc(d,f,r)];a?(t.moveTo(m.x,m.y),a=!1):(t.lineTo(n,m.y),t.lineTo(m.x,m.y)),l=!!e.pathSegment(t,c,{move:l}),l?t.closePath():t.lineTo(n,g.y)}t.lineTo(n,e.first().y),t.closePath(),t.clip()}function Kd(t,e){const{line:n,target:s,property:r,color:a,scale:l,clip:c}=e,d=lE(n,s,r);for(const{source:f,target:m,start:g,end:y}of d){const{style:{backgroundColor:x=a}={}}=f,_=s!==!0;t.save(),t.fillStyle=x,CE(t,l,c,_&&Ah(r,g,y)),t.beginPath();const S=!!n.pathSegment(t,f);let b;if(_){S?t.closePath():Qy(t,s,y,r);const k=!!s.pathSegment(t,m,{move:S,reverse:!0});b=S&&k,b||Qy(t,s,g,r)}t.closePath(),t.fill(b?"evenodd":"nonzero"),t.restore()}}function CE(t,e,n,s){const r=e.chart.chartArea,{property:a,start:l,end:c}=s||{};if(a==="x"||a==="y"){let d,f,m,g;a==="x"?(d=l,f=r.top,m=c,g=r.bottom):(d=r.left,f=l,m=r.right,g=c),t.beginPath(),n&&(d=Math.max(d,n.left),m=Math.min(m,n.right),f=Math.max(f,n.top),g=Math.min(g,n.bottom)),t.rect(d,f,m-d,g-f),t.clip()}}function Qy(t,e,n,s){const r=e.interpolate(n,s);r&&t.lineTo(r.x,r.y)}var PE={id:"filler",afterDatasetsUpdate(t,e,n){const s=(t.data.datasets||[]).length,r=[];let a,l,c,d;for(l=0;l<s;++l)a=t.getDatasetMeta(l),c=a.dataset,d=null,c&&c.options&&c instanceof Ec&&(d={visible:t.isDatasetVisible(l),index:l,fill:dE(c,l,s),chart:t,axis:a.controller.options.indexAxis,scale:a.vScale,line:c}),a.$filler=d,r.push(d);for(l=0;l<s;++l)d=r[l],!(!d||d.fill===!1)&&(d.fill=uE(r,l,n.propagate))},beforeDraw(t,e,n){const s=n.drawTime==="beforeDraw",r=t.getSortedVisibleDatasetMetas(),a=t.chartArea;for(let l=r.length-1;l>=0;--l){const c=r[l].$filler;c&&(c.line.updateControlPoints(a,c.axis),s&&c.fill&&Hd(t.ctx,c,a))}},beforeDatasetsDraw(t,e,n){if(n.drawTime!=="beforeDatasetsDraw")return;const s=t.getSortedVisibleDatasetMetas();for(let r=s.length-1;r>=0;--r){const a=s[r].$filler;Yy(a)&&Hd(t.ctx,a,t.chartArea)}},beforeDatasetDraw(t,e,n){const s=e.meta.$filler;!Yy(s)||n.drawTime!=="beforeDatasetDraw"||Hd(t.ctx,s,t.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const Zy=(t,e)=>{let{boxHeight:n=e,boxWidth:s=e}=t;return t.usePointStyle&&(n=Math.min(n,e),s=t.pointStyleWidth||Math.min(s,e)),{boxWidth:s,boxHeight:n,itemHeight:Math.max(e,n)}},IE=(t,e)=>t!==null&&e!==null&&t.datasetIndex===e.datasetIndex&&t.index===e.index;class ev extends As{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,n,s){this.maxWidth=e,this.maxHeight=n,this._margins=s,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let n=Ye(e.generateLabels,[this.chart],this)||[];e.filter&&(n=n.filter(s=>e.filter(s,this.chart.data))),e.sort&&(n=n.sort((s,r)=>e.sort(s,r,this.chart.data))),this.options.reverse&&n.reverse(),this.legendItems=n}fit(){const{options:e,ctx:n}=this;if(!e.display){this.width=this.height=0;return}const s=e.labels,r=_t(s.font),a=r.size,l=this._computeTitleHeight(),{boxWidth:c,itemHeight:d}=Zy(s,a);let f,m;n.font=r.string,this.isHorizontal()?(f=this.maxWidth,m=this._fitRows(l,a,c,d)+10):(m=this.maxHeight,f=this._fitCols(l,r,c,d)+10),this.width=Math.min(f,e.maxWidth||this.maxWidth),this.height=Math.min(m,e.maxHeight||this.maxHeight)}_fitRows(e,n,s,r){const{ctx:a,maxWidth:l,options:{labels:{padding:c}}}=this,d=this.legendHitBoxes=[],f=this.lineWidths=[0],m=r+c;let g=e;a.textAlign="left",a.textBaseline="middle";let y=-1,x=-m;return this.legendItems.forEach((_,S)=>{const b=s+n/2+a.measureText(_.text).width;(S===0||f[f.length-1]+b+2*c>l)&&(g+=m,f[f.length-(S>0?0:1)]=0,x+=m,y++),d[S]={left:0,top:x,row:y,width:b,height:r},f[f.length-1]+=b+c}),g}_fitCols(e,n,s,r){const{ctx:a,maxHeight:l,options:{labels:{padding:c}}}=this,d=this.legendHitBoxes=[],f=this.columnSizes=[],m=l-e;let g=c,y=0,x=0,_=0,S=0;return this.legendItems.forEach((b,k)=>{const{itemWidth:I,itemHeight:C}=EE(s,n,a,b,r);k>0&&x+C+2*c>m&&(g+=y+c,f.push({width:y,height:x}),_+=y+c,S++,y=x=0),d[k]={left:_,top:x,col:S,width:I,height:C},y=Math.max(y,I),x+=C+c}),g+=y,f.push({width:y,height:x}),g}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:n,options:{align:s,labels:{padding:r},rtl:a}}=this,l=Oi(a,this.left,this.width);if(this.isHorizontal()){let c=0,d=Ft(s,this.left+r,this.right-this.lineWidths[c]);for(const f of n)c!==f.row&&(c=f.row,d=Ft(s,this.left+r,this.right-this.lineWidths[c])),f.top+=this.top+e+r,f.left=l.leftForLtr(l.x(d),f.width),d+=f.width+r}else{let c=0,d=Ft(s,this.top+e+r,this.bottom-this.columnSizes[c].height);for(const f of n)f.col!==c&&(c=f.col,d=Ft(s,this.top+e+r,this.bottom-this.columnSizes[c].height)),f.top=d,f.left+=this.left+r,f.left=l.leftForLtr(l.x(f.left),f.width),d+=f.height+r}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;jc(e,this),this._draw(),Cc(e)}}_draw(){const{options:e,columnSizes:n,lineWidths:s,ctx:r}=this,{align:a,labels:l}=e,c=tt.color,d=Oi(e.rtl,this.left,this.width),f=_t(l.font),{padding:m}=l,g=f.size,y=g/2;let x;this.drawTitle(),r.textAlign=d.textAlign("left"),r.textBaseline="middle",r.lineWidth=.5,r.font=f.string;const{boxWidth:_,boxHeight:S,itemHeight:b}=Zy(l,g),k=function(U,E,L){if(isNaN(_)||_<=0||isNaN(S)||S<0)return;r.save();const R=Pe(L.lineWidth,1);if(r.fillStyle=Pe(L.fillStyle,c),r.lineCap=Pe(L.lineCap,"butt"),r.lineDashOffset=Pe(L.lineDashOffset,0),r.lineJoin=Pe(L.lineJoin,"miter"),r.lineWidth=R,r.strokeStyle=Pe(L.strokeStyle,c),r.setLineDash(Pe(L.lineDash,[])),l.usePointStyle){const T={radius:S*Math.SQRT2/2,pointStyle:L.pointStyle,rotation:L.rotation,borderWidth:R},D=d.xPlus(U,_/2),Y=E+y;xx(r,T,D,Y,l.pointStyleWidth&&_)}else{const T=E+Math.max((g-S)/2,0),D=d.leftForLtr(U,_),Y=qr(L.borderRadius);r.beginPath(),Object.values(Y).some(se=>se!==0)?ro(r,{x:D,y:T,w:_,h:S,radius:Y}):r.rect(D,T,_,S),r.fill(),R!==0&&r.stroke()}r.restore()},I=function(U,E,L){Gr(r,L.text,U,E+b/2,f,{strikethrough:L.hidden,textAlign:d.textAlign(L.textAlign)})},C=this.isHorizontal(),N=this._computeTitleHeight();C?x={x:Ft(a,this.left+m,this.right-s[0]),y:this.top+m+N,line:0}:x={x:this.left+m,y:Ft(a,this.top+N+m,this.bottom-n[0].height),line:0},Px(this.ctx,e.textDirection);const O=b+m;this.legendItems.forEach((U,E)=>{r.strokeStyle=U.fontColor,r.fillStyle=U.fontColor;const L=r.measureText(U.text).width,R=d.textAlign(U.textAlign||(U.textAlign=l.textAlign)),T=_+y+L;let D=x.x,Y=x.y;d.setWidth(this.width),C?E>0&&D+T+m>this.right&&(Y=x.y+=O,x.line++,D=x.x=Ft(a,this.left+m,this.right-s[x.line])):E>0&&Y+O>this.bottom&&(D=x.x=D+n[x.line].width+m,x.line++,Y=x.y=Ft(a,this.top+N+m,this.bottom-n[x.line].height));const se=d.x(D);if(k(se,Y,U),D=BC(R,D+_+y,C?D+T:this.right,e.rtl),I(d.x(D),Y,U),C)x.x+=T+m;else if(typeof U.text!="string"){const H=f.lineHeight;x.y+=eb(U,H)+m}else x.y+=O}),Ix(this.ctx,e.textDirection)}drawTitle(){const e=this.options,n=e.title,s=_t(n.font),r=zt(n.padding);if(!n.display)return;const a=Oi(e.rtl,this.left,this.width),l=this.ctx,c=n.position,d=s.size/2,f=r.top+d;let m,g=this.left,y=this.width;if(this.isHorizontal())y=Math.max(...this.lineWidths),m=this.top+f,g=Ft(e.align,g,this.right-y);else{const _=this.columnSizes.reduce((S,b)=>Math.max(S,b.height),0);m=f+Ft(e.align,this.top,this.bottom-_-e.labels.padding-this._computeTitleHeight())}const x=Ft(c,g,g+y);l.textAlign=a.textAlign(ef(c)),l.textBaseline="middle",l.strokeStyle=n.color,l.fillStyle=n.color,l.font=s.string,Gr(l,n.text,x,m,s)}_computeTitleHeight(){const e=this.options.title,n=_t(e.font),s=zt(e.padding);return e.display?n.lineHeight+s.height:0}_getLegendItemAt(e,n){let s,r,a;if(Cs(e,this.left,this.right)&&Cs(n,this.top,this.bottom)){for(a=this.legendHitBoxes,s=0;s<a.length;++s)if(r=a[s],Cs(e,r.left,r.left+r.width)&&Cs(n,r.top,r.top+r.height))return this.legendItems[s]}return null}handleEvent(e){const n=this.options;if(!AE(e.type,n))return;const s=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const r=this._hoveredItem,a=IE(r,s);r&&!a&&Ye(n.onLeave,[e,r,this],this),this._hoveredItem=s,s&&!a&&Ye(n.onHover,[e,s,this],this)}else s&&Ye(n.onClick,[e,s,this],this)}}function EE(t,e,n,s,r){const a=TE(s,t,e,n),l=NE(r,s,e.lineHeight);return{itemWidth:a,itemHeight:l}}function TE(t,e,n,s){let r=t.text;return r&&typeof r!="string"&&(r=r.reduce((a,l)=>a.length>l.length?a:l)),e+n.size/2+s.measureText(r).width}function NE(t,e,n){let s=t;return typeof e.text!="string"&&(s=eb(e,n)),s}function eb(t,e){const n=t.text?t.text.length:0;return e*n}function AE(t,e){return!!((t==="mousemove"||t==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(t==="click"||t==="mouseup"))}var OE={id:"legend",_element:ev,start(t,e,n){const s=t.legend=new ev({ctx:t.ctx,options:n,chart:t});$t.configure(t,s,n),$t.addBox(t,s)},stop(t){$t.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,n){const s=t.legend;$t.configure(t,s,n),s.options=n},afterUpdate(t){const e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,n){const s=e.datasetIndex,r=n.chart;r.isDatasetVisible(s)?(r.hide(s),e.hidden=!0):(r.show(s),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const e=t.data.datasets,{labels:{usePointStyle:n,pointStyle:s,textAlign:r,color:a,useBorderRadius:l,borderRadius:c}}=t.legend.options;return t._getSortedDatasetMetas().map(d=>{const f=d.controller.getStyle(n?0:void 0),m=zt(f.borderWidth);return{text:e[d.index].label,fillStyle:f.backgroundColor,fontColor:a,hidden:!d.visible,lineCap:f.borderCapStyle,lineDash:f.borderDash,lineDashOffset:f.borderDashOffset,lineJoin:f.borderJoinStyle,lineWidth:(m.width+m.height)/4,strokeStyle:f.borderColor,pointStyle:s||f.pointStyle,rotation:f.rotation,textAlign:r||f.textAlign,borderRadius:l&&(c||f.borderRadius),datasetIndex:d.index}},this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};class hf extends As{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,n){const s=this.options;if(this.left=0,this.top=0,!s.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=n;const r=et(s.text)?s.text.length:1;this._padding=zt(s.padding);const a=r*_t(s.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=a:this.width=a}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:n,left:s,bottom:r,right:a,options:l}=this,c=l.align;let d=0,f,m,g;return this.isHorizontal()?(m=Ft(c,s,a),g=n+e,f=a-s):(l.position==="left"?(m=s+e,g=Ft(c,r,n),d=ze*-.5):(m=a-e,g=Ft(c,n,r),d=ze*.5),f=r-n),{titleX:m,titleY:g,maxWidth:f,rotation:d}}draw(){const e=this.ctx,n=this.options;if(!n.display)return;const s=_t(n.font),a=s.lineHeight/2+this._padding.top,{titleX:l,titleY:c,maxWidth:d,rotation:f}=this._drawArgs(a);Gr(e,n.text,0,0,s,{color:n.color,maxWidth:d,rotation:f,textAlign:ef(n.align),textBaseline:"middle",translation:[l,c]})}}function RE(t,e){const n=new hf({ctx:t.ctx,options:e,chart:t});$t.configure(t,n,e),$t.addBox(t,n),t.titleBlock=n}var ME={id:"title",_element:hf,start(t,e,n){RE(t,n)},stop(t){const e=t.titleBlock;$t.removeBox(t,e),delete t.titleBlock},beforeUpdate(t,e,n){const s=t.titleBlock;$t.configure(t,s,n),s.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Vl=new WeakMap;var LE={id:"subtitle",start(t,e,n){const s=new hf({ctx:t.ctx,options:n,chart:t});$t.configure(t,s,n),$t.addBox(t,s),Vl.set(t,s)},stop(t){$t.removeBox(t,Vl.get(t)),Vl.delete(t)},beforeUpdate(t,e,n){const s=Vl.get(t);$t.configure(t,s,n),s.options=n},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const La={average(t){if(!t.length)return!1;let e,n,s=new Set,r=0,a=0;for(e=0,n=t.length;e<n;++e){const c=t[e].element;if(c&&c.hasValue()){const d=c.tooltipPosition();s.add(d.x),r+=d.y,++a}}return a===0||s.size===0?!1:{x:[...s].reduce((c,d)=>c+d)/s.size,y:r/a}},nearest(t,e){if(!t.length)return!1;let n=e.x,s=e.y,r=Number.POSITIVE_INFINITY,a,l,c;for(a=0,l=t.length;a<l;++a){const d=t[a].element;if(d&&d.hasValue()){const f=d.getCenterPoint(),m=jh(e,f);m<r&&(r=m,c=d)}}if(c){const d=c.tooltipPosition();n=d.x,s=d.y}return{x:n,y:s}}};function ts(t,e){return e&&(et(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function _s(t){return(typeof t=="string"||t instanceof String)&&t.indexOf(`
`)>-1?t.split(`
`):t}function DE(t,e){const{element:n,datasetIndex:s,index:r}=e,a=t.getDatasetMeta(s).controller,{label:l,value:c}=a.getLabelAndValue(r);return{chart:t,label:l,parsed:a.getParsed(r),raw:t.data.datasets[s].data[r],formattedValue:c,dataset:a.getDataset(),dataIndex:r,datasetIndex:s,element:n}}function tv(t,e){const n=t.chart.ctx,{body:s,footer:r,title:a}=t,{boxWidth:l,boxHeight:c}=e,d=_t(e.bodyFont),f=_t(e.titleFont),m=_t(e.footerFont),g=a.length,y=r.length,x=s.length,_=zt(e.padding);let S=_.height,b=0,k=s.reduce((N,O)=>N+O.before.length+O.lines.length+O.after.length,0);if(k+=t.beforeBody.length+t.afterBody.length,g&&(S+=g*f.lineHeight+(g-1)*e.titleSpacing+e.titleMarginBottom),k){const N=e.displayColors?Math.max(c,d.lineHeight):d.lineHeight;S+=x*N+(k-x)*d.lineHeight+(k-1)*e.bodySpacing}y&&(S+=e.footerMarginTop+y*m.lineHeight+(y-1)*e.footerSpacing);let I=0;const C=function(N){b=Math.max(b,n.measureText(N).width+I)};return n.save(),n.font=f.string,He(t.title,C),n.font=d.string,He(t.beforeBody.concat(t.afterBody),C),I=e.displayColors?l+2+e.boxPadding:0,He(s,N=>{He(N.before,C),He(N.lines,C),He(N.after,C)}),I=0,n.font=m.string,He(t.footer,C),n.restore(),b+=_.width,{width:b,height:S}}function FE(t,e){const{y:n,height:s}=e;return n<s/2?"top":n>t.height-s/2?"bottom":"center"}function BE(t,e,n,s){const{x:r,width:a}=s,l=n.caretSize+n.caretPadding;if(t==="left"&&r+a+l>e.width||t==="right"&&r-a-l<0)return!0}function $E(t,e,n,s){const{x:r,width:a}=n,{width:l,chartArea:{left:c,right:d}}=t;let f="center";return s==="center"?f=r<=(c+d)/2?"left":"right":r<=a/2?f="left":r>=l-a/2&&(f="right"),BE(f,t,e,n)&&(f="center"),f}function nv(t,e,n){const s=n.yAlign||e.yAlign||FE(t,n);return{xAlign:n.xAlign||e.xAlign||$E(t,e,n,s),yAlign:s}}function zE(t,e){let{x:n,width:s}=t;return e==="right"?n-=s:e==="center"&&(n-=s/2),n}function UE(t,e,n){let{y:s,height:r}=t;return e==="top"?s+=n:e==="bottom"?s-=r+n:s-=r/2,s}function sv(t,e,n,s){const{caretSize:r,caretPadding:a,cornerRadius:l}=t,{xAlign:c,yAlign:d}=n,f=r+a,{topLeft:m,topRight:g,bottomLeft:y,bottomRight:x}=qr(l);let _=zE(e,c);const S=UE(e,d,f);return d==="center"?c==="left"?_+=f:c==="right"&&(_-=f):c==="left"?_-=Math.max(m,y)+r:c==="right"&&(_+=Math.max(g,x)+r),{x:Pt(_,0,s.width-e.width),y:Pt(S,0,s.height-e.height)}}function ql(t,e,n){const s=zt(n.padding);return e==="center"?t.x+t.width/2:e==="right"?t.x+t.width-s.right:t.x+s.left}function rv(t){return ts([],_s(t))}function WE(t,e,n){return pr(t,{tooltip:e,tooltipItems:n,type:"tooltip"})}function iv(t,e){const n=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return n?t.override(n):t}const tb={beforeTitle:bs,title(t){if(t.length>0){const e=t[0],n=e.chart.data.labels,s=n?n.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(s>0&&e.dataIndex<s)return n[e.dataIndex]}return""},afterTitle:bs,beforeBody:bs,beforeLabel:bs,label(t){if(this&&this.options&&this.options.mode==="dataset")return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");const n=t.formattedValue;return Ae(n)||(e+=n),e},labelColor(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:n.borderColor,backgroundColor:n.backgroundColor,borderWidth:n.borderWidth,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:n.pointStyle,rotation:n.rotation}},afterLabel:bs,afterBody:bs,beforeFooter:bs,footer:bs,afterFooter:bs};function tn(t,e,n,s){const r=t[e].call(n,s);return typeof r>"u"?tb[e].call(n,s):r}class av extends As{static positioners=La;constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const n=this.chart,s=this.options.setContext(this.getContext()),r=s.enabled&&n.options.animation&&s.animations,a=new Ox(this.chart,r);return r._cacheable&&(this._cachedAnimations=Object.freeze(a)),a}getContext(){return this.$context||(this.$context=WE(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,n){const{callbacks:s}=n,r=tn(s,"beforeTitle",this,e),a=tn(s,"title",this,e),l=tn(s,"afterTitle",this,e);let c=[];return c=ts(c,_s(r)),c=ts(c,_s(a)),c=ts(c,_s(l)),c}getBeforeBody(e,n){return rv(tn(n.callbacks,"beforeBody",this,e))}getBody(e,n){const{callbacks:s}=n,r=[];return He(e,a=>{const l={before:[],lines:[],after:[]},c=iv(s,a);ts(l.before,_s(tn(c,"beforeLabel",this,a))),ts(l.lines,tn(c,"label",this,a)),ts(l.after,_s(tn(c,"afterLabel",this,a))),r.push(l)}),r}getAfterBody(e,n){return rv(tn(n.callbacks,"afterBody",this,e))}getFooter(e,n){const{callbacks:s}=n,r=tn(s,"beforeFooter",this,e),a=tn(s,"footer",this,e),l=tn(s,"afterFooter",this,e);let c=[];return c=ts(c,_s(r)),c=ts(c,_s(a)),c=ts(c,_s(l)),c}_createItems(e){const n=this._active,s=this.chart.data,r=[],a=[],l=[];let c=[],d,f;for(d=0,f=n.length;d<f;++d)c.push(DE(this.chart,n[d]));return e.filter&&(c=c.filter((m,g,y)=>e.filter(m,g,y,s))),e.itemSort&&(c=c.sort((m,g)=>e.itemSort(m,g,s))),He(c,m=>{const g=iv(e.callbacks,m);r.push(tn(g,"labelColor",this,m)),a.push(tn(g,"labelPointStyle",this,m)),l.push(tn(g,"labelTextColor",this,m))}),this.labelColors=r,this.labelPointStyles=a,this.labelTextColors=l,this.dataPoints=c,c}update(e,n){const s=this.options.setContext(this.getContext()),r=this._active;let a,l=[];if(!r.length)this.opacity!==0&&(a={opacity:0});else{const c=La[s.position].call(this,r,this._eventPosition);l=this._createItems(s),this.title=this.getTitle(l,s),this.beforeBody=this.getBeforeBody(l,s),this.body=this.getBody(l,s),this.afterBody=this.getAfterBody(l,s),this.footer=this.getFooter(l,s);const d=this._size=tv(this,s),f=Object.assign({},c,d),m=nv(this.chart,s,f),g=sv(s,f,m,this.chart);this.xAlign=m.xAlign,this.yAlign=m.yAlign,a={opacity:1,x:g.x,y:g.y,width:d.width,height:d.height,caretX:c.x,caretY:c.y}}this._tooltipItems=l,this.$context=void 0,a&&this._resolveAnimations().update(this,a),e&&s.external&&s.external.call(this,{chart:this.chart,tooltip:this,replay:n})}drawCaret(e,n,s,r){const a=this.getCaretPosition(e,s,r);n.lineTo(a.x1,a.y1),n.lineTo(a.x2,a.y2),n.lineTo(a.x3,a.y3)}getCaretPosition(e,n,s){const{xAlign:r,yAlign:a}=this,{caretSize:l,cornerRadius:c}=s,{topLeft:d,topRight:f,bottomLeft:m,bottomRight:g}=qr(c),{x:y,y:x}=e,{width:_,height:S}=n;let b,k,I,C,N,O;return a==="center"?(N=x+S/2,r==="left"?(b=y,k=b-l,C=N+l,O=N-l):(b=y+_,k=b+l,C=N-l,O=N+l),I=b):(r==="left"?k=y+Math.max(d,m)+l:r==="right"?k=y+_-Math.max(f,g)-l:k=this.caretX,a==="top"?(C=x,N=C-l,b=k-l,I=k+l):(C=x+S,N=C+l,b=k+l,I=k-l),O=C),{x1:b,x2:k,x3:I,y1:C,y2:N,y3:O}}drawTitle(e,n,s){const r=this.title,a=r.length;let l,c,d;if(a){const f=Oi(s.rtl,this.x,this.width);for(e.x=ql(this,s.titleAlign,s),n.textAlign=f.textAlign(s.titleAlign),n.textBaseline="middle",l=_t(s.titleFont),c=s.titleSpacing,n.fillStyle=s.titleColor,n.font=l.string,d=0;d<a;++d)n.fillText(r[d],f.x(e.x),e.y+l.lineHeight/2),e.y+=l.lineHeight+c,d+1===a&&(e.y+=s.titleMarginBottom-c)}}_drawColorBox(e,n,s,r,a){const l=this.labelColors[s],c=this.labelPointStyles[s],{boxHeight:d,boxWidth:f}=a,m=_t(a.bodyFont),g=ql(this,"left",a),y=r.x(g),x=d<m.lineHeight?(m.lineHeight-d)/2:0,_=n.y+x;if(a.usePointStyle){const S={radius:Math.min(f,d)/2,pointStyle:c.pointStyle,rotation:c.rotation,borderWidth:1},b=r.leftForLtr(y,f)+f/2,k=_+d/2;e.strokeStyle=a.multiKeyBackground,e.fillStyle=a.multiKeyBackground,Ph(e,S,b,k),e.strokeStyle=l.borderColor,e.fillStyle=l.backgroundColor,Ph(e,S,b,k)}else{e.lineWidth=Re(l.borderWidth)?Math.max(...Object.values(l.borderWidth)):l.borderWidth||1,e.strokeStyle=l.borderColor,e.setLineDash(l.borderDash||[]),e.lineDashOffset=l.borderDashOffset||0;const S=r.leftForLtr(y,f),b=r.leftForLtr(r.xPlus(y,1),f-2),k=qr(l.borderRadius);Object.values(k).some(I=>I!==0)?(e.beginPath(),e.fillStyle=a.multiKeyBackground,ro(e,{x:S,y:_,w:f,h:d,radius:k}),e.fill(),e.stroke(),e.fillStyle=l.backgroundColor,e.beginPath(),ro(e,{x:b,y:_+1,w:f-2,h:d-2,radius:k}),e.fill()):(e.fillStyle=a.multiKeyBackground,e.fillRect(S,_,f,d),e.strokeRect(S,_,f,d),e.fillStyle=l.backgroundColor,e.fillRect(b,_+1,f-2,d-2))}e.fillStyle=this.labelTextColors[s]}drawBody(e,n,s){const{body:r}=this,{bodySpacing:a,bodyAlign:l,displayColors:c,boxHeight:d,boxWidth:f,boxPadding:m}=s,g=_t(s.bodyFont);let y=g.lineHeight,x=0;const _=Oi(s.rtl,this.x,this.width),S=function(L){n.fillText(L,_.x(e.x+x),e.y+y/2),e.y+=y+a},b=_.textAlign(l);let k,I,C,N,O,U,E;for(n.textAlign=l,n.textBaseline="middle",n.font=g.string,e.x=ql(this,b,s),n.fillStyle=s.bodyColor,He(this.beforeBody,S),x=c&&b!=="right"?l==="center"?f/2+m:f+2+m:0,N=0,U=r.length;N<U;++N){for(k=r[N],I=this.labelTextColors[N],n.fillStyle=I,He(k.before,S),C=k.lines,c&&C.length&&(this._drawColorBox(n,e,N,_,s),y=Math.max(g.lineHeight,d)),O=0,E=C.length;O<E;++O)S(C[O]),y=g.lineHeight;He(k.after,S)}x=0,y=g.lineHeight,He(this.afterBody,S),e.y-=a}drawFooter(e,n,s){const r=this.footer,a=r.length;let l,c;if(a){const d=Oi(s.rtl,this.x,this.width);for(e.x=ql(this,s.footerAlign,s),e.y+=s.footerMarginTop,n.textAlign=d.textAlign(s.footerAlign),n.textBaseline="middle",l=_t(s.footerFont),n.fillStyle=s.footerColor,n.font=l.string,c=0;c<a;++c)n.fillText(r[c],d.x(e.x),e.y+l.lineHeight/2),e.y+=l.lineHeight+s.footerSpacing}}drawBackground(e,n,s,r){const{xAlign:a,yAlign:l}=this,{x:c,y:d}=e,{width:f,height:m}=s,{topLeft:g,topRight:y,bottomLeft:x,bottomRight:_}=qr(r.cornerRadius);n.fillStyle=r.backgroundColor,n.strokeStyle=r.borderColor,n.lineWidth=r.borderWidth,n.beginPath(),n.moveTo(c+g,d),l==="top"&&this.drawCaret(e,n,s,r),n.lineTo(c+f-y,d),n.quadraticCurveTo(c+f,d,c+f,d+y),l==="center"&&a==="right"&&this.drawCaret(e,n,s,r),n.lineTo(c+f,d+m-_),n.quadraticCurveTo(c+f,d+m,c+f-_,d+m),l==="bottom"&&this.drawCaret(e,n,s,r),n.lineTo(c+x,d+m),n.quadraticCurveTo(c,d+m,c,d+m-x),l==="center"&&a==="left"&&this.drawCaret(e,n,s,r),n.lineTo(c,d+g),n.quadraticCurveTo(c,d,c+g,d),n.closePath(),n.fill(),r.borderWidth>0&&n.stroke()}_updateAnimationTarget(e){const n=this.chart,s=this.$animations,r=s&&s.x,a=s&&s.y;if(r||a){const l=La[e.position].call(this,this._active,this._eventPosition);if(!l)return;const c=this._size=tv(this,e),d=Object.assign({},l,this._size),f=nv(n,e,d),m=sv(e,d,f,n);(r._to!==m.x||a._to!==m.y)&&(this.xAlign=f.xAlign,this.yAlign=f.yAlign,this.width=c.width,this.height=c.height,this.caretX=l.x,this.caretY=l.y,this._resolveAnimations().update(this,m))}}_willRender(){return!!this.opacity}draw(e){const n=this.options.setContext(this.getContext());let s=this.opacity;if(!s)return;this._updateAnimationTarget(n);const r={width:this.width,height:this.height},a={x:this.x,y:this.y};s=Math.abs(s)<.001?0:s;const l=zt(n.padding),c=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;n.enabled&&c&&(e.save(),e.globalAlpha=s,this.drawBackground(a,e,r,n),Px(e,n.textDirection),a.y+=l.top,this.drawTitle(a,e,n),this.drawBody(a,e,n),this.drawFooter(a,e,n),Ix(e,n.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,n){const s=this._active,r=e.map(({datasetIndex:c,index:d})=>{const f=this.chart.getDatasetMeta(c);if(!f)throw new Error("Cannot find a dataset at index "+c);return{datasetIndex:c,element:f.data[d],index:d}}),a=!ac(s,r),l=this._positionChanged(r,n);(a||l)&&(this._active=r,this._eventPosition=n,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,n,s=!0){if(n&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const r=this.options,a=this._active||[],l=this._getActiveElements(e,a,n,s),c=this._positionChanged(l,e),d=n||!ac(l,a)||c;return d&&(this._active=l,(r.enabled||r.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,n))),d}_getActiveElements(e,n,s,r){const a=this.options;if(e.type==="mouseout")return[];if(!r)return n.filter(c=>this.chart.data.datasets[c.datasetIndex]&&this.chart.getDatasetMeta(c.datasetIndex).controller.getParsed(c.index)!==void 0);const l=this.chart.getElementsAtEventForMode(e,a.mode,a,s);return a.reverse&&l.reverse(),l}_positionChanged(e,n){const{caretX:s,caretY:r,options:a}=this,l=La[a.position].call(this,e,n);return l!==!1&&(s!==l.x||r!==l.y)}}var VE={id:"tooltip",_element:av,positioners:La,afterInit(t,e,n){n&&(t.tooltip=new av({chart:t,options:n}))},beforeUpdate(t,e,n){t.tooltip&&t.tooltip.initialize(n)},reset(t,e,n){t.tooltip&&t.tooltip.initialize(n)},afterDraw(t){const e=t.tooltip;if(e&&e._willRender()){const n={tooltip:e};if(t.notifyPlugins("beforeTooltipDraw",{...n,cancelable:!0})===!1)return;e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",n)}},afterEvent(t,e){if(t.tooltip){const n=e.replay;t.tooltip.handleEvent(e.event,n,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:tb},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>t!=="filter"&&t!=="itemSort"&&t!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},qE=Object.freeze({__proto__:null,Colors:sE,Decimation:oE,Filler:PE,Legend:OE,SubTitle:LE,Title:ME,Tooltip:VE});const HE=(t,e,n,s)=>(typeof e=="string"?(n=t.push(e)-1,s.unshift({index:n,label:e})):isNaN(e)&&(n=null),n);function KE(t,e,n,s){const r=t.indexOf(e);if(r===-1)return HE(t,e,n,s);const a=t.lastIndexOf(e);return r!==a?n:r}const GE=(t,e)=>t===null?null:Pt(Math.round(t),0,e);function ov(t){const e=this.getLabels();return t>=0&&t<e.length?e[t]:t}class YE extends Yr{static id="category";static defaults={ticks:{callback:ov}};constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const n=this._addedLabels;if(n.length){const s=this.getLabels();for(const{index:r,label:a}of n)s[r]===a&&s.splice(r,1);this._addedLabels=[]}super.init(e)}parse(e,n){if(Ae(e))return null;const s=this.getLabels();return n=isFinite(n)&&s[n]===e?n:KE(s,e,Pe(n,e),this._addedLabels),GE(n,s.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:n}=this.getUserBounds();let{min:s,max:r}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(s=0),n||(r=this.getLabels().length-1)),this.min=s,this.max=r}buildTicks(){const e=this.min,n=this.max,s=this.options.offset,r=[];let a=this.getLabels();a=e===0&&n===a.length-1?a:a.slice(e,n+1),this._valueRange=Math.max(a.length-(s?0:1),1),this._startValue=this.min-(s?.5:0);for(let l=e;l<=n;l++)r.push({value:l});return r}getLabelForValue(e){return ov.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}function JE(t,e){const n=[],{bounds:r,step:a,min:l,max:c,precision:d,count:f,maxTicks:m,maxDigits:g,includeBounds:y}=t,x=a||1,_=m-1,{min:S,max:b}=e,k=!Ae(l),I=!Ae(c),C=!Ae(f),N=(b-S)/(g+1);let O=ty((b-S)/_/x)*x,U,E,L,R;if(O<1e-14&&!k&&!I)return[{value:S},{value:b}];R=Math.ceil(b/O)-Math.floor(S/O),R>_&&(O=ty(R*O/_/x)*x),Ae(d)||(U=Math.pow(10,d),O=Math.ceil(O*U)/U),r==="ticks"?(E=Math.floor(S/O)*O,L=Math.ceil(b/O)*O):(E=S,L=b),k&&I&&a&&AC((c-l)/a,O/1e3)?(R=Math.round(Math.min((c-l)/O,m)),O=(c-l)/R,E=l,L=c):C?(E=k?l:E,L=I?c:L,R=f-1,O=(L-E)/R):(R=(L-E)/O,Ua(R,Math.round(R),O/1e3)?R=Math.round(R):R=Math.ceil(R));const T=Math.max(ny(O),ny(E));U=Math.pow(10,Ae(d)?T:d),E=Math.round(E*U)/U,L=Math.round(L*U)/U;let D=0;for(k&&(y&&E!==l?(n.push({value:l}),E<l&&D++,Ua(Math.round((E+D*O)*U)/U,l,lv(l,N,t))&&D++):E<l&&D++);D<R;++D){const Y=Math.round((E+D*O)*U)/U;if(I&&Y>c)break;n.push({value:Y})}return I&&y&&L!==c?n.length&&Ua(n[n.length-1].value,c,lv(c,N,t))?n[n.length-1].value=c:n.push({value:c}):(!I||L===c)&&n.push({value:L}),n}function lv(t,e,{horizontal:n,minRotation:s}){const r=Un(s),a=(n?Math.sin(r):Math.cos(r))||.001,l=.75*e*(""+t).length;return Math.min(e/a,l)}class fc extends Yr{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,n){return Ae(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:n,maxDefined:s}=this.getUserBounds();let{min:r,max:a}=this;const l=d=>r=n?r:d,c=d=>a=s?a:d;if(e){const d=rs(r),f=rs(a);d<0&&f<0?c(0):d>0&&f>0&&l(0)}if(r===a){let d=a===0?1:Math.abs(a*.05);c(a+d),e||l(r-d)}this.min=r,this.max=a}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:n,stepSize:s}=e,r;return s?(r=Math.ceil(this.max/s)-Math.floor(this.min/s)+1,r>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${s} would result generating up to ${r} ticks. Limiting to 1000.`),r=1e3)):(r=this.computeTickLimit(),n=n||11),n&&(r=Math.min(n,r)),r}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,n=e.ticks;let s=this.getTickLimit();s=Math.max(2,s);const r={maxTicks:s,bounds:e.bounds,min:e.min,max:e.max,precision:n.precision,step:n.stepSize,count:n.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:n.minRotation||0,includeBounds:n.includeBounds!==!1},a=this._range||this,l=JE(r,a);return e.bounds==="ticks"&&ux(l,this,"value"),e.reverse?(l.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),l}configure(){const e=this.ticks;let n=this.min,s=this.max;if(super.configure(),this.options.offset&&e.length){const r=(s-n)/Math.max(e.length-1,1)/2;n-=r,s+=r}this._startValue=n,this._endValue=s,this._valueRange=s-n}getLabelForValue(e){return po(e,this.chart.options.locale,this.options.ticks.format)}}class XE extends fc{static id="linear";static defaults={ticks:{callback:kc.formatters.numeric}};determineDataLimits(){const{min:e,max:n}=this.getMinMax(!0);this.min=ut(e)?e:0,this.max=ut(n)?n:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),n=e?this.width:this.height,s=Un(this.options.ticks.minRotation),r=(e?Math.sin(s):Math.cos(s))||.001,a=this._resolveTickFontOptions(0);return Math.ceil(n/Math.min(40,a.lineHeight/r))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}const ao=t=>Math.floor(ar(t)),Dr=(t,e)=>Math.pow(10,ao(t)+e);function cv(t){return t/Math.pow(10,ao(t))===1}function uv(t,e,n){const s=Math.pow(10,n),r=Math.floor(t/s);return Math.ceil(e/s)-r}function QE(t,e){const n=e-t;let s=ao(n);for(;uv(t,e,s)>10;)s++;for(;uv(t,e,s)<10;)s--;return Math.min(s,ao(t))}function ZE(t,{min:e,max:n}){e=hn(t.min,e);const s=[],r=ao(e);let a=QE(e,n),l=a<0?Math.pow(10,Math.abs(a)):1;const c=Math.pow(10,a),d=r>a?Math.pow(10,r):0,f=Math.round((e-d)*l)/l,m=Math.floor((e-d)/c/10)*c*10;let g=Math.floor((f-m)/Math.pow(10,a)),y=hn(t.min,Math.round((d+m+g*Math.pow(10,a))*l)/l);for(;y<n;)s.push({value:y,major:cv(y),significand:g}),g>=10?g=g<15?15:20:g++,g>=20&&(a++,g=2,l=a>=0?1:l),y=Math.round((d+m+g*Math.pow(10,a))*l)/l;const x=hn(t.max,y);return s.push({value:x,major:cv(x),significand:g}),s}class eT extends Yr{static id="logarithmic";static defaults={ticks:{callback:kc.formatters.logarithmic,major:{enabled:!0}}};constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(e,n){const s=fc.prototype.parse.apply(this,[e,n]);if(s===0){this._zero=!0;return}return ut(s)&&s>0?s:null}determineDataLimits(){const{min:e,max:n}=this.getMinMax(!0);this.min=ut(e)?Math.max(0,e):null,this.max=ut(n)?Math.max(0,n):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!ut(this._userMin)&&(this.min=e===Dr(this.min,0)?Dr(this.min,-1):Dr(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:e,maxDefined:n}=this.getUserBounds();let s=this.min,r=this.max;const a=c=>s=e?s:c,l=c=>r=n?r:c;s===r&&(s<=0?(a(1),l(10)):(a(Dr(s,-1)),l(Dr(r,1)))),s<=0&&a(Dr(r,-1)),r<=0&&l(Dr(s,1)),this.min=s,this.max=r}buildTicks(){const e=this.options,n={min:this._userMin,max:this._userMax},s=ZE(n,this);return e.bounds==="ticks"&&ux(s,this,"value"),e.reverse?(s.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),s}getLabelForValue(e){return e===void 0?"0":po(e,this.chart.options.locale,this.options.ticks.format)}configure(){const e=this.min;super.configure(),this._startValue=ar(e),this._valueRange=ar(this.max)-ar(e)}getPixelForValue(e){return(e===void 0||e===0)&&(e=this.min),e===null||isNaN(e)?NaN:this.getPixelForDecimal(e===this.min?0:(ar(e)-this._startValue)/this._valueRange)}getValueForPixel(e){const n=this.getDecimalForPixel(e);return Math.pow(10,this._startValue+n*this._valueRange)}}function Oh(t){const e=t.ticks;if(e.display&&t.display){const n=zt(e.backdropPadding);return Pe(e.font&&e.font.size,tt.font.size)+n.height}return 0}function tT(t,e,n){return n=et(n)?n:[n],{w:YC(t,e.string,n),h:n.length*e.lineHeight}}function dv(t,e,n,s,r){return t===s||t===r?{start:e-n/2,end:e+n/2}:t<s||t>r?{start:e-n,end:e}:{start:e,end:e+n}}function nT(t){const e={l:t.left+t._padding.left,r:t.right-t._padding.right,t:t.top+t._padding.top,b:t.bottom-t._padding.bottom},n=Object.assign({},e),s=[],r=[],a=t._pointLabels.length,l=t.options.pointLabels,c=l.centerPointLabels?ze/a:0;for(let d=0;d<a;d++){const f=l.setContext(t.getPointLabelContext(d));r[d]=f.padding;const m=t.getPointPosition(d,t.drawingArea+r[d],c),g=_t(f.font),y=tT(t.ctx,g,t._pointLabels[d]);s[d]=y;const x=Bt(t.getIndexAngle(d)+c),_=Math.round(Qh(x)),S=dv(_,m.x,y.w,0,180),b=dv(_,m.y,y.h,90,270);sT(n,e,x,S,b)}t.setCenterPoint(e.l-n.l,n.r-e.r,e.t-n.t,n.b-e.b),t._pointLabelItems=aT(t,s,r)}function sT(t,e,n,s,r){const a=Math.abs(Math.sin(n)),l=Math.abs(Math.cos(n));let c=0,d=0;s.start<e.l?(c=(e.l-s.start)/a,t.l=Math.min(t.l,e.l-c)):s.end>e.r&&(c=(s.end-e.r)/a,t.r=Math.max(t.r,e.r+c)),r.start<e.t?(d=(e.t-r.start)/l,t.t=Math.min(t.t,e.t-d)):r.end>e.b&&(d=(r.end-e.b)/l,t.b=Math.max(t.b,e.b+d))}function rT(t,e,n){const s=t.drawingArea,{extra:r,additionalAngle:a,padding:l,size:c}=n,d=t.getPointPosition(e,s+r+l,a),f=Math.round(Qh(Bt(d.angle+pt))),m=cT(d.y,c.h,f),g=oT(f),y=lT(d.x,c.w,g);return{visible:!0,x:d.x,y:m,textAlign:g,left:y,top:m,right:y+c.w,bottom:m+c.h}}function iT(t,e){if(!e)return!0;const{left:n,top:s,right:r,bottom:a}=t;return!(Is({x:n,y:s},e)||Is({x:n,y:a},e)||Is({x:r,y:s},e)||Is({x:r,y:a},e))}function aT(t,e,n){const s=[],r=t._pointLabels.length,a=t.options,{centerPointLabels:l,display:c}=a.pointLabels,d={extra:Oh(a)/2,additionalAngle:l?ze/r:0};let f;for(let m=0;m<r;m++){d.padding=n[m],d.size=e[m];const g=rT(t,m,d);s.push(g),c==="auto"&&(g.visible=iT(g,f),g.visible&&(f=g))}return s}function oT(t){return t===0||t===180?"center":t<180?"left":"right"}function lT(t,e,n){return n==="right"?t-=e:n==="center"&&(t-=e/2),t}function cT(t,e,n){return n===90||n===270?t-=e/2:(n>270||n<90)&&(t-=e),t}function uT(t,e,n){const{left:s,top:r,right:a,bottom:l}=n,{backdropColor:c}=e;if(!Ae(c)){const d=qr(e.borderRadius),f=zt(e.backdropPadding);t.fillStyle=c;const m=s-f.left,g=r-f.top,y=a-s+f.width,x=l-r+f.height;Object.values(d).some(_=>_!==0)?(t.beginPath(),ro(t,{x:m,y:g,w:y,h:x,radius:d}),t.fill()):t.fillRect(m,g,y,x)}}function dT(t,e){const{ctx:n,options:{pointLabels:s}}=t;for(let r=e-1;r>=0;r--){const a=t._pointLabelItems[r];if(!a.visible)continue;const l=s.setContext(t.getPointLabelContext(r));uT(n,l,a);const c=_t(l.font),{x:d,y:f,textAlign:m}=a;Gr(n,t._pointLabels[r],d,f+c.lineHeight/2,c,{color:l.color,textAlign:m,textBaseline:"middle"})}}function nb(t,e,n,s){const{ctx:r}=t;if(n)r.arc(t.xCenter,t.yCenter,e,0,Qe);else{let a=t.getPointPosition(0,e);r.moveTo(a.x,a.y);for(let l=1;l<s;l++)a=t.getPointPosition(l,e),r.lineTo(a.x,a.y)}}function hT(t,e,n,s,r){const a=t.ctx,l=e.circular,{color:c,lineWidth:d}=e;!l&&!s||!c||!d||n<0||(a.save(),a.strokeStyle=c,a.lineWidth=d,a.setLineDash(r.dash||[]),a.lineDashOffset=r.dashOffset,a.beginPath(),nb(t,n,l,s),a.closePath(),a.stroke(),a.restore())}function fT(t,e,n){return pr(t,{label:n,index:e,type:"pointLabel"})}class pT extends fc{static id="radialLinear";static defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:kc.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(e){return e},padding:5,centerPointLabels:!1}};static defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"};static descriptors={angleLines:{_fallback:"grid"}};constructor(e){super(e),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const e=this._padding=zt(Oh(this.options)/2),n=this.width=this.maxWidth-e.width,s=this.height=this.maxHeight-e.height;this.xCenter=Math.floor(this.left+n/2+e.left),this.yCenter=Math.floor(this.top+s/2+e.top),this.drawingArea=Math.floor(Math.min(n,s)/2)}determineDataLimits(){const{min:e,max:n}=this.getMinMax(!1);this.min=ut(e)&&!isNaN(e)?e:0,this.max=ut(n)&&!isNaN(n)?n:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/Oh(this.options))}generateTickLabels(e){fc.prototype.generateTickLabels.call(this,e),this._pointLabels=this.getLabels().map((n,s)=>{const r=Ye(this.options.pointLabels.callback,[n,s],this);return r||r===0?r:""}).filter((n,s)=>this.chart.getDataVisibility(s))}fit(){const e=this.options;e.display&&e.pointLabels.display?nT(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(e,n,s,r){this.xCenter+=Math.floor((e-n)/2),this.yCenter+=Math.floor((s-r)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(e,n,s,r))}getIndexAngle(e){const n=Qe/(this._pointLabels.length||1),s=this.options.startAngle||0;return Bt(e*n+Un(s))}getDistanceFromCenterForValue(e){if(Ae(e))return NaN;const n=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-e)*n:(e-this.min)*n}getValueForDistanceFromCenter(e){if(Ae(e))return NaN;const n=e/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-n:this.min+n}getPointLabelContext(e){const n=this._pointLabels||[];if(e>=0&&e<n.length){const s=n[e];return fT(this.getContext(),e,s)}}getPointPosition(e,n,s=0){const r=this.getIndexAngle(e)-pt+s;return{x:Math.cos(r)*n+this.xCenter,y:Math.sin(r)*n+this.yCenter,angle:r}}getPointPositionForValue(e,n){return this.getPointPosition(e,this.getDistanceFromCenterForValue(n))}getBasePosition(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}getPointLabelPosition(e){const{left:n,top:s,right:r,bottom:a}=this._pointLabelItems[e];return{left:n,top:s,right:r,bottom:a}}drawBackground(){const{backgroundColor:e,grid:{circular:n}}=this.options;if(e){const s=this.ctx;s.save(),s.beginPath(),nb(this,this.getDistanceFromCenterForValue(this._endValue),n,this._pointLabels.length),s.closePath(),s.fillStyle=e,s.fill(),s.restore()}}drawGrid(){const e=this.ctx,n=this.options,{angleLines:s,grid:r,border:a}=n,l=this._pointLabels.length;let c,d,f;if(n.pointLabels.display&&dT(this,l),r.display&&this.ticks.forEach((m,g)=>{if(g!==0||g===0&&this.min<0){d=this.getDistanceFromCenterForValue(m.value);const y=this.getContext(g),x=r.setContext(y),_=a.setContext(y);hT(this,x,d,l,_)}}),s.display){for(e.save(),c=l-1;c>=0;c--){const m=s.setContext(this.getPointLabelContext(c)),{color:g,lineWidth:y}=m;!y||!g||(e.lineWidth=y,e.strokeStyle=g,e.setLineDash(m.borderDash),e.lineDashOffset=m.borderDashOffset,d=this.getDistanceFromCenterForValue(n.reverse?this.min:this.max),f=this.getPointPosition(c,d),e.beginPath(),e.moveTo(this.xCenter,this.yCenter),e.lineTo(f.x,f.y),e.stroke())}e.restore()}}drawBorder(){}drawLabels(){const e=this.ctx,n=this.options,s=n.ticks;if(!s.display)return;const r=this.getIndexAngle(0);let a,l;e.save(),e.translate(this.xCenter,this.yCenter),e.rotate(r),e.textAlign="center",e.textBaseline="middle",this.ticks.forEach((c,d)=>{if(d===0&&this.min>=0&&!n.reverse)return;const f=s.setContext(this.getContext(d)),m=_t(f.font);if(a=this.getDistanceFromCenterForValue(this.ticks[d].value),f.showLabelBackdrop){e.font=m.string,l=e.measureText(c.label).width,e.fillStyle=f.backdropColor;const g=zt(f.backdropPadding);e.fillRect(-l/2-g.left,-a-m.size/2-g.top,l+g.width,m.size+g.height)}Gr(e,c.label,0,-a,m,{color:f.color,strokeColor:f.textStrokeColor,strokeWidth:f.textStrokeWidth})}),e.restore()}drawTitle(){}}const Nc={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},sn=Object.keys(Nc);function hv(t,e){return t-e}function fv(t,e){if(Ae(e))return null;const n=t._adapter,{parser:s,round:r,isoWeekday:a}=t._parseOpts;let l=e;return typeof s=="function"&&(l=s(l)),ut(l)||(l=typeof s=="string"?n.parse(l,s):n.parse(l)),l===null?null:(r&&(l=r==="week"&&(Li(a)||a===!0)?n.startOf(l,"isoWeek",a):n.startOf(l,r)),+l)}function pv(t,e,n,s){const r=sn.length;for(let a=sn.indexOf(t);a<r-1;++a){const l=Nc[sn[a]],c=l.steps?l.steps:Number.MAX_SAFE_INTEGER;if(l.common&&Math.ceil((n-e)/(c*l.size))<=s)return sn[a]}return sn[r-1]}function mT(t,e,n,s,r){for(let a=sn.length-1;a>=sn.indexOf(n);a--){const l=sn[a];if(Nc[l].common&&t._adapter.diff(r,s,l)>=e-1)return l}return sn[n?sn.indexOf(n):0]}function gT(t){for(let e=sn.indexOf(t)+1,n=sn.length;e<n;++e)if(Nc[sn[e]].common)return sn[e]}function mv(t,e,n){if(!n)t[e]=!0;else if(n.length){const{lo:s,hi:r}=Zh(n,e),a=n[s]>=e?n[s]:n[r];t[a]=!0}}function yT(t,e,n,s){const r=t._adapter,a=+r.startOf(e[0].value,s),l=e[e.length-1].value;let c,d;for(c=a;c<=l;c=+r.add(c,1,s))d=n[c],d>=0&&(e[d].major=!0);return e}function gv(t,e,n){const s=[],r={},a=e.length;let l,c;for(l=0;l<a;++l)c=e[l],r[c]=l,s.push({value:c,major:!1});return a===0||!n?s:yT(t,s,r,n)}class Rh extends Yr{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,n={}){const s=e.time||(e.time={}),r=this._adapter=new vI._date(e.adapters.date);r.init(n),za(s.displayFormats,r.formats()),this._parseOpts={parser:s.parser,round:s.round,isoWeekday:s.isoWeekday},super.init(e),this._normalized=n.normalized}parse(e,n){return e===void 0?null:fv(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,n=this._adapter,s=e.time.unit||"day";let{min:r,max:a,minDefined:l,maxDefined:c}=this.getUserBounds();function d(f){!l&&!isNaN(f.min)&&(r=Math.min(r,f.min)),!c&&!isNaN(f.max)&&(a=Math.max(a,f.max))}(!l||!c)&&(d(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&d(this.getMinMax(!1))),r=ut(r)&&!isNaN(r)?r:+n.startOf(Date.now(),s),a=ut(a)&&!isNaN(a)?a:+n.endOf(Date.now(),s)+1,this.min=Math.min(r,a-1),this.max=Math.max(r+1,a)}_getLabelBounds(){const e=this.getLabelTimestamps();let n=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;return e.length&&(n=e[0],s=e[e.length-1]),{min:n,max:s}}buildTicks(){const e=this.options,n=e.time,s=e.ticks,r=s.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&r.length&&(this.min=this._userMin||r[0],this.max=this._userMax||r[r.length-1]);const a=this.min,l=this.max,c=LC(r,a,l);return this._unit=n.unit||(s.autoSkip?pv(n.minUnit,this.min,this.max,this._getLabelCapacity(a)):mT(this,c.length,n.minUnit,this.min,this.max)),this._majorUnit=!s.major.enabled||this._unit==="year"?void 0:gT(this._unit),this.initOffsets(r),e.reverse&&c.reverse(),gv(this,c,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let n=0,s=0,r,a;this.options.offset&&e.length&&(r=this.getDecimalForValue(e[0]),e.length===1?n=1-r:n=(this.getDecimalForValue(e[1])-r)/2,a=this.getDecimalForValue(e[e.length-1]),e.length===1?s=a:s=(a-this.getDecimalForValue(e[e.length-2]))/2);const l=e.length<3?.5:.25;n=Pt(n,0,l),s=Pt(s,0,l),this._offsets={start:n,end:s,factor:1/(n+1+s)}}_generate(){const e=this._adapter,n=this.min,s=this.max,r=this.options,a=r.time,l=a.unit||pv(a.minUnit,n,s,this._getLabelCapacity(n)),c=Pe(r.ticks.stepSize,1),d=l==="week"?a.isoWeekday:!1,f=Li(d)||d===!0,m={};let g=n,y,x;if(f&&(g=+e.startOf(g,"isoWeek",d)),g=+e.startOf(g,f?"day":l),e.diff(s,n,l)>1e5*c)throw new Error(n+" and "+s+" are too far apart with stepSize of "+c+" "+l);const _=r.ticks.source==="data"&&this.getDataTimestamps();for(y=g,x=0;y<s;y=+e.add(y,c,l),x++)mv(m,y,_);return(y===s||r.bounds==="ticks"||x===1)&&mv(m,y,_),Object.keys(m).sort(hv).map(S=>+S)}getLabelForValue(e){const n=this._adapter,s=this.options.time;return s.tooltipFormat?n.format(e,s.tooltipFormat):n.format(e,s.displayFormats.datetime)}format(e,n){const r=this.options.time.displayFormats,a=this._unit,l=n||r[a];return this._adapter.format(e,l)}_tickFormatFunction(e,n,s,r){const a=this.options,l=a.ticks.callback;if(l)return Ye(l,[e,n,s],this);const c=a.time.displayFormats,d=this._unit,f=this._majorUnit,m=d&&c[d],g=f&&c[f],y=s[n],x=f&&g&&y&&y.major;return this._adapter.format(e,r||(x?g:m))}generateTickLabels(e){let n,s,r;for(n=0,s=e.length;n<s;++n)r=e[n],r.label=this._tickFormatFunction(r.value,n,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const n=this._offsets,s=this.getDecimalForValue(e);return this.getPixelForDecimal((n.start+s)*n.factor)}getValueForPixel(e){const n=this._offsets,s=this.getDecimalForPixel(e)/n.factor-n.end;return this.min+s*(this.max-this.min)}_getLabelSize(e){const n=this.options.ticks,s=this.ctx.measureText(e).width,r=Un(this.isHorizontal()?n.maxRotation:n.minRotation),a=Math.cos(r),l=Math.sin(r),c=this._resolveTickFontOptions(0).size;return{w:s*a+c*l,h:s*l+c*a}}_getLabelCapacity(e){const n=this.options.time,s=n.displayFormats,r=s[n.unit]||s.millisecond,a=this._tickFormatFunction(e,0,gv(this,[e],this._majorUnit),r),l=this._getLabelSize(a),c=Math.floor(this.isHorizontal()?this.width/l.w:this.height/l.h)-1;return c>0?c:1}getDataTimestamps(){let e=this._cache.data||[],n,s;if(e.length)return e;const r=this.getMatchingVisibleMetas();if(this._normalized&&r.length)return this._cache.data=r[0].controller.getAllParsedValues(this);for(n=0,s=r.length;n<s;++n)e=e.concat(r[n].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let n,s;if(e.length)return e;const r=this.getLabels();for(n=0,s=r.length;n<s;++n)e.push(fv(this,r[n]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return fx(e.sort(hv))}}function Hl(t,e,n){let s=0,r=t.length-1,a,l,c,d;n?(e>=t[s].pos&&e<=t[r].pos&&({lo:s,hi:r}=Ps(t,"pos",e)),{pos:a,time:c}=t[s],{pos:l,time:d}=t[r]):(e>=t[s].time&&e<=t[r].time&&({lo:s,hi:r}=Ps(t,"time",e)),{time:a,pos:c}=t[s],{time:l,pos:d}=t[r]);const f=l-a;return f?c+(d-c)*(e-a)/f:c}class vT extends Rh{static id="timeseries";static defaults=Rh.defaults;constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),n=this._table=this.buildLookupTable(e);this._minPos=Hl(n,this.min),this._tableRange=Hl(n,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:n,max:s}=this,r=[],a=[];let l,c,d,f,m;for(l=0,c=e.length;l<c;++l)f=e[l],f>=n&&f<=s&&r.push(f);if(r.length<2)return[{time:n,pos:0},{time:s,pos:1}];for(l=0,c=r.length;l<c;++l)m=r[l+1],d=r[l-1],f=r[l],Math.round((m+d)/2)!==f&&a.push({time:f,pos:l/(c-1)});return a}_generate(){const e=this.min,n=this.max;let s=super.getDataTimestamps();return(!s.includes(e)||!s.length)&&s.splice(0,0,e),(!s.includes(n)||s.length===1)&&s.push(n),s.sort((r,a)=>r-a)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const n=this.getDataTimestamps(),s=this.getLabelTimestamps();return n.length&&s.length?e=this.normalize(n.concat(s)):e=n.length?n:s,e=this._cache.all=e,e}getDecimalForValue(e){return(Hl(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const n=this._offsets,s=this.getDecimalForPixel(e)/n.factor-n.end;return Hl(this._table,s*this._tableRange+this._minPos,!0)}}var xT=Object.freeze({__proto__:null,CategoryScale:YE,LinearScale:XE,LogarithmicScale:eT,RadialLinearScale:pT,TimeScale:Rh,TimeSeriesScale:vT});const bT=[yI,J1,qE,xT];df.register(...bT);function Ea({type:t,data:e,options:n}){const s=j.useRef(null),r=j.useRef(null);return j.useEffect(()=>{if(s.current)return r.current&&(r.current.destroy(),r.current=null),r.current=new df(s.current,{type:t,data:e,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:"#4a5568"}}},...n}}),()=>{r.current&&(r.current.destroy(),r.current=null)}},[t,e,n]),u.jsx("div",{className:"dashboard-chart-wrap",children:u.jsx("canvas",{ref:s})})}const Ta={sale:1,expense:2,income:3};function wT(t){const e=new Date(`${t}T00:00:00`),n=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0");return`${n}-${s}`}function _T(){const t=new Date,e=new Date(t.getFullYear(),t.getMonth(),1),n=new Date(t.getFullYear(),t.getMonth()+1,0);return{from:e.toISOString().slice(0,10),to:n.toISOString().slice(0,10),daysInMonth:n.getDate()}}function ST(t=6){const e=new Date,n=[];for(let s=t-1;s>=0;s-=1){const r=new Date(e.getFullYear(),e.getMonth()-s,1);n.push(`${r.getFullYear()}-${String(r.getMonth()+1).padStart(2,"0")}`)}return n}async function kT(t,e="es"){const{data:n,error:s}=await G.from("account_payment_forms").select('id, name, kind, provider, reference, "isActive"').eq("accountId",t).eq("isActive",!0);if(s)throw s;const{data:r,error:a}=await G.from("transactions").select('id, date, type, total, balance, "accountPaymentFormId", "isInternalObligation", "isActive"').eq("accountId",t).eq("isActive",!0);if(a)throw a;const l=(r??[]).map(E=>E.id);let c=[];if(l.length>0){const{data:E,error:L}=await G.from("transactionDetails").select("transactionId, conceptId, total, concepts(name)").in("transactionId",l);if(L)throw L;c=E??[]}const d=new Map((n??[]).map(E=>[Number(E.id),E])),f=new Map((r??[]).map(E=>[Number(E.id),E])),g=(n??[]).filter(E=>E.kind==="bank_account").map(E=>{const L=(r??[]).filter(R=>Number(R.accountPaymentFormId)===Number(E.id)).reduce((R,T)=>R+Number(T.total||0),0);return{id:E.id,name:E.name,provider:E.provider,balance:L}}),{from:y,to:x,daysInMonth:_}=_T(),S=Array.from({length:_},(E,L)=>L+1),b=new Map(S.map(E=>[E,0]));(r??[]).filter(E=>E.type===Ta.sale&&E.date>=y&&E.date<=x).forEach(E=>{const L=Number(String(E.date).slice(-2));b.set(L,Number(b.get(L)||0)+Number(E.total||0))});const k=new Map,I=new Map;c.forEach(E=>{const L=f.get(Number(E.transactionId));if(!L||L.date<y||L.date>x)return;const R=E.concepts?.name||`#${E.conceptId}`,T=Math.abs(Number(E.total||0));L.type===Ta.expense&&k.set(R,Number(k.get(R)||0)+T),L.type===Ta.income&&I.set(R,Number(I.get(R)||0)+T)});const C=ST(6),N=new Intl.DateTimeFormat(e==="es"?"es-ES":"en-US",{month:"short",year:"2-digit"}),O=new Map(C.map(E=>[E,{income:0,expense:0}]));(r??[]).forEach(E=>{const L=wT(E.date);if(!O.has(L))return;const R=O.get(L);E.type===Ta.income&&(R.income+=Math.abs(Number(E.total||0))),E.type===Ta.expense&&(R.expense+=Math.abs(Number(E.total||0))),O.set(L,R)});const U=new Map;return(r??[]).filter(E=>E.isInternalObligation).forEach(E=>{const R=d.get(Number(E.accountPaymentFormId))?.name||"-";U.set(R,Number(U.get(R)||0)+Math.abs(Number(E.balance||E.total||0)))}),{bankBalances:g,salesByDay:{labels:S.map(E=>String(E)),values:S.map(E=>Number(b.get(E)||0))},expensesByConcept:{labels:[...k.keys()],values:[...k.values()]},incomesByConcept:{labels:[...I.keys()],values:[...I.values()]},incomeExpenseLine:{labels:C.map(E=>{const[L,R]=E.split("-").map(Number);return N.format(new Date(L,R-1,1))}),incomeValues:C.map(E=>O.get(E)?.income||0),expenseValues:C.map(E=>O.get(E)?.expense||0)},internalObligationsByPaymentForm:{labels:[...U.keys()],values:[...U.values()]}}}function Ie(t,e={}){const n=Number(t??0);return Number.isFinite(n)?new Intl.NumberFormat("en-US",{minimumFractionDigits:e.minimumFractionDigits??2,maximumFractionDigits:e.maximumFractionDigits??2}).format(n):"0"}const yv=["#0f766e","#0284c7","#f59e0b","#dc2626","#6366f1","#10b981","#f97316","#8b5cf6"];function Gd(t){return t.labels.length?{labels:t.labels,datasets:[{data:t.values,backgroundColor:t.labels.map((e,n)=>yv[n%yv.length])}]}:{labels:["-"],datasets:[{data:[1],backgroundColor:["#cbd5e1"]}]}}function jT(){const{t}=Ee(),{account:e}=Oe(),[n,s]=j.useState(null),[r,a]=j.useState(""),[l,c]=j.useState(!0);j.useEffect(()=>{e?.accountId&&d()},[e?.accountId]);const d=async()=>{try{c(!0);const g=await kT(e.accountId);s(g),a("")}catch{a(t("common.genericLoadError"))}finally{c(!1)}},f=j.useMemo(()=>n?{labels:n.salesByDay.labels,datasets:[{label:t("dashboard.salesMonthBar"),data:n.salesByDay.values,backgroundColor:"#0f766e"}]}:{labels:[],datasets:[]},[n,t]),m=j.useMemo(()=>n?{labels:n.incomeExpenseLine.labels,datasets:[{label:t("dashboard.incomesLine"),data:n.incomeExpenseLine.incomeValues,borderColor:"#0f766e",backgroundColor:"rgba(15,118,110,0.2)",tension:.3},{label:t("dashboard.expensesLine"),data:n.incomeExpenseLine.expenseValues,borderColor:"#dc2626",backgroundColor:"rgba(220,38,38,0.2)",tension:.3}]}:{labels:[],datasets:[]},[n,t]);return l?u.jsx("p",{children:t("common.loading")}):u.jsxs("div",{className:"module-page dashboard-page",children:[u.jsx("h1",{children:t("dashboard.title")}),u.jsx("p",{children:t("dashboard.subtitle")}),r&&u.jsx("p",{className:"error-text",children:r}),n&&u.jsxs(u.Fragment,{children:[u.jsxs("section",{className:"generic-panel",children:[u.jsx("h2",{className:"crud-form-section-title",children:t("dashboard.bankBalances")}),u.jsxs("table",{className:"crud-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:t("common.name")}),u.jsx("th",{children:t("paymentForms.provider")}),u.jsx("th",{children:t("transactions.balance")})]})}),u.jsx("tbody",{children:n.bankBalances.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:3,children:t("common.empty")})}):n.bankBalances.map(g=>u.jsxs("tr",{children:[u.jsx("td",{children:g.name}),u.jsx("td",{children:g.provider||"-"}),u.jsx("td",{children:Ie(g.balance)})]},g.id))})]})]}),u.jsxs("section",{className:"dashboard-grid",children:[u.jsxs("article",{className:"generic-panel dashboard-panel",children:[u.jsx("h2",{className:"crud-form-section-title",children:t("dashboard.salesMonthBar")}),u.jsx(Ea,{type:"bar",data:f,options:{plugins:{legend:{display:!1}}}})]}),u.jsxs("article",{className:"generic-panel dashboard-panel",children:[u.jsx("h2",{className:"crud-form-section-title",children:t("dashboard.expensesByConceptDonut")}),u.jsx(Ea,{type:"doughnut",data:Gd(n.expensesByConcept)})]}),u.jsxs("article",{className:"generic-panel dashboard-panel",children:[u.jsx("h2",{className:"crud-form-section-title",children:t("dashboard.incomesByConceptDonut")}),u.jsx(Ea,{type:"doughnut",data:Gd(n.incomesByConcept)})]}),u.jsxs("article",{className:"generic-panel dashboard-panel",children:[u.jsx("h2",{className:"crud-form-section-title",children:t("dashboard.incomeVsExpenseLine")}),u.jsx(Ea,{type:"line",data:m})]}),u.jsxs("article",{className:"generic-panel dashboard-panel",children:[u.jsx("h2",{className:"crud-form-section-title",children:t("dashboard.internalObligationsByPaymentForm")}),u.jsx(Ea,{type:"doughnut",data:Gd(n.internalObligationsByPaymentForm)})]})]})]})]})}function qn({page:t,pageSize:e,totalItems:n,onPageChange:s}){const{t:r}=Ee(),a=Math.max(1,Math.ceil(n/e));return u.jsxs("div",{className:"pagination-wrap",children:[u.jsx("button",{type:"button",className:"button-secondary",onClick:()=>s(t-1),disabled:t<=1,children:r("common.previous")}),u.jsxs("span",{children:[r("common.page")," ",t," ",r("common.of")," ",a]}),u.jsx("button",{type:"button",className:"button-secondary",onClick:()=>s(t+1),disabled:t>=a,children:r("common.next")})]})}function mo({label:t,required:e=!1,error:n=!1,className:s="",children:r}){return u.jsxs("label",{className:`field-block ${e?"required":""} ${n?"field-error":""} ${s}`.trim(),children:[t?u.jsx("span",{children:t}):null,r]})}function nt({label:t,required:e=!1,error:n=!1,className:s="",...r}){return u.jsx(mo,{label:t,required:e,error:n,className:s,children:u.jsx("input",{...r,required:e})})}const go="id, name, phone, address, type";async function vv(t){const{data:e,error:n}=await G.from("persons").select(go).eq("accountId",t).order("id",{ascending:!1});if(n)throw n;return e??[]}async function CT(t,e){const{data:n,error:s}=await G.from("persons").select(go).eq("accountId",t).eq("type",e).order("id",{ascending:!1});if(s)throw s;return n??[]}async function PT(t){const{data:e,error:n}=await G.from("persons").select(go).eq("id",t).single();if(n)throw n;return e}async function IT(t){const{data:e,error:n}=await G.from("persons").insert(t).select(go).single();if(n)throw n;return e}async function ET(t,e){const{data:n,error:s}=await G.from("persons").update(e).eq("id",t).select(go).single();if(s)throw s;return n}async function TT(t){const{error:e}=await G.from("persons").delete().eq("id",t);if(e)throw e}const NT={name:"",phone:"",address:""};function Vr({personType:t,titleKey:e,basePath:n,embedded:s=!1,onCancel:r,onCreated:a}){const{t:l}=Ee(),{account:c,user:d}=Oe(),f=Ht(),{id:m}=Vn(),g=!s&&!!m,[y,x]=j.useState(NT),[_,S]=j.useState(!1),[b,k]=j.useState(g),[I,C]=j.useState("");j.useEffect(()=>{g&&N()},[g,m]);const N=async()=>{try{k(!0);const E=await PT(m);x({name:E.name,phone:E.phone??"",address:E.address??""})}catch{C(l("common.genericLoadError"))}finally{k(!1)}},O=E=>{const{name:L,value:R}=E.target;x(T=>({...T,[L]:R}))},U=async E=>{if(E.preventDefault(),C(""),!E.currentTarget.checkValidity()){E.currentTarget.reportValidity(),C(l("common.requiredFields"));return}if(!c?.accountId||!d?.id){C(l("common.requiredFields"));return}const L={accountId:c.accountId,name:y.name.trim(),phone:y.phone.trim()||null,address:y.address.trim()||null,type:t};try{S(!0);let R=null;if(g?R=await ET(m,L):R=await IT({...L,createdById:d.id}),s){a?.(R);return}f(n)}catch{C(l("common.genericSaveError"))}finally{S(!1)}};return u.jsxs("div",{className:s?"":"module-page",children:[s?u.jsx("h3",{children:l(g?"common.edit":e)}):u.jsxs("div",{className:"page-header-row",children:[u.jsx("h1",{children:l(g?"common.edit":e)}),u.jsx(st,{to:n,className:"button-link-secondary",children:l("common.backToList")})]}),I&&u.jsx("p",{className:"error-text",children:I}),b?u.jsx("p",{children:l("common.loading")}):u.jsxs("form",{className:"crud-form",onSubmit:U,children:[u.jsxs("div",{className:"form-grid-2",children:[u.jsx(nt,{label:l("common.name"),name:"name",placeholder:l("common.name"),value:y.name,onChange:O,required:!0}),u.jsx(nt,{label:l("common.phone"),name:"phone",placeholder:l("common.phone"),value:y.phone,onChange:O}),u.jsx(nt,{label:l("common.address"),name:"address",placeholder:l("common.address"),value:y.address,onChange:O,className:"form-span-2"})]}),u.jsxs("div",{className:"crud-form-actions",children:[s?u.jsx("button",{type:"button",className:"button-secondary",onClick:()=>r?.(),children:l("common.cancel")}):null,u.jsx("button",{type:"submit",disabled:_,children:l(g?"common.update":"common.create")})]})]})]})}function En({actions:t}){const[e,n]=j.useState(!1),s=j.useRef(null);return j.useEffect(()=>{const r=a=>{s.current?.contains(a.target)||n(!1)};return window.addEventListener("click",r),()=>window.removeEventListener("click",r)},[]),u.jsxs("div",{className:"row-actions-wrap",ref:s,children:[u.jsx("button",{type:"button",className:"row-menu-btn",onClick:()=>n(r=>!r),"aria-label":"Actions",children:u.jsx(D_,{})}),e&&u.jsx("div",{className:"row-menu-dropdown",children:t.map(r=>r.to?u.jsx(st,{to:r.to,className:`row-menu-item ${r.danger?"danger":""}`,children:r.label},r.key):u.jsx("button",{type:"button",className:`row-menu-item ${r.danger?"danger":""}`,onClick:()=>{r.onClick?.(),n(!1)},disabled:r.disabled,children:r.label},r.key))})]})}const Yd=10;function xv({personType:t,titleKey:e,basePath:n}){const{t:s}=Ee(),{account:r}=Oe(),[a,l]=j.useState([]),[c,d]=j.useState(""),[f,m]=j.useState(!0),[g,y]=j.useState(1),[x,_]=as(),S=x.get("create")==="1";j.useEffect(()=>{r?.accountId&&k()},[r?.accountId,t]);const b=j.useMemo(()=>{const C=(g-1)*Yd;return a.slice(C,C+Yd)},[a,g]),k=async()=>{try{m(!0);const C=await CT(r.accountId,t);l(C),d(""),y(1)}catch{d(s("common.genericLoadError"))}finally{m(!1)}},I=async C=>{try{await TT(C),await k()}catch{d(s("common.genericSaveError"))}};return u.jsxs("div",{className:"module-page",children:[u.jsx("h1",{children:s(e)}),c&&u.jsx("p",{className:"error-text",children:c}),f?u.jsx("p",{children:s("common.loading")}):a.length===0?u.jsx("p",{children:s("common.empty")}):u.jsxs(u.Fragment,{children:[u.jsxs("table",{className:"crud-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:s("common.name")}),u.jsx("th",{children:s("common.phone")}),u.jsx("th",{children:s("common.address")}),u.jsx("th",{children:s("common.actions")})]})}),u.jsx("tbody",{children:b.map(C=>u.jsxs("tr",{children:[u.jsx("td",{children:C.name}),u.jsx("td",{children:C.phone??"-"}),u.jsx("td",{children:C.address??"-"}),u.jsx("td",{className:"table-actions",children:u.jsx(En,{actions:[{key:"edit",label:s("common.edit"),to:`${n}/${C.id}/edit`},{key:"delete",label:s("common.delete"),onClick:()=>I(C.id),danger:!0}]})})]},C.id))})]}),u.jsx(qn,{page:g,pageSize:Yd,totalItems:a.length,onPageChange:y})]}),S?u.jsx("div",{className:"modal-backdrop",onClick:()=>{const C=new URLSearchParams(x);C.delete("create"),_(C)},children:u.jsx("div",{className:"modal-card",onClick:C=>C.stopPropagation(),children:u.jsx(Vr,{embedded:!0,personType:t,titleKey:t===1?"actions.newClient":"actions.newProvider",basePath:n,onCancel:()=>{const C=new URLSearchParams(x);C.delete("create"),_(C)},onCreated:async()=>{await k();const C=new URLSearchParams(x);C.delete("create"),_(C)}})})}):null]})}const Ac="id, name, phone, email, address, isPartner";async function pc(t){const{data:e,error:n}=await G.from("employes").select(Ac).eq("accountId",t).order("id",{ascending:!1});if(n)throw n;return e??[]}async function AT(t){const{data:e,error:n}=await G.from("employes").select(Ac).eq("id",t).single();if(n)throw n;return e}async function OT(t){const{data:e,error:n}=await G.from("employes").insert(t).select(Ac).single();if(n)throw n;return e}async function RT(t,e){const{data:n,error:s}=await G.from("employes").update(e).eq("id",t).select(Ac).single();if(s)throw s;return n}async function MT(t){const{error:e}=await G.from("employes").delete().eq("id",t);if(e)throw e}const LT={name:"",phone:"",email:"",address:"",isPartner:!1};function mc({embedded:t=!1,onCancel:e,onCreated:n}){const{t:s}=Ee(),{account:r,user:a}=Oe(),l=Ht(),{id:c}=Vn(),d=!t&&!!c,[f,m]=j.useState(LT),[g,y]=j.useState(!1),[x,_]=j.useState(d),[S,b]=j.useState("");j.useEffect(()=>{d&&k()},[d,c]);const k=async()=>{try{_(!0);const N=await AT(c);m({name:N.name,phone:N.phone??"",email:N.email??"",address:N.address??"",isPartner:!!N.isPartner})}catch{b(s("common.genericLoadError"))}finally{_(!1)}},I=N=>{const{name:O,value:U,type:E,checked:L}=N.target;m(R=>({...R,[O]:E==="checkbox"?L:U}))},C=async N=>{if(N.preventDefault(),b(""),!N.currentTarget.checkValidity()){N.currentTarget.reportValidity(),b(s("common.requiredFields"));return}if(!r?.accountId||!a?.id){b(s("common.requiredFields"));return}const O={accountId:r.accountId,name:f.name.trim(),phone:f.phone.trim()||null,email:f.email.trim()||null,address:f.address.trim()||null,isPartner:f.isPartner};try{y(!0);let U=null;if(d?U=await RT(c,O):U=await OT({...O,createdById:a.id}),t){n?.(U);return}l("/employees")}catch{b(s("common.genericSaveError"))}finally{y(!1)}};return u.jsxs("div",{className:t?"":"module-page",children:[t?u.jsx("h3",{children:s(d?"common.edit":"actions.newEmployee")}):u.jsxs("div",{className:"page-header-row",children:[u.jsx("h1",{children:s(d?"common.edit":"common.create")}),u.jsx(st,{to:"/employees",className:"button-link-secondary",children:s("common.backToList")})]}),S&&u.jsx("p",{className:"error-text",children:S}),x?u.jsx("p",{children:s("common.loading")}):u.jsxs("form",{className:"crud-form",onSubmit:C,children:[u.jsxs("div",{className:"form-grid-2",children:[u.jsx(nt,{label:s("common.name"),name:"name",placeholder:s("common.name"),value:f.name,onChange:I,required:!0}),u.jsx(nt,{label:s("common.phone"),name:"phone",placeholder:s("common.phone"),value:f.phone,onChange:I}),u.jsx(nt,{label:s("common.email"),name:"email",placeholder:s("common.email"),value:f.email,onChange:I}),u.jsx(nt,{label:s("common.address"),name:"address",placeholder:s("common.address"),value:f.address,onChange:I}),u.jsxs("label",{className:"checkbox-field form-span-2",children:[u.jsx("input",{name:"isPartner",type:"checkbox",checked:f.isPartner,onChange:I}),s("employees.isPartner")]})]}),u.jsxs("div",{className:"crud-form-actions",children:[t?u.jsx("button",{type:"button",className:"button-secondary",onClick:()=>e?.(),children:s("common.cancel")}):null,u.jsx("button",{type:"submit",disabled:g,children:s(d?"common.update":"common.create")})]})]})]})}const Jd=10;function DT(){const{t}=Ee(),{account:e}=Oe(),[n,s]=j.useState([]),[r,a]=j.useState(""),[l,c]=j.useState(!0),[d,f]=j.useState(1),[m,g]=as(),y=m.get("create")==="1";j.useEffect(()=>{e?.accountId&&_()},[e?.accountId]);const x=j.useMemo(()=>{const b=(d-1)*Jd;return n.slice(b,b+Jd)},[n,d]),_=async()=>{try{c(!0);const b=await pc(e.accountId);s(b),a(""),f(1)}catch{a(t("common.genericLoadError"))}finally{c(!1)}},S=async b=>{try{await MT(b),await _()}catch{a(t("common.genericSaveError"))}};return u.jsxs("div",{className:"module-page",children:[u.jsx("h1",{children:t("employees.title")}),u.jsx("p",{children:t("employees.sensitiveHint")}),r&&u.jsx("p",{className:"error-text",children:r}),l?u.jsx("p",{children:t("common.loading")}):n.length===0?u.jsx("p",{children:t("common.empty")}):u.jsxs(u.Fragment,{children:[u.jsxs("table",{className:"crud-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:t("common.name")}),u.jsx("th",{children:t("common.phone")}),u.jsx("th",{children:t("common.email")}),u.jsx("th",{children:t("common.address")}),u.jsx("th",{children:t("employees.isPartner")}),u.jsx("th",{children:t("common.actions")})]})}),u.jsx("tbody",{children:x.map(b=>u.jsxs("tr",{children:[u.jsx("td",{children:b.name}),u.jsx("td",{children:b.phone??"-"}),u.jsx("td",{children:b.email??"-"}),u.jsx("td",{children:b.address??"-"}),u.jsx("td",{children:b.isPartner?t("common.yes"):t("common.no")}),u.jsx("td",{className:"table-actions",children:u.jsx(En,{actions:[{key:"edit",label:t("common.edit"),to:`/employees/${b.id}/edit`},{key:"delete",label:t("common.delete"),onClick:()=>S(b.id),danger:!0}]})})]},b.id))})]}),u.jsx(qn,{page:d,pageSize:Jd,totalItems:n.length,onPageChange:f})]}),y?u.jsx("div",{className:"modal-backdrop",onClick:()=>{const b=new URLSearchParams(m);b.delete("create"),g(b)},children:u.jsx("div",{className:"modal-card",onClick:b=>b.stopPropagation(),children:u.jsx(mc,{embedded:!0,onCancel:()=>{const b=new URLSearchParams(m);b.delete("create"),g(b)},onCreated:async()=>{await _();const b=new URLSearchParams(m);b.delete("create"),g(b)}})})}):null]})}function Ri({label:t,required:e=!1,error:n=!1,className:s="",...r}){return u.jsx(mo,{label:t,required:e,error:n,className:s,children:u.jsx("input",{type:"number",...r,required:e})})}function mn({label:t,required:e=!1,error:n=!1,className:s="",children:r,...a}){return u.jsx(mo,{label:t,required:e,error:n,className:s,children:u.jsx("select",{...a,required:e,children:r})})}function ns({label:t,value:e,onValueChange:n,options:s,getOptionLabel:r,onSelect:a,placeholder:l,addButton:c,renderCreateModal:d,onCreateRecord:f,noResultsText:m,selectedPillText:g,onClearSelection:y,required:x=!1,hasError:_=!1}){const[S,b]=j.useState(!1),[k,I]=j.useState(-1),[C,N]=j.useState(!1),O=j.useRef(null),[U,E]=j.useState({}),L=j.useMemo(()=>{const T=e.trim().toLowerCase();return T?s.filter(D=>r(D).toLowerCase().includes(T)).slice(0,50):s.slice(0,50)},[r,s,e]),R=T=>{if(!S){(T.key==="ArrowDown"||T.key==="ArrowUp")&&(b(!0),I(L.length>0?0:-1),T.preventDefault());return}if(T.key==="ArrowDown"){if(T.preventDefault(),L.length===0)return;I(D=>D<L.length-1?D+1:0);return}if(T.key==="ArrowUp"){if(T.preventDefault(),L.length===0)return;I(D=>D>0?D-1:L.length-1);return}if(T.key==="Enter"){k>=0&&k<L.length&&(T.preventDefault(),a(L[k]),b(!1));return}T.key==="Escape"&&(b(!1),I(-1))};return j.useEffect(()=>{if(!S||g)return;const T=()=>{const D=O.current?.getBoundingClientRect();D&&E({position:"fixed",top:`${D.bottom+2}px`,left:`${D.left}px`,width:`${D.width}px`,zIndex:1300})};return T(),window.addEventListener("resize",T),window.addEventListener("scroll",T,!0),()=>{window.removeEventListener("resize",T),window.removeEventListener("scroll",T,!0)}},[S,g,e,L.length]),u.jsxs("div",{className:`lookup-wrap ${x?"required":""} ${_?"has-error":""}`,children:[t?u.jsx("label",{children:t}):null,u.jsxs("div",{className:"lookup-input-row",children:[g?u.jsxs("div",{className:"lookup-selected-pill",children:[u.jsx("span",{children:g}),y?u.jsx("button",{type:"button",onClick:()=>{y(),b(!1),I(-1)},"aria-label":"clear selected",children:""}):null]}):u.jsx("input",{ref:O,value:e,onChange:T=>{n(T.target.value),b(!0),I(0)},onFocus:()=>{b(!0),I(L.length>0?0:-1)},onClick:()=>{b(!0),I(L.length>0?0:-1)},onBlur:()=>setTimeout(()=>b(!1),120),onKeyDown:R,placeholder:l}),c?u.jsx("div",{className:"lookup-input-action",children:c}):null,!c&&d?u.jsx("div",{className:"lookup-input-action",children:u.jsx("button",{type:"button",className:"button-secondary lookup-add-button",onClick:()=>N(!0),title:"create",children:"+"})}):null]}),!g&&S?eg.createPortal(u.jsx("div",{className:"lookup-results",style:U,children:L.length>0?L.map((T,D)=>u.jsx("button",{type:"button",className:`lookup-item ${k===D?"active":""}`,onMouseDown:Y=>Y.preventDefault(),onClick:()=>{a(T),b(!1)},children:r(T)},T.id)):u.jsx("div",{className:"lookup-empty",children:m})}),document.body):null,d?eg.createPortal(d({isOpen:C,onClose:()=>N(!1),onCreated:async T=>{try{f&&await f(T)}finally{N(!1)}}}),document.body):null]})}const yo="id, name, parentConceptId, parentConcept:concepts!concepts_parentConceptId_fkey(name), isGroup, isIncome, isExpense, isProduct, isPaymentForm, isAccountPayableConcept, isIncomingPaymentConcept, isOutgoingPaymentConcept, isSystem, taxPercentage, price, additionalCharges";async function Bi(t){const{data:e,error:n}=await G.from("concepts").select(yo).eq("accountId",t).order("id",{ascending:!1});if(n)throw n;return e??[]}async function Mh(t,e){let n=G.from("concepts").select(yo).eq("accountId",t);e==="products"&&(n=n.eq("isProduct",!0).eq("isGroup",!1)),e==="income"&&(n=n.eq("isIncome",!0).eq("isProduct",!1).eq("isGroup",!1).eq("isIncomingPaymentConcept",!1)),e==="expense"&&(n=n.eq("isExpense",!0).eq("isGroup",!1).eq("isOutgoingPaymentConcept",!1).eq("isAccountPayableConcept",!1)),e==="groups"&&(n=n.eq("isGroup",!0)),e==="payable"&&(n=n.eq("isAccountPayableConcept",!0).eq("isGroup",!1));const{data:s,error:r}=await n.order("id",{ascending:!1});if(r)throw r;return s??[]}async function FT(t){const{data:e,error:n}=await G.from("concepts").select(yo).eq("id",t).single();if(n)throw n;return e}async function BT(t){const{data:e,error:n}=await G.from("concepts").insert(t).select(yo).single();if(n)throw n;return e}async function $T(t,e){const{data:n,error:s}=await G.from("concepts").update(e).eq("id",t).select(yo).single();if(s)throw s;return n}async function zT(t){const{error:e}=await G.from("concepts").delete().eq("id",t);if(e)throw e}const UT={products:{isProduct:!0,isIncome:!0,isExpense:!1,isGroup:!1,isPaymentForm:!1,isAccountPayableConcept:!1},income:{isProduct:!1,isIncome:!0,isExpense:!1,isGroup:!1,isPaymentForm:!1,isAccountPayableConcept:!1},expense:{isProduct:!1,isIncome:!1,isExpense:!0,isGroup:!1,isPaymentForm:!1,isAccountPayableConcept:!1},payable:{isProduct:!1,isIncome:!1,isExpense:!0,isGroup:!1,isPaymentForm:!1,isAccountPayableConcept:!0},groups:{isProduct:!1,isIncome:!1,isExpense:!1,isGroup:!0,isPaymentForm:!1,isAccountPayableConcept:!1}},WT={name:"",parentConceptId:"",taxPercentage:0,price:0,additionalCharges:0,groupType:"income"};function nn({moduleType:t,titleKey:e,basePath:n,embedded:s=!1,onCancel:r,onCreated:a}){const{t:l}=Ee(),{account:c,user:d}=Oe(),f=Ht(),{id:m}=Vn(),g=!s&&!!m,[y,x]=j.useState(WT),[_,S]=j.useState(!1),[b,k]=j.useState(g),[I,C]=j.useState(""),[N,O]=j.useState(!1),[U,E]=j.useState([]),[L,R]=j.useState("");j.useEffect(()=>{c?.accountId&&T()},[c?.accountId]),j.useEffect(()=>{!g||!c?.accountId||D()},[g,m,c?.accountId]);const T=async()=>{try{const H=await Mh(c.accountId,"groups");E(H)}catch{E([])}},D=async()=>{try{k(!0);const H=await FT(m);x({name:H.name,parentConceptId:H.parentConceptId?String(H.parentConceptId):"",taxPercentage:H.taxPercentage??0,price:H.price??0,additionalCharges:H.additionalCharges??0,groupType:H.isExpense?"expense":"income"});const J=H.parentConceptId?U.find(ee=>ee.id===Number(H.parentConceptId)):null;R(J?.name||"")}catch{C(l("common.genericLoadError"))}finally{k(!1)}},Y=H=>{const{name:J,value:ee}=H.target;x(he=>({...he,[J]:ee}))},se=async H=>{if(H.preventDefault(),O(!0),C(""),!H.currentTarget.checkValidity()){H.currentTarget.reportValidity(),C(l("common.requiredFields"));return}if(!c?.accountId||!d?.id){C(l("common.requiredFields"));return}if(["income","expense","payable"].includes(t)&&!y.parentConceptId){C(l("common.requiredFields"));return}const J={accountId:c.accountId,name:y.name.trim(),parentConceptId:t==="groups"?null:y.parentConceptId?Number(y.parentConceptId):null,taxPercentage:t==="products"&&Number(y.taxPercentage)||0,price:Number(y.price)||0,additionalCharges:Number(y.additionalCharges)||0,...UT[t]};t==="groups"&&(J.isIncome=y.groupType==="income",J.isExpense=y.groupType==="expense");try{S(!0);let ee=null;if(g?ee=await $T(m,J):ee=await BT({...J,createdById:d.id}),s){a?.(ee);return}f(n)}catch{C(l("common.genericSaveError"))}finally{S(!1)}};return u.jsxs("div",{className:s?"":"module-page",children:[s?u.jsx("h3",{children:l(g?"common.edit":e)}):u.jsxs("div",{className:"page-header-row",children:[u.jsx("h1",{children:l(g?"common.edit":e)}),u.jsx(st,{to:n,className:"button-link-secondary",children:l("common.backToList")})]}),I&&u.jsx("p",{className:"error-text",children:I}),b?u.jsx("p",{children:l("common.loading")}):u.jsxs("form",{className:"crud-form",onSubmit:se,children:[u.jsxs("div",{className:"form-grid-2",children:[u.jsx(nt,{label:l("common.name"),name:"name",placeholder:l("common.name"),value:y.name,onChange:Y,required:!0}),t!=="groups"?["income","expense","payable"].includes(t)?u.jsx(ns,{label:l("concepts.group"),value:L,onValueChange:R,options:U,getOptionLabel:H=>H.name||"",onSelect:H=>{x(J=>({...J,parentConceptId:String(H.id)})),R("")},placeholder:`-- ${l("concepts.group")} --`,noResultsText:l("common.empty"),required:!0,hasError:N&&!y.parentConceptId,selectedPillText:U.find(H=>H.id===Number(y.parentConceptId))?.name||"",onClearSelection:()=>{x(H=>({...H,parentConceptId:""})),R("")},renderCreateModal:({isOpen:H,onClose:J,onCreated:ee})=>H?u.jsx("div",{className:"modal-backdrop",onClick:J,children:u.jsx("div",{className:"modal-card",onClick:he=>he.stopPropagation(),children:u.jsx(nn,{embedded:!0,moduleType:"groups",titleKey:"actions.newConceptGroup",basePath:"/concept-groups",onCancel:J,onCreated:ee})})}):null,onCreateRecord:async H=>{const J=await Mh(c.accountId,"groups");E(J),x(ee=>({...ee,parentConceptId:String(H.id)})),R("")}}):u.jsxs(mn,{label:l("concepts.group"),name:"parentConceptId",value:y.parentConceptId,onChange:Y,children:[u.jsx("option",{value:"",children:`-- ${l("concepts.noGroup")} --`}),U.map(H=>u.jsx("option",{value:H.id,children:H.name},H.id))]}):u.jsxs(mn,{label:l("concepts.groupType"),name:"groupType",value:y.groupType,onChange:Y,children:[u.jsx("option",{value:"income",children:l("concepts.groupTypeIncome")}),u.jsx("option",{value:"expense",children:l("concepts.groupTypeExpense")})]}),t==="products"?u.jsx(Ri,{label:l("concepts.taxPercentage"),name:"taxPercentage",min:"0",step:"0.01",placeholder:l("concepts.taxPercentage"),value:y.taxPercentage,onChange:Y,required:!0}):null,t==="products"&&u.jsxs(u.Fragment,{children:[u.jsx(Ri,{label:l("transactions.price"),name:"price",min:"0",step:"0.01",placeholder:l("transactions.price"),value:y.price,onChange:Y,required:!0}),u.jsx(Ri,{label:l("transactions.additionalCharges"),name:"additionalCharges",min:"0",step:"0.01",placeholder:l("transactions.additionalCharges"),value:y.additionalCharges,onChange:Y,required:!0})]})]}),u.jsxs("div",{className:"crud-form-actions",children:[s?u.jsx("button",{type:"button",className:"button-secondary",onClick:()=>r?.(),children:l("common.cancel")}):null,u.jsx("button",{type:"submit",disabled:_,children:l(g?"common.update":"common.create")})]})]})]})}const Xd=10;function Na({moduleType:t,titleKey:e,basePath:n}){const{t:s}=Ee(),{account:r}=Oe(),[a,l]=j.useState([]),[c,d]=j.useState(""),[f,m]=j.useState(!0),[g,y]=j.useState(1),[x,_]=as(),S=x.get("create")==="1";j.useEffect(()=>{r?.accountId&&k()},[r?.accountId,t]);const b=j.useMemo(()=>{const C=(g-1)*Xd;return a.slice(C,C+Xd)},[a,g]),k=async()=>{try{m(!0);const C=await Mh(r.accountId,t);l(C),d(""),y(1)}catch{d(s("common.genericLoadError"))}finally{m(!1)}},I=async C=>{try{await zT(C),await k()}catch{d(s("common.genericSaveError"))}};return u.jsxs("div",{className:"module-page",children:[u.jsx("h1",{children:s(e)}),c&&u.jsx("p",{className:"error-text",children:c}),f?u.jsx("p",{children:s("common.loading")}):a.length===0?u.jsx("p",{children:s("common.empty")}):u.jsxs(u.Fragment,{children:[u.jsxs("table",{className:"crud-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:s("common.name")}),u.jsx("th",{children:s("concepts.group")}),u.jsx("th",{children:s("concepts.taxPercentage")}),t==="products"&&u.jsx("th",{children:s("transactions.price")}),t==="products"&&u.jsx("th",{children:s("transactions.additionalCharges")}),u.jsx("th",{children:s("common.actions")})]})}),u.jsx("tbody",{children:b.map(C=>u.jsxs("tr",{children:[u.jsx("td",{children:C.name}),u.jsx("td",{children:C.parentConcept?.name??"-"}),u.jsx("td",{children:C.taxPercentage}),t==="products"&&u.jsx("td",{children:Number(C.price||0).toFixed(2)}),t==="products"&&u.jsx("td",{children:Number(C.additionalCharges||0).toFixed(2)}),u.jsx("td",{className:"table-actions",children:u.jsx(En,{actions:[...C.isSystem?[]:[{key:"edit",label:s("common.edit"),to:`${n}/${C.id}/edit`}],...C.isSystem?[]:[{key:"delete",label:s("common.delete"),onClick:()=>I(C.id),danger:!0}]]})})]},C.id))})]}),u.jsx(qn,{page:g,pageSize:Xd,totalItems:a.length,onPageChange:y})]}),S?u.jsx("div",{className:"modal-backdrop",onClick:()=>{const C=new URLSearchParams(x);C.delete("create"),_(C)},children:u.jsx("div",{className:"modal-card",onClick:C=>C.stopPropagation(),children:u.jsx(nn,{embedded:!0,moduleType:t,titleKey:t==="products"?"actions.newProduct":t==="income"?"actions.newIncomeConcept":t==="expense"?"actions.newExpenseConcept":t==="payable"?"actions.newPayableConcept":"actions.newConceptGroup",basePath:n,onCancel:()=>{const C=new URLSearchParams(x);C.delete("create"),_(C)},onCreated:async()=>{await k();const C=new URLSearchParams(x);C.delete("create"),_(C)}})})}):null]})}const Oc='id, "accountId", name, kind, provider, reference, "employeeId", "createInternalPayableOnOutgoingPayment", "isActive"';async function fr(t){const{data:e,error:n}=await G.from("account_payment_forms").select(Oc).eq("accountId",t).eq("isActive",!0).order("id",{ascending:!1});if(n)throw n;return e??[]}async function VT(t){const{data:e,error:n}=await G.from("account_payment_forms").select(Oc).eq("id",t).single();if(n)throw n;return e}async function qT(t){const{data:e,error:n}=await G.from("account_payment_forms").insert(t).select(Oc).single();if(n)throw n;return e}async function HT(t,e){const{data:n,error:s}=await G.from("account_payment_forms").update(e).eq("id",t).select(Oc).single();if(s)throw s;return n}async function KT(t){const{error:e}=await G.from("account_payment_forms").update({isActive:!1}).eq("id",t);if(e)throw e}async function oo(t){const{data:e,error:n}=await G.from("payment_methods").select('id, "accountId", code, name, is_active').eq("accountId",t).eq("is_active",!0).order("id");if(n)throw n;return e??[]}async function GT(t){const{data:e,error:n}=await G.from("payment_methods").insert(t).select('id, "accountId", code, name, is_active').single();if(n)throw n;return e}const At={sale:1,expense:2,income:3,purchase:4,outgoingPayment:5,incomingPayment:6};async function YT({accountId:t,type:e,excludeInternalObligations:n=!1}){let s=G.from("transactions").select('id, personId, date, type, status, total, balance, payments, name, currencyId, "projectId", "referenceNumber", "paymentMethodId", "accountPaymentFormId", "isReconciled", "reconciledAt", "isInternalObligation", "sourceTransactionId", "isInternalTransfer", "isDeposit", isActive, persons(name), projects(name), account_payment_forms(name)').eq("accountId",t).eq("type",e);n&&(s=s.eq("isInternalObligation",!1));const{data:r,error:a}=await s.order("id",{ascending:!1});if(a)throw a;return r??[]}async function JT(t=[]){const e=(t||[]).map(a=>Number(a)).filter(a=>Number.isFinite(a)&&a>0);if(e.length===0)return{};const{data:n,error:s}=await G.from("transactionDetails").select("id, transactionId, concepts(name)").in("transactionId",e).order("id",{ascending:!0});if(s)throw s;const r={};for(const a of n??[]){const l=Number(a.transactionId);!l||r[l]||(r[l]=a.concepts?.name??null)}return r}async function XT({accountId:t,projectId:e,dateFrom:n,dateTo:s}){let r=G.from("transactions").select('id, date, type, total, balance, name, personId, "projectId", isActive, persons(name), projects(name)').eq("accountId",t).eq("projectId",e).eq("isActive",!0);n&&(r=r.gte("date",n)),s&&(r=r.lte("date",s));const{data:a,error:l}=await r.order("date",{ascending:!1});if(l)throw l;return a??[]}async function bv({transaction:t,details:e}){const{data:n,error:s}=await G.from("transactions").insert(t).select("id").single();if(s)throw s;const r=e.map(l=>({...l,transactionId:n.id})),{error:a}=await G.from("transactionDetails").insert(r);if(a)throw await G.from("transactions").delete().eq("id",n.id),a;return n}async function sb(t){const{error:e}=await G.from("transactions").update({isActive:!1}).eq("id",t);if(e)throw e}async function rb(t){const{data:e,error:n}=await G.from("transactions").select('id, accountId, personId, date, type, name, total, balance, payments, "projectId", "referenceNumber", "paymentMethodId", "accountPaymentFormId", "isReconciled", "reconciledAt", "isInternalObligation", "sourceTransactionId", "isInternalTransfer", "isDeposit", isActive, currencyId, persons(name), projects(name), account_payment_forms(name)').eq("id",t).single();if(n)throw n;return e}async function QT(t){const{data:e,error:n}=await G.from("transactionDetails").select("id, conceptId, quantity, price, net, taxPercentage, tax, discountPercentage, discount, total, additionalCharges, transactionPaidId, concepts(name)").eq("transactionId",t).order("id");if(n)throw n;return e??[]}async function ZT(t){const{data:e,error:n}=await G.from("transactionDetails").select('id, total, transactionId, transactionPaidId, transactions!transaction_details_transactionId_fkey(id, date, type, name, "referenceNumber", paymentMethodId, accountPaymentFormId)').eq("transactionPaidId",t).order("id",{ascending:!1});if(n)throw n;return(e??[]).map(s=>({...s,transactions:s.transactions??null}))}async function eN({paidTransaction:t,paymentTransaction:e,paymentDetail:n}){const{data:s,error:r}=await G.from("transactions").select("id, total, balance, payments").eq("id",t.id).single();if(r)throw r;const a=Number(e.total||0);if(a<=0||a>Number(s.balance||0))throw new Error("Payment amount exceeds current balance.");const{data:l,error:c}=await G.from("transactions").insert(e).select("id").single();if(c)throw c;const{error:d}=await G.from("transactionDetails").insert({...n,transactionId:l.id,transactionPaidId:t.id});if(d)throw await G.from("transactions").delete().eq("id",l.id),d;const f=Number(s.payments||0),m=Number(e.total||0),g=f+m,y=Math.max(Number(s.total||0)-g,0),{error:x}=await G.from("transactions").update({payments:g,balance:y}).eq("id",t.id);if(x)throw x;return l}async function tN({accountId:t,accountPaymentFormId:e}){const{data:n,error:s}=await G.from("transactions").select('id, date, type, total, isIncomingPayment, isOutcomingPayment, "accountPaymentFormId", "isReconciled", "reconciledAt", "referenceNumber", "isInternalObligation", "sourceTransactionId", "isInternalTransfer", "isDeposit", isActive, name').eq("accountId",t).eq("accountPaymentFormId",e).eq("isActive",!0).order("date",{ascending:!1});if(s)throw s;return n??[]}async function nN(t,e){const{error:n}=await G.from("transactions").update({isReconciled:!0,reconciledAt:e}).eq("id",t);if(n)throw n}async function sN(t){const{error:e}=await G.from("transactions").update({isReconciled:!1,reconciledAt:null}).eq("id",t);if(e)throw e}async function rN(t){const{data:e,error:n}=await G.from("transactions").select('id, date, name, total, payments, balance, currencyId, "referenceNumber", "accountPaymentFormId", "sourceTransactionId", isActive, account_payment_forms(name)').eq("accountId",t).eq("isInternalObligation",!0).eq("isActive",!0).order("id",{ascending:!1});if(n)throw n;return e??[]}async function iN({accountId:t,userId:e,date:n,name:s,referenceNumber:r,currencyId:a,accountPaymentFormId:l,total:c}){const d=Math.abs(Number(c||0)),f={accountId:t,personId:null,date:n,type:At.purchase,name:s?.trim()||"Obligacin interna",referenceNumber:r?.trim()||null,deliverTo:null,deliveryAddress:null,status:1,createdById:e,net:d,discounts:0,taxes:0,additionalCharges:0,total:d,isAccountPayable:!0,isAccountReceivable:!1,isIncomingPayment:!1,isOutcomingPayment:!1,balance:d,payments:0,isActive:!0,currencyId:Number(a),paymentMethodId:null,accountPaymentFormId:l?Number(l):null,isInternalObligation:!0,sourceTransactionId:null,isInternalTransfer:!1,isDeposit:!1},{data:m,error:g}=await G.from("transactions").insert(f).select("id").single();if(g)throw g;return m}async function aN(t,{date:e,name:n,referenceNumber:s,currencyId:r,accountPaymentFormId:a,total:l}){const{data:c,error:d}=await G.from("transactions").select("id, payments").eq("id",t).single();if(d)throw d;const f=Math.abs(Number(c.payments||0)),m=Math.abs(Number(l||0));if(m<f)throw new Error("Total cannot be lower than already registered payments.");const g={date:e,name:n?.trim()||"Obligacin interna",referenceNumber:s?.trim()||null,currencyId:Number(r),accountPaymentFormId:a?Number(a):null,net:m,total:m,payments:f,balance:Math.max(m-f,0)},{data:y,error:x}=await G.from("transactions").update(g).eq("id",t).select("id").single();if(x)throw x;return y}async function oN(t,{dateFrom:e,dateTo:n,currencyId:s}={}){let r=G.from("transactions").select("id, date, name, total, balance, currencyId").eq("accountId",t).eq("isInternalObligation",!0).eq("isActive",!0);e&&(r=r.gte("date",e)),n&&(r=r.lte("date",n)),s&&(r=r.eq("currencyId",s));const{data:a,error:l}=await r.order("date",{ascending:!1});if(l)throw l;return a??[]}async function lN({accountId:t,userId:e,date:n,amount:s,currencyId:r,referenceNumber:a,description:l,cashPaymentMethodId:c,transferPaymentMethodId:d,fromCashFormId:f,toBankFormId:m,outgoingConceptId:g,incomingConceptId:y}){const x=Math.abs(Number(s||0));if(!x)throw new Error("Invalid amount");const _=l?.trim()||"Depsito bancario",S={accountId:t,personId:null,date:n,deliverTo:null,deliveryAddress:null,status:1,createdById:e,net:x,discounts:0,taxes:0,additionalCharges:0,total:x,isAccountPayable:!1,isAccountReceivable:!1,balance:0,payments:x,isActive:!0,currencyId:Number(r),referenceNumber:a?.trim()||null,isInternalObligation:!1,sourceTransactionId:null,isInternalTransfer:!0,isDeposit:!0},b={...S,type:At.outgoingPayment,name:`${_} (salida)`,isIncomingPayment:!1,isOutcomingPayment:!0,paymentMethodId:Number(c),accountPaymentFormId:Number(f)},{data:k,error:I}=await G.from("transactions").insert(b).select("id").single();if(I)throw I;const C={...S,type:At.incomingPayment,name:`${_} (entrada)`,isIncomingPayment:!0,isOutcomingPayment:!1,paymentMethodId:Number(d),accountPaymentFormId:Number(m),sourceTransactionId:k.id},{data:N,error:O}=await G.from("transactions").insert(C).select("id").single();if(O)throw await G.from("transactions").delete().eq("id",k.id),O;const U=[{transactionId:k.id,conceptId:Number(g),quantity:1,price:x,net:x,taxPercentage:0,tax:0,discountPercentage:0,discount:0,total:x,additionalCharges:0,createdById:e,sellerId:null,transactionPaidId:null},{transactionId:N.id,conceptId:Number(y),quantity:1,price:x,net:x,taxPercentage:0,tax:0,discountPercentage:0,discount:0,total:x,additionalCharges:0,createdById:e,sellerId:null,transactionPaidId:null}],{error:E}=await G.from("transactionDetails").insert(U);if(E)throw await G.from("transactions").delete().in("id",[k.id,N.id]),E}async function cN({accountId:t,userId:e,date:n,amount:s,currencyId:r,referenceNumber:a,description:l,transferPaymentMethodId:c,fromBankFormId:d,toBankFormId:f,fromBankLabel:m,toBankLabel:g,outgoingConceptId:y,incomingConceptId:x}){const _=Math.abs(Number(s||0));if(!_)throw new Error("Invalid amount");if(Number(d)===Number(f))throw new Error("Source and destination must be different.");const S=l?.trim()||"Traslado entre cuentas",b={accountId:t,personId:null,date:n,referenceNumber:a?.trim()||null,status:1,createdById:e,net:0,discounts:0,taxes:0,additionalCharges:0,total:0,isAccountPayable:!1,isAccountReceivable:!1,isIncomingPayment:!1,isOutcomingPayment:!1,balance:0,payments:0,isActive:!0,currencyId:Number(r),paymentMethodId:Number(c),isInternalObligation:!1,isInternalTransfer:!0,isDeposit:!1,isReconciled:!0,reconciledAt:n},k={...b,type:At.outgoingPayment,name:`${S} (salida)`,deliverTo:m||null,deliveryAddress:g||null,net:-_,total:-_,isOutcomingPayment:!0,payments:-_,accountPaymentFormId:Number(d),sourceTransactionId:null},{data:I,error:C}=await G.from("transactions").insert(k).select("id").single();if(C)throw C;const N={...b,type:At.incomingPayment,name:`${S} (entrada)`,deliverTo:m||null,deliveryAddress:g||null,net:_,total:_,isIncomingPayment:!0,payments:_,accountPaymentFormId:Number(f),sourceTransactionId:I.id},{data:O,error:U}=await G.from("transactions").insert(N).select("id").single();if(U)throw await G.from("transactions").delete().eq("id",I.id),U;const E={transactionId:I.id,conceptId:Number(y),quantity:1,price:-_,net:-_,taxPercentage:0,tax:0,discountPercentage:0,discount:0,total:-_,additionalCharges:0,createdById:e,sellerId:null,transactionPaidId:null},L={transactionId:O.id,conceptId:Number(x),quantity:1,price:_,net:_,taxPercentage:0,tax:0,discountPercentage:0,discount:0,total:_,additionalCharges:0,createdById:e,sellerId:null,transactionPaidId:null},{error:R}=await G.from("transactionDetails").insert(E);if(R)throw await G.from("transactions").delete().in("id",[I.id,O.id]),R;const{error:T}=await G.from("transactionDetails").insert(L);if(T)throw await G.from("transactions").delete().in("id",[I.id,O.id]),T}async function uN(t){const{data:e,error:n}=await G.from("transactions").select('id, date, name, total, "referenceNumber", "sourceTransactionId", "accountPaymentFormId", isActive, account_payment_forms(name)').eq("accountId",t).eq("isDeposit",!0).eq("isIncomingPayment",!0).eq("isActive",!0).order("id",{ascending:!1});if(n)throw n;return e??[]}async function dN(t){const{data:e,error:n}=await G.from("transactions").select('id, "sourceTransactionId"').eq("id",t).single();if(n)throw n;const s=[e.id];e.sourceTransactionId&&s.push(e.sourceTransactionId);const{error:r}=await G.from("transactions").update({isActive:!1}).in("id",s);if(r)throw r}async function hN(t){const{data:e,error:n}=await G.from("transactions").select('id, date, name, total, "referenceNumber", "sourceTransactionId", deliverTo, "deliveryAddress", isActive, account_payment_forms(name)').eq("accountId",t).eq("isInternalTransfer",!0).eq("isDeposit",!1).eq("isIncomingPayment",!0).eq("isActive",!0).order("id",{ascending:!1});if(n)throw n;return e??[]}async function fN(t){const{data:e,error:n}=await G.from("transactions").select('id, "sourceTransactionId"').eq("id",t).single();if(n)throw n;const s=[e.id];e.sourceTransactionId&&s.push(e.sourceTransactionId);const{error:r}=await G.from("transactions").update({isActive:!1}).in("id",s);if(r)throw r}function pn(t){const e=String(t?.name||"").trim(),n=String(t?.provider||"").trim();return n?`${e} - ${n}`:e}const pN={date:new Date().toISOString().slice(0,10),amount:0,description:"",referenceNumber:"",paymentMethodId:"",accountPaymentFormId:""};function ib({isOpen:t,onClose:e,transaction:n,direction:s,onSaved:r}){const{t:a}=Ee(),{account:l,user:c}=Oe(),[d,f]=j.useState(pN),[m,g]=j.useState([]),[y,x]=j.useState([]),[_,S]=j.useState([]),[b,k]=j.useState(""),[I,C]=j.useState(!1),N=j.useMemo(()=>m.find(T=>T.id===Number(d.paymentMethodId))??null,[m,d.paymentMethodId]),O=N?.code==="card"||N?.code==="bank_transfer",U=j.useMemo(()=>N?N.code==="card"?y.filter(T=>T.kind==="credit_card"):N.code==="bank_transfer"?y.filter(T=>T.kind==="bank_account"):N.code==="cash"?y.filter(T=>T.kind==="cashbox"):y:y,[y,N]);j.useEffect(()=>{!t||!l?.accountId||(E(),f(T=>({...T,amount:Number(n?.balance||0)})))},[t,l?.accountId,n?.id]);const E=async()=>{try{const[T,D,Y]=await Promise.all([oo(l.accountId),fr(l.accountId),Bi(l.accountId)]);g(T),x(D),S(Y),k("")}catch{k(a("common.genericLoadError"))}};if(!t||!n)return null;const L=T=>{const{name:D,value:Y}=T.target;if(D==="paymentMethodId"){f(se=>({...se,paymentMethodId:Y,accountPaymentFormId:""}));return}f(se=>({...se,[D]:Y}))},R=async T=>{if(T.preventDefault(),k(""),!T.currentTarget.checkValidity()){T.currentTarget.reportValidity(),k(a("common.requiredFields"));return}if(!l?.accountId||!c?.id)return;if(!d.paymentMethodId){k(a("transactions.paymentMethodRequired"));return}if(O&&!d.accountPaymentFormId){k(a("transactions.accountPaymentFormRequired"));return}const D=Number(d.amount||0);if(D<=0||D>Number(n.balance||0)){k(a("transactions.invalidPaymentAmount"));return}const Y=_.find(J=>s==="incoming"?J.isIncomingPaymentConcept:J.isOutgoingPaymentConcept);if(!Y){k(a("transactions.missingSystemPaymentConcept"));return}const se={accountId:l.accountId,personId:n.personId,date:d.date,type:s==="incoming"?At.incomingPayment:At.outgoingPayment,name:d.description?.trim()||null,referenceNumber:d.referenceNumber?.trim()||null,deliverTo:null,deliveryAddress:null,status:1,createdById:c.id,net:D,discounts:0,taxes:0,additionalCharges:0,total:D,isAccountPayable:!1,isAccountReceivable:!1,isIncomingPayment:s==="incoming",isOutcomingPayment:s==="outgoing",balance:0,payments:D,isActive:!0,currencyId:n.currencyId??null,paymentMethodId:Number(d.paymentMethodId),accountPaymentFormId:d.accountPaymentFormId?Number(d.accountPaymentFormId):null},H={conceptId:Y.id,quantity:1,price:D,net:D,taxPercentage:0,tax:0,discountPercentage:0,discount:0,total:D,additionalCharges:0,createdById:c.id,sellerId:null};try{C(!0),await eN({paidTransaction:n,paymentTransaction:se,paymentDetail:H}),r?.(),e?.()}catch(J){k(J?.message||a("common.genericSaveError"))}finally{C(!1)}};return u.jsx("div",{className:"modal-backdrop",onClick:e,children:u.jsxs("div",{className:"modal-card",onClick:T=>T.stopPropagation(),children:[u.jsx("h3",{children:a(s==="incoming"?"transactions.newIncomingPayment":"transactions.newOutgoingPayment")}),b&&u.jsx("p",{className:"error-text",children:b}),u.jsxs("form",{className:"crud-form",onSubmit:R,children:[u.jsxs("div",{className:"form-grid-2",children:[u.jsxs("label",{className:"field-block",children:[u.jsx("span",{children:a("transactions.date")}),u.jsx("input",{type:"date",name:"date",value:d.date,onChange:L,required:!0})]}),u.jsxs("label",{className:"field-block",children:[u.jsx("span",{children:a("transactions.amount")}),u.jsx("input",{type:"number",min:"0",step:"0.01",name:"amount",value:d.amount,onChange:L,required:!0})]}),u.jsxs("label",{className:"field-block",children:[u.jsx("span",{children:a("transactions.paymentMethod")}),u.jsxs("select",{name:"paymentMethodId",value:d.paymentMethodId,onChange:L,required:!0,children:[u.jsx("option",{value:"",children:`-- ${a("transactions.selectPaymentMethod")} --`}),m.map(T=>u.jsx("option",{value:T.id,children:T.name},T.id))]})]}),u.jsxs("label",{className:"field-block",children:[u.jsx("span",{children:a("transactions.accountPaymentForm")}),u.jsxs("select",{name:"accountPaymentFormId",value:d.accountPaymentFormId,onChange:L,required:O,children:[u.jsx("option",{value:"",children:`-- ${a("transactions.selectAccountPaymentForm")} --`}),U.map(T=>u.jsx("option",{value:T.id,children:pn(T)},T.id))]})]}),u.jsxs("label",{className:"field-block",children:[u.jsx("span",{children:a("transactions.referenceNumber")}),u.jsx("input",{name:"referenceNumber",value:d.referenceNumber,onChange:L})]}),u.jsxs("label",{className:"field-block form-span-2",children:[u.jsx("span",{children:a("transactions.description")}),u.jsx("input",{name:"description",value:d.description,onChange:L})]})]}),u.jsxs("div",{className:"crud-form-actions",children:[u.jsx("button",{type:"button",className:"button-secondary",onClick:e,children:a("common.cancel")}),u.jsx("button",{type:"submit",disabled:I,children:a("common.create")})]})]})]})})}const mN={name:"",kind:"bank_account",provider:"",reference:"",employeeId:"",createInternalPayableOnOutgoingPayment:!1};function gc({embedded:t=!1,onCancel:e,onCreated:n}){const{t:s}=Ee(),{account:r,user:a}=Oe(),l=Ht(),{id:c}=Vn(),d=!t&&!!c,[f,m]=j.useState(mN),[g,y]=j.useState(""),[x,_]=j.useState(d),[S,b]=j.useState(!1),[k,I]=j.useState([]);j.useEffect(()=>{r?.accountId&&C()},[r?.accountId]),j.useEffect(()=>{!d||!r?.accountId||N()},[d,c,r?.accountId]);const C=async()=>{try{const E=await pc(r.accountId);I(E)}catch{I([])}},N=async()=>{try{_(!0);const E=await VT(c);m({name:E.name||"",kind:E.kind||"bank_account",provider:E.provider||"",reference:E.reference||"",employeeId:E.employeeId?String(E.employeeId):"",createInternalPayableOnOutgoingPayment:!!E.createInternalPayableOnOutgoingPayment})}catch{y(s("common.genericLoadError"))}finally{_(!1)}},O=E=>{const{name:L,value:R}=E.target;if(L==="createInternalPayableOnOutgoingPayment"){m(T=>({...T,createInternalPayableOnOutgoingPayment:E.target.checked}));return}m(T=>({...T,[L]:R}))},U=async E=>{if(E.preventDefault(),y(""),!E.currentTarget.checkValidity()){E.currentTarget.reportValidity(),y(s("common.requiredFields"));return}if(!r?.accountId||!a?.id){y(s("common.requiredFields"));return}const L={accountId:r.accountId,name:f.name.trim(),kind:f.kind,provider:f.provider.trim()||null,reference:f.reference.trim()||null,createInternalPayableOnOutgoingPayment:!!f.createInternalPayableOnOutgoingPayment};f.employeeId&&(L.employeeId=Number(f.employeeId));try{b(!0);let R=null;if(d?R=await HT(c,L):R=await qT({...L,createdById:a.id}),t){n?.(R);return}l("/payment-forms")}catch{y(s("common.genericSaveError"))}finally{b(!1)}};return u.jsxs("div",{className:t?"":"module-page",children:[t?u.jsx("h3",{children:s(d?"common.edit":"actions.newPaymentForm")}):u.jsxs("div",{className:"page-header-row",children:[u.jsx("h1",{children:s(d?"common.edit":"actions.newPaymentForm")}),u.jsx(st,{to:"/payment-forms",className:"button-link-secondary",children:s("common.backToList")})]}),g&&u.jsx("p",{className:"error-text",children:g}),x?u.jsx("p",{children:s("common.loading")}):u.jsxs("form",{className:"crud-form",onSubmit:U,children:[u.jsxs("div",{className:"form-grid-2",children:[u.jsx(nt,{label:s("common.name"),name:"name",value:f.name,onChange:O,required:!0}),u.jsxs(mn,{label:s("paymentForms.kind"),name:"kind",value:f.kind,onChange:O,required:!0,children:[u.jsx("option",{value:"bank_account",children:s("paymentForms.kinds.bank_account")}),u.jsx("option",{value:"credit_card",children:s("paymentForms.kinds.credit_card")}),u.jsx("option",{value:"cashbox",children:s("paymentForms.kinds.cashbox")})]}),u.jsx(nt,{label:s("paymentForms.provider"),name:"provider",value:f.provider,onChange:O}),u.jsx(nt,{label:s("paymentForms.reference"),name:"reference",value:f.reference,onChange:O}),u.jsxs(mn,{label:s("paymentForms.employee"),name:"employeeId",value:f.employeeId,onChange:O,children:[u.jsx("option",{value:"",children:`-- ${s("transactions.optionalSeller")} --`}),k.map(E=>u.jsx("option",{value:E.id,children:E.name},E.id))]}),u.jsxs("label",{className:"checkbox-field form-span-2",children:[u.jsx("input",{type:"checkbox",name:"createInternalPayableOnOutgoingPayment",checked:f.createInternalPayableOnOutgoingPayment,onChange:O}),u.jsx("span",{children:s("paymentForms.createInternalPayableOnOutgoingPayment")})]})]}),u.jsxs("div",{className:"crud-form-actions",children:[t?u.jsx("button",{type:"button",className:"button-secondary",onClick:()=>e?.(),children:s("common.cancel")}):null,u.jsx("button",{type:"submit",disabled:S,children:s(d?"common.update":"common.create")})]})]})]})}function lo({label:t,required:e=!1,error:n=!1,className:s="",...r}){return u.jsx(mo,{label:t,required:e,error:n,className:s,children:u.jsx("input",{type:"date",...r,required:e})})}const Rc='id, name, description, "startDate", "endDate", "isActive"';async function co(t,{activeOnly:e=!0}={}){let n=G.from("projects").select(Rc).eq("accountId",t);e&&(n=n.eq("isActive",!0));const{data:s,error:r}=await n.order("id",{ascending:!1});if(r)throw r;return s??[]}async function ab(t){const{data:e,error:n}=await G.from("projects").select(Rc).eq("id",t).single();if(n)throw n;return e}async function gN(t){const{data:e,error:n}=await G.from("projects").insert(t).select(Rc).single();if(n)throw n;return e}async function yN(t,e){const{data:n,error:s}=await G.from("projects").update(e).eq("id",t).select(Rc).single();if(s)throw s;return n}async function vN(t){const{error:e}=await G.from("projects").update({isActive:!1}).eq("id",t);if(e)throw e}const xN={name:"",description:"",startDate:"",endDate:""};function uo({embedded:t=!1,onCancel:e,onCreated:n}){const{t:s}=Ee(),{account:r,user:a}=Oe(),l=Ht(),{id:c}=Vn(),d=!t&&!!c,[f,m]=j.useState(xN),[g,y]=j.useState(!1),[x,_]=j.useState(d),[S,b]=j.useState("");j.useEffect(()=>{d&&k()},[d,c]);const k=async()=>{try{_(!0);const N=await ab(c);m({name:N.name||"",description:N.description||"",startDate:N.startDate||"",endDate:N.endDate||""})}catch{b(s("common.genericLoadError"))}finally{_(!1)}},I=N=>{const{name:O,value:U}=N.target;m(E=>({...E,[O]:U}))},C=async N=>{if(N.preventDefault(),b(""),!N.currentTarget.checkValidity()){N.currentTarget.reportValidity(),b(s("common.requiredFields"));return}if(!r?.accountId||!a?.id){b(s("common.requiredFields"));return}const O={accountId:r.accountId,name:f.name.trim(),description:f.description.trim()||null,startDate:f.startDate||null,endDate:f.endDate||null,isActive:!0};try{y(!0);let U=null;if(d?U=await yN(c,O):U=await gN({...O,createdById:a.id}),t){n?.(U);return}l("/projects")}catch{b(s("common.genericSaveError"))}finally{y(!1)}};return u.jsxs("div",{className:t?"":"module-page",children:[t?u.jsx("h3",{children:s(d?"common.edit":"actions.newProject")}):u.jsxs("div",{className:"page-header-row",children:[u.jsx("h1",{children:s(d?"common.edit":"actions.newProject")}),u.jsx(st,{to:"/projects",className:"button-link-secondary",children:s("common.backToList")})]}),S&&u.jsx("p",{className:"error-text",children:S}),x?u.jsx("p",{children:s("common.loading")}):u.jsxs("form",{className:"crud-form",onSubmit:C,children:[u.jsxs("div",{className:"form-grid-2",children:[u.jsx(nt,{label:s("common.name"),name:"name",value:f.name,onChange:I,required:!0}),u.jsx(nt,{label:s("transactions.description"),name:"description",value:f.description,onChange:I}),u.jsx(lo,{label:s("projects.startDate"),name:"startDate",value:f.startDate,onChange:I}),u.jsx(lo,{label:s("projects.endDate"),name:"endDate",value:f.endDate,onChange:I})]}),u.jsxs("div",{className:"crud-form-actions",children:[t?u.jsx("button",{type:"button",className:"button-secondary",onClick:()=>e?.(),children:s("common.cancel")}):null,u.jsx("button",{type:"submit",disabled:g,children:s(d?"common.update":"common.create")})]})]})]})}async function vo(t){const{data:e,error:n}=await G.from("currencies").select("id, name, symbol, isLocal").or(`accountId.eq.${t},accountId.is.null`).order("isLocal",{ascending:!1}).order("name",{ascending:!0});if(n)throw n;return e??[]}const bN={sale:{type:At.sale,titleKey:"transactions.salesCreateTitle",personFilter:1,conceptFilter:t=>!!t.isProduct,backPath:"/sales"},purchase:{type:At.purchase,titleKey:"transactions.purchasesCreateTitle",personFilter:2,conceptFilter:t=>!!t.isExpense&&!t.isOutgoingPaymentConcept,backPath:"/purchases"},expense:{type:At.expense,titleKey:"transactions.expensesCreateTitle",personFilter:2,conceptFilter:t=>!!t.isExpense&&!t.isOutgoingPaymentConcept,backPath:"/expenses"},income:{type:At.income,titleKey:"transactions.incomesCreateTitle",personFilter:null,conceptFilter:t=>!!t.isIncome&&!t.isProduct&&!t.isIncomingPaymentConcept,backPath:"/incomes"}},wN={date:new Date().toISOString().slice(0,10),personId:"",conceptId:"",description:"",amount:0,additionalCharges:0,currencyId:"",referenceNumber:"",paymentMode:"cash",paymentMethodId:"",accountPaymentFormId:"",projectId:"",employeeId:""},_N={date:new Date().toISOString().slice(0,10),paymentMode:"cash",description:"",currencyId:"",referenceNumber:"",paymentMethodId:"",accountPaymentFormId:"",projectId:""};function Lh(t){const e=Number(t.quantity)||0,n=Number(t.price)||0,s=Number(t.taxPercentage)||0,r=Number(t.discountPercentage)||0,a=Number(t.additionalCharges)||0,l=e*n,c=l*(s/100),d=l*(r/100),f=l+c-d+a;return{net:l,tax:c,discount:d,total:f,quantity:e,price:n,taxPercentage:s,discountPercentage:r,additionalCharges:a}}function SN(t){return t.reduce((e,n)=>{const s=Lh(n);return e.net+=s.net,e.tax+=s.tax,e.discount+=s.discount,e.additionalCharges+=s.additionalCharges,e.total+=s.total,e},{net:0,tax:0,discount:0,additionalCharges:0,total:0})}function kN({t,accountId:e,onCancel:n,onCreated:s}){const[r,a]=j.useState(""),[l,c]=j.useState(!1),[d,f]=j.useState(""),m=async g=>{if(g.preventDefault(),f(""),!e||!r.trim()){f(t("common.requiredFields"));return}const x=`custom_${r.trim().toLowerCase().replace(/[^a-z0-9]+/g,"_").replace(/^_+|_+$/g,"")||"method"}_${Date.now()}`;try{c(!0);const _=await GT({accountId:e,code:x,name:r.trim(),is_active:!0,isSystem:!1});s?.(_)}catch{f(t("common.genericSaveError"))}finally{c(!1)}};return u.jsxs("form",{className:"crud-form",onSubmit:m,children:[u.jsx("h3",{children:t("transactions.paymentMethod")}),d?u.jsx("p",{className:"error-text",children:d}):null,u.jsxs("label",{className:"field-block",children:[u.jsx("span",{children:t("common.name")}),u.jsx("input",{value:r,onChange:g=>a(g.target.value),required:!0})]}),u.jsxs("div",{className:"crud-form-actions",children:[u.jsx("button",{type:"button",className:"button-secondary",onClick:n,children:t("common.cancel")}),u.jsx("button",{type:"submit",disabled:l,children:t("common.create")})]})]})}function Da({moduleType:t,embedded:e=!1,onCancel:n,onCreated:s}){const{t:r}=Ee(),{account:a,user:l}=Oe(),c=Ht(),d=bN[t],[f,m]=j.useState([]),[g,y]=j.useState([]),[x,_]=j.useState([]),[S,b]=j.useState([]),[k,I]=j.useState([]),[C,N]=j.useState([]),[O,U]=j.useState([]),[E,L]=j.useState(wN),[R,T]=j.useState(_N),[D,Y]=j.useState(""),[se,H]=j.useState(""),[J,ee]=j.useState(""),[he,Z]=j.useState(""),[oe,ie]=j.useState(null),[W,B]=j.useState(""),[le,ae]=j.useState(""),[ge,_e]=j.useState(""),[De,Te]=j.useState(""),[Fe,mt]=j.useState(""),[Kt,gn]=j.useState([]),[os,We]=j.useState(""),[ls,cs]=j.useState(!0),[Hn,Tn]=j.useState(!1),[Ut,rn]=j.useState(!1),[yn,us]=j.useState(!1),vn=j.useMemo(()=>g.filter(d.conceptFilter),[g,d.conceptFilter]),Gt=j.useMemo(()=>d.personFilter?f.filter(M=>M.type===d.personFilter):f,[f,d.personFilter]),St=j.useMemo(()=>k.find(M=>M.id===Number(E.paymentMethodId))??null,[k,E.paymentMethodId]),Ot=j.useMemo(()=>k.find(M=>M.id===Number(R.paymentMethodId))??null,[k,R.paymentMethodId]),xn=j.useMemo(()=>S.find(M=>M.isLocal)?.id??"",[S]),bn=j.useMemo(()=>St?St.code==="card"?C.filter(M=>M.kind==="credit_card"):St.code==="bank_transfer"?C.filter(M=>M.kind==="bank_account"):St.code==="cash"?C.filter(M=>M.kind==="cashbox"):C:C,[C,St]),gr=j.useMemo(()=>Ot?Ot.code==="card"?C.filter(M=>M.kind==="credit_card"):Ot.code==="bank_transfer"?C.filter(M=>M.kind==="bank_account"):Ot.code==="cash"?C.filter(M=>M.kind==="cashbox"):C:C,[C,Ot]),an=j.useMemo(()=>{const M=t==="income"||t==="expense",ne=t==="purchase"&&E.paymentMode==="cash";return!M&&!ne?!1:St?.code==="card"||St?.code==="bank_transfer"},[t,E.paymentMode,St]),Kn=j.useMemo(()=>R.paymentMode!=="cash"?!1:Ot?.code==="card"||Ot?.code==="bank_transfer",[R.paymentMode,Ot]),Os=j.useMemo(()=>SN(Kt),[Kt]);j.useEffect(()=>{a?.accountId&&Jr()},[a?.accountId,d.type]),j.useEffect(()=>{xn&&(L(M=>({...M,currencyId:M.currencyId||String(xn)})),T(M=>({...M,currencyId:M.currencyId||String(xn)})))},[xn]);const Jr=async()=>{try{cs(!0);const[M,ne,ce,je,Me,ot,Wt]=await Promise.allSettled([vv(a.accountId),Bi(a.accountId),pc(a.accountId),vo(a.accountId),oo(a.accountId),fr(a.accountId),co(a.accountId)]);m(M.status==="fulfilled"?M.value:[]),y(ne.status==="fulfilled"?ne.value:[]),_(ce.status==="fulfilled"?ce.value:[]),b(je.status==="fulfilled"?je.value:[]),I(Me.status==="fulfilled"?Me.value:[]),N(ot.status==="fulfilled"?ot.value:[]),U(Wt.status==="fulfilled"?Wt.value:[]),We("")}catch{We(r("common.genericLoadError"))}finally{cs(!1)}},gt=async M=>{try{const ne=await vv(a.accountId);m(ne),t==="sale"?(ie(M),B("")):L(ce=>({...ce,personId:String(M.id)}))}catch{We(r("common.genericLoadError"))}},Rs=async M=>{try{const ne=await Bi(a.accountId);y(ne),L(ce=>({...ce,conceptId:String(M.id),additionalCharges:M.additionalCharges??ce.additionalCharges})),t==="sale"&&Be(M)}catch{We(r("common.genericLoadError"))}},Ms=async M=>{try{const ne=await co(a.accountId);U(ne),t==="sale"?(T(ce=>({...ce,projectId:String(M.id)})),Te("")):(L(ce=>({...ce,projectId:String(M.id)})),ae(""))}catch{We(r("common.genericLoadError"))}},Gn=async M=>{try{const ne=await pc(a.accountId);_(ne),L(ce=>({...ce,employeeId:String(M.id)})),_e("")}catch{We(r("common.genericLoadError"))}},z=M=>{const{name:ne,value:ce}=M.target;if(ne==="paymentMode"&&ce==="credit"){L(je=>({...je,paymentMode:ce,paymentMethodId:"",accountPaymentFormId:""}));return}if(ne==="conceptId"){const je=vn.find(Me=>Me.id===Number(ce));L(Me=>({...Me,conceptId:ce,additionalCharges:je?.additionalCharges??Me.additionalCharges}));return}if(ne==="paymentMethodId"){L(je=>({...je,paymentMethodId:ce,accountPaymentFormId:""}));return}L(je=>({...je,[ne]:ce}))},xe=M=>{const{name:ne,value:ce}=M.target;if(ne==="paymentMode"&&ce==="credit"){T(je=>({...je,paymentMode:ce,paymentMethodId:"",accountPaymentFormId:""}));return}if(ne==="paymentMethodId"){T(je=>({...je,paymentMethodId:ce,accountPaymentFormId:""}));return}T(je=>({...je,[ne]:ce}))},Be=M=>{gn(ne=>[...ne,{rowId:`${M.id}-${Date.now()}-${Math.random()}`,conceptId:M.id,conceptName:M.name,quantity:1,price:Number(M.price)||0,taxPercentage:Number(M.taxPercentage)||0,discountPercentage:0,additionalCharges:Number(M.additionalCharges)||0,sellerId:""}]),mt("")},Ve=(M,ne,ce)=>{gn(je=>je.map(Me=>Me.rowId===M?{...Me,[ne]:ce}:Me))},wn=M=>{gn(ne=>ne.filter(ce=>ce.rowId!==M))},yr=({isCredit:M,personId:ne,description:ce,date:je,totals:Me,currencyId:ot,referenceNumber:Wt,paymentMethodId:Ls,accountPaymentFormId:Nn,projectId:ds,employeeId:Yn,incomingPayment:vr=!1})=>({accountId:a.accountId,personId:ne||null,date:je,type:d.type,name:ce?.trim()||null,referenceNumber:Wt?.trim()||null,deliverTo:null,deliveryAddress:null,status:1,createdById:l.id,net:Me.net,discounts:Me.discount,taxes:Me.tax,additionalCharges:Me.additionalCharges,total:Me.total,isAccountPayable:t==="purchase"?M:!1,isAccountReceivable:t==="sale"?M:!1,isIncomingPayment:vr,isOutcomingPayment:!1,balance:M?Me.total:0,payments:M?0:Me.total,isActive:!0,currencyId:ot?Number(ot):null,projectId:ds?Number(ds):null,employeeId:Yn?Number(Yn):null,paymentMethodId:Ls?Number(Ls):null,accountPaymentFormId:Nn?Number(Nn):null}),Xr=async M=>{if(M.preventDefault(),rn(!0),We(""),!M.currentTarget.checkValidity()){M.currentTarget.reportValidity(),We(r("common.requiredFields"));return}if(!a?.accountId||!l?.id||!E.conceptId||!E.currencyId){We(r("common.requiredFields"));return}if(t==="purchase"&&!E.personId){We(r("transactions.providerRequired"));return}const ne=t==="purchase"&&E.paymentMode==="cash";if((t==="income"||t==="expense"||ne)&&!E.paymentMethodId){We(r("transactions.paymentMethodRequired"));return}if(an&&!E.accountPaymentFormId){We(r("transactions.accountPaymentFormRequired"));return}const je=Number(E.amount)||0,Me=Number(E.additionalCharges)||0,ot=t==="expense";if(Math.abs(je)<=0){We(r("transactions.invalidTransactionAmount"));return}const Wt=ot?-Math.abs(je):je,Ls=ot?-Math.abs(Me):Me,Nn=Wt+Ls,ds=t==="purchase"?E.paymentMode==="credit":!1,Yn=t!=="purchase"||E.paymentMode==="cash",vr=yr({isCredit:ds,personId:E.personId?Number(E.personId):null,description:E.description,date:E.date,totals:{net:Wt,tax:0,discount:0,additionalCharges:Ls,total:Nn},currencyId:E.currencyId,referenceNumber:E.referenceNumber,paymentMethodId:Yn?E.paymentMethodId:null,accountPaymentFormId:Yn?E.accountPaymentFormId:null,projectId:E.projectId,employeeId:t==="income"||t==="expense"?E.employeeId:null,incomingPayment:t==="income"}),Mc={conceptId:Number(E.conceptId),quantity:1,price:Wt,net:Wt,taxPercentage:0,tax:0,discountPercentage:0,discount:0,total:Nn,additionalCharges:Ls,createdById:l.id,sellerId:null,transactionPaidId:null};try{Tn(!0);const Lc=await bv({transaction:vr,details:[Mc]});e?s?.(Lc):c(d.backPath)}catch{We(r("common.genericSaveError"))}finally{Tn(!1)}},xo=async M=>{if(M.preventDefault(),us(!0),We(""),!M.currentTarget.checkValidity()){M.currentTarget.reportValidity(),We(r("common.requiredFields"));return}if(!a?.accountId||!l?.id||!oe||Kt.length===0||!R.currencyId){We(r("transactions.saleValidationError"));return}const ne=R.paymentMode==="credit";if(!ne&&!R.paymentMethodId){We(r("transactions.paymentMethodRequired"));return}if(Kn&&!R.accountPaymentFormId){We(r("transactions.accountPaymentFormRequired"));return}const ce=yr({isCredit:ne,personId:oe.id,description:R.description,date:R.date,totals:Os,currencyId:R.currencyId,referenceNumber:R.referenceNumber,paymentMethodId:ne?null:R.paymentMethodId,accountPaymentFormId:ne?null:R.accountPaymentFormId,projectId:R.projectId,incomingPayment:!1}),je=Kt.map(Me=>{const ot=Lh(Me);return{conceptId:Number(Me.conceptId),quantity:ot.quantity,price:ot.price,net:ot.net,taxPercentage:ot.taxPercentage,tax:ot.tax,discountPercentage:ot.discountPercentage,discount:ot.discount,total:ot.total,additionalCharges:ot.additionalCharges,createdById:l.id,sellerId:Me.sellerId?Number(Me.sellerId):null,transactionPaidId:null}});try{Tn(!0);const Me=await bv({transaction:ce,details:je});e?s?.(Me):c(d.backPath)}catch{We(r("common.genericSaveError"))}finally{Tn(!1)}};return ls?u.jsx("p",{children:r("common.loading")}):u.jsxs("div",{className:e?"":"module-page",children:[e?u.jsx("h3",{children:r(d.titleKey)}):u.jsxs("div",{className:"page-header-row",children:[u.jsx("h1",{children:r(d.titleKey)}),u.jsx(st,{to:d.backPath,className:"button-link-secondary",children:r("common.backToList")})]}),os&&u.jsx("p",{className:"error-text",children:os}),t!=="sale"?u.jsxs("form",{className:"crud-form",onSubmit:Xr,children:[u.jsxs("section",{className:"crud-form-section",children:[u.jsx("h2",{className:"crud-form-section-title",children:r("transactions.sectionGeneral")}),u.jsxs("div",{className:"form-grid-2",children:[u.jsxs("label",{className:"field-block",children:[u.jsx("span",{children:r("transactions.date")}),u.jsx("input",{type:"date",name:"date",value:E.date,onChange:z,required:!0})]}),u.jsxs("label",{className:"field-block",children:[u.jsx("span",{children:r("transactions.currency")}),u.jsxs("select",{name:"currencyId",value:E.currencyId,onChange:z,required:!0,children:[u.jsx("option",{value:"",children:`-- ${r("transactions.selectCurrency")} --`}),S.map(M=>u.jsxs("option",{value:M.id,children:[M.name," (",M.symbol,")"]},M.id))]})]}),u.jsxs("div",{className:"field-block",children:[u.jsx("span",{children:r("transactions.person")}),t==="income"||t==="expense"?u.jsx(ns,{label:"",value:D,onValueChange:Y,options:Gt,getOptionLabel:M=>M.name||"",onSelect:M=>L(ne=>({...ne,personId:String(M.id)})),placeholder:`-- ${r(t==="expense"?"transactions.selectProvider":"transactions.optionalPerson")} --`,noResultsText:r("common.empty"),selectedPillText:Gt.find(M=>M.id===Number(E.personId))?.name||"",onClearSelection:()=>{L(M=>({...M,personId:""})),Y("")},onCreateRecord:gt,renderCreateModal:({isOpen:M,onClose:ne,onCreated:ce})=>M?u.jsx("div",{className:"modal-backdrop",onClick:ne,children:u.jsx("div",{className:"modal-card",onClick:je=>je.stopPropagation(),children:u.jsx(Vr,{embedded:!0,personType:t==="expense"?2:1,titleKey:t==="expense"?"actions.newProvider":"actions.newClient",basePath:t==="expense"?"/providers":"/clients",onCancel:ne,onCreated:ce})})}):null}):u.jsxs("div",{className:"field-select-with-action",children:[u.jsxs("select",{name:"personId",value:E.personId,onChange:z,required:t==="purchase",children:[u.jsx("option",{value:"",children:t==="purchase"?`-- ${r("transactions.selectProvider")} --`:`-- ${r("transactions.optionalPerson")} --`}),Gt.map(M=>u.jsx("option",{value:M.id,children:M.name},M.id))]}),u.jsx(st,{to:t==="purchase"?"/providers/new":"/clients/new",className:"button-secondary",title:r("actions.newPerson"),children:"+"})]})]}),u.jsxs("div",{className:`field-block required ${Ut&&!E.conceptId?"field-error":""}`,children:[u.jsx("span",{children:r("transactions.concept")}),t==="income"||t==="expense"?u.jsx(ns,{label:"",value:se,onValueChange:H,options:vn,getOptionLabel:M=>M.name||"",onSelect:M=>L(ne=>({...ne,conceptId:String(M.id),additionalCharges:M.additionalCharges??ne.additionalCharges})),placeholder:`-- ${r("transactions.selectConcept")} --`,noResultsText:r("common.empty"),selectedPillText:vn.find(M=>M.id===Number(E.conceptId))?.name||"",onClearSelection:()=>{L(M=>({...M,conceptId:"",additionalCharges:0})),H("")},onCreateRecord:Rs,required:!0,hasError:Ut&&!E.conceptId,renderCreateModal:({isOpen:M,onClose:ne,onCreated:ce})=>M?u.jsx("div",{className:"modal-backdrop",onClick:ne,children:u.jsx("div",{className:"modal-card",onClick:je=>je.stopPropagation(),children:u.jsx(nn,{embedded:!0,moduleType:t==="expense"?"expense":"income",titleKey:t==="expense"?"actions.newExpenseConcept":"actions.newIncomeConcept",basePath:t==="expense"?"/expense-concepts":"/income-concepts",onCancel:ne,onCreated:ce})})}):null}):u.jsxs("div",{className:"field-select-with-action",children:[u.jsxs("select",{name:"conceptId",value:E.conceptId,onChange:z,required:!0,children:[u.jsx("option",{value:"",children:`-- ${r("transactions.selectConcept")} --`}),vn.map(M=>u.jsx("option",{value:M.id,children:M.name},M.id))]}),u.jsx(st,{to:t==="purchase"||t==="expense"?"/expense-concepts/new":"/income-concepts/new",className:"button-secondary",title:r("actions.newConcept"),children:"+"})]})]}),u.jsxs("label",{className:"field-block form-span-2",children:[u.jsx("span",{children:r("transactions.description")}),u.jsx("input",{name:"description",value:E.description,onChange:z})]}),u.jsxs("label",{className:"field-block",children:[u.jsx("span",{children:r("transactions.referenceNumber")}),u.jsx("input",{name:"referenceNumber",value:E.referenceNumber,onChange:z})]}),u.jsx(ns,{label:r("projects.project"),value:le,onValueChange:M=>{ae(M),M||L(ne=>({...ne,projectId:""}))},options:O,getOptionLabel:M=>M.name||"",onSelect:M=>{ae(""),L(ne=>({...ne,projectId:String(M.id)}))},placeholder:`-- ${r("projects.optionalProject")} --`,onCreateRecord:Ms,renderCreateModal:({isOpen:M,onClose:ne,onCreated:ce})=>M?u.jsx("div",{className:"modal-backdrop",onClick:ne,children:u.jsx("div",{className:"modal-card",onClick:je=>je.stopPropagation(),children:u.jsx(uo,{embedded:!0,onCancel:ne,onCreated:ce})})}):null,noResultsText:r("common.empty"),selectedPillText:O.find(M=>M.id===Number(E.projectId))?.name||"",onClearSelection:()=>{L(M=>({...M,projectId:""})),ae("")}}),(t==="income"||t==="expense")&&u.jsx(ns,{label:r("transactions.employee"),value:ge,onValueChange:M=>{_e(M),M||L(ne=>({...ne,employeeId:""}))},options:x,getOptionLabel:M=>M.name||"",onSelect:M=>{_e(""),L(ne=>({...ne,employeeId:String(M.id)}))},placeholder:`-- ${r("transactions.optionalSeller")} --`,noResultsText:r("common.empty"),selectedPillText:x.find(M=>M.id===Number(E.employeeId))?.name||"",onClearSelection:()=>{L(M=>({...M,employeeId:""})),_e("")},onCreateRecord:Gn,renderCreateModal:({isOpen:M,onClose:ne,onCreated:ce})=>M?u.jsx("div",{className:"modal-backdrop",onClick:ne,children:u.jsx("div",{className:"modal-card",onClick:je=>je.stopPropagation(),children:u.jsx(mc,{embedded:!0,onCancel:ne,onCreated:ce})})}):null})]})]}),(t==="purchase"||t==="income"||t==="expense")&&u.jsxs("section",{className:"crud-form-section",children:[u.jsx("h2",{className:"crud-form-section-title",children:r("transactions.sectionPayment")}),u.jsxs("div",{className:"form-grid-2",children:[t==="purchase"&&u.jsxs("label",{className:"field-block",children:[u.jsx("span",{children:r("transactions.paymentMode")}),u.jsxs("select",{name:"paymentMode",value:E.paymentMode,onChange:z,children:[u.jsx("option",{value:"cash",children:r("transactions.cash")}),u.jsx("option",{value:"credit",children:r("transactions.credit")})]})]}),(t!=="purchase"||E.paymentMode==="cash")&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"field-block required",children:[u.jsx("span",{children:r("transactions.paymentMethod")}),t==="income"||t==="expense"?u.jsx(ns,{label:"",value:J,onValueChange:ee,options:k,getOptionLabel:M=>M.name||"",onSelect:M=>L(ne=>({...ne,paymentMethodId:String(M.id),accountPaymentFormId:""})),placeholder:`-- ${r("transactions.selectPaymentMethod")} --`,noResultsText:r("common.empty"),required:!0,hasError:Ut&&!E.paymentMethodId,selectedPillText:k.find(M=>M.id===Number(E.paymentMethodId))?.name||"",onClearSelection:()=>{L(M=>({...M,paymentMethodId:"",accountPaymentFormId:""})),ee("")},renderCreateModal:({isOpen:M,onClose:ne,onCreated:ce})=>M?u.jsx("div",{className:"modal-backdrop",onClick:ne,children:u.jsx("div",{className:"modal-card",onClick:je=>je.stopPropagation(),children:u.jsx(kN,{t:r,accountId:a?.accountId,onCancel:ne,onCreated:ce})})}):null,onCreateRecord:async M=>{const ne=await oo(a.accountId);I(ne),L(ce=>({...ce,paymentMethodId:String(M.id),accountPaymentFormId:""})),ee("")}}):u.jsxs("select",{name:"paymentMethodId",value:E.paymentMethodId,onChange:z,required:t!=="purchase"||E.paymentMode==="cash",children:[u.jsx("option",{value:"",children:`-- ${r("transactions.selectPaymentMethod")} --`}),k.map(M=>u.jsx("option",{value:M.id,children:M.name},M.id))]})]}),u.jsxs("div",{className:`field-block ${an?"required":""}`,children:[u.jsx("span",{children:r("transactions.accountPaymentForm")}),t==="income"||t==="expense"?u.jsx(ns,{label:"",value:he,onValueChange:Z,options:bn,getOptionLabel:M=>pn(M),onSelect:M=>L(ne=>({...ne,accountPaymentFormId:String(M.id)})),placeholder:`-- ${r("transactions.selectAccountPaymentForm")} --`,noResultsText:r("common.empty"),required:an,hasError:Ut&&an&&!E.accountPaymentFormId,selectedPillText:bn.find(M=>M.id===Number(E.accountPaymentFormId))?pn(bn.find(M=>M.id===Number(E.accountPaymentFormId))):"",onClearSelection:()=>{L(M=>({...M,accountPaymentFormId:""})),Z("")},onCreateRecord:async M=>{const ne=await fr(a.accountId);N(ne),L(ce=>({...ce,accountPaymentFormId:String(M.id)})),Z("")},renderCreateModal:({isOpen:M,onClose:ne,onCreated:ce})=>M?u.jsx("div",{className:"modal-backdrop",onClick:ne,children:u.jsx("div",{className:"modal-card",onClick:je=>je.stopPropagation(),children:u.jsx(gc,{embedded:!0,onCancel:ne,onCreated:ce})})}):null}):u.jsxs("select",{name:"accountPaymentFormId",value:E.accountPaymentFormId,onChange:z,required:an,children:[u.jsx("option",{value:"",children:`-- ${r("transactions.selectAccountPaymentForm")} --`}),bn.map(M=>u.jsx("option",{value:M.id,children:pn(M)},M.id))]})]})]})]})]}),u.jsxs("section",{className:"crud-form-section",children:[u.jsx("h2",{className:"crud-form-section-title",children:r("transactions.sectionAmounts")}),u.jsxs("div",{className:"form-grid-2",children:[u.jsxs("label",{className:`field-block ${Ut&&!(Number(E.amount)>0)?"field-error":""}`,children:[u.jsx("span",{children:r("transactions.amount")}),u.jsx("input",{name:"amount",type:"number",min:"0",step:"0.01",value:E.amount,onChange:z,required:!0})]}),u.jsxs("label",{className:"field-block",children:[u.jsx("span",{children:r("transactions.additionalCharges")}),u.jsx("input",{name:"additionalCharges",type:"number",step:"0.01",value:E.additionalCharges,readOnly:!0})]})]})]}),u.jsxs("p",{children:[r("transactions.summary")," ",(Number(E.amount||0)+Number(E.additionalCharges||0)).toFixed(2)]}),u.jsxs("div",{className:"crud-form-actions",children:[e?u.jsx("button",{type:"button",className:"button-secondary",onClick:()=>n?.(),children:r("common.cancel")}):null,u.jsx("button",{type:"submit",disabled:Hn,children:r("common.create")})]})]}):u.jsxs("form",{className:"crud-form",onSubmit:xo,children:[u.jsxs("section",{className:"crud-form-section",children:[u.jsx("h2",{className:"crud-form-section-title",children:r("transactions.sectionGeneral")}),u.jsxs("div",{className:"form-grid-2",children:[u.jsxs("label",{className:"field-block",children:[u.jsx("span",{children:r("transactions.date")}),u.jsx("input",{type:"date",name:"date",value:R.date,onChange:xe,required:!0})]}),u.jsxs("label",{className:"field-block",children:[u.jsx("span",{children:r("transactions.currency")}),u.jsxs("select",{name:"currencyId",value:R.currencyId,onChange:xe,required:!0,children:[u.jsx("option",{value:"",children:`-- ${r("transactions.selectCurrency")} --`}),S.map(M=>u.jsxs("option",{value:M.id,children:[M.name," (",M.symbol,")"]},M.id))]})]}),u.jsxs("label",{className:"field-block",children:[u.jsx("span",{children:r("transactions.paymentMode")}),u.jsxs("select",{name:"paymentMode",value:R.paymentMode,onChange:xe,children:[u.jsx("option",{value:"cash",children:r("transactions.cash")}),u.jsx("option",{value:"credit",children:r("transactions.credit")})]})]}),u.jsx(ns,{label:r("transactions.clientLookup"),value:W,onValueChange:M=>{B(M),M||ie(null)},options:Gt,getOptionLabel:M=>M.name||"",onSelect:M=>{ie(M),B("")},placeholder:r("transactions.lookupPlaceholder"),onCreateRecord:gt,required:!0,hasError:yn&&!oe,renderCreateModal:({isOpen:M,onClose:ne,onCreated:ce})=>M?u.jsx("div",{className:"modal-backdrop",onClick:ne,children:u.jsx("div",{className:"modal-card",onClick:je=>je.stopPropagation(),children:u.jsx(Vr,{embedded:!0,personType:1,titleKey:"actions.newClient",basePath:"/clients",onCancel:ne,onCreated:ce})})}):null,noResultsText:r("common.empty"),selectedPillText:oe?.name||"",onClearSelection:()=>{ie(null),B("")}}),u.jsxs("label",{className:"field-block form-span-2",children:[u.jsx("span",{children:r("transactions.description")}),u.jsx("input",{name:"description",value:R.description,onChange:xe})]}),u.jsxs("label",{className:"field-block",children:[u.jsx("span",{children:r("transactions.referenceNumber")}),u.jsx("input",{name:"referenceNumber",value:R.referenceNumber,onChange:xe})]}),u.jsx(ns,{label:r("projects.project"),value:De,onValueChange:M=>{Te(M),M||T(ne=>({...ne,projectId:""}))},options:O,getOptionLabel:M=>M.name||"",onSelect:M=>{Te(""),T(ne=>({...ne,projectId:String(M.id)}))},placeholder:`-- ${r("projects.optionalProject")} --`,onCreateRecord:Ms,renderCreateModal:({isOpen:M,onClose:ne,onCreated:ce})=>M?u.jsx("div",{className:"modal-backdrop",onClick:ne,children:u.jsx("div",{className:"modal-card",onClick:je=>je.stopPropagation(),children:u.jsx(uo,{embedded:!0,onCancel:ne,onCreated:ce})})}):null,noResultsText:r("common.empty"),selectedPillText:O.find(M=>M.id===Number(R.projectId))?.name||"",onClearSelection:()=>{T(M=>({...M,projectId:""})),Te("")}})]})]}),R.paymentMode==="cash"&&u.jsxs("section",{className:"crud-form-section",children:[u.jsx("h2",{className:"crud-form-section-title",children:r("transactions.sectionPayment")}),u.jsxs("div",{className:"form-grid-2",children:[u.jsxs("label",{className:"field-block",children:[u.jsx("span",{children:r("transactions.paymentMethod")}),u.jsxs("select",{name:"paymentMethodId",value:R.paymentMethodId,onChange:xe,required:!0,children:[u.jsx("option",{value:"",children:`-- ${r("transactions.selectPaymentMethod")} --`}),k.map(M=>u.jsx("option",{value:M.id,children:M.name},M.id))]})]}),u.jsxs("label",{className:"field-block",children:[u.jsx("span",{children:r("transactions.accountPaymentForm")}),u.jsxs("select",{name:"accountPaymentFormId",value:R.accountPaymentFormId,onChange:xe,required:Kn,children:[u.jsx("option",{value:"",children:`-- ${r("transactions.selectAccountPaymentForm")} --`}),gr.map(M=>u.jsx("option",{value:M.id,children:pn(M)},M.id))]})]})]})]}),u.jsxs("section",{className:"crud-form-section",children:[u.jsx("h2",{className:"crud-form-section-title",children:r("transactions.sectionDetail")}),u.jsx(ns,{label:r("transactions.productLookup"),value:Fe,onValueChange:mt,options:vn,getOptionLabel:M=>M.name||"",onSelect:M=>{Be(M),mt("")},placeholder:r("transactions.productLookupPlaceholder"),onCreateRecord:Rs,renderCreateModal:({isOpen:M,onClose:ne,onCreated:ce})=>M?u.jsx("div",{className:"modal-backdrop",onClick:ne,children:u.jsx("div",{className:"modal-card",onClick:je=>je.stopPropagation(),children:u.jsx(nn,{embedded:!0,moduleType:"products",titleKey:"actions.newProduct",basePath:"/products",onCancel:ne,onCreated:ce})})}):null,noResultsText:r("common.empty")})]}),u.jsxs("table",{className:"crud-table invoice-lines-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:r("transactions.product")}),u.jsx("th",{children:r("transactions.quantity")}),u.jsx("th",{children:r("transactions.price")}),u.jsx("th",{children:r("transactions.taxPercentage")}),u.jsx("th",{children:r("transactions.discountPercentage")}),u.jsx("th",{children:r("transactions.additionalCharges")}),u.jsx("th",{children:r("transactions.lineTotal")}),u.jsx("th",{children:r("transactions.seller")}),u.jsx("th",{children:r("common.actions")})]})}),u.jsx("tbody",{children:Kt.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:9,children:r("transactions.noLines")})}):Kt.map(M=>{const ne=Lh(M);return u.jsxs("tr",{children:[u.jsx("td",{children:M.conceptName}),u.jsx("td",{children:u.jsx("input",{type:"number",min:"0",step:"0.01",value:M.quantity,onChange:ce=>Ve(M.rowId,"quantity",ce.target.value)})}),u.jsx("td",{children:u.jsx("input",{type:"number",min:"0",step:"0.01",value:M.price,onChange:ce=>Ve(M.rowId,"price",ce.target.value)})}),u.jsx("td",{children:u.jsx("input",{type:"number",min:"0",step:"0.01",value:M.taxPercentage,onChange:ce=>Ve(M.rowId,"taxPercentage",ce.target.value)})}),u.jsx("td",{children:u.jsx("input",{type:"number",min:"0",step:"0.01",value:M.discountPercentage,onChange:ce=>Ve(M.rowId,"discountPercentage",ce.target.value)})}),u.jsx("td",{children:u.jsx("input",{type:"number",step:"0.01",value:M.additionalCharges,onChange:ce=>Ve(M.rowId,"additionalCharges",ce.target.value)})}),u.jsx("td",{children:ne.total.toFixed(2)}),u.jsx("td",{children:u.jsxs("select",{value:M.sellerId,onChange:ce=>Ve(M.rowId,"sellerId",ce.target.value),children:[u.jsx("option",{value:"",children:`-- ${r("transactions.optionalSeller")} --`}),x.map(ce=>u.jsx("option",{value:ce.id,children:ce.name},ce.id))]})}),u.jsx("td",{children:u.jsx("button",{type:"button",className:"button-danger",onClick:()=>wn(M.rowId),children:r("common.delete")})})]},M.rowId)})})]}),u.jsxs("p",{children:[r("transactions.summary")," ",Os.total.toFixed(2)]}),u.jsxs("div",{className:"crud-form-actions",children:[e?u.jsx("button",{type:"button",className:"button-secondary",onClick:()=>n?.(),children:r("common.cancel")}):null,u.jsx("button",{type:"submit",disabled:Hn,children:r("common.create")})]})]})]})}const jN={sale:{type:At.sale,titleKey:"transactions.salesTitle"},expense:{type:At.expense,titleKey:"transactions.expensesTitle"},income:{type:At.income,titleKey:"transactions.incomesTitle"},purchase:{type:At.purchase,titleKey:"transactions.purchasesTitle"},outgoingPayment:{type:At.outgoingPayment,titleKey:"transactions.outgoingPaymentsTitle"},incomingPayment:{type:At.incomingPayment,titleKey:"transactions.incomingPaymentsTitle"}},Qd=10;function Kl({moduleType:t}){const{t:e,language:n}=Ee(),{account:s}=Oe(),r=jN[t],a=["sale","purchase","expense","income"].includes(t),[l,c]=j.useState([]),[d,f]=j.useState(""),[m,g]=j.useState(!0),[y,x]=j.useState(1),[_,S]=j.useState({open:!1,transaction:null,direction:"incoming"}),[b,k]=j.useState({dateFrom:"",dateTo:"",person:"",minAmount:"",maxAmount:""}),[I,C]=as(),N=I.get("create")==="1";j.useEffect(()=>{s?.accountId&&E()},[s?.accountId,r.type]);const O=j.useMemo(()=>{const D=b.person.trim().toLowerCase(),Y=b.minAmount===""?null:Number(b.minAmount),se=b.maxAmount===""?null:Number(b.maxAmount);return l.filter(H=>!(b.dateFrom&&H.date<b.dateFrom||b.dateTo&&H.date>b.dateTo||D&&!(H.persons?.name||"").toLowerCase().includes(D)||Number.isFinite(Y)&&Number(H.total||0)<Y||Number.isFinite(se)&&Number(H.total||0)>se))},[l,b]),U=j.useMemo(()=>{const D=(y-1)*Qd;return O.slice(D,D+Qd)},[O,y]);j.useEffect(()=>{x(1)},[b]);const E=async()=>{try{g(!0);const D=await YT({accountId:s.accountId,type:r.type,excludeInternalObligations:t==="purchase"});if(t==="income"||t==="expense"){const Y=await JT(D.map(se=>se.id));c(D.map(se=>({...se,conceptName:Y[Number(se.id)]??"-"})))}else c(D);f(""),x(1)}catch{f(e("common.genericLoadError"))}finally{g(!1)}},L=async D=>{try{await sb(D),await E()}catch{f(e("common.genericSaveError"))}},R=D=>{const{name:Y,value:se}=D.target;k(H=>({...H,[Y]:se}))},T=()=>{k({dateFrom:"",dateTo:"",person:"",minAmount:"",maxAmount:""})};return u.jsxs("div",{className:"module-page",children:[u.jsx("h1",{children:e(r.titleKey)}),a&&u.jsxs("details",{className:"generic-panel filters-accordion",children:[u.jsx("summary",{className:"filters-accordion-summary",children:e("reports.applicableFilters")}),u.jsxs("div",{className:"filters-accordion-body",children:[u.jsxs("div",{className:"transaction-filters-grid",children:[u.jsxs("label",{className:"field-block",children:[u.jsx("span",{children:e("reports.dateFrom")}),u.jsx("input",{type:"date",name:"dateFrom",value:b.dateFrom,onChange:R})]}),u.jsxs("label",{className:"field-block",children:[u.jsx("span",{children:e("reports.dateTo")}),u.jsx("input",{type:"date",name:"dateTo",value:b.dateTo,onChange:R})]}),u.jsxs("label",{className:"field-block",children:[u.jsx("span",{children:e("transactions.person")}),u.jsx("input",{type:"text",name:"person",value:b.person,onChange:R,placeholder:`-- ${e("transactions.person")} --`})]}),u.jsxs("label",{className:"field-block",children:[u.jsx("span",{children:e("transactions.minAmount")}),u.jsx("input",{type:"number",min:"0",step:"0.01",name:"minAmount",value:b.minAmount,onChange:R,placeholder:`-- ${e("transactions.minAmount")} --`})]}),u.jsxs("label",{className:"field-block",children:[u.jsx("span",{children:e("transactions.maxAmount")}),u.jsx("input",{type:"number",min:"0",step:"0.01",name:"maxAmount",value:b.maxAmount,onChange:R,placeholder:`-- ${e("transactions.maxAmount")} --`})]})]}),u.jsx("div",{className:"crud-form-actions",children:u.jsx("button",{type:"button",className:"button-secondary",onClick:T,children:e("common.clearFilters")})})]})]}),d&&u.jsx("p",{className:"error-text",children:d}),m?u.jsx("p",{children:e("common.loading")}):O.length===0?u.jsx("p",{children:e("common.empty")}):u.jsxs(u.Fragment,{children:[u.jsxs("table",{className:"crud-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"ID"}),u.jsx("th",{children:e("transactions.date")}),u.jsx("th",{children:e("common.name")}),(t==="income"||t==="expense")&&u.jsx("th",{children:e("transactions.concept")}),u.jsx("th",{children:e("transactions.person")}),u.jsx("th",{children:e("projects.project")}),u.jsx("th",{children:e("transactions.total")}),u.jsx("th",{children:e("transactions.balance")}),u.jsx("th",{children:e("transactions.referenceNumber")}),u.jsx("th",{children:e("transactions.status")}),u.jsx("th",{children:e("common.actions")})]})}),u.jsx("tbody",{children:U.map(D=>u.jsxs("tr",{children:[u.jsx("td",{children:t==="sale"||t==="purchase"?u.jsx(st,{to:`/${t==="sale"?"sales":"purchases"}/${D.id}`,children:D.id}):D.id}),u.jsx("td",{children:dt(D.date,n)}),u.jsx("td",{children:D.name??"-"}),(t==="income"||t==="expense")&&u.jsx("td",{children:D.conceptName??"-"}),u.jsx("td",{children:D.persons?.name??"-"}),u.jsx("td",{children:D.projects?.name??"-"}),u.jsx("td",{children:Ie(D.total)}),u.jsx("td",{children:Ie(D.balance)}),u.jsx("td",{children:D.referenceNumber??"-"}),u.jsx("td",{children:D.isActive?e("transactions.active"):e("transactions.inactive")}),u.jsx("td",{className:"table-actions",children:u.jsx(En,{actions:[...t==="sale"||t==="purchase"?[{key:"detail",label:e("transactions.viewDetail"),to:`/${t==="sale"?"sales":"purchases"}/${D.id}`}]:[],...t==="purchase"&&Number(D.balance||0)>0?[{key:"pay",label:e("transactions.newOutgoingPayment"),onClick:()=>S({open:!0,transaction:D,direction:"outgoing"})}]:[],...t==="sale"&&Number(D.balance||0)>0?[{key:"collect",label:e("transactions.newIncomingPayment"),onClick:()=>S({open:!0,transaction:D,direction:"incoming"})}]:[],{key:"deactivate",label:e("transactions.deactivate"),onClick:()=>L(D.id),disabled:!D.isActive,danger:!0}]})})]},D.id))})]}),u.jsx(qn,{page:y,pageSize:Qd,totalItems:O.length,onPageChange:x}),u.jsx(ib,{isOpen:_.open,transaction:_.transaction,direction:_.direction,onClose:()=>S({open:!1,transaction:null,direction:"incoming"}),onSaved:E})]}),N?u.jsx("div",{className:"modal-backdrop",onClick:()=>{const D=new URLSearchParams(I);D.delete("create"),C(D)},children:u.jsx("div",{className:`modal-card ${t==="sale"?"modal-card-wide":""}`,onClick:D=>D.stopPropagation(),children:u.jsx(Da,{embedded:!0,moduleType:t,onCancel:()=>{const D=new URLSearchParams(I);D.delete("create"),C(D)},onCreated:async()=>{await E();const D=new URLSearchParams(I);D.delete("create"),C(D)}})})}):null]})}function wv({moduleType:t}){const{t:e,language:n}=Ee(),{id:s}=Vn(),[r,a]=j.useState(null),[l,c]=j.useState([]),[d,f]=j.useState([]),[m,g]=j.useState(!1),[y,x]=j.useState(""),[_,S]=j.useState(!0),b=t==="sale"?"/sales":"/purchases";j.useEffect(()=>{k()},[s]);const k=async()=>{try{S(!0);const[I,C,N]=await Promise.all([rb(s),QT(s),ZT(s)]);a(I),c(C),f(N),x("")}catch{x(e("common.genericLoadError"))}finally{S(!1)}};return _?u.jsx("p",{children:e("common.loading")}):u.jsxs("div",{className:"module-page",children:[u.jsxs("div",{className:"page-header-row",children:[u.jsx("h1",{children:e("transactions.detailTitle")}),u.jsxs("div",{className:"crud-form-actions",children:[u.jsx(st,{to:b,className:"button-link-secondary",children:e("common.backToList")}),Number(r?.balance||0)>0&&u.jsx("button",{type:"button",className:"button-link-primary",onClick:()=>g(!0),children:e(t==="sale"?"transactions.newIncomingPayment":"transactions.newOutgoingPayment")})]})]}),y&&u.jsx("p",{className:"error-text",children:y}),r&&u.jsxs("section",{className:"generic-panel",children:[u.jsxs("p",{children:["ID: ",r.id]}),u.jsxs("p",{children:[e("transactions.person"),": ",r.persons?.name??"-"]}),u.jsxs("p",{children:[e("transactions.total"),": ",Ie(r.total)]}),u.jsxs("p",{children:[e("transactions.balance"),": ",Ie(r.balance)]}),u.jsxs("p",{children:[e("transactions.referenceNumber"),": ",r.referenceNumber||"-"]})]}),u.jsxs("section",{className:"generic-panel",children:[u.jsx("h3",{children:e("transactions.detailLines")}),u.jsxs("table",{className:"crud-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:e("transactions.concept")}),u.jsx("th",{children:e("transactions.quantity")}),u.jsx("th",{children:e("transactions.price")}),u.jsx("th",{children:e("transactions.total")})]})}),u.jsx("tbody",{children:l.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:4,children:e("common.empty")})}):l.map(I=>u.jsxs("tr",{children:[u.jsx("td",{children:I.concepts?.name??"-"}),u.jsx("td",{children:I.quantity}),u.jsx("td",{children:Ie(I.price)}),u.jsx("td",{children:Ie(I.total)})]},I.id))})]})]}),u.jsxs("section",{className:"generic-panel",children:[u.jsx("h3",{children:e("transactions.paymentsApplied")}),u.jsxs("table",{className:"crud-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"ID"}),u.jsx("th",{children:e("transactions.date")}),u.jsx("th",{children:e("transactions.referenceNumber")}),u.jsx("th",{children:e("transactions.total")})]})}),u.jsx("tbody",{children:d.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:3,children:e("common.empty")})}):d.map(I=>u.jsxs("tr",{children:[u.jsx("td",{children:I.transactionId}),u.jsx("td",{children:dt(I.transactions?.date,n)}),u.jsx("td",{children:I.transactions?.referenceNumber??"-"}),u.jsx("td",{children:Ie(I.total)})]},I.id))})]})]}),u.jsx(ib,{isOpen:m,transaction:r,direction:t==="sale"?"incoming":"outgoing",onClose:()=>g(!1),onSaved:k})]})}const CN='id, name, "periodType", "periodStart", "periodEnd", "projectId", "isActive", projects(name)';async function ob(t,{activeOnly:e=!0}={}){let n=G.from("budgets").select(CN).eq("accountId",t);e&&(n=n.eq("isActive",!0));const{data:s,error:r}=await n.order("id",{ascending:!1});if(r)throw r;return s??[]}async function lb(t){const{data:e,error:n}=await G.from("budgets").select('id, name, "periodType", "periodStart", "periodEnd", "projectId", "isActive"').eq("id",t).single();if(n)throw n;return e}async function cb(t){const{data:e,error:n}=await G.from("budget_lines").select('id, "budgetId", "conceptId", amount, concepts(name)').eq("budgetId",t).order("id",{ascending:!0});if(n)throw n;return e??[]}async function PN({budget:t,lines:e}){const{data:n,error:s}=await G.from("budgets").insert(t).select("id").single();if(s)throw s;const r=(e??[]).filter(a=>Number(a.conceptId)).map(a=>({budgetId:n.id,conceptId:Number(a.conceptId),amount:Number(a.amount||0),createdById:t.createdById}));if(r.length>0){const{error:a}=await G.from("budget_lines").insert(r);if(a)throw await G.from("budgets").delete().eq("id",n.id),a}return n}async function IN(t,{budget:e,lines:n}){const{error:s}=await G.from("budgets").update(e).eq("id",t);if(s)throw s;const{error:r}=await G.from("budget_lines").delete().eq("budgetId",t);if(r)throw r;const a=(n??[]).filter(l=>Number(l.conceptId)).map(l=>({budgetId:t,conceptId:Number(l.conceptId),amount:Number(l.amount||0),createdById:e.createdById}));if(a.length>0){const{error:l}=await G.from("budget_lines").insert(a);if(l)throw l}}async function EN(t){const{error:e}=await G.from("budgets").update({isActive:!1}).eq("id",t);if(e)throw e}async function ub({accountId:t,budgetId:e,dateFrom:n,dateTo:s}){const{data:r,error:a}=await G.from("budgets").select('id, name, "periodStart", "periodEnd", "projectId"').eq("id",e).eq("accountId",t).single();if(a)throw a;const{data:l,error:c}=await G.from("budget_lines").select('id, "conceptId", amount, concepts(name, isExpense, isIncome)').eq("budgetId",e);if(c)throw c;const d=[...new Set((l??[]).map(_=>_.conceptId).filter(Boolean))];if(d.length===0)return[];const f=n||r.periodStart,m=s||r.periodEnd,{data:g,error:y}=await G.from("transactionDetails").select('conceptId, total, transactions!transaction_details_transactionId_fkey(accountId, date, isActive, "projectId")').in("conceptId",d);if(y)throw y;const x=new Map;return(g??[]).forEach(_=>{const S=_.transactions;if(!S||S.accountId!==t||S.isActive!==!0||f&&S.date<f||m&&S.date>m||r.projectId&&Number(S.projectId||0)!==Number(r.projectId))return;const b=Number(_.conceptId),C=!!(l??[]).find(N=>Number(N.conceptId)===b)?.concepts?.isExpense?Math.abs(Number(_.total||0)):Number(_.total||0);x.set(b,(x.get(b)||0)+C)}),(l??[]).map(_=>{const S=Number(_.amount||0),b=Number(x.get(Number(_.conceptId))||0);return{id:_.id,conceptId:_.conceptId,conceptName:_.concepts?.name||`#${_.conceptId}`,budgeted:S,executed:b,variance:S-b}})}async function db({accountId:t,projectId:e,dateFrom:n,dateTo:s}){const{data:r,error:a}=await G.from("budgets").select('id, "periodStart", "periodEnd"').eq("accountId",t).eq("projectId",e).eq("isActive",!0);if(a)throw a;const l=(r??[]).map(S=>S.id),{data:c,error:d}=l.length?await G.from("budget_lines").select('id, "budgetId", "conceptId", amount, concepts(name, isExpense, isIncome)').in("budgetId",l):{data:[],error:null};if(d)throw d;const{data:f,error:m}=await G.from("transactionDetails").select('conceptId, total, transactions!transaction_details_transactionId_fkey(accountId, date, isActive, "projectId")');if(m)throw m;const g=new Map;(c??[]).forEach(S=>{const b=Number(S.conceptId);g.set(b,(g.get(b)||0)+Number(S.amount||0))});const y=new Map;(f??[]).forEach(S=>{const b=S.transactions;if(!b||b.accountId!==t||b.isActive!==!0||Number(b.projectId||0)!==Number(e)||n&&b.date<n||s&&b.date>s)return;const k=Number(S.conceptId),N=!!(c??[]).find(O=>Number(O.conceptId)===k)?.concepts?.isExpense?Math.abs(Number(S.total||0)):Number(S.total||0);y.set(k,(y.get(k)||0)+N)});const x=[...new Set([...g.keys(),...y.keys()])],_=new Map((c??[]).map(S=>[Number(S.conceptId),S.concepts?.name||`#${S.conceptId}`]));return x.map(S=>{const b=Number(g.get(S)||0),k=Number(y.get(S)||0);return{id:S,conceptId:S,conceptName:_.get(S)||`#${S}`,budgeted:b,executed:k,variance:b-k}})}async function TN(t,{dateFrom:e,dateTo:n}={}){let s=G.from("transactions").select('id, date, type, total, balance, payments, additionalCharges, isActive, isAccountPayable, isAccountReceivable, isIncomingPayment, isOutcomingPayment, "accountPaymentFormId", "projectId", currencyId, account_payment_forms(name), projects(name)').eq("accountId",t).eq("isActive",!0);e&&(s=s.gte("date",e)),n&&(s=s.lte("date",n));const{data:r,error:a}=await s.order("date",{ascending:!1});if(a)throw a;return r??[]}async function NN({accountId:t,reportId:e,dateFrom:n,dateTo:s,currencyId:r,budgetId:a,projectId:l}){const c="https://vpbokueczoylouivgnin.supabase.co",d="sb_publishable_qnne91NTAXswisfSQlObFg_NnwBiV9d";async function f(){let{data:{session:_}}=await G.auth.getSession();if((!_?.access_token||!_?.expires_at||_.expires_at*1e3<=Date.now()+6e4)&&(_=(await G.auth.refreshSession()).data.session),!_?.access_token)throw new Error("Missing auth session for report export request.");return _.access_token}async function m(_){const S=await fetch(`${c}/functions/v1/export-report`,{method:"POST",headers:{"Content-Type":"application/json",apikey:d,Authorization:`Bearer ${_}`},body:JSON.stringify({accountId:t,reportId:e,dateFrom:n,dateTo:s,currencyId:r,budgetId:a,projectId:l})});let b;try{b=await S.json()}catch{b=null}return{response:S,payload:b}}let g=await f(),{response:y,payload:x}=await m(g);if(y.status===401){if(g=(await G.auth.refreshSession()).data.session?.access_token,!g)throw new Error(x?.error??"Unauthorized. Please sign in again.");const S=await m(g);y=S.response,x=S.payload}if(!y.ok)throw new Error(x?.error??`Report export HTTP ${y.status}`);if(x?.success===!1||!x?.downloadUrl)throw new Error(`Report export failed: ${x?.error??"unknown function error"}`);return x}const Zd=[{id:"sales",titleKey:"reports.sales",filters:["dateRange","currency"]},{id:"receivable",titleKey:"reports.accountsReceivable",filters:["dateRange","currency"]},{id:"payable",titleKey:"reports.accountsPayable",filters:["dateRange","currency"]},{id:"internal_obligations",titleKey:"reports.internalObligations",filters:["dateRange","currency"]},{id:"budget_execution",titleKey:"reports.budgetExecution",filters:["budget"]},{id:"project_execution",titleKey:"reports.projectExecution",filters:["project","dateRange"]},{id:"expenses",titleKey:"reports.expenses",filters:["dateRange","currency"]},{id:"cashflow",titleKey:"reports.cashflow",filters:["dateRange","currency"]}];function AN(){const{t,language:e}=Ee(),{account:n}=Oe(),[s,r]=j.useState("sales"),[a,l]=j.useState({dateFrom:"",dateTo:"",currencyId:"",budgetId:"",projectId:""}),[c,d]=j.useState([]),[f,m]=j.useState([]),[g,y]=j.useState([]),[x,_]=j.useState([]),[S,b]=j.useState(""),[k,I]=j.useState(!1),[C,N]=j.useState(!1),[O,U]=j.useState(!1),[E,L]=j.useState(!0),R=j.useMemo(()=>Zd.find(B=>B.id===s)??Zd[0],[s]);j.useEffect(()=>{n?.accountId&&T()},[n?.accountId]);const T=async()=>{try{const[B,le,ae]=await Promise.all([vo(n.accountId).catch(()=>[]),co(n.accountId).catch(()=>[]),ob(n.accountId).catch(()=>[])]);d(B),m(le),y(ae)}catch{d([]),m([]),y([])}},D=B=>{const{name:le,value:ae}=B.target;l(ge=>({...ge,[le]:ae}))},Y=(B,le)=>{if(le==="internal_obligations")return B;if(le==="sales")return B.filter(ae=>ae.type===1);if(le==="expenses")return B.filter(ae=>ae.type===2);if(le==="receivable")return B.filter(ae=>ae.isAccountReceivable&&Number(ae.balance||0)>0);if(le==="payable")return B.filter(ae=>ae.isAccountPayable&&Number(ae.balance||0)>0);if(le==="cashflow"){const ae=new Map;return B.forEach(ge=>{if(!ge.accountPaymentFormId||!(ge.isIncomingPayment||ge.isOutcomingPayment||ge.type===2))return;const _e=String(ge.accountPaymentFormId),De=ge.account_payment_forms?.name||`#${ge.accountPaymentFormId}`,Te=ge.isIncomingPayment?Math.abs(Number(ge.total||0)):-Math.abs(Number(ge.total||0)),Fe=ae.get(_e)||{id:_e,date:"-",typeLabel:De,total:0,balance:0};Fe.total+=Te,ae.set(_e,Fe)}),Array.from(ae.values())}return B},se=async()=>{if(!(!n?.accountId||!s))try{if(I(!0),s==="budget_execution"){if(!a.budgetId){b(t("reports.budgetRequired"));return}const B=await ub({accountId:n.accountId,budgetId:Number(a.budgetId),dateFrom:a.dateFrom||void 0,dateTo:a.dateTo||void 0});_(B)}else if(s==="project_execution"){if(!a.projectId){b(t("reports.projectRequired"));return}const B=await db({accountId:n.accountId,projectId:Number(a.projectId),dateFrom:a.dateFrom||void 0,dateTo:a.dateTo||void 0});_(B)}else if(s==="internal_obligations"){const B=await oN(n.accountId,{dateFrom:a.dateFrom||void 0,dateTo:a.dateTo||void 0,currencyId:a.currencyId?Number(a.currencyId):void 0});_(Y(B,s))}else{const B=await TN(n.accountId,{dateFrom:a.dateFrom||void 0,dateTo:a.dateTo||void 0}),le=a.currencyId?B.filter(ae=>String(ae.currencyId??"")===a.currencyId):B;_(Y(le,s))}U(!0),L(!1),b("")}catch{b(t("common.genericLoadError"))}finally{I(!1)}},H=j.useMemo(()=>x.map(B=>({...B,typeLabel:s==="budget_execution"||s==="project_execution"?B.conceptName||"-":s==="internal_obligations"?B.name||t("reports.internalObligations"):s==="cashflow"?B.typeLabel||"-":B.type===1?t("reports.sales"):B.type===2?t("reports.expenses"):t("reports.incomes")})),[x,s,t]),J=j.useMemo(()=>["budget_execution","project_execution"].includes(s)?x.reduce((B,le)=>(B.budgeted+=Number(le.budgeted||0),B.executed+=Number(le.executed||0),B.variance+=Number(le.variance||0),B),{budgeted:0,executed:0,variance:0}):null,[x,s]),ee=!["budget_execution","project_execution"].includes(s),he=j.useMemo(()=>{const B=c.find(ge=>String(ge.id)===String(a.currencyId))?.name||t("reports.currencyFilterHint"),le=g.find(ge=>String(ge.id)===String(a.budgetId))?.name||"-",ae=f.find(ge=>String(ge.id)===String(a.projectId))?.name||"-";return[`${t("reports.dateFrom")}: ${dt(a.dateFrom,e)}`,`${t("reports.dateTo")}: ${dt(a.dateTo,e)}`,`${t("reports.currencyFilter")}: ${B}`,`${t("reports.budget")}: ${le}`,`${t("projects.project")}: ${ae}`]},[a,c,g,f,t,e]),Z=j.useMemo(()=>x.reduce((B,le)=>B+Number(le.total||0),0),[x]),oe=j.useMemo(()=>x.reduce((B,le)=>B+Number(le.balance||0),0),[x]),ie=j.useMemo(()=>s!=="sales"?0:x.reduce((B,le)=>B+Number(le.additionalCharges||0),0),[x,s]),W=async()=>{if(!(!n?.accountId||!s||C))try{N(!0);const B=await NN({accountId:n.accountId,reportId:s,dateFrom:a.dateFrom||null,dateTo:a.dateTo||null,currencyId:a.currencyId?Number(a.currencyId):null,budgetId:a.budgetId?Number(a.budgetId):null,projectId:a.projectId?Number(a.projectId):null});window.open(B.downloadUrl,"_blank","noopener,noreferrer"),b("")}catch(B){b(B?.message||t("common.genericLoadError"))}finally{N(!1)}};return u.jsxs("div",{className:"module-page",children:[u.jsx("h1",{children:t("reports.title")}),S&&u.jsx("p",{className:"error-text",children:S}),E&&u.jsxs("div",{className:"grid-2",children:[u.jsxs("section",{className:"generic-panel",children:[u.jsx("h3",{children:t("reports.availableReports")}),u.jsx("div",{className:"reports-list",role:"listbox","aria-label":t("reports.availableReports"),children:Zd.map(B=>u.jsx("button",{type:"button",className:`reports-list-item ${s===B.id?"active":""}`,"aria-selected":s===B.id,onClick:()=>r(B.id),children:t(B.titleKey)},B.id))})]}),u.jsxs("section",{className:"generic-panel",children:[u.jsx("h3",{children:t("reports.applicableFilters")}),u.jsxs("div",{className:"form-grid-2",children:[R.filters.includes("dateRange")&&u.jsxs(u.Fragment,{children:[u.jsxs("label",{className:"field-block",children:[u.jsx("span",{children:t("reports.dateFrom")}),u.jsx("input",{type:"date",name:"dateFrom",value:a.dateFrom,onChange:D})]}),u.jsxs("label",{className:"field-block",children:[u.jsx("span",{children:t("reports.dateTo")}),u.jsx("input",{type:"date",name:"dateTo",value:a.dateTo,onChange:D})]})]}),R.filters.includes("currency")&&u.jsxs("label",{className:"field-block form-span-2",children:[u.jsx("span",{children:t("reports.currencyFilter")}),u.jsxs("select",{name:"currencyId",value:a.currencyId,onChange:D,children:[u.jsx("option",{value:"",children:`-- ${t("reports.currencyFilterHint")} --`}),c.map(B=>u.jsxs("option",{value:B.id,children:[B.name," (",B.symbol,")"]},B.id))]})]}),R.filters.includes("budget")&&u.jsxs("label",{className:"field-block form-span-2",children:[u.jsx("span",{children:t("reports.budget")}),u.jsxs("select",{name:"budgetId",value:a.budgetId,onChange:D,children:[u.jsx("option",{value:"",children:`-- ${t("reports.selectBudget")} --`}),g.map(B=>u.jsx("option",{value:B.id,children:B.name},B.id))]})]}),R.filters.includes("project")&&u.jsxs("label",{className:"field-block form-span-2",children:[u.jsx("span",{children:t("projects.project")}),u.jsxs("select",{name:"projectId",value:a.projectId,onChange:D,children:[u.jsx("option",{value:"",children:`-- ${t("reports.selectProject")} --`}),f.map(B=>u.jsx("option",{value:B.id,children:B.name},B.id))]})]})]})]})]}),u.jsx("div",{className:"actions-menu",children:u.jsx("div",{className:"actions-primary",children:!O||E?u.jsx("button",{type:"button",className:"action-btn main",disabled:!s||k,onClick:se,children:t("reports.run")}):u.jsxs(u.Fragment,{children:[u.jsx("button",{type:"button",className:"action-btn",onClick:()=>L(!0),children:t("reports.changeReportFilters")}),ee?u.jsx("button",{type:"button",className:"action-btn",onClick:W,disabled:C,children:t(C?"common.loading":"reports.exportExcel")}):null]})})}),O&&!E&&u.jsxs("section",{className:"generic-panel",children:[u.jsx("h3",{children:t(R.titleKey)}),he.map(B=>u.jsx("p",{children:B},B)),u.jsxs("p",{children:[t("reports.totalRecords"),":"," ",Ie(x.length,{minimumFractionDigits:0,maximumFractionDigits:0})]}),J?u.jsxs("p",{children:[t("budgets.totalBudget"),": ",Ie(J.budgeted)," | ",t("reports.executed"),": ",Ie(J.executed)," | ",t("reports.variance"),": ",Ie(J.variance)]}):u.jsxs(u.Fragment,{children:[u.jsxs("p",{children:[t("transactions.total"),": ",Ie(Z)]}),s==="sales"?u.jsxs("p",{children:[t("transactions.additionalCharges"),": ",Ie(ie)]}):null,(s==="receivable"||s==="payable"||s==="internal_obligations"||s==="cashflow")&&u.jsxs("p",{children:[t("transactions.balance"),": ",Ie(oe)]})]}),u.jsxs("table",{className:"crud-table",children:[u.jsx("thead",{children:J?u.jsxs("tr",{children:[u.jsx("th",{children:t("transactions.concept")}),u.jsx("th",{children:t("budgets.budgetAmount")}),u.jsx("th",{children:t("reports.executed")}),u.jsx("th",{children:t("reports.variance")})]}):u.jsxs("tr",{children:[u.jsx("th",{children:"ID"}),u.jsx("th",{children:t("transactions.date")}),u.jsx("th",{children:t("common.type")}),u.jsx("th",{children:t("transactions.total")}),u.jsx("th",{children:t("transactions.balance")})]})}),u.jsx("tbody",{children:H.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:J?4:5,children:t("common.empty")})}):J?H.map(B=>u.jsxs("tr",{children:[u.jsx("td",{children:B.typeLabel}),u.jsx("td",{children:Ie(B.budgeted||0)}),u.jsx("td",{children:Ie(B.executed||0)}),u.jsx("td",{children:Ie(B.variance||0)})]},`${s}-${B.id}`)):H.map(B=>u.jsxs("tr",{children:[u.jsx("td",{children:B.id}),u.jsx("td",{children:dt(B.date,e)}),u.jsx("td",{children:B.typeLabel}),u.jsx("td",{children:Ie(B.total||0)}),u.jsx("td",{children:Ie(B.balance||0)})]},`${s}-${B.id}-${B.date}`))})]})]})]})}const ff='id, name, "isSystemAdmin", "canCreateUsers", "canCreateProfiles", "canVoidTransactions", permissions';async function hb(t){const{data:e,error:n}=await G.from("account_profiles").select(ff).eq("accountId",t).order("id",{ascending:!1});if(n)throw n;return e??[]}async function ON(t){const{data:e,error:n}=await G.from("account_profiles").insert(t).select(ff).single();if(n)throw n;return e}async function RN(t,e){const{data:n,error:s}=await G.from("account_profiles").update(e).eq("id",t).select(ff).single();if(s)throw s;return n}async function MN(t){const{data:e,error:n}=await G.from("users_to_profiles").select('id, "userId", "profileId", account_profiles(name)').eq("accountId",t).order("id",{ascending:!1});if(n)throw n;return e??[]}async function LN({accountId:t,userId:e,profileId:n}){const{error:s}=await G.from("users_to_profiles").delete().eq("accountId",t).eq("userId",e);if(s)throw s;const{error:r}=await G.from("users_to_profiles").insert({accountId:t,userId:e,profileId:n});if(r)throw r}async function DN(t,e){const{data:n,error:s}=await G.from("users_to_profiles").select('id, "profileId", account_profiles(id, name, "isSystemAdmin")').eq("accountId",t).eq("userId",e).maybeSingle();if(s)throw s;return n}const eh=10,Ql={name:"",canCreateUsers:!1,canCreateProfiles:!1,canVoidTransactions:!1,permissions:{transactions:{read:!0,create:!1,update:!1},concepts:{read:!0,create:!1,update:!1},clients:{read:!0,create:!1,update:!1},providers:{read:!0,create:!1,update:!1}}};function _v(t){return JSON.parse(JSON.stringify(t??Ql.permissions))}function FN(){const{t}=Ee(),{account:e,user:n}=Oe(),[s,r]=j.useState([]),[a,l]=j.useState(""),[c,d]=j.useState(1),[f,m]=j.useState(null),[g,y]=j.useState(!1),[x,_]=j.useState(Ql);j.useEffect(()=>{e?.accountId&&I()},[e?.accountId]);const S=j.useMemo(()=>{const T=(c-1)*eh;return s.slice(T,T+eh)},[s,c]),b=["transactions","concepts","clients","providers"],k=["read","create","update"],I=async()=>{try{const T=await hb(e.accountId);r(T),l(""),d(1)}catch{l(t("common.genericLoadError"))}},C=()=>{m(null),_(Ql),y(!1)},N=()=>{m(null),_(Ql),y(!0)},O=T=>{m(T.id),_({name:T.name,canCreateUsers:!!T.canCreateUsers,canCreateProfiles:!!T.canCreateProfiles,canVoidTransactions:!!T.canVoidTransactions,permissions:_v(T.permissions)}),y(!0)},U=T=>{m(null),_({name:`${T.name} (copy)`,canCreateUsers:!!T.canCreateUsers,canCreateProfiles:!!T.canCreateProfiles,canVoidTransactions:!!T.canVoidTransactions,permissions:_v(T.permissions)}),y(!0)},E=T=>{const{name:D,value:Y,type:se,checked:H}=T.target;_(J=>({...J,[D]:se==="checkbox"?H:Y}))},L=(T,D,Y)=>{_(se=>({...se,permissions:{...se.permissions,[T]:{...se.permissions[T],[D]:Y}}}))},R=async T=>{if(T.preventDefault(),l(""),!T.currentTarget.checkValidity()){T.currentTarget.reportValidity(),l(t("common.requiredFields"));return}if(!e?.accountId||!n?.id){l(t("common.requiredFields"));return}const D={accountId:e.accountId,name:x.name.trim(),canCreateUsers:x.canCreateUsers,canCreateProfiles:x.canCreateProfiles,canVoidTransactions:x.canVoidTransactions,permissions:x.permissions,createdById:n.id};try{f?await RN(f,D):await ON(D),C(),await I()}catch{l(t("common.genericSaveError"))}};return u.jsxs("div",{className:"module-page",children:[u.jsxs("div",{className:"page-header-row",children:[u.jsx("h1",{children:t("profiles.title")}),u.jsx("button",{type:"button",className:"button-link-primary",onClick:N,children:t("profiles.newProfile")})]}),a&&u.jsx("p",{className:"error-text",children:a}),u.jsxs("table",{className:"crud-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:t("common.name")}),u.jsx("th",{children:t("profiles.canCreateUsers")}),u.jsx("th",{children:t("profiles.canCreateProfiles")}),u.jsx("th",{children:t("profiles.canVoidTransactions")}),u.jsx("th",{children:t("common.actions")})]})}),u.jsx("tbody",{children:S.map(T=>u.jsxs("tr",{children:[u.jsx("td",{children:T.name}),u.jsx("td",{children:T.canCreateUsers?t("common.yes"):t("common.no")}),u.jsx("td",{children:T.canCreateProfiles?t("common.yes"):t("common.no")}),u.jsx("td",{children:T.canVoidTransactions?t("common.yes"):t("common.no")}),u.jsx("td",{className:"table-actions",children:u.jsx(En,{actions:[{key:"edit",label:t("common.edit"),onClick:()=>O(T)},{key:"duplicate",label:t("profiles.duplicate"),onClick:()=>U(T)}]})})]},T.id))})]}),u.jsx(qn,{page:c,pageSize:eh,totalItems:s.length,onPageChange:d}),g&&u.jsxs("form",{className:"crud-form",onSubmit:R,children:[u.jsx("h3",{children:t(f?"profiles.editProfile":"profiles.createProfile")}),u.jsxs("div",{className:"form-grid-2",children:[u.jsxs("label",{className:"field-block form-span-2",children:[u.jsx("span",{children:t("common.name")}),u.jsx("input",{name:"name",placeholder:t("common.name"),value:x.name,onChange:E,required:!0})]}),u.jsxs("label",{className:"checkbox-field",children:[u.jsx("input",{type:"checkbox",name:"canCreateUsers",checked:x.canCreateUsers,onChange:E}),t("profiles.canCreateUsers")]}),u.jsxs("label",{className:"checkbox-field",children:[u.jsx("input",{type:"checkbox",name:"canCreateProfiles",checked:x.canCreateProfiles,onChange:E}),t("profiles.canCreateProfiles")]}),u.jsxs("label",{className:"checkbox-field form-span-2",children:[u.jsx("input",{type:"checkbox",name:"canVoidTransactions",checked:x.canVoidTransactions,onChange:E}),t("profiles.canVoidTransactions")]})]}),u.jsxs("table",{className:"crud-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:t("profiles.module")}),u.jsx("th",{children:t("profiles.read")}),u.jsx("th",{children:t("profiles.write")}),u.jsx("th",{children:t("profiles.update")})]})}),u.jsx("tbody",{children:b.map(T=>u.jsxs("tr",{children:[u.jsx("td",{children:t(`profiles.modules.${T}`)}),k.map(D=>u.jsx("td",{children:u.jsx("input",{type:"checkbox",checked:!!x.permissions?.[T]?.[D],onChange:Y=>L(T,D,Y.target.checked)})},D))]},T))})]}),u.jsxs("div",{className:"crud-form-actions",children:[u.jsx("button",{type:"submit",children:t(f?"common.update":"common.create")}),u.jsx("button",{type:"button",className:"button-secondary",onClick:C,children:t("common.cancel")})]})]})]})}async function BN(t){let{data:{session:e}}=await G.auth.getSession();if(e?.access_token||(e=(await G.auth.refreshSession()).data.session),!e?.access_token)throw new Error("Missing auth session for list users request.");const{data:n,error:s}=await G.functions.invoke("list-account-users",{body:{accountId:t},headers:{Authorization:`Bearer ${e.access_token}`}});if(s)throw new Error(`List users function error: ${s.message??"unknown error"}`);if(n?.success===!1)throw new Error(`List users failed: ${n.error??"unknown function error"}`);return n?.users??[]}async function $N(t){const{data:e,error:n}=await G.from("account_user_invitations").select('id, email, status, "profileId", "created_at", "expiresAt", account_profiles(name)').eq("accountId",t).order("id",{ascending:!1});if(n)throw n;return e??[]}async function zN(t){let{data:{session:e}}=await G.auth.getSession();if(e?.access_token||(e=(await G.auth.refreshSession()).data.session),!e?.access_token)throw new Error("Missing auth session for invitation request.");const{data:n,error:s}=await G.functions.invoke("send-invitation",{body:t,headers:{Authorization:`Bearer ${e.access_token}`}});if(s)throw new Error(`Invitation function error: ${s.message??"unknown error"}`);if(n?.success===!1)throw new Error(`Invitation failed: ${n.error??"unknown function error"}`);return n}async function UN(t){let{data:{session:e}}=await G.auth.getSession();if(e?.access_token||(e=(await G.auth.refreshSession()).data.session),!e?.access_token)throw new Error("Missing auth session for invitation resend request.");const{data:n,error:s}=await G.functions.invoke("send-invitation",{body:t,headers:{Authorization:`Bearer ${e.access_token}`}});if(s)throw new Error(`Invitation resend function error: ${s.message??"unknown error"}`);if(n?.success===!1)throw new Error(`Invitation resend failed: ${n.error??"unknown function error"}`);return n}async function WN(t){let{data:{session:e}}=await G.auth.getSession();if(e?.access_token||(e=(await G.auth.refreshSession()).data.session),!e?.access_token)throw new Error("Missing auth session for deactivate user request.");const{data:n,error:s}=await G.functions.invoke("deactivate-account-user",{body:t,headers:{Authorization:`Bearer ${e.access_token}`}});if(s)throw new Error(`Deactivate user function error: ${s.message??"unknown error"}`);if(n?.success===!1)throw new Error(`Deactivate user failed: ${n.error??"unknown function error"}`);return n}function VN(){const{t,language:e}=Ee(),{account:n,user:s}=Oe(),[r,a]=j.useState([]),[l,c]=j.useState([]),[d,f]=j.useState([]),[m,g]=j.useState([]),[y,x]=j.useState({email:"",profileId:""}),[_,S]=j.useState(""),[b,k]=j.useState("");j.useEffect(()=>{n?.accountId&&I()},[n?.accountId]),j.useEffect(()=>{if(!b)return;const R=window.setTimeout(()=>k(""),3200);return()=>window.clearTimeout(R)},[b]);const I=async()=>{try{const[R,T,D,Y]=await Promise.all([BN(n.accountId),hb(n.accountId),MN(n.accountId),$N(n.accountId)]);a(R),c(T),f(D),g(Y),await Kh({accountId:n.accountId}).catch(()=>null),S("")}catch{S(t("common.genericLoadError"))}},C=R=>{const T=d.find(D=>D.userId===R);return T?.profileId?String(T.profileId):""},N=async(R,T)=>{try{if(!T)return;await LN({accountId:n.accountId,userId:R,profileId:Number(T)}),await I()}catch(D){console.error("Invitation error",D),S(D?.message||t("common.genericSaveError"))}},O=R=>{const{name:T,value:D}=R.target;x(Y=>({...Y,[T]:D}))},U=async R=>{if(R.preventDefault(),S(""),!R.currentTarget.checkValidity()){R.currentTarget.reportValidity(),S(t("common.requiredFields"));return}if(!y.email||!y.profileId||!n?.accountId||!s?.id){S(t("common.requiredFields"));return}try{const T=y.email.trim().toLowerCase();if(m.some(Y=>(Y.email||"").toLowerCase()===T&&Y.status==="sent"&&(!Y.expiresAt||new Date(Y.expiresAt).getTime()>Date.now()))){S(t("admin.activeInvitationExists"));return}await zN({accountId:n.accountId,email:T,profileId:Number(y.profileId),appUrl:window.location.origin}),x({email:"",profileId:""}),k(t("admin.invitationSent")),await I()}catch(T){S(T?.message||t("common.genericSaveError"))}},E=async R=>{if(!(!n?.accountId||!R))try{S(""),await UN({accountId:n.accountId,resendInvitationId:R,appUrl:window.location.origin}),k(t("admin.invitationResent")),await I()}catch(T){S(T?.message||t("common.genericSaveError"))}},L=async R=>{if(!(!n?.accountId||!R))try{await WN({accountId:n.accountId,userId:R}),await I()}catch(T){S(T?.message||t("common.genericSaveError"))}};return u.jsxs("div",{className:"module-page",children:[u.jsx("h1",{children:t("admin.title")}),_&&u.jsx("p",{className:"error-text",children:_}),b&&u.jsx("div",{className:"app-toast",children:b}),u.jsxs("form",{className:"crud-form",onSubmit:U,children:[u.jsx("h3",{children:t("admin.inviteUser")}),u.jsxs("div",{className:"form-grid-2",children:[u.jsx(nt,{label:t("common.email"),name:"email",type:"email",placeholder:t("common.email"),value:y.email,onChange:O,required:!0}),u.jsxs(mn,{label:t("admin.profile"),name:"profileId",value:y.profileId,onChange:O,required:!0,children:[u.jsx("option",{value:"",children:`-- ${t("admin.selectProfile")} --`}),l.map(R=>u.jsx("option",{value:R.id,children:R.name},R.id))]})]}),u.jsx("div",{className:"crud-form-actions",children:u.jsx("button",{type:"submit",children:t("admin.createInvite")})})]}),u.jsxs("table",{className:"crud-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:t("common.email")}),u.jsx("th",{children:t("admin.userId")}),u.jsx("th",{children:t("admin.profile")}),u.jsx("th",{children:t("common.actions")})]})}),u.jsx("tbody",{children:r.map(R=>u.jsxs("tr",{children:[u.jsx("td",{children:R.email??"-"}),u.jsx("td",{children:R.userId}),u.jsx("td",{children:u.jsxs("select",{value:C(R.userId),onChange:T=>N(R.userId,T.target.value),children:[u.jsx("option",{value:"",children:`-- ${t("admin.selectProfile")} --`}),l.map(T=>u.jsx("option",{value:T.id,children:T.name},T.id))]})}),u.jsx("td",{children:R.userId===s?.id?"-":u.jsx("button",{type:"button",className:"button-danger",onClick:()=>L(R.userId),children:t("admin.deactivateUser")})})]},R.userId))})]}),u.jsxs("table",{className:"crud-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:t("common.email")}),u.jsx("th",{children:t("admin.profile")}),u.jsx("th",{children:t("admin.status")}),u.jsx("th",{children:t("admin.expiresAt")}),u.jsx("th",{children:t("common.actions")})]})}),u.jsx("tbody",{children:m.map(R=>u.jsxs("tr",{children:[u.jsx("td",{children:R.email}),u.jsx("td",{children:R.account_profiles?.name??"-"}),u.jsx("td",{children:R.status}),u.jsx("td",{children:qh(R.expiresAt,e)}),u.jsx("td",{children:R.status==="sent"?u.jsx("button",{type:"button",className:"button-secondary",onClick:()=>E(R.id),children:t("admin.resendInvite")}):"-"})]},R.id))})]})]})}const Gl=[{path:"/account/billing",key:"accountManage.billing",icon:fh},{path:"/account/users",key:"accountManage.users",icon:V_},{path:"/account/profiles",key:"accountManage.profiles",icon:$_},{path:"/account/invitations",key:"accountManage.invitations",icon:M_},{path:"/account/settings",key:"accountManage.settings",icon:B_}];function qN(){const{t}=Ee(),{account:e}=Oe(),{pathname:n}=Wn(),[s,r]=j.useState(window.matchMedia("(max-width: 980px)").matches),[a,l]=j.useState(!1),c=j.useRef(null),d=j.useMemo(()=>Gl.find(g=>n.startsWith(g.path))??Gl[0],[n]),f=s?[d]:Gl,m=s?Gl.filter(g=>g.path!==d.path):[];return j.useEffect(()=>{const g=()=>{const y=window.matchMedia("(max-width: 980px)").matches;if(!y&&c.current){const x=c.current.scrollWidth>c.current.clientWidth+2;r(x)}else r(y)};return g(),window.addEventListener("resize",g),()=>window.removeEventListener("resize",g)},[]),j.useEffect(()=>{const g=()=>l(!1);return window.addEventListener("click",g),()=>window.removeEventListener("click",g)},[]),e&&!e.isOriginalAccount?u.jsx(js,{to:"/",replace:!0}):u.jsx("div",{className:"account-manage-shell",children:u.jsxs("section",{className:"account-manage-content",children:[u.jsxs("nav",{className:"app-menu account-app-menu",children:[u.jsx("div",{className:"app-menu-primary",ref:c,children:f.map(g=>u.jsx(Fa,{to:g.path,className:({isActive:y})=>`app-menu-entry ${y?"active":""}`,children:t(g.key)},g.path))}),m.length>0?u.jsxs("div",{className:"account-menu-overflow-wrap",onClick:g=>g.stopPropagation(),children:[u.jsx("button",{type:"button",className:"action-btn overflow-trigger-btn",onClick:()=>l(g=>!g),children:t("common.more")}),a?u.jsx("div",{className:"account-menu-overflow-dropdown",children:m.map(g=>u.jsx(Fa,{to:g.path,className:({isActive:y})=>`panel-action ${y?"active":""}`,onClick:()=>l(!1),children:t(g.key)},g.path))}):null]}):null]}),u.jsx("div",{className:"workspace-body single-column",children:u.jsx("section",{className:"generic-panel",children:u.jsx(ch,{})})})]})})}const HN={name:"",email:"",phone:"",address:"",reportRetentionDays:30};function KN(){const{t}=Ee(),{account:e,user:n}=Oe(),[s,r]=j.useState(HN),[a,l]=j.useState(!1),[c,d]=j.useState(!0),[f,m]=j.useState(""),[g,y]=j.useState("");j.useEffect(()=>{!e?.accountId||!n?.id||x()},[e?.accountId,n?.id]);const x=async()=>{try{d(!0);const[b,k]=await Promise.all([Nj(e.accountId),DN(e.accountId,n.id)]);r({name:b.name??"",email:b.email??"",phone:b.phone??"",address:b.address??"",reportRetentionDays:Number(b.reportRetentionDays??30)}),l(!!k?.account_profiles?.isSystemAdmin),m(""),y("")}catch{m(t("common.genericLoadError"))}finally{d(!1)}},_=b=>{const{name:k,value:I}=b.target;r(C=>({...C,[k]:k==="reportRetentionDays"?Number(I||1):I}))},S=async b=>{if(b.preventDefault(),m(""),!b.currentTarget.checkValidity()){b.currentTarget.reportValidity(),m(t("common.requiredFields"));return}if(!e?.accountId||!a){m(t("common.requiredFields"));return}try{await Aj(e.accountId,{name:s.name.trim(),email:s.email.trim()||null,phone:s.phone.trim()||null,address:s.address.trim()||null,reportRetentionDays:Math.max(1,Number(s.reportRetentionDays||30))}),y(t("accountManage.accountSaved")),m("")}catch{m(t("common.genericSaveError"))}};return c?u.jsx("p",{children:t("common.loading")}):u.jsxs("div",{className:"module-page",children:[u.jsx("h1",{children:t("accountManage.accountSettingsTitle")}),!a&&u.jsx("p",{className:"error-text",children:t("accountManage.adminOnly")}),f&&u.jsx("p",{className:"error-text",children:f}),g&&u.jsx("p",{className:"success-text",children:g}),u.jsxs("form",{className:"crud-form",onSubmit:S,children:[u.jsxs("div",{className:"form-grid-2",children:[u.jsx(nt,{label:t("common.name"),name:"name",value:s.name,onChange:_,disabled:!a,required:!0}),u.jsx(nt,{label:t("common.email"),name:"email",type:"email",value:s.email,onChange:_,disabled:!a}),u.jsx(nt,{label:t("common.phone"),name:"phone",value:s.phone,onChange:_,disabled:!a}),u.jsx(nt,{label:t("common.address"),name:"address",value:s.address,onChange:_,disabled:!a}),u.jsxs(mo,{label:t("accountManage.reportRetentionDays"),children:[u.jsx("input",{type:"number",name:"reportRetentionDays",min:1,max:3650,value:s.reportRetentionDays,onChange:_,disabled:!a}),u.jsx("small",{children:t("accountManage.reportRetentionHint")})]})]}),u.jsx("div",{className:"crud-form-actions",children:u.jsx("button",{type:"submit",disabled:!a,children:t("common.save")})})]})]})}function GN(){const{t,language:e}=Ee(),{account:n}=Oe(),[s,r]=j.useState(""),[a,l]=j.useState(""),[c,d]=j.useState(!1),f=j.useMemo(()=>{if(!n?.trialEndsAt)return 0;const _=new Date(n.trialEndsAt).getTime()-Date.now();return Math.max(0,Math.ceil(_/(1e3*60*60*24)))},[n?.trialEndsAt]),m=n?.billingStatus==="active"||n?.billingStatus==="past_due"||n?.billingStatus==="incomplete",g=async()=>{if(n?.accountId)try{d(!0),r(""),l("");const _=await Jj({accountId:n.accountId,appUrl:window.location.origin});window.location.href=_.url}catch(_){r(_?.message||t("common.genericLoadError")),d(!1)}},y=async()=>{if(n?.accountId)try{d(!0),r(""),l("");const _=await Xj({accountId:n.accountId,appUrl:window.location.origin});window.location.href=_.url}catch(_){r(_?.message||t("common.genericLoadError")),d(!1)}},x=async()=>{if(n?.accountId)try{d(!0),r(""),l("");const _=await Kh({accountId:n.accountId});if(_?.requiresApproval&&_?.url){window.location.href=_.url;return}l(t("billing.seatsSynced"))}catch(_){r(_?.message||t("common.genericSaveError"))}finally{d(!1)}};return u.jsxs("div",{className:"module-page",children:[u.jsx("h1",{children:t("billing.title")}),u.jsx("p",{children:t("billing.description")}),u.jsx("p",{children:t("billing.priceHint")}),u.jsxs("p",{children:[t("billing.status"),": ",u.jsx("strong",{children:n?.billingStatus||"-"})]}),u.jsxs("p",{children:[t("billing.trialEndsAt"),": ",u.jsx("strong",{children:qh(n?.trialEndsAt,e)})]}),u.jsxs("p",{children:[t("billing.trialDaysLeft"),": ",u.jsx("strong",{children:f})]}),s&&u.jsx("p",{className:"error-text",children:s}),a&&u.jsx("p",{children:a}),u.jsxs("div",{className:"crud-form-actions",children:[u.jsx("button",{type:"button",className:"button-link-primary",onClick:g,disabled:c,children:t("billing.startMembership")}),u.jsx("button",{type:"button",className:"button-secondary",onClick:y,disabled:c||!m,children:t("billing.manageSubscription")}),u.jsx("button",{type:"button",className:"button-secondary",onClick:x,disabled:c,children:t("billing.syncSeats")})]}),u.jsx("p",{children:t("billing.paypalManageHint")})]})}function YN(){const{t,language:e}=Ee(),{refreshAccounts:n,switchAccount:s}=Oe(),[r,a]=j.useState([]),[l,c]=j.useState(!0),[d,f]=j.useState(""),[m,g]=j.useState("");j.useEffect(()=>{y()},[]);const y=async()=>{try{c(!0);const _=await sx();a(_),f("")}catch{a([]),f(t("common.genericLoadError"))}finally{c(!1)}},x=async(_,S)=>{try{const b=await nx({invitationId:Number(_),email:(S||"").toLowerCase()});await n?.(),b?.accountId&&s?.(Number(b.accountId)),g(t("accountManage.invitationAccepted")),f(""),await y()}catch{f(t("common.genericSaveError"))}};return u.jsxs("div",{className:"module-page",children:[u.jsx("h1",{children:t("accountManage.pendingInvitationsTitle")}),m&&u.jsx("p",{className:"success-text",children:m}),d&&u.jsx("p",{className:"error-text",children:d}),l?u.jsx("p",{children:t("common.loading")}):u.jsxs("table",{className:"crud-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:t("common.account")}),u.jsx("th",{children:t("admin.profile")}),u.jsx("th",{children:t("admin.expiresAt")}),u.jsx("th",{children:t("common.actions")})]})}),u.jsx("tbody",{children:r.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:4,children:t("common.empty")})}):r.map(_=>u.jsxs("tr",{children:[u.jsx("td",{children:_.accounts?.name??`${t("topbar.currentAccount")} #${_.accountId}`}),u.jsx("td",{children:_.account_profiles?.name??"-"}),u.jsx("td",{children:qh(_.expiresAt,e)}),u.jsx("td",{children:u.jsx("button",{type:"button",className:"button-link-primary",onClick:()=>x(_.id,_.email),children:t("accountManage.acceptInvitation")})})]},_.id))})]})]})}const th=10;function JN(){const{t}=Ee(),{account:e}=Oe(),[n,s]=j.useState([]),[r,a]=j.useState(""),[l,c]=j.useState(!0),[d,f]=j.useState(1),[m,g]=as(),y=m.get("create")==="1";j.useEffect(()=>{e?.accountId&&_()},[e?.accountId]);const x=j.useMemo(()=>{const b=(d-1)*th;return n.slice(b,b+th)},[n,d]),_=async()=>{try{c(!0);const b=await fr(e.accountId);s(b),a(""),f(1)}catch{a(t("common.genericLoadError"))}finally{c(!1)}},S=async b=>{try{await KT(b),await _()}catch{a(t("common.genericSaveError"))}};return u.jsxs("div",{className:"module-page",children:[u.jsx("h1",{children:t("paymentForms.title")}),r&&u.jsx("p",{className:"error-text",children:r}),l?u.jsx("p",{children:t("common.loading")}):n.length===0?u.jsx("p",{children:t("common.empty")}):u.jsxs(u.Fragment,{children:[u.jsxs("table",{className:"crud-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:t("common.name")}),u.jsx("th",{children:t("paymentForms.kind")}),u.jsx("th",{children:t("paymentForms.provider")}),u.jsx("th",{children:t("paymentForms.reference")}),u.jsx("th",{children:t("paymentForms.createInternalPayableOnOutgoingPaymentShort")}),u.jsx("th",{children:t("common.actions")})]})}),u.jsx("tbody",{children:x.map(b=>u.jsxs("tr",{children:[u.jsx("td",{children:b.name}),u.jsx("td",{children:t(`paymentForms.kinds.${b.kind}`)}),u.jsx("td",{children:b.provider||"-"}),u.jsx("td",{children:b.reference||"-"}),u.jsx("td",{children:b.createInternalPayableOnOutgoingPayment?t("common.yes"):t("common.no")}),u.jsx("td",{className:"table-actions",children:u.jsx(En,{actions:[{key:"edit",label:t("common.edit"),to:`/payment-forms/${b.id}/edit`},{key:"delete",label:t("common.delete"),onClick:()=>S(b.id),danger:!0}]})})]},b.id))})]}),u.jsx(qn,{page:d,pageSize:th,totalItems:n.length,onPageChange:f})]}),y?u.jsx("div",{className:"modal-backdrop",onClick:()=>{const b=new URLSearchParams(m);b.delete("create"),g(b)},children:u.jsx("div",{className:"modal-card",onClick:b=>b.stopPropagation(),children:u.jsx(gc,{embedded:!0,onCancel:()=>{const b=new URLSearchParams(m);b.delete("create"),g(b)},onCreated:async()=>{await _();const b=new URLSearchParams(m);b.delete("create"),g(b)}})})}):null]})}function Sv(t){return Number(t.total||0)}function XN(){const{t,language:e}=Ee(),{account:n}=Oe(),[s,r]=j.useState([]),[a,l]=j.useState(""),[c,d]=j.useState(new Date(new Date().setDate(1)).toISOString().slice(0,10)),[f,m]=j.useState(new Date().toISOString().slice(0,10)),[g,y]=j.useState(new Date().toISOString().slice(0,10)),[x,_]=j.useState([]),[S,b]=j.useState("");j.useEffect(()=>{n?.accountId&&k()},[n?.accountId]),j.useEffect(()=>{!n?.accountId||!a||I()},[n?.accountId,a]);const k=async()=>{try{const D=(await fr(n.accountId)).filter(Y=>Y.kind==="bank_account");r(D),D[0]&&l(String(D[0].id)),b("")}catch{b(t("common.genericLoadError"))}},I=async()=>{try{const T=await tN({accountId:n.accountId,accountPaymentFormId:Number(a)});_(T),b("")}catch{b(t("common.genericLoadError"))}},C=j.useMemo(()=>x.filter(T=>T.isActive!==!1),[x]),N=j.useMemo(()=>{const T=new Date(`${c}T00:00:00.000Z`),D=new Date(`${f}T23:59:59.999Z`);return C.filter(Y=>{const se=new Date(`${Y.date}T00:00:00.000Z`);return se>=T&&se<=D}).reduce((Y,se)=>Y+Sv(se),0)},[C,c,f]),O=j.useMemo(()=>C.filter(T=>T.isReconciled&&T.reconciledAt&&T.reconciledAt<c).reduce((T,D)=>T+Sv(D),0),[C,c]),U=j.useMemo(()=>O+N,[O,N]),E=j.useMemo(()=>{const T=new Date(`${c}T00:00:00.000Z`),D=new Date(`${f}T23:59:59.999Z`);return C.filter(Y=>{const se=new Date(`${Y.date}T00:00:00.000Z`);return se>=T&&se<=D})},[C,c,f]),L=async T=>{try{await nN(T,g),await I()}catch{b(t("common.genericSaveError"))}},R=async T=>{try{await sN(T),await I()}catch{b(t("common.genericSaveError"))}};return u.jsxs("div",{className:"module-page",children:[u.jsx("h1",{children:t("reconciliation.title")}),S&&u.jsx("p",{className:"error-text",children:S}),u.jsxs("section",{className:"generic-panel",children:[u.jsxs("div",{className:"form-grid-2",children:[u.jsxs("label",{className:"field-block form-span-2",children:[u.jsx("span",{children:t("reconciliation.bankAccount")}),u.jsxs("select",{value:a,onChange:T=>l(T.target.value),children:[u.jsx("option",{value:"",children:`-- ${t("transactions.selectAccountPaymentForm")} --`}),s.map(T=>u.jsx("option",{value:T.id,children:pn(T)},T.id))]})]}),u.jsxs("label",{className:"field-block",children:[u.jsx("span",{children:t("reports.dateFrom")}),u.jsx("input",{type:"date",value:c,onChange:T=>d(T.target.value)})]}),u.jsxs("label",{className:"field-block",children:[u.jsx("span",{children:t("reports.dateTo")}),u.jsx("input",{type:"date",value:f,onChange:T=>m(T.target.value)})]}),u.jsxs("label",{className:"field-block form-span-2",children:[u.jsx("span",{children:t("reconciliation.reconcileDate")}),u.jsx("input",{type:"date",value:g,onChange:T=>y(T.target.value)}),u.jsx("small",{children:t("reconciliation.reconcileDateHelp")})]})]}),u.jsxs("p",{children:[t("reconciliation.previousBalance"),": ",u.jsx("strong",{children:Ie(O)})]}),u.jsxs("p",{children:[t("reconciliation.currentBalance"),": ",u.jsx("strong",{children:Ie(U)})]}),u.jsxs("p",{children:[t("reconciliation.periodMovementsSum"),": ",u.jsx("strong",{children:Ie(N)})]})]}),u.jsxs("table",{className:"crud-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"ID"}),u.jsx("th",{children:t("transactions.date")}),u.jsx("th",{children:t("transactions.referenceNumber")}),u.jsx("th",{children:t("transactions.total")}),u.jsx("th",{children:t("reconciliation.reconciled")}),u.jsx("th",{children:t("common.actions")})]})}),u.jsx("tbody",{children:E.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:6,children:t("common.empty")})}):E.map(T=>u.jsxs("tr",{children:[u.jsx("td",{children:T.id}),u.jsx("td",{children:dt(T.date,e)}),u.jsx("td",{children:T.referenceNumber||"-"}),u.jsx("td",{children:Ie(T.total)}),u.jsx("td",{children:T.isReconciled?dt(T.reconciledAt,e):"-"}),u.jsxs("td",{className:"table-actions reconciliation-actions",children:[T.isReconciled?null:u.jsx("button",{type:"button",className:"button-secondary",onClick:()=>L(T.id),children:t("reconciliation.reconcile")}),u.jsx(En,{actions:[{key:"change-reconcile-date",label:t("reconciliation.changeReconcileDate"),onClick:()=>L(T.id),disabled:!T.isReconciled},{key:"unreconcile",label:t("reconciliation.unreconcile"),onClick:()=>R(T.id),disabled:!T.isReconciled,danger:!0}]})]})]},T.id))})]})]})}const QN={date:new Date().toISOString().slice(0,10),name:"",referenceNumber:"",accountPaymentFormId:"",currencyId:"",total:0};function Dh({embedded:t=!1,onCancel:e,onCreated:n}){const{t:s}=Ee(),{account:r,user:a}=Oe(),l=Ht(),{id:c}=Vn(),d=!t&&!!c,[f,m]=j.useState(QN),[g,y]=j.useState(""),[x,_]=j.useState(d),[S,b]=j.useState(!1),[k,I]=j.useState([]),[C,N]=j.useState([]),[O,U]=j.useState(0);j.useEffect(()=>{r?.accountId&&E()},[r?.accountId]),j.useEffect(()=>{!d||!r?.accountId||L()},[d,c,r?.accountId]);const E=async()=>{try{const[D,Y]=await Promise.all([fr(r.accountId),vo(r.accountId)]);I(D),N(Y);const se=Y.find(H=>H.isLocal)?.id;m(H=>({...H,currencyId:H.currencyId||(se?String(se):"")}))}catch{I([]),N([])}},L=async()=>{try{_(!0);const D=await rb(c);if(!D.isInternalObligation)throw new Error("Not an internal obligation");m({date:D.date||new Date().toISOString().slice(0,10),name:D.name||"",referenceNumber:D.referenceNumber||"",accountPaymentFormId:D.accountPaymentFormId?String(D.accountPaymentFormId):"",currencyId:D.currencyId?String(D.currencyId):"",total:Number(D.total||0)}),U(Number(D.payments||0))}catch{y(s("common.genericLoadError"))}finally{_(!1)}},R=D=>{const{name:Y,value:se}=D.target;m(H=>({...H,[Y]:se}))},T=async D=>{if(D.preventDefault(),y(""),!D.currentTarget.checkValidity()){D.currentTarget.reportValidity(),y(s("common.requiredFields"));return}if(!r?.accountId||!a?.id||!f.currencyId){y(s("common.requiredFields"));return}const Y=Number(f.total||0);if(Y<=0){y(s("transactions.invalidTransactionAmount"));return}if(Y<O){y(s("internalObligations.totalLowerThanPayments"));return}const se={accountId:r.accountId,date:f.date,name:f.name.trim(),referenceNumber:f.referenceNumber.trim()||null,accountPaymentFormId:f.accountPaymentFormId?Number(f.accountPaymentFormId):null,currencyId:Number(f.currencyId),total:Y,payments:O,balance:Math.max(Y-O,0)};try{b(!0);let H=null;if(d?H=await aN(c,se):H=await iN({...se,userId:a.id}),t){n?.(H);return}l("/internal-obligations")}catch{y(s("common.genericSaveError"))}finally{b(!1)}};return u.jsxs("div",{className:t?"":"module-page",children:[t?u.jsx("h3",{children:s(d?"common.edit":"actions.newInternalObligation")}):u.jsxs("div",{className:"page-header-row",children:[u.jsx("h1",{children:s(d?"common.edit":"actions.newInternalObligation")}),u.jsx(st,{to:"/internal-obligations",className:"button-link-secondary",children:s("common.backToList")})]}),g&&u.jsx("p",{className:"error-text",children:g}),x?u.jsx("p",{children:s("common.loading")}):u.jsxs("form",{className:"crud-form",onSubmit:T,children:[u.jsxs("div",{className:"form-grid-2",children:[u.jsx(lo,{label:s("transactions.date"),name:"date",value:f.date,onChange:R,required:!0}),u.jsxs(mn,{label:s("transactions.currency"),name:"currencyId",value:f.currencyId,onChange:R,required:!0,children:[u.jsx("option",{value:"",children:`-- ${s("transactions.selectCurrency")} --`}),C.map(D=>u.jsxs("option",{value:D.id,children:[D.name," (",D.symbol,")"]},D.id))]}),u.jsx(nt,{label:s("common.name"),name:"name",value:f.name,onChange:R,className:"form-span-2",required:!0}),u.jsxs(mn,{label:s("paymentForms.title"),name:"accountPaymentFormId",value:f.accountPaymentFormId,onChange:R,children:[u.jsx("option",{value:"",children:`-- ${s("transactions.selectAccountPaymentForm")} --`}),k.map(D=>u.jsx("option",{value:D.id,children:pn(D)},D.id))]}),u.jsx(nt,{label:s("transactions.referenceNumber"),name:"referenceNumber",value:f.referenceNumber,onChange:R}),u.jsx(Ri,{label:s("transactions.total"),step:"0.01",min:"0",name:"total",value:f.total,onChange:R,required:!0})]}),u.jsxs("div",{className:"crud-form-actions",children:[t?u.jsx("button",{type:"button",className:"button-secondary",onClick:()=>e?.(),children:s("common.cancel")}):null,u.jsx("button",{type:"submit",disabled:S,children:s(d?"common.update":"common.create")})]})]})]})}const nh=10;function ZN(){const{t,language:e}=Ee(),{account:n}=Oe(),[s,r]=j.useState([]),[a,l]=j.useState(""),[c,d]=j.useState(!0),[f,m]=j.useState(1),[g,y]=as(),x=g.get("create")==="1";j.useEffect(()=>{n?.accountId&&S()},[n?.accountId]);const _=j.useMemo(()=>{const k=(f-1)*nh;return s.slice(k,k+nh)},[s,f]),S=async()=>{try{d(!0);const k=await rN(n.accountId);r(k),l(""),m(1)}catch{l(t("common.genericLoadError"))}finally{d(!1)}},b=async k=>{try{await sb(k),await S()}catch{l(t("common.genericSaveError"))}};return u.jsxs("div",{className:"module-page",children:[u.jsx("h1",{children:t("internalObligations.title")}),a&&u.jsx("p",{className:"error-text",children:a}),c?u.jsx("p",{children:t("common.loading")}):s.length===0?u.jsx("p",{children:t("common.empty")}):u.jsxs(u.Fragment,{children:[u.jsxs("table",{className:"crud-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"ID"}),u.jsx("th",{children:t("transactions.date")}),u.jsx("th",{children:t("common.name")}),u.jsx("th",{children:t("paymentForms.kind")}),u.jsx("th",{children:t("transactions.referenceNumber")}),u.jsx("th",{children:t("transactions.total")}),u.jsx("th",{children:t("transactions.balance")}),u.jsx("th",{children:t("common.actions")})]})}),u.jsx("tbody",{children:_.map(k=>u.jsxs("tr",{children:[u.jsx("td",{children:k.id}),u.jsx("td",{children:dt(k.date,e)}),u.jsx("td",{children:k.name}),u.jsx("td",{children:k.account_payment_forms?.name||"-"}),u.jsx("td",{children:k.referenceNumber||"-"}),u.jsx("td",{children:Ie(k.total)}),u.jsx("td",{children:Ie(k.balance)}),u.jsx("td",{className:"table-actions",children:u.jsx(En,{actions:[{key:"edit",label:t("common.edit"),to:`/internal-obligations/${k.id}/edit`},{key:"delete",label:t("common.delete"),onClick:()=>b(k.id),danger:!0}]})})]},k.id))})]}),u.jsx(qn,{page:f,pageSize:nh,totalItems:s.length,onPageChange:m})]}),x?u.jsx("div",{className:"modal-backdrop",onClick:()=>{const k=new URLSearchParams(g);k.delete("create"),y(k)},children:u.jsx("div",{className:"modal-card",onClick:k=>k.stopPropagation(),children:u.jsx(Dh,{embedded:!0,onCancel:()=>{const k=new URLSearchParams(g);k.delete("create"),y(k)},onCreated:async()=>{await S();const k=new URLSearchParams(g);k.delete("create"),y(k)}})})}):null]})}const eA={date:new Date().toISOString().slice(0,10),amount:0,currencyId:"",fromCashFormId:"",toBankFormId:"",referenceNumber:"",description:""};function fb({embedded:t=!1,onCancel:e,onCreated:n}){const{t:s}=Ee(),{account:r,user:a}=Oe(),l=Ht(),[c,d]=j.useState(eA),[f,m]=j.useState([]),[g,y]=j.useState([]),[x,_]=j.useState([]),[S,b]=j.useState([]),[k,I]=j.useState(!1),[C,N]=j.useState(""),O=j.useMemo(()=>f.filter(T=>T.kind==="cashbox"),[f]),U=j.useMemo(()=>f.filter(T=>T.kind==="bank_account"),[f]);j.useEffect(()=>{r?.accountId&&E()},[r?.accountId]);const E=async()=>{try{const[T,D,Y,se]=await Promise.all([fr(r.accountId),vo(r.accountId),oo(r.accountId),Bi(r.accountId)]);m(T),y(D),_(Y),b(se);const H=D.find(J=>J.isLocal)?.id;d(J=>({...J,currencyId:J.currencyId||String(H||"")})),N("")}catch{N(s("common.genericLoadError"))}},L=T=>{const{name:D,value:Y}=T.target;d(se=>({...se,[D]:Y}))},R=async T=>{if(T.preventDefault(),N(""),!T.currentTarget.checkValidity()){T.currentTarget.reportValidity(),N(s("common.requiredFields"));return}if(!r?.accountId||!a?.id||!c.currencyId){N(s("common.requiredFields"));return}const D=Math.abs(Number(c.amount||0));if(!D||!c.fromCashFormId||!c.toBankFormId){N(s("common.requiredFields"));return}const Y=S.find(ee=>ee.isOutgoingPaymentConcept),se=S.find(ee=>ee.isIncomingPaymentConcept),H=x.find(ee=>ee.code==="cash"),J=x.find(ee=>ee.code==="bank_transfer");if(!Y||!se||!H||!J){N(s("transactions.missingSystemPaymentConcept"));return}try{I(!0);const ee=await lN({accountId:r.accountId,userId:a.id,date:c.date,amount:D,currencyId:Number(c.currencyId),referenceNumber:c.referenceNumber,description:c.description,cashPaymentMethodId:H.id,transferPaymentMethodId:J.id,fromCashFormId:Number(c.fromCashFormId),toBankFormId:Number(c.toBankFormId),outgoingConceptId:Y.id,incomingConceptId:se.id});t?n?.(ee):l("/bank-deposits")}catch(ee){N(ee?.message||s("common.genericSaveError"))}finally{I(!1)}};return u.jsxs("div",{className:t?"":"module-page",children:[t?u.jsx("h3",{children:s("actions.newBankDeposit")}):u.jsxs("div",{className:"page-header-row",children:[u.jsx("h1",{children:s("bankDeposits.title")}),u.jsx(st,{to:"/bank-deposits",className:"button-link-secondary",children:s("common.backToList")})]}),C&&u.jsx("p",{className:"error-text",children:C}),u.jsxs("form",{className:"crud-form",onSubmit:R,children:[u.jsxs("div",{className:"form-grid-2",children:[u.jsx(lo,{label:s("transactions.date"),name:"date",value:c.date,onChange:L,required:!0}),u.jsxs(mn,{label:s("transactions.currency"),name:"currencyId",value:c.currencyId,onChange:L,required:!0,children:[u.jsx("option",{value:"",children:`-- ${s("transactions.selectCurrency")} --`}),g.map(T=>u.jsxs("option",{value:T.id,children:[T.name," (",T.symbol,")"]},T.id))]}),u.jsxs(mn,{label:s("bankDeposits.fromCash"),name:"fromCashFormId",value:c.fromCashFormId,onChange:L,required:!0,children:[u.jsx("option",{value:"",children:`-- ${s("transactions.selectAccountPaymentForm")} --`}),O.map(T=>u.jsx("option",{value:T.id,children:pn(T)},T.id))]}),u.jsxs(mn,{label:s("bankDeposits.toBankAccount"),name:"toBankFormId",value:c.toBankFormId,onChange:L,required:!0,children:[u.jsx("option",{value:"",children:`-- ${s("transactions.selectAccountPaymentForm")} --`}),U.map(T=>u.jsx("option",{value:T.id,children:pn(T)},T.id))]}),u.jsx(Ri,{label:s("transactions.amount"),min:"0",step:"0.01",name:"amount",value:c.amount,onChange:L,required:!0}),u.jsx(nt,{label:s("transactions.referenceNumber"),name:"referenceNumber",value:c.referenceNumber,onChange:L}),u.jsx(nt,{label:s("transactions.description"),name:"description",value:c.description,onChange:L,className:"form-span-2"})]}),u.jsxs("div",{className:"crud-form-actions",children:[t?u.jsx("button",{type:"button",className:"button-secondary",onClick:()=>e?.(),children:s("common.cancel")}):null,u.jsx("button",{type:"submit",disabled:k,children:s("common.create")})]})]})]})}const sh=10;function tA(){const{t,language:e}=Ee(),{account:n}=Oe(),[s,r]=j.useState([]),[a,l]=j.useState(""),[c,d]=j.useState(!0),[f,m]=j.useState(1),[g,y]=as(),x=g.get("create")==="1";j.useEffect(()=>{n?.accountId&&S()},[n?.accountId]);const _=j.useMemo(()=>{const k=(f-1)*sh;return s.slice(k,k+sh)},[s,f]),S=async()=>{try{d(!0);const k=await uN(n.accountId);r(k),l(""),m(1)}catch{l(t("common.genericLoadError"))}finally{d(!1)}},b=async k=>{try{await dN(k),await S()}catch{l(t("common.genericSaveError"))}};return u.jsxs("div",{className:"module-page",children:[u.jsx("h1",{children:t("bankDeposits.title")}),a&&u.jsx("p",{className:"error-text",children:a}),c?u.jsx("p",{children:t("common.loading")}):s.length===0?u.jsx("p",{children:t("common.empty")}):u.jsxs(u.Fragment,{children:[u.jsxs("table",{className:"crud-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"ID"}),u.jsx("th",{children:t("transactions.date")}),u.jsx("th",{children:t("common.name")}),u.jsx("th",{children:t("transactions.accountPaymentForm")}),u.jsx("th",{children:t("transactions.referenceNumber")}),u.jsx("th",{children:t("transactions.total")}),u.jsx("th",{children:t("common.actions")})]})}),u.jsx("tbody",{children:_.map(k=>u.jsxs("tr",{children:[u.jsx("td",{children:k.id}),u.jsx("td",{children:dt(k.date,e)}),u.jsx("td",{children:k.name||"-"}),u.jsx("td",{children:k.account_payment_forms?.name||"-"}),u.jsx("td",{children:k.referenceNumber||"-"}),u.jsx("td",{children:Ie(k.total)}),u.jsx("td",{className:"table-actions",children:u.jsx(En,{actions:[{key:"deactivate",label:t("transactions.deactivate"),onClick:()=>b(k.id),danger:!0}]})})]},k.id))})]}),u.jsx(qn,{page:f,pageSize:sh,totalItems:s.length,onPageChange:m})]}),x?u.jsx("div",{className:"modal-backdrop",onClick:()=>{const k=new URLSearchParams(g);k.delete("create"),y(k)},children:u.jsx("div",{className:"modal-card",onClick:k=>k.stopPropagation(),children:u.jsx(fb,{embedded:!0,onCancel:()=>{const k=new URLSearchParams(g);k.delete("create"),y(k)},onCreated:async()=>{await S();const k=new URLSearchParams(g);k.delete("create"),y(k)}})})}):null]})}const nA={date:new Date().toISOString().slice(0,10),amount:0,currencyId:"",fromBankFormId:"",toBankFormId:"",referenceNumber:"",description:""};function pb({embedded:t=!1,onCancel:e,onCreated:n}){const{t:s}=Ee(),{account:r,user:a}=Oe(),l=Ht(),[c,d]=j.useState(nA),[f,m]=j.useState([]),[g,y]=j.useState([]),[x,_]=j.useState([]),[S,b]=j.useState([]),[k,I]=j.useState(!1),[C,N]=j.useState(""),O=j.useMemo(()=>f.filter(R=>R.kind==="bank_account"),[f]);j.useEffect(()=>{r?.accountId&&U()},[r?.accountId]);const U=async()=>{try{const[R,T,D,Y]=await Promise.all([fr(r.accountId),vo(r.accountId),oo(r.accountId),Bi(r.accountId)]);m(R),y(T),_(D),b(Y);const se=T.find(H=>H.isLocal)?.id;d(H=>({...H,currencyId:H.currencyId||String(se||"")})),N("")}catch{N(s("common.genericLoadError"))}},E=R=>{const{name:T,value:D}=R.target;d(Y=>({...Y,[T]:D}))},L=async R=>{if(R.preventDefault(),N(""),!R.currentTarget.checkValidity()){R.currentTarget.reportValidity(),N(s("common.requiredFields"));return}if(!r?.accountId||!a?.id||!c.currencyId){N(s("common.requiredFields"));return}const T=Math.abs(Number(c.amount||0));if(!T||!c.fromBankFormId||!c.toBankFormId){N(s("common.requiredFields"));return}if(Number(c.fromBankFormId)===Number(c.toBankFormId)){N(s("bankTransfers.sameAccountError"));return}const D=S.find(ee=>ee.isOutgoingPaymentConcept),Y=S.find(ee=>ee.isIncomingPaymentConcept),se=x.find(ee=>ee.code==="bank_transfer");if(!D||!Y||!se){N(s("transactions.missingSystemPaymentConcept"));return}const H=O.find(ee=>ee.id===Number(c.fromBankFormId)),J=O.find(ee=>ee.id===Number(c.toBankFormId));try{I(!0);const ee=await cN({accountId:r.accountId,userId:a.id,date:c.date,amount:T,currencyId:Number(c.currencyId),referenceNumber:c.referenceNumber,description:c.description,transferPaymentMethodId:se.id,fromBankFormId:Number(c.fromBankFormId),toBankFormId:Number(c.toBankFormId),fromBankLabel:H?pn(H):null,toBankLabel:J?pn(J):null,outgoingConceptId:D.id,incomingConceptId:Y.id});t?n?.(ee):l("/bank-transfers")}catch(ee){N(ee?.message||s("common.genericSaveError"))}finally{I(!1)}};return u.jsxs("div",{className:t?"":"module-page",children:[t?u.jsx("h3",{children:s("actions.newBankTransfer")}):u.jsxs("div",{className:"page-header-row",children:[u.jsx("h1",{children:s("bankTransfers.title")}),u.jsx(st,{to:"/bank-transfers",className:"button-link-secondary",children:s("common.backToList")})]}),C&&u.jsx("p",{className:"error-text",children:C}),u.jsxs("form",{className:"crud-form",onSubmit:L,children:[u.jsxs("div",{className:"form-grid-2",children:[u.jsx(lo,{label:s("transactions.date"),name:"date",value:c.date,onChange:E,required:!0}),u.jsxs(mn,{label:s("transactions.currency"),name:"currencyId",value:c.currencyId,onChange:E,required:!0,children:[u.jsx("option",{value:"",children:`-- ${s("transactions.selectCurrency")} --`}),g.map(R=>u.jsxs("option",{value:R.id,children:[R.name," (",R.symbol,")"]},R.id))]}),u.jsxs(mn,{label:s("bankTransfers.fromBankAccount"),name:"fromBankFormId",value:c.fromBankFormId,onChange:E,required:!0,children:[u.jsx("option",{value:"",children:`-- ${s("transactions.selectAccountPaymentForm")} --`}),O.map(R=>u.jsx("option",{value:R.id,children:pn(R)},R.id))]}),u.jsxs(mn,{label:s("bankTransfers.toBankAccount"),name:"toBankFormId",value:c.toBankFormId,onChange:E,required:!0,children:[u.jsx("option",{value:"",children:`-- ${s("transactions.selectAccountPaymentForm")} --`}),O.map(R=>u.jsx("option",{value:R.id,children:pn(R)},R.id))]}),u.jsx(Ri,{label:s("transactions.amount"),min:"0",step:"0.01",name:"amount",value:c.amount,onChange:E,required:!0}),u.jsx(nt,{label:s("transactions.referenceNumber"),name:"referenceNumber",value:c.referenceNumber,onChange:E}),u.jsx(nt,{label:s("transactions.description"),name:"description",value:c.description,onChange:E,className:"form-span-2"})]}),u.jsxs("div",{className:"crud-form-actions",children:[t?u.jsx("button",{type:"button",className:"button-secondary",onClick:()=>e?.(),children:s("common.cancel")}):null,u.jsx("button",{type:"submit",disabled:k,children:s("common.create")})]})]})]})}const rh=10;function sA(){const{t,language:e}=Ee(),{account:n}=Oe(),[s,r]=j.useState([]),[a,l]=j.useState(""),[c,d]=j.useState(!0),[f,m]=j.useState(1),[g,y]=as(),x=g.get("create")==="1";j.useEffect(()=>{n?.accountId&&S()},[n?.accountId]);const _=j.useMemo(()=>{const k=(f-1)*rh;return s.slice(k,k+rh)},[s,f]),S=async()=>{try{d(!0);const k=await hN(n.accountId);r(k),l(""),m(1)}catch{l(t("common.genericLoadError"))}finally{d(!1)}},b=async k=>{try{await fN(k),await S()}catch{l(t("common.genericSaveError"))}};return u.jsxs("div",{className:"module-page",children:[u.jsx("h1",{children:t("bankTransfers.title")}),a&&u.jsx("p",{className:"error-text",children:a}),c?u.jsx("p",{children:t("common.loading")}):s.length===0?u.jsx("p",{children:t("common.empty")}):u.jsxs(u.Fragment,{children:[u.jsxs("table",{className:"crud-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"ID"}),u.jsx("th",{children:t("bankTransfers.sourceTransactionId")}),u.jsx("th",{children:t("transactions.date")}),u.jsx("th",{children:t("common.name")}),u.jsx("th",{children:t("bankTransfers.fromBankAccount")}),u.jsx("th",{children:t("bankTransfers.toBankAccount")}),u.jsx("th",{children:t("transactions.referenceNumber")}),u.jsx("th",{children:t("transactions.total")}),u.jsx("th",{children:t("common.actions")})]})}),u.jsx("tbody",{children:_.map(k=>u.jsxs("tr",{children:[u.jsx("td",{children:k.id}),u.jsx("td",{children:k.sourceTransactionId||"-"}),u.jsx("td",{children:dt(k.date,e)}),u.jsx("td",{children:k.name||"-"}),u.jsx("td",{children:k.deliverTo||"-"}),u.jsx("td",{children:k.deliveryAddress||k.account_payment_forms?.name||"-"}),u.jsx("td",{children:k.referenceNumber||"-"}),u.jsx("td",{children:Ie(k.total)}),u.jsx("td",{className:"table-actions",children:u.jsx(En,{actions:[{key:"deactivate",label:t("transactions.deactivate"),onClick:()=>b(k.id),danger:!0}]})})]},k.id))})]}),u.jsx(qn,{page:f,pageSize:rh,totalItems:s.length,onPageChange:m})]}),x?u.jsx("div",{className:"modal-backdrop",onClick:()=>{const k=new URLSearchParams(g);k.delete("create"),y(k)},children:u.jsx("div",{className:"modal-card",onClick:k=>k.stopPropagation(),children:u.jsx(pb,{embedded:!0,onCancel:()=>{const k=new URLSearchParams(g);k.delete("create"),y(k)},onCreated:async()=>{await S();const k=new URLSearchParams(g);k.delete("create"),y(k)}})})}):null]})}const ih=10;function rA(){const{t,language:e}=Ee(),{account:n}=Oe(),[s,r]=j.useState([]),[a,l]=j.useState(""),[c,d]=j.useState(!0),[f,m]=j.useState(1),[g,y]=as(),x=g.get("create")==="1";j.useEffect(()=>{n?.accountId&&S()},[n?.accountId]);const _=j.useMemo(()=>{const k=(f-1)*ih;return s.slice(k,k+ih)},[s,f]),S=async()=>{try{d(!0);const k=await co(n.accountId);r(k),l(""),m(1)}catch{l(t("common.genericLoadError"))}finally{d(!1)}},b=async k=>{try{await vN(k),await S()}catch{l(t("common.genericSaveError"))}};return u.jsxs("div",{className:"module-page",children:[u.jsx("h1",{children:t("projects.title")}),a&&u.jsx("p",{className:"error-text",children:a}),c?u.jsx("p",{children:t("common.loading")}):s.length===0?u.jsx("p",{children:t("common.empty")}):u.jsxs(u.Fragment,{children:[u.jsxs("table",{className:"crud-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:t("common.name")}),u.jsx("th",{children:t("projects.startDate")}),u.jsx("th",{children:t("projects.endDate")}),u.jsx("th",{children:t("transactions.status")}),u.jsx("th",{children:t("common.actions")})]})}),u.jsx("tbody",{children:_.map(k=>u.jsxs("tr",{children:[u.jsx("td",{children:k.name}),u.jsx("td",{children:dt(k.startDate,e)}),u.jsx("td",{children:dt(k.endDate,e)}),u.jsx("td",{children:k.isActive?t("transactions.active"):t("transactions.inactive")}),u.jsx("td",{className:"table-actions",children:u.jsx(En,{actions:[{key:"edit",label:t("common.edit"),to:`/projects/${k.id}/edit`},{key:"deactivate",label:t("transactions.deactivate"),onClick:()=>b(k.id),danger:!0}]})})]},k.id))})]}),u.jsx(qn,{page:f,pageSize:ih,totalItems:s.length,onPageChange:m})]}),x?u.jsx("div",{className:"modal-backdrop",onClick:()=>{const k=new URLSearchParams(g);k.delete("create"),y(k)},children:u.jsx("div",{className:"modal-card",onClick:k=>k.stopPropagation(),children:u.jsx(uo,{embedded:!0,onCancel:()=>{const k=new URLSearchParams(g);k.delete("create"),y(k)},onCreated:async()=>{await S();const k=new URLSearchParams(g);k.delete("create"),y(k)}})})}):null]})}function iA(){const{t,language:e}=Ee(),{account:n}=Oe(),{id:s}=Vn(),[r,a]=j.useState(null),[l,c]=j.useState([]),[d,f]=j.useState([]),[m,g]=j.useState(""),[y,x]=j.useState(!0);j.useEffect(()=>{!n?.accountId||!s||S()},[n?.accountId,s]);const _=j.useMemo(()=>l.reduce((b,k)=>(b.budgeted+=Number(k.budgeted||0),b.executed+=Number(k.executed||0),b.variance+=Number(k.variance||0),b),{budgeted:0,executed:0,variance:0}),[l]),S=async()=>{try{x(!0);const[b,k,I]=await Promise.all([ab(s),db({accountId:n.accountId,projectId:Number(s)}),XT({accountId:n.accountId,projectId:Number(s)})]);a(b),c(k),f(I),g("")}catch{g(t("common.genericLoadError"))}finally{x(!1)}};return u.jsxs("div",{className:"module-page",children:[u.jsxs("div",{className:"page-header-row",children:[u.jsx("h1",{children:t("projects.title")}),u.jsx(st,{to:"/projects",className:"button-link-secondary",children:t("common.backToList")})]}),m&&u.jsx("p",{className:"error-text",children:m}),y?u.jsx("p",{children:t("common.loading")}):u.jsxs(u.Fragment,{children:[u.jsxs("section",{className:"generic-panel",children:[u.jsxs("p",{children:[u.jsxs("strong",{children:[t("common.name"),":"]})," ",r?.name||"-"]}),u.jsxs("p",{children:[u.jsxs("strong",{children:[t("projects.startDate"),":"]})," ",dt(r?.startDate,e)," | ",u.jsxs("strong",{children:[t("projects.endDate"),":"]})," ",dt(r?.endDate,e)]}),u.jsxs("p",{children:[t("budgets.totalBudget"),": ",Ie(_.budgeted)," | ",t("reports.executed"),": ",Ie(_.executed)," |"," ",t("reports.variance"),": ",Ie(_.variance)]})]}),u.jsxs("section",{className:"generic-panel",children:[u.jsx("h3",{children:t("reports.projectExecution")}),u.jsxs("table",{className:"crud-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:t("transactions.concept")}),u.jsx("th",{children:t("budgets.budgetAmount")}),u.jsx("th",{children:t("reports.executed")}),u.jsx("th",{children:t("reports.variance")})]})}),u.jsx("tbody",{children:l.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:4,children:t("common.empty")})}):l.map(b=>u.jsxs("tr",{children:[u.jsx("td",{children:b.conceptName}),u.jsx("td",{children:Ie(b.budgeted)}),u.jsx("td",{className:Number(b.executed||0)>Number(b.budgeted||0)?"text-danger":"",children:Ie(b.executed)}),u.jsx("td",{children:Ie(b.variance)})]},b.id))})]})]}),u.jsxs("section",{className:"generic-panel",children:[u.jsx("h3",{children:t("transactions.detailTitle")}),u.jsxs("table",{className:"crud-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"ID"}),u.jsx("th",{children:t("transactions.date")}),u.jsx("th",{children:t("common.name")}),u.jsx("th",{children:t("transactions.total")})]})}),u.jsx("tbody",{children:d.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:4,children:t("common.empty")})}):d.map(b=>u.jsxs("tr",{children:[u.jsx("td",{children:b.id}),u.jsx("td",{children:dt(b.date,e)}),u.jsx("td",{children:b.name||"-"}),u.jsx("td",{children:Ie(b.total)})]},b.id))})]})]})]})]})}const aA={name:"",periodType:"monthly",periodStart:"",periodEnd:"",projectId:""};function Fh({embedded:t=!1,onCancel:e,onCreated:n}){const{t:s}=Ee(),{account:r,user:a}=Oe(),l=Ht(),{id:c}=Vn(),d=!t&&!!c,[f,m]=j.useState(aA),[g,y]=j.useState([]),[x,_]=j.useState([]),[S,b]=j.useState([]),[k,I]=j.useState(""),[C,N]=j.useState(!0),[O,U]=j.useState(!1),E=j.useMemo(()=>x.filter(H=>!H.isGroup&&(H.isIncome||H.isExpense||H.isProduct)),[x]);j.useEffect(()=>{r?.accountId&&L()},[r?.accountId]),j.useEffect(()=>{!d||!r?.accountId||R()},[d,c,r?.accountId]);const L=async()=>{try{const[H,J]=await Promise.all([Bi(r.accountId),co(r.accountId)]);_(H),b(J)}catch{I(s("common.genericLoadError"))}finally{d||N(!1)}},R=async()=>{try{N(!0);const[H,J]=await Promise.all([lb(c),cb(c)]);m({name:H.name||"",periodType:H.periodType||"monthly",periodStart:H.periodStart||"",periodEnd:H.periodEnd||"",projectId:H.projectId?String(H.projectId):""}),y((J||[]).map(ee=>({rowId:String(ee.id),conceptId:String(ee.conceptId),amount:Number(ee.amount||0)}))),I("")}catch{I(s("common.genericLoadError"))}finally{N(!1)}},T=()=>{y(H=>[...H,{rowId:`${Date.now()}-${Math.random()}`,conceptId:"",amount:0}])},D=(H,J,ee)=>{y(he=>he.map(Z=>Z.rowId===H?{...Z,[J]:ee}:Z))},Y=H=>{y(J=>J.filter(ee=>ee.rowId!==H))},se=async H=>{if(H.preventDefault(),I(""),!H.currentTarget.checkValidity()){H.currentTarget.reportValidity(),I(s("common.requiredFields"));return}if(!r?.accountId||!a?.id){I(s("common.requiredFields"));return}const J={accountId:r.accountId,name:f.name.trim(),periodType:f.periodType,periodStart:f.periodStart,periodEnd:f.periodEnd,projectId:f.projectId?Number(f.projectId):null,isActive:!0,createdById:a.id},ee=g.filter(he=>he.conceptId).map(he=>({conceptId:Number(he.conceptId),amount:Number(he.amount||0)}));if(ee.length===0){I(s("common.requiredFields"));return}try{U(!0);let he=null;if(d?he=await IN(c,{budget:J,lines:ee}):he=await PN({budget:J,lines:ee}),t){n?.(he);return}l("/budgets")}catch{I(s("common.genericSaveError"))}finally{U(!1)}};return u.jsxs("div",{className:t?"":"module-page",children:[t?u.jsx("h3",{children:s(d?"common.edit":"actions.newBudget")}):u.jsxs("div",{className:"page-header-row",children:[u.jsx("h1",{children:s(d?"common.edit":"actions.newBudget")}),u.jsx(st,{to:"/budgets",className:"button-link-secondary",children:s("common.backToList")})]}),k&&u.jsx("p",{className:"error-text",children:k}),C?u.jsx("p",{children:s("common.loading")}):u.jsxs("form",{className:"crud-form",onSubmit:se,children:[u.jsxs("div",{className:"form-grid-2",children:[u.jsxs("label",{className:"field-block",children:[u.jsx("span",{children:s("common.name")}),u.jsx("input",{name:"name",value:f.name,onChange:H=>m(J=>({...J,name:H.target.value})),required:!0})]}),u.jsxs("label",{className:"field-block",children:[u.jsx("span",{children:s("budgets.periodType")}),u.jsxs("select",{name:"periodType",value:f.periodType,onChange:H=>m(J=>({...J,periodType:H.target.value})),children:[u.jsx("option",{value:"daily",children:s("budgets.periods.daily")}),u.jsx("option",{value:"weekly",children:s("budgets.periods.weekly")}),u.jsx("option",{value:"monthly",children:s("budgets.periods.monthly")}),u.jsx("option",{value:"yearly",children:s("budgets.periods.yearly")})]})]}),u.jsxs("label",{className:"field-block",children:[u.jsx("span",{children:s("reports.dateFrom")}),u.jsx("input",{type:"date",name:"periodStart",value:f.periodStart,onChange:H=>m(J=>({...J,periodStart:H.target.value}))})]}),u.jsxs("label",{className:"field-block",children:[u.jsx("span",{children:s("reports.dateTo")}),u.jsx("input",{type:"date",name:"periodEnd",value:f.periodEnd,onChange:H=>m(J=>({...J,periodEnd:H.target.value}))})]}),u.jsxs("label",{className:"field-block form-span-2",children:[u.jsx("span",{children:s("projects.project")}),u.jsxs("select",{name:"projectId",value:f.projectId,onChange:H=>m(J=>({...J,projectId:H.target.value})),children:[u.jsx("option",{value:"",children:`-- ${s("projects.optionalProject")} --`}),S.map(H=>u.jsx("option",{value:H.id,children:H.name},H.id))]})]})]}),u.jsxs("section",{className:"crud-form-section",children:[u.jsxs("div",{className:"page-header-row",children:[u.jsx("h2",{className:"crud-form-section-title",children:s("budgets.lines")}),u.jsx("button",{type:"button",className:"button-secondary",onClick:T,children:s("budgets.addLine")})]}),u.jsxs("table",{className:"crud-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:s("transactions.concept")}),u.jsx("th",{children:s("budgets.budgetAmount")}),u.jsx("th",{children:s("common.actions")})]})}),u.jsx("tbody",{children:g.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:3,children:s("common.empty")})}):g.map(H=>u.jsxs("tr",{children:[u.jsx("td",{children:u.jsxs("select",{value:H.conceptId,onChange:J=>D(H.rowId,"conceptId",J.target.value),children:[u.jsx("option",{value:"",children:`-- ${s("transactions.selectConcept")} --`}),E.map(J=>u.jsx("option",{value:J.id,children:J.name},J.id))]})}),u.jsx("td",{children:u.jsx("input",{type:"number",step:"0.01",value:H.amount,onChange:J=>D(H.rowId,"amount",J.target.value)})}),u.jsx("td",{children:u.jsx("button",{type:"button",className:"button-danger",onClick:()=>Y(H.rowId),children:s("common.delete")})})]},H.rowId))})]})]}),u.jsxs("div",{className:"crud-form-actions",children:[t?u.jsx("button",{type:"button",className:"button-secondary",onClick:()=>e?.(),children:s("common.cancel")}):null,u.jsx("button",{type:"submit",disabled:O,children:s(d?"common.update":"common.create")})]})]})]})}const ah=10;function oA(){const{t,language:e}=Ee(),{account:n}=Oe(),[s,r]=j.useState([]),[a,l]=j.useState({}),[c,d]=j.useState(""),[f,m]=j.useState(!0),[g,y]=j.useState(1),[x,_]=as(),S=x.get("create")==="1";j.useEffect(()=>{n?.accountId&&k()},[n?.accountId]);const b=j.useMemo(()=>{const C=(g-1)*ah;return s.slice(C,C+ah)},[s,g]),k=async()=>{try{m(!0);const C=await ob(n.accountId);r(C),y(1),d("");const N={};await Promise.all(C.map(async O=>{const U=await cb(O.id).catch(()=>[]);N[O.id]=U.reduce((E,L)=>E+Number(L.amount||0),0)})),l(N)}catch{d(t("common.genericLoadError"))}finally{m(!1)}},I=async C=>{try{await EN(C),await k()}catch{d(t("common.genericSaveError"))}};return u.jsxs("div",{className:"module-page",children:[u.jsx("h1",{children:t("budgets.title")}),c&&u.jsx("p",{className:"error-text",children:c}),f?u.jsx("p",{children:t("common.loading")}):s.length===0?u.jsx("p",{children:t("common.empty")}):u.jsxs(u.Fragment,{children:[u.jsxs("table",{className:"crud-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:t("common.name")}),u.jsx("th",{children:t("budgets.periodType")}),u.jsx("th",{children:t("reports.dateFrom")}),u.jsx("th",{children:t("reports.dateTo")}),u.jsx("th",{children:t("projects.project")}),u.jsx("th",{children:t("budgets.totalBudget")}),u.jsx("th",{children:t("common.actions")})]})}),u.jsx("tbody",{children:b.map(C=>u.jsxs("tr",{children:[u.jsx("td",{children:u.jsx(st,{to:`/budgets/${C.id}`,children:C.name})}),u.jsx("td",{children:t(`budgets.periods.${C.periodType}`)}),u.jsx("td",{children:dt(C.periodStart,e)}),u.jsx("td",{children:dt(C.periodEnd,e)}),u.jsx("td",{children:C.projects?.name||"-"}),u.jsx("td",{children:Ie(a[C.id]||0)}),u.jsx("td",{className:"table-actions",children:u.jsx(En,{actions:[{key:"detail",label:t("transactions.viewDetail"),to:`/budgets/${C.id}`},{key:"edit",label:t("common.edit"),to:`/budgets/${C.id}/edit`},{key:"deactivate",label:t("transactions.deactivate"),onClick:()=>I(C.id),danger:!0}]})})]},C.id))})]}),u.jsx(qn,{page:g,pageSize:ah,totalItems:s.length,onPageChange:y})]}),S?u.jsx("div",{className:"modal-backdrop",onClick:()=>{const C=new URLSearchParams(x);C.delete("create"),_(C)},children:u.jsx("div",{className:"modal-card",onClick:C=>C.stopPropagation(),children:u.jsx(Fh,{embedded:!0,onCancel:()=>{const C=new URLSearchParams(x);C.delete("create"),_(C)},onCreated:async()=>{await k();const C=new URLSearchParams(x);C.delete("create"),_(C)}})})}):null]})}function lA(){const{t,language:e}=Ee(),{account:n}=Oe(),{id:s}=Vn(),[r,a]=j.useState(null),[l,c]=j.useState([]),[d,f]=j.useState(""),[m,g]=j.useState(!0);j.useEffect(()=>{!n?.accountId||!s||x()},[n?.accountId,s]);const y=j.useMemo(()=>l.reduce((_,S)=>(_.budgeted+=Number(S.budgeted||0),_.executed+=Number(S.executed||0),_.variance+=Number(S.variance||0),_),{budgeted:0,executed:0,variance:0}),[l]),x=async()=>{try{g(!0);const[_,S]=await Promise.all([lb(s),ub({accountId:n.accountId,budgetId:Number(s)})]);a(_),c(S),f("")}catch{f(t("common.genericLoadError"))}finally{g(!1)}};return u.jsxs("div",{className:"module-page",children:[u.jsxs("div",{className:"page-header-row",children:[u.jsx("h1",{children:t("budgets.title")}),u.jsx(st,{to:"/budgets",className:"button-link-secondary",children:t("common.backToList")})]}),d&&u.jsx("p",{className:"error-text",children:d}),m?u.jsx("p",{children:t("common.loading")}):u.jsxs(u.Fragment,{children:[u.jsxs("section",{className:"generic-panel",children:[u.jsxs("p",{children:[u.jsxs("strong",{children:[t("common.name"),":"]})," ",r?.name||"-"]}),u.jsxs("p",{children:[u.jsxs("strong",{children:[t("budgets.periodType"),":"]})," ",r?.periodType?t(`budgets.periods.${r.periodType}`):"-"]}),u.jsxs("p",{children:[u.jsxs("strong",{children:[t("reports.dateFrom"),":"]})," ",dt(r?.periodStart,e)," | ",u.jsxs("strong",{children:[t("reports.dateTo"),":"]})," ",dt(r?.periodEnd,e)]}),u.jsxs("p",{children:[t("budgets.totalBudget"),": ",Ie(y.budgeted)," | ",t("reports.executed"),": ",Ie(y.executed)," |"," ",t("reports.variance"),": ",Ie(y.variance)]})]}),u.jsxs("table",{className:"crud-table",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:t("transactions.concept")}),u.jsx("th",{children:t("budgets.budgetAmount")}),u.jsx("th",{children:t("reports.executed")}),u.jsx("th",{children:t("reports.variance")})]})}),u.jsx("tbody",{children:l.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:4,children:t("common.empty")})}):l.map(_=>u.jsxs("tr",{children:[u.jsx("td",{children:_.conceptName}),u.jsx("td",{children:Ie(_.budgeted)}),u.jsx("td",{className:Number(_.executed||0)>Number(_.budgeted||0)?"text-danger":"",children:Ie(_.executed)}),u.jsx("td",{children:Ie(_.variance)})]},_.id))})]})]})]})}function cA(){return u.jsxs(l_,{children:[u.jsx(de,{path:"/login",element:u.jsx(Kj,{})}),u.jsx(de,{path:"/register",element:u.jsx(Gj,{})}),u.jsx(de,{path:"/accept-invitation/:invitationId",element:u.jsx(Qj,{})}),u.jsxs(de,{path:"/",element:u.jsx(Hj,{children:u.jsx(qj,{})}),children:[u.jsx(de,{index:!0,element:u.jsx(jT,{})}),u.jsx(de,{path:"clients",element:u.jsx(xv,{personType:1,titleKey:"clients.title",basePath:"/clients"})}),u.jsx(de,{path:"clients/new",element:u.jsx(Vr,{personType:1,titleKey:"actions.newClient",basePath:"/clients"})}),u.jsx(de,{path:"clients/:id/edit",element:u.jsx(Vr,{personType:1,titleKey:"actions.newClient",basePath:"/clients"})}),u.jsx(de,{path:"providers",element:u.jsx(xv,{personType:2,titleKey:"providers.title",basePath:"/providers"})}),u.jsx(de,{path:"providers/new",element:u.jsx(Vr,{personType:2,titleKey:"actions.newProvider",basePath:"/providers"})}),u.jsx(de,{path:"providers/:id/edit",element:u.jsx(Vr,{personType:2,titleKey:"actions.newProvider",basePath:"/providers"})}),u.jsx(de,{path:"employees",element:u.jsx(DT,{})}),u.jsx(de,{path:"employees/new",element:u.jsx(mc,{})}),u.jsx(de,{path:"employees/:id/edit",element:u.jsx(mc,{})}),u.jsx(de,{path:"products",element:u.jsx(Na,{moduleType:"products",titleKey:"conceptModules.products",basePath:"/products"})}),u.jsx(de,{path:"products/new",element:u.jsx(nn,{moduleType:"products",titleKey:"actions.newProduct",basePath:"/products"})}),u.jsx(de,{path:"products/:id/edit",element:u.jsx(nn,{moduleType:"products",titleKey:"actions.newProduct",basePath:"/products"})}),u.jsx(de,{path:"income-concepts",element:u.jsx(Na,{moduleType:"income",titleKey:"conceptModules.income",basePath:"/income-concepts"})}),u.jsx(de,{path:"income-concepts/new",element:u.jsx(nn,{moduleType:"income",titleKey:"actions.newIncomeConcept",basePath:"/income-concepts"})}),u.jsx(de,{path:"income-concepts/:id/edit",element:u.jsx(nn,{moduleType:"income",titleKey:"actions.newIncomeConcept",basePath:"/income-concepts"})}),u.jsx(de,{path:"expense-concepts",element:u.jsx(Na,{moduleType:"expense",titleKey:"conceptModules.expense",basePath:"/expense-concepts"})}),u.jsx(de,{path:"expense-concepts/new",element:u.jsx(nn,{moduleType:"expense",titleKey:"actions.newExpenseConcept",basePath:"/expense-concepts"})}),u.jsx(de,{path:"expense-concepts/:id/edit",element:u.jsx(nn,{moduleType:"expense",titleKey:"actions.newExpenseConcept",basePath:"/expense-concepts"})}),u.jsx(de,{path:"payable-concepts",element:u.jsx(Na,{moduleType:"payable",titleKey:"conceptModules.payable",basePath:"/payable-concepts"})}),u.jsx(de,{path:"payable-concepts/new",element:u.jsx(nn,{moduleType:"payable",titleKey:"actions.newPayableConcept",basePath:"/payable-concepts"})}),u.jsx(de,{path:"payable-concepts/:id/edit",element:u.jsx(nn,{moduleType:"payable",titleKey:"actions.newPayableConcept",basePath:"/payable-concepts"})}),u.jsx(de,{path:"concept-groups",element:u.jsx(Na,{moduleType:"groups",titleKey:"conceptModules.groups",basePath:"/concept-groups"})}),u.jsx(de,{path:"concept-groups/new",element:u.jsx(nn,{moduleType:"groups",titleKey:"actions.newConceptGroup",basePath:"/concept-groups"})}),u.jsx(de,{path:"concept-groups/:id/edit",element:u.jsx(nn,{moduleType:"groups",titleKey:"actions.newConceptGroup",basePath:"/concept-groups"})}),u.jsx(de,{path:"sales",element:u.jsx(Kl,{moduleType:"sale"})}),u.jsx(de,{path:"sales/new",element:u.jsx(Da,{moduleType:"sale"})}),u.jsx(de,{path:"sales/:id",element:u.jsx(wv,{moduleType:"sale"})}),u.jsx(de,{path:"expenses",element:u.jsx(Kl,{moduleType:"expense"})}),u.jsx(de,{path:"expenses/new",element:u.jsx(Da,{moduleType:"expense"})}),u.jsx(de,{path:"incomes",element:u.jsx(Kl,{moduleType:"income"})}),u.jsx(de,{path:"incomes/new",element:u.jsx(Da,{moduleType:"income"})}),u.jsx(de,{path:"purchases",element:u.jsx(Kl,{moduleType:"purchase"})}),u.jsx(de,{path:"purchases/new",element:u.jsx(Da,{moduleType:"purchase"})}),u.jsx(de,{path:"purchases/:id",element:u.jsx(wv,{moduleType:"purchase"})}),u.jsx(de,{path:"payment-forms",element:u.jsx(JN,{})}),u.jsx(de,{path:"payment-forms/new",element:u.jsx(gc,{})}),u.jsx(de,{path:"payment-forms/:id/edit",element:u.jsx(gc,{})}),u.jsx(de,{path:"bank-deposits",element:u.jsx(tA,{})}),u.jsx(de,{path:"bank-deposits/new",element:u.jsx(fb,{})}),u.jsx(de,{path:"bank-transfers",element:u.jsx(sA,{})}),u.jsx(de,{path:"bank-transfers/new",element:u.jsx(pb,{})}),u.jsx(de,{path:"internal-obligations",element:u.jsx(ZN,{})}),u.jsx(de,{path:"internal-obligations/new",element:u.jsx(Dh,{})}),u.jsx(de,{path:"internal-obligations/:id/edit",element:u.jsx(Dh,{})}),u.jsx(de,{path:"bank-reconciliation",element:u.jsx(XN,{})}),u.jsx(de,{path:"projects",element:u.jsx(rA,{})}),u.jsx(de,{path:"projects/new",element:u.jsx(uo,{})}),u.jsx(de,{path:"projects/:id",element:u.jsx(iA,{})}),u.jsx(de,{path:"projects/:id/edit",element:u.jsx(uo,{})}),u.jsx(de,{path:"budgets",element:u.jsx(oA,{})}),u.jsx(de,{path:"budgets/new",element:u.jsx(Fh,{})}),u.jsx(de,{path:"budgets/:id",element:u.jsx(lA,{})}),u.jsx(de,{path:"budgets/:id/edit",element:u.jsx(Fh,{})}),u.jsx(de,{path:"reports",element:u.jsx(AN,{})}),u.jsxs(de,{path:"account",element:u.jsx(qN,{}),children:[u.jsx(de,{index:!0,element:u.jsx(js,{to:"/account/users",replace:!0})}),u.jsx(de,{path:"billing",element:u.jsx(GN,{})}),u.jsx(de,{path:"users",element:u.jsx(VN,{})}),u.jsx(de,{path:"profiles",element:u.jsx(FN,{})}),u.jsx(de,{path:"invitations",element:u.jsx(YN,{})}),u.jsx(de,{path:"settings",element:u.jsx(KN,{})})]}),u.jsx(de,{path:"profiles",element:u.jsx(js,{to:"/account/profiles",replace:!0})}),u.jsx(de,{path:"admin",element:u.jsx(js,{to:"/account/users",replace:!0})})]}),u.jsx(de,{path:"*",element:u.jsx(js,{to:"/",replace:!0})})]})}typeof document<"u"&&!window.__crudValidationListenerBound&&(window.__crudValidationListenerBound=!0,document.addEventListener("submit",t=>{const e=t.target;e instanceof HTMLFormElement&&e.classList.contains("crud-form")&&e.classList.add("was-validated")},!0));gw.createRoot(document.getElementById("root")).render(u.jsx(Es.StrictMode,{children:u.jsx(y_,{children:u.jsx(Lj,{children:u.jsx(Oj,{children:u.jsx(cA,{})})})})}));
