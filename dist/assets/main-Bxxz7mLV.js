function ew(t,e){for(var n=0;n<e.length;n++){const s=e[n];if(typeof s!="string"&&!Array.isArray(s)){for(const r in s)if(r!=="default"&&!(r in t)){const a=Object.getOwnPropertyDescriptor(s,r);a&&Object.defineProperty(t,r,a.get?a:{enumerable:!0,get:()=>s[r]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function n(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(r){if(r.ep)return;r.ep=!0;const a=n(r);fetch(r.href,a)}})();function tw(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var dd={exports:{}},va={},hd={exports:{}},Ne={};var Fm;function nw(){if(Fm)return Ne;Fm=1;var t=Symbol.for("react.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),g=Symbol.iterator;function y(U){return U===null||typeof U!="object"?null:(U=g&&U[g]||U["@@iterator"],typeof U=="function"?U:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_=Object.assign,k={};function b(U,B,le){this.props=U,this.context=B,this.refs=k,this.updater=le||x}b.prototype.isReactComponent={},b.prototype.setState=function(U,B){if(typeof U!="object"&&typeof U!="function"&&U!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,U,B,"setState")},b.prototype.forceUpdate=function(U){this.updater.enqueueForceUpdate(this,U,"forceUpdate")};function S(){}S.prototype=b.prototype;function I(U,B,le){this.props=U,this.context=B,this.refs=k,this.updater=le||x}var C=I.prototype=new S;C.constructor=I,_(C,b.prototype),C.isPureReactComponent=!0;var T=Array.isArray,A=Object.prototype.hasOwnProperty,z={current:null},E={key:!0,ref:!0,__self:!0,__source:!0};function D(U,B,le){var ae,ge={},we=null,Le=null;if(B!=null)for(ae in B.ref!==void 0&&(Le=B.ref),B.key!==void 0&&(we=""+B.key),B)A.call(B,ae)&&!E.hasOwnProperty(ae)&&(ge[ae]=B[ae]);var Te=arguments.length-2;if(Te===1)ge.children=le;else if(1<Te){for(var De=Array(Te),mt=0;mt<Te;mt++)De[mt]=arguments[mt+2];ge.children=De}if(U&&U.defaultProps)for(ae in Te=U.defaultProps,Te)ge[ae]===void 0&&(ge[ae]=Te[ae]);return{$$typeof:t,type:U,key:we,ref:Le,props:ge,_owner:z.current}}function M(U,B){return{$$typeof:t,type:U.type,key:B,ref:U.ref,props:U.props,_owner:U._owner}}function N(U){return typeof U=="object"&&U!==null&&U.$$typeof===t}function F(U){var B={"=":"=0",":":"=2"};return"$"+U.replace(/[=:]/g,function(le){return B[le]})}var H=/\/+/g;function J(U,B){return typeof U=="object"&&U!==null&&U.key!=null?F(""+U.key):B.toString(36)}function Y(U,B,le,ae,ge){var we=typeof U;(we==="undefined"||we==="boolean")&&(U=null);var Le=!1;if(U===null)Le=!0;else switch(we){case"string":case"number":Le=!0;break;case"object":switch(U.$$typeof){case t:case e:Le=!0}}if(Le)return Le=U,ge=ge(Le),U=ae===""?"."+J(Le,0):ae,T(ge)?(le="",U!=null&&(le=U.replace(H,"$&/")+"/"),Y(ge,B,le,"",function(mt){return mt})):ge!=null&&(N(ge)&&(ge=M(ge,le+(!ge.key||Le&&Le.key===ge.key?"":(""+ge.key).replace(H,"$&/")+"/")+U)),B.push(ge)),1;if(Le=0,ae=ae===""?".":ae+":",T(U))for(var Te=0;Te<U.length;Te++){we=U[Te];var De=ae+J(we,Te);Le+=Y(we,B,le,De,ge)}else if(De=y(U),typeof De=="function")for(U=De.call(U),Te=0;!(we=U.next()).done;)we=we.value,De=ae+J(we,Te++),Le+=Y(we,B,le,De,ge);else if(we==="object")throw B=String(U),Error("Objects are not valid as a React child (found: "+(B==="[object Object]"?"object with keys {"+Object.keys(U).join(", ")+"}":B)+"). If you meant to render a collection of children, use an array instead.");return Le}function X(U,B,le){if(U==null)return U;var ae=[],ge=0;return Y(U,ae,"","",function(we){return B.call(le,we,ge++)}),ae}function re(U){if(U._status===-1){var B=U._result;B=B(),B.then(function(le){(U._status===0||U._status===-1)&&(U._status=1,U._result=le)},function(le){(U._status===0||U._status===-1)&&(U._status=2,U._result=le)}),U._status===-1&&(U._status=0,U._result=B)}if(U._status===1)return U._result.default;throw U._result}var pe={current:null},ee={transition:null},ce={ReactCurrentDispatcher:pe,ReactCurrentBatchConfig:ee,ReactCurrentOwner:z};function ie(){throw Error("act(...) is not supported in production builds of React.")}return Ne.Children={map:X,forEach:function(U,B,le){X(U,function(){B.apply(this,arguments)},le)},count:function(U){var B=0;return X(U,function(){B++}),B},toArray:function(U){return X(U,function(B){return B})||[]},only:function(U){if(!N(U))throw Error("React.Children.only expected to receive a single React element child.");return U}},Ne.Component=b,Ne.Fragment=n,Ne.Profiler=r,Ne.PureComponent=I,Ne.StrictMode=s,Ne.Suspense=d,Ne.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ce,Ne.act=ie,Ne.cloneElement=function(U,B,le){if(U==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+U+".");var ae=_({},U.props),ge=U.key,we=U.ref,Le=U._owner;if(B!=null){if(B.ref!==void 0&&(we=B.ref,Le=z.current),B.key!==void 0&&(ge=""+B.key),U.type&&U.type.defaultProps)var Te=U.type.defaultProps;for(De in B)A.call(B,De)&&!E.hasOwnProperty(De)&&(ae[De]=B[De]===void 0&&Te!==void 0?Te[De]:B[De])}var De=arguments.length-2;if(De===1)ae.children=le;else if(1<De){Te=Array(De);for(var mt=0;mt<De;mt++)Te[mt]=arguments[mt+2];ae.children=Te}return{$$typeof:t,type:U.type,key:ge,ref:we,props:ae,_owner:Le}},Ne.createContext=function(U){return U={$$typeof:l,_currentValue:U,_currentValue2:U,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},U.Provider={$$typeof:a,_context:U},U.Consumer=U},Ne.createElement=D,Ne.createFactory=function(U){var B=D.bind(null,U);return B.type=U,B},Ne.createRef=function(){return{current:null}},Ne.forwardRef=function(U){return{$$typeof:u,render:U}},Ne.isValidElement=N,Ne.lazy=function(U){return{$$typeof:m,_payload:{_status:-1,_result:U},_init:re}},Ne.memo=function(U,B){return{$$typeof:f,type:U,compare:B===void 0?null:B}},Ne.startTransition=function(U){var B=ee.transition;ee.transition={};try{U()}finally{ee.transition=B}},Ne.unstable_act=ie,Ne.useCallback=function(U,B){return pe.current.useCallback(U,B)},Ne.useContext=function(U){return pe.current.useContext(U)},Ne.useDebugValue=function(){},Ne.useDeferredValue=function(U){return pe.current.useDeferredValue(U)},Ne.useEffect=function(U,B){return pe.current.useEffect(U,B)},Ne.useId=function(){return pe.current.useId()},Ne.useImperativeHandle=function(U,B,le){return pe.current.useImperativeHandle(U,B,le)},Ne.useInsertionEffect=function(U,B){return pe.current.useInsertionEffect(U,B)},Ne.useLayoutEffect=function(U,B){return pe.current.useLayoutEffect(U,B)},Ne.useMemo=function(U,B){return pe.current.useMemo(U,B)},Ne.useReducer=function(U,B,le){return pe.current.useReducer(U,B,le)},Ne.useRef=function(U){return pe.current.useRef(U)},Ne.useState=function(U){return pe.current.useState(U)},Ne.useSyncExternalStore=function(U,B,le){return pe.current.useSyncExternalStore(U,B,le)},Ne.useTransition=function(){return pe.current.useTransition()},Ne.version="18.3.1",Ne}var Bm;function Ah(){return Bm||(Bm=1,hd.exports=nw()),hd.exports}var $m;function sw(){if($m)return va;$m=1;var t=Ah(),e=Symbol.for("react.element"),n=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,r=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function l(u,d,f){var m,g={},y=null,x=null;f!==void 0&&(y=""+f),d.key!==void 0&&(y=""+d.key),d.ref!==void 0&&(x=d.ref);for(m in d)s.call(d,m)&&!a.hasOwnProperty(m)&&(g[m]=d[m]);if(u&&u.defaultProps)for(m in d=u.defaultProps,d)g[m]===void 0&&(g[m]=d[m]);return{$$typeof:e,type:u,key:y,ref:x,props:g,_owner:r.current}}return va.Fragment=n,va.jsx=l,va.jsxs=l,va}var zm;function rw(){return zm||(zm=1,dd.exports=sw()),dd.exports}var c=rw(),j=Ah();const Ps=tw(j),iw=ew({__proto__:null,default:Ps},[j]);var xl={},fd={exports:{}},en={},pd={exports:{}},md={};var Um;function aw(){return Um||(Um=1,(function(t){function e(ee,ce){var ie=ee.length;ee.push(ce);e:for(;0<ie;){var U=ie-1>>>1,B=ee[U];if(0<r(B,ce))ee[U]=ce,ee[ie]=B,ie=U;else break e}}function n(ee){return ee.length===0?null:ee[0]}function s(ee){if(ee.length===0)return null;var ce=ee[0],ie=ee.pop();if(ie!==ce){ee[0]=ie;e:for(var U=0,B=ee.length,le=B>>>1;U<le;){var ae=2*(U+1)-1,ge=ee[ae],we=ae+1,Le=ee[we];if(0>r(ge,ie))we<B&&0>r(Le,ge)?(ee[U]=Le,ee[we]=ie,U=we):(ee[U]=ge,ee[ae]=ie,U=ae);else if(we<B&&0>r(Le,ie))ee[U]=Le,ee[we]=ie,U=we;else break e}}return ce}function r(ee,ce){var ie=ee.sortIndex-ce.sortIndex;return ie!==0?ie:ee.id-ce.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var l=Date,u=l.now();t.unstable_now=function(){return l.now()-u}}var d=[],f=[],m=1,g=null,y=3,x=!1,_=!1,k=!1,b=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function C(ee){for(var ce=n(f);ce!==null;){if(ce.callback===null)s(f);else if(ce.startTime<=ee)s(f),ce.sortIndex=ce.expirationTime,e(d,ce);else break;ce=n(f)}}function T(ee){if(k=!1,C(ee),!_)if(n(d)!==null)_=!0,re(A);else{var ce=n(f);ce!==null&&pe(T,ce.startTime-ee)}}function A(ee,ce){_=!1,k&&(k=!1,S(D),D=-1),x=!0;var ie=y;try{for(C(ce),g=n(d);g!==null&&(!(g.expirationTime>ce)||ee&&!F());){var U=g.callback;if(typeof U=="function"){g.callback=null,y=g.priorityLevel;var B=U(g.expirationTime<=ce);ce=t.unstable_now(),typeof B=="function"?g.callback=B:g===n(d)&&s(d),C(ce)}else s(d);g=n(d)}if(g!==null)var le=!0;else{var ae=n(f);ae!==null&&pe(T,ae.startTime-ce),le=!1}return le}finally{g=null,y=ie,x=!1}}var z=!1,E=null,D=-1,M=5,N=-1;function F(){return!(t.unstable_now()-N<M)}function H(){if(E!==null){var ee=t.unstable_now();N=ee;var ce=!0;try{ce=E(!0,ee)}finally{ce?J():(z=!1,E=null)}}else z=!1}var J;if(typeof I=="function")J=function(){I(H)};else if(typeof MessageChannel<"u"){var Y=new MessageChannel,X=Y.port2;Y.port1.onmessage=H,J=function(){X.postMessage(null)}}else J=function(){b(H,0)};function re(ee){E=ee,z||(z=!0,J())}function pe(ee,ce){D=b(function(){ee(t.unstable_now())},ce)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ee){ee.callback=null},t.unstable_continueExecution=function(){_||x||(_=!0,re(A))},t.unstable_forceFrameRate=function(ee){0>ee||125<ee?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<ee?Math.floor(1e3/ee):5},t.unstable_getCurrentPriorityLevel=function(){return y},t.unstable_getFirstCallbackNode=function(){return n(d)},t.unstable_next=function(ee){switch(y){case 1:case 2:case 3:var ce=3;break;default:ce=y}var ie=y;y=ce;try{return ee()}finally{y=ie}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(ee,ce){switch(ee){case 1:case 2:case 3:case 4:case 5:break;default:ee=3}var ie=y;y=ee;try{return ce()}finally{y=ie}},t.unstable_scheduleCallback=function(ee,ce,ie){var U=t.unstable_now();switch(typeof ie=="object"&&ie!==null?(ie=ie.delay,ie=typeof ie=="number"&&0<ie?U+ie:U):ie=U,ee){case 1:var B=-1;break;case 2:B=250;break;case 5:B=1073741823;break;case 4:B=1e4;break;default:B=5e3}return B=ie+B,ee={id:m++,callback:ce,priorityLevel:ee,startTime:ie,expirationTime:B,sortIndex:-1},ie>U?(ee.sortIndex=ie,e(f,ee),n(d)===null&&ee===n(f)&&(k?(S(D),D=-1):k=!0,pe(T,ie-U))):(ee.sortIndex=B,e(d,ee),_||x||(_=!0,re(A))),ee},t.unstable_shouldYield=F,t.unstable_wrapCallback=function(ee){var ce=y;return function(){var ie=y;y=ce;try{return ee.apply(this,arguments)}finally{y=ie}}}})(md)),md}var Wm;function ow(){return Wm||(Wm=1,pd.exports=aw()),pd.exports}var Vm;function lw(){if(Vm)return en;Vm=1;var t=Ah(),e=ow();function n(i){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+i,h=1;h<arguments.length;h++)o+="&args[]="+encodeURIComponent(arguments[h]);return"Minified React error #"+i+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,r={};function a(i,o){l(i,o),l(i+"Capture",o)}function l(i,o){for(r[i]=o,i=0;i<o.length;i++)s.add(o[i])}var u=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),d=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m={},g={};function y(i){return d.call(g,i)?!0:d.call(m,i)?!1:f.test(i)?g[i]=!0:(m[i]=!0,!1)}function x(i,o,h,p){if(h!==null&&h.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return p?!1:h!==null?!h.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function _(i,o,h,p){if(o===null||typeof o>"u"||x(i,o,h,p))return!0;if(p)return!1;if(h!==null)switch(h.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function k(i,o,h,p,v,w,P){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=p,this.attributeNamespace=v,this.mustUseProperty=h,this.propertyName=i,this.type=o,this.sanitizeURL=w,this.removeEmptyString=P}var b={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){b[i]=new k(i,0,!1,i,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var o=i[0];b[o]=new k(o,1,!1,i[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(i){b[i]=new k(i,2,!1,i.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){b[i]=new k(i,2,!1,i,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){b[i]=new k(i,3,!1,i.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(i){b[i]=new k(i,3,!0,i,null,!1,!1)}),["capture","download"].forEach(function(i){b[i]=new k(i,4,!1,i,null,!1,!1)}),["cols","rows","size","span"].forEach(function(i){b[i]=new k(i,6,!1,i,null,!1,!1)}),["rowSpan","start"].forEach(function(i){b[i]=new k(i,5,!1,i.toLowerCase(),null,!1,!1)});var S=/[\-:]([a-z])/g;function I(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var o=i.replace(S,I);b[o]=new k(o,1,!1,i,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var o=i.replace(S,I);b[o]=new k(o,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(i){var o=i.replace(S,I);b[o]=new k(o,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(i){b[i]=new k(i,1,!1,i.toLowerCase(),null,!1,!1)}),b.xlinkHref=new k("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(i){b[i]=new k(i,1,!1,i.toLowerCase(),null,!0,!0)});function C(i,o,h,p){var v=b.hasOwnProperty(o)?b[o]:null;(v!==null?v.type!==0:p||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(_(o,h,v,p)&&(h=null),p||v===null?y(o)&&(h===null?i.removeAttribute(o):i.setAttribute(o,""+h)):v.mustUseProperty?i[v.propertyName]=h===null?v.type===3?!1:"":h:(o=v.attributeName,p=v.attributeNamespace,h===null?i.removeAttribute(o):(v=v.type,h=v===3||v===4&&h===!0?"":""+h,p?i.setAttributeNS(p,o,h):i.setAttribute(o,h))))}var T=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,A=Symbol.for("react.element"),z=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),D=Symbol.for("react.strict_mode"),M=Symbol.for("react.profiler"),N=Symbol.for("react.provider"),F=Symbol.for("react.context"),H=Symbol.for("react.forward_ref"),J=Symbol.for("react.suspense"),Y=Symbol.for("react.suspense_list"),X=Symbol.for("react.memo"),re=Symbol.for("react.lazy"),pe=Symbol.for("react.offscreen"),ee=Symbol.iterator;function ce(i){return i===null||typeof i!="object"?null:(i=ee&&i[ee]||i["@@iterator"],typeof i=="function"?i:null)}var ie=Object.assign,U;function B(i){if(U===void 0)try{throw Error()}catch(h){var o=h.stack.trim().match(/\n( *(at )?)/);U=o&&o[1]||""}return`
`+U+i}var le=!1;function ae(i,o){if(!i||le)return"";le=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(K){var p=K}Reflect.construct(i,[],o)}else{try{o.call()}catch(K){p=K}i.call(o.prototype)}else{try{throw Error()}catch(K){p=K}i()}}catch(K){if(K&&p&&typeof K.stack=="string"){for(var v=K.stack.split(`
`),w=p.stack.split(`
`),P=v.length-1,O=w.length-1;1<=P&&0<=O&&v[P]!==w[O];)O--;for(;1<=P&&0<=O;P--,O--)if(v[P]!==w[O]){if(P!==1||O!==1)do if(P--,O--,0>O||v[P]!==w[O]){var L=`
`+v[P].replace(" at new "," at ");return i.displayName&&L.includes("<anonymous>")&&(L=L.replace("<anonymous>",i.displayName)),L}while(1<=P&&0<=O);break}}}finally{le=!1,Error.prepareStackTrace=h}return(i=i?i.displayName||i.name:"")?B(i):""}function ge(i){switch(i.tag){case 5:return B(i.type);case 16:return B("Lazy");case 13:return B("Suspense");case 19:return B("SuspenseList");case 0:case 2:case 15:return i=ae(i.type,!1),i;case 11:return i=ae(i.type.render,!1),i;case 1:return i=ae(i.type,!0),i;default:return""}}function we(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case E:return"Fragment";case z:return"Portal";case M:return"Profiler";case D:return"StrictMode";case J:return"Suspense";case Y:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case F:return(i.displayName||"Context")+".Consumer";case N:return(i._context.displayName||"Context")+".Provider";case H:var o=i.render;return i=i.displayName,i||(i=o.displayName||o.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case X:return o=i.displayName||null,o!==null?o:we(i.type)||"Memo";case re:o=i._payload,i=i._init;try{return we(i(o))}catch{}}return null}function Le(i){var o=i.type;switch(i.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=o.render,i=i.displayName||i.name||"",o.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return we(o);case 8:return o===D?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function Te(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function De(i){var o=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function mt(i){var o=De(i)?"checked":"value",h=Object.getOwnPropertyDescriptor(i.constructor.prototype,o),p=""+i[o];if(!i.hasOwnProperty(o)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var v=h.get,w=h.set;return Object.defineProperty(i,o,{configurable:!0,get:function(){return v.call(this)},set:function(P){p=""+P,w.call(this,P)}}),Object.defineProperty(i,o,{enumerable:h.enumerable}),{getValue:function(){return p},setValue:function(P){p=""+P},stopTracking:function(){i._valueTracker=null,delete i[o]}}}}function Kt(i){i._valueTracker||(i._valueTracker=mt(i))}function mn(i){if(!i)return!1;var o=i._valueTracker;if(!o)return!0;var h=o.getValue(),p="";return i&&(p=De(i)?i.checked?"true":"false":i.value),i=p,i!==h?(o.setValue(i),!0):!1}function as(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function Ue(i,o){var h=o.checked;return ie({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:h??i._wrapperState.initialChecked})}function os(i,o){var h=o.defaultValue==null?"":o.defaultValue,p=o.checked!=null?o.checked:o.defaultChecked;h=Te(o.value!=null?o.value:h),i._wrapperState={initialChecked:p,initialValue:h,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function ls(i,o){o=o.checked,o!=null&&C(i,"checked",o,!1)}function Wn(i,o){ls(i,o);var h=Te(o.value),p=o.type;if(h!=null)p==="number"?(h===0&&i.value===""||i.value!=h)&&(i.value=""+h):i.value!==""+h&&(i.value=""+h);else if(p==="submit"||p==="reset"){i.removeAttribute("value");return}o.hasOwnProperty("value")?Ut(i,o.type,h):o.hasOwnProperty("defaultValue")&&Ut(i,o.type,Te(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(i.defaultChecked=!!o.defaultChecked)}function Sn(i,o,h){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var p=o.type;if(!(p!=="submit"&&p!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+i._wrapperState.initialValue,h||o===i.value||(i.value=o),i.defaultValue=o}h=i.name,h!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,h!==""&&(i.name=h)}function Ut(i,o,h){(o!=="number"||as(i.ownerDocument)!==i)&&(h==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+h&&(i.defaultValue=""+h))}var At=Array.isArray;function vt(i,o,h,p){if(i=i.options,o){o={};for(var v=0;v<h.length;v++)o["$"+h[v]]=!0;for(h=0;h<i.length;h++)v=o.hasOwnProperty("$"+i[h].value),i[h].selected!==v&&(i[h].selected=v),v&&p&&(i[h].defaultSelected=!0)}else{for(h=""+Te(h),o=null,v=0;v<i.length;v++){if(i[v].value===h){i[v].selected=!0,p&&(i[v].defaultSelected=!0);return}o!==null||i[v].disabled||(o=i[v])}o!==null&&(o.selected=!0)}}function Ot(i,o){if(o.dangerouslySetInnerHTML!=null)throw Error(n(91));return ie({},o,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function jn(i,o){var h=o.value;if(h==null){if(h=o.children,o=o.defaultValue,h!=null){if(o!=null)throw Error(n(92));if(At(h)){if(1<h.length)throw Error(n(93));h=h[0]}o=h}o==null&&(o=""),h=o}i._wrapperState={initialValue:Te(h)}}function Gt(i,o){var h=Te(o.value),p=Te(o.defaultValue);h!=null&&(h=""+h,h!==i.value&&(i.value=h),o.defaultValue==null&&i.defaultValue!==h&&(i.defaultValue=h)),p!=null&&(i.defaultValue=""+p)}function Cn(i){var o=i.textContent;o===i._wrapperState.initialValue&&o!==""&&o!==null&&(i.value=o)}function Vn(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function qn(i,o){return i==null||i==="http://www.w3.org/1999/xhtml"?Vn(o):i==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var Hn,fr=(function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,h,p,v){MSApp.execUnsafeLocalFunction(function(){return i(o,h,p,v)})}:i})(function(i,o){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=o;else{for(Hn=Hn||document.createElement("div"),Hn.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=Hn.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;o.firstChild;)i.appendChild(o.firstChild)}});function Kn(i,o){if(o){var h=i.firstChild;if(h&&h===i.lastChild&&h.nodeType===3){h.nodeValue=o;return}}i.textContent=o}var Gn={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ns=["Webkit","ms","Moz","O"];Object.keys(Gn).forEach(function(i){Ns.forEach(function(o){o=o+i.charAt(0).toUpperCase()+i.substring(1),Gn[o]=Gn[i]})});function Hr(i,o,h){return o==null||typeof o=="boolean"||o===""?"":h||typeof o!="number"||o===0||Gn.hasOwnProperty(i)&&Gn[i]?(""+o).trim():o+"px"}function He(i,o){i=i.style;for(var h in o)if(o.hasOwnProperty(h)){var p=h.indexOf("--")===0,v=Hr(h,o[h],p);h==="float"&&(h="cssFloat"),p?i.setProperty(h,v):i[h]=v}}var rn=ie({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function As(i,o){if(o){if(rn[i]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(n(137,i));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(n(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(n(61))}if(o.style!=null&&typeof o.style!="object")throw Error(n(62))}}function Wt(i,o){if(i.indexOf("-")===-1)return typeof o.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var W=null;function Se(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var ze=null,Ze=null,R=null;function ne(i){if(i=sa(i)){if(typeof ze!="function")throw Error(n(280));var o=i.stateNode;o&&(o=Ro(o),ze(i.stateNode,i.type,o))}}function oe(i){Ze?R?R.push(i):R=[i]:Ze=i}function je(){if(Ze){var i=Ze,o=R;if(R=Ze=null,ne(i),o)for(i=0;i<o.length;i++)ne(o[i])}}function Fe(i,o){return i(o)}function dt(){}var an=!1;function cs(i,o,h){if(an)return i(o,h);an=!0;try{return Fe(i,o,h)}finally{an=!1,(Ze!==null||R!==null)&&(dt(),je())}}function Pn(i,o){var h=i.stateNode;if(h===null)return null;var p=Ro(h);if(p===null)return null;h=p[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(i=i.type,p=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!p;break e;default:i=!1}if(i)return null;if(h&&typeof h!="function")throw Error(n(231,o,typeof h));return h}var Os=!1;if(u)try{var In={};Object.defineProperty(In,"passive",{get:function(){Os=!0}}),window.addEventListener("test",In,In),window.removeEventListener("test",In,In)}catch{Os=!1}function Fi(i,o,h,p,v,w,P,O,L){var K=Array.prototype.slice.call(arguments,3);try{o.apply(h,K)}catch(Z){this.onError(Z)}}var pr=!1,Kr=null,fo=!1,Tc=null,ob={onError:function(i){pr=!0,Kr=i}};function lb(i,o,h,p,v,w,P,O,L){pr=!1,Kr=null,Fi.apply(ob,arguments)}function cb(i,o,h,p,v,w,P,O,L){if(lb.apply(this,arguments),pr){if(pr){var K=Kr;pr=!1,Kr=null}else throw Error(n(198));fo||(fo=!0,Tc=K)}}function mr(i){var o=i,h=i;if(i.alternate)for(;o.return;)o=o.return;else{i=o;do o=i,(o.flags&4098)!==0&&(h=o.return),i=o.return;while(i)}return o.tag===3?h:null}function of(i){if(i.tag===13){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function lf(i){if(mr(i)!==i)throw Error(n(188))}function ub(i){var o=i.alternate;if(!o){if(o=mr(i),o===null)throw Error(n(188));return o!==i?null:i}for(var h=i,p=o;;){var v=h.return;if(v===null)break;var w=v.alternate;if(w===null){if(p=v.return,p!==null){h=p;continue}break}if(v.child===w.child){for(w=v.child;w;){if(w===h)return lf(v),i;if(w===p)return lf(v),o;w=w.sibling}throw Error(n(188))}if(h.return!==p.return)h=v,p=w;else{for(var P=!1,O=v.child;O;){if(O===h){P=!0,h=v,p=w;break}if(O===p){P=!0,p=v,h=w;break}O=O.sibling}if(!P){for(O=w.child;O;){if(O===h){P=!0,h=w,p=v;break}if(O===p){P=!0,p=w,h=v;break}O=O.sibling}if(!P)throw Error(n(189))}}if(h.alternate!==p)throw Error(n(190))}if(h.tag!==3)throw Error(n(188));return h.stateNode.current===h?i:o}function cf(i){return i=ub(i),i!==null?uf(i):null}function uf(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var o=uf(i);if(o!==null)return o;i=i.sibling}return null}var df=e.unstable_scheduleCallback,hf=e.unstable_cancelCallback,db=e.unstable_shouldYield,hb=e.unstable_requestPaint,ht=e.unstable_now,fb=e.unstable_getCurrentPriorityLevel,Nc=e.unstable_ImmediatePriority,ff=e.unstable_UserBlockingPriority,po=e.unstable_NormalPriority,pb=e.unstable_LowPriority,pf=e.unstable_IdlePriority,mo=null,Yn=null;function mb(i){if(Yn&&typeof Yn.onCommitFiberRoot=="function")try{Yn.onCommitFiberRoot(mo,i,void 0,(i.current.flags&128)===128)}catch{}}var En=Math.clz32?Math.clz32:vb,gb=Math.log,yb=Math.LN2;function vb(i){return i>>>=0,i===0?32:31-(gb(i)/yb|0)|0}var go=64,yo=4194304;function Bi(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function vo(i,o){var h=i.pendingLanes;if(h===0)return 0;var p=0,v=i.suspendedLanes,w=i.pingedLanes,P=h&268435455;if(P!==0){var O=P&~v;O!==0?p=Bi(O):(w&=P,w!==0&&(p=Bi(w)))}else P=h&~v,P!==0?p=Bi(P):w!==0&&(p=Bi(w));if(p===0)return 0;if(o!==0&&o!==p&&(o&v)===0&&(v=p&-p,w=o&-o,v>=w||v===16&&(w&4194240)!==0))return o;if((p&4)!==0&&(p|=h&16),o=i.entangledLanes,o!==0)for(i=i.entanglements,o&=p;0<o;)h=31-En(o),v=1<<h,p|=i[h],o&=~v;return p}function xb(i,o){switch(i){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function bb(i,o){for(var h=i.suspendedLanes,p=i.pingedLanes,v=i.expirationTimes,w=i.pendingLanes;0<w;){var P=31-En(w),O=1<<P,L=v[P];L===-1?((O&h)===0||(O&p)!==0)&&(v[P]=xb(O,o)):L<=o&&(i.expiredLanes|=O),w&=~O}}function Ac(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function mf(){var i=go;return go<<=1,(go&4194240)===0&&(go=64),i}function Oc(i){for(var o=[],h=0;31>h;h++)o.push(i);return o}function $i(i,o,h){i.pendingLanes|=o,o!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,o=31-En(o),i[o]=h}function wb(i,o){var h=i.pendingLanes&~o;i.pendingLanes=o,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=o,i.mutableReadLanes&=o,i.entangledLanes&=o,o=i.entanglements;var p=i.eventTimes;for(i=i.expirationTimes;0<h;){var v=31-En(h),w=1<<v;o[v]=0,p[v]=-1,i[v]=-1,h&=~w}}function Rc(i,o){var h=i.entangledLanes|=o;for(i=i.entanglements;h;){var p=31-En(h),v=1<<p;v&o|i[p]&o&&(i[p]|=o),h&=~v}}var We=0;function gf(i){return i&=-i,1<i?4<i?(i&268435455)!==0?16:536870912:4:1}var yf,Mc,vf,xf,bf,Lc=!1,xo=[],Rs=null,Ms=null,Ls=null,zi=new Map,Ui=new Map,Ds=[],_b="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function wf(i,o){switch(i){case"focusin":case"focusout":Rs=null;break;case"dragenter":case"dragleave":Ms=null;break;case"mouseover":case"mouseout":Ls=null;break;case"pointerover":case"pointerout":zi.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ui.delete(o.pointerId)}}function Wi(i,o,h,p,v,w){return i===null||i.nativeEvent!==w?(i={blockedOn:o,domEventName:h,eventSystemFlags:p,nativeEvent:w,targetContainers:[v]},o!==null&&(o=sa(o),o!==null&&Mc(o)),i):(i.eventSystemFlags|=p,o=i.targetContainers,v!==null&&o.indexOf(v)===-1&&o.push(v),i)}function kb(i,o,h,p,v){switch(o){case"focusin":return Rs=Wi(Rs,i,o,h,p,v),!0;case"dragenter":return Ms=Wi(Ms,i,o,h,p,v),!0;case"mouseover":return Ls=Wi(Ls,i,o,h,p,v),!0;case"pointerover":var w=v.pointerId;return zi.set(w,Wi(zi.get(w)||null,i,o,h,p,v)),!0;case"gotpointercapture":return w=v.pointerId,Ui.set(w,Wi(Ui.get(w)||null,i,o,h,p,v)),!0}return!1}function _f(i){var o=gr(i.target);if(o!==null){var h=mr(o);if(h!==null){if(o=h.tag,o===13){if(o=of(h),o!==null){i.blockedOn=o,bf(i.priority,function(){vf(h)});return}}else if(o===3&&h.stateNode.current.memoizedState.isDehydrated){i.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}i.blockedOn=null}function bo(i){if(i.blockedOn!==null)return!1;for(var o=i.targetContainers;0<o.length;){var h=Fc(i.domEventName,i.eventSystemFlags,o[0],i.nativeEvent);if(h===null){h=i.nativeEvent;var p=new h.constructor(h.type,h);W=p,h.target.dispatchEvent(p),W=null}else return o=sa(h),o!==null&&Mc(o),i.blockedOn=h,!1;o.shift()}return!0}function kf(i,o,h){bo(i)&&h.delete(o)}function Sb(){Lc=!1,Rs!==null&&bo(Rs)&&(Rs=null),Ms!==null&&bo(Ms)&&(Ms=null),Ls!==null&&bo(Ls)&&(Ls=null),zi.forEach(kf),Ui.forEach(kf)}function Vi(i,o){i.blockedOn===o&&(i.blockedOn=null,Lc||(Lc=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Sb)))}function qi(i){function o(v){return Vi(v,i)}if(0<xo.length){Vi(xo[0],i);for(var h=1;h<xo.length;h++){var p=xo[h];p.blockedOn===i&&(p.blockedOn=null)}}for(Rs!==null&&Vi(Rs,i),Ms!==null&&Vi(Ms,i),Ls!==null&&Vi(Ls,i),zi.forEach(o),Ui.forEach(o),h=0;h<Ds.length;h++)p=Ds[h],p.blockedOn===i&&(p.blockedOn=null);for(;0<Ds.length&&(h=Ds[0],h.blockedOn===null);)_f(h),h.blockedOn===null&&Ds.shift()}var Gr=T.ReactCurrentBatchConfig,wo=!0;function jb(i,o,h,p){var v=We,w=Gr.transition;Gr.transition=null;try{We=1,Dc(i,o,h,p)}finally{We=v,Gr.transition=w}}function Cb(i,o,h,p){var v=We,w=Gr.transition;Gr.transition=null;try{We=4,Dc(i,o,h,p)}finally{We=v,Gr.transition=w}}function Dc(i,o,h,p){if(wo){var v=Fc(i,o,h,p);if(v===null)tu(i,o,p,_o,h),wf(i,p);else if(kb(v,i,o,h,p))p.stopPropagation();else if(wf(i,p),o&4&&-1<_b.indexOf(i)){for(;v!==null;){var w=sa(v);if(w!==null&&yf(w),w=Fc(i,o,h,p),w===null&&tu(i,o,p,_o,h),w===v)break;v=w}v!==null&&p.stopPropagation()}else tu(i,o,p,null,h)}}var _o=null;function Fc(i,o,h,p){if(_o=null,i=Se(p),i=gr(i),i!==null)if(o=mr(i),o===null)i=null;else if(h=o.tag,h===13){if(i=of(o),i!==null)return i;i=null}else if(h===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;i=null}else o!==i&&(i=null);return _o=i,null}function Sf(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(fb()){case Nc:return 1;case ff:return 4;case po:case pb:return 16;case pf:return 536870912;default:return 16}default:return 16}}var Fs=null,Bc=null,ko=null;function jf(){if(ko)return ko;var i,o=Bc,h=o.length,p,v="value"in Fs?Fs.value:Fs.textContent,w=v.length;for(i=0;i<h&&o[i]===v[i];i++);var P=h-i;for(p=1;p<=P&&o[h-p]===v[w-p];p++);return ko=v.slice(i,1<p?1-p:void 0)}function So(i){var o=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&o===13&&(i=13)):i=o,i===10&&(i=13),32<=i||i===13?i:0}function jo(){return!0}function Cf(){return!1}function on(i){function o(h,p,v,w,P){this._reactName=h,this._targetInst=v,this.type=p,this.nativeEvent=w,this.target=P,this.currentTarget=null;for(var O in i)i.hasOwnProperty(O)&&(h=i[O],this[O]=h?h(w):w[O]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?jo:Cf,this.isPropagationStopped=Cf,this}return ie(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=jo)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=jo)},persist:function(){},isPersistent:jo}),o}var Yr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},$c=on(Yr),Hi=ie({},Yr,{view:0,detail:0}),Pb=on(Hi),zc,Uc,Ki,Co=ie({},Hi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Vc,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Ki&&(Ki&&i.type==="mousemove"?(zc=i.screenX-Ki.screenX,Uc=i.screenY-Ki.screenY):Uc=zc=0,Ki=i),zc)},movementY:function(i){return"movementY"in i?i.movementY:Uc}}),Pf=on(Co),Ib=ie({},Co,{dataTransfer:0}),Eb=on(Ib),Tb=ie({},Hi,{relatedTarget:0}),Wc=on(Tb),Nb=ie({},Yr,{animationName:0,elapsedTime:0,pseudoElement:0}),Ab=on(Nb),Ob=ie({},Yr,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),Rb=on(Ob),Mb=ie({},Yr,{data:0}),If=on(Mb),Lb={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Db={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Fb={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Bb(i){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(i):(i=Fb[i])?!!o[i]:!1}function Vc(){return Bb}var $b=ie({},Hi,{key:function(i){if(i.key){var o=Lb[i.key]||i.key;if(o!=="Unidentified")return o}return i.type==="keypress"?(i=So(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?Db[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Vc,charCode:function(i){return i.type==="keypress"?So(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?So(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),zb=on($b),Ub=ie({},Co,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ef=on(Ub),Wb=ie({},Hi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Vc}),Vb=on(Wb),qb=ie({},Yr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Hb=on(qb),Kb=ie({},Co,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Gb=on(Kb),Yb=[9,13,27,32],qc=u&&"CompositionEvent"in window,Gi=null;u&&"documentMode"in document&&(Gi=document.documentMode);var Jb=u&&"TextEvent"in window&&!Gi,Tf=u&&(!qc||Gi&&8<Gi&&11>=Gi),Nf=" ",Af=!1;function Of(i,o){switch(i){case"keyup":return Yb.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Rf(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Jr=!1;function Xb(i,o){switch(i){case"compositionend":return Rf(o);case"keypress":return o.which!==32?null:(Af=!0,Nf);case"textInput":return i=o.data,i===Nf&&Af?null:i;default:return null}}function Qb(i,o){if(Jr)return i==="compositionend"||!qc&&Of(i,o)?(i=jf(),ko=Bc=Fs=null,Jr=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Tf&&o.locale!=="ko"?null:o.data;default:return null}}var Zb={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Mf(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o==="input"?!!Zb[i.type]:o==="textarea"}function Lf(i,o,h,p){oe(p),o=No(o,"onChange"),0<o.length&&(h=new $c("onChange","change",null,h,p),i.push({event:h,listeners:o}))}var Yi=null,Ji=null;function e0(i){ep(i,0)}function Po(i){var o=ti(i);if(mn(o))return i}function t0(i,o){if(i==="change")return o}var Df=!1;if(u){var Hc;if(u){var Kc="oninput"in document;if(!Kc){var Ff=document.createElement("div");Ff.setAttribute("oninput","return;"),Kc=typeof Ff.oninput=="function"}Hc=Kc}else Hc=!1;Df=Hc&&(!document.documentMode||9<document.documentMode)}function Bf(){Yi&&(Yi.detachEvent("onpropertychange",$f),Ji=Yi=null)}function $f(i){if(i.propertyName==="value"&&Po(Ji)){var o=[];Lf(o,Ji,i,Se(i)),cs(e0,o)}}function n0(i,o,h){i==="focusin"?(Bf(),Yi=o,Ji=h,Yi.attachEvent("onpropertychange",$f)):i==="focusout"&&Bf()}function s0(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Po(Ji)}function r0(i,o){if(i==="click")return Po(o)}function i0(i,o){if(i==="input"||i==="change")return Po(o)}function a0(i,o){return i===o&&(i!==0||1/i===1/o)||i!==i&&o!==o}var Tn=typeof Object.is=="function"?Object.is:a0;function Xi(i,o){if(Tn(i,o))return!0;if(typeof i!="object"||i===null||typeof o!="object"||o===null)return!1;var h=Object.keys(i),p=Object.keys(o);if(h.length!==p.length)return!1;for(p=0;p<h.length;p++){var v=h[p];if(!d.call(o,v)||!Tn(i[v],o[v]))return!1}return!0}function zf(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Uf(i,o){var h=zf(i);i=0;for(var p;h;){if(h.nodeType===3){if(p=i+h.textContent.length,i<=o&&p>=o)return{node:h,offset:o-i};i=p}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=zf(h)}}function Wf(i,o){return i&&o?i===o?!0:i&&i.nodeType===3?!1:o&&o.nodeType===3?Wf(i,o.parentNode):"contains"in i?i.contains(o):i.compareDocumentPosition?!!(i.compareDocumentPosition(o)&16):!1:!1}function Vf(){for(var i=window,o=as();o instanceof i.HTMLIFrameElement;){try{var h=typeof o.contentWindow.location.href=="string"}catch{h=!1}if(h)i=o.contentWindow;else break;o=as(i.document)}return o}function Gc(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o&&(o==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||o==="textarea"||i.contentEditable==="true")}function o0(i){var o=Vf(),h=i.focusedElem,p=i.selectionRange;if(o!==h&&h&&h.ownerDocument&&Wf(h.ownerDocument.documentElement,h)){if(p!==null&&Gc(h)){if(o=p.start,i=p.end,i===void 0&&(i=o),"selectionStart"in h)h.selectionStart=o,h.selectionEnd=Math.min(i,h.value.length);else if(i=(o=h.ownerDocument||document)&&o.defaultView||window,i.getSelection){i=i.getSelection();var v=h.textContent.length,w=Math.min(p.start,v);p=p.end===void 0?w:Math.min(p.end,v),!i.extend&&w>p&&(v=p,p=w,w=v),v=Uf(h,w);var P=Uf(h,p);v&&P&&(i.rangeCount!==1||i.anchorNode!==v.node||i.anchorOffset!==v.offset||i.focusNode!==P.node||i.focusOffset!==P.offset)&&(o=o.createRange(),o.setStart(v.node,v.offset),i.removeAllRanges(),w>p?(i.addRange(o),i.extend(P.node,P.offset)):(o.setEnd(P.node,P.offset),i.addRange(o)))}}for(o=[],i=h;i=i.parentNode;)i.nodeType===1&&o.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof h.focus=="function"&&h.focus(),h=0;h<o.length;h++)i=o[h],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var l0=u&&"documentMode"in document&&11>=document.documentMode,Xr=null,Yc=null,Qi=null,Jc=!1;function qf(i,o,h){var p=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;Jc||Xr==null||Xr!==as(p)||(p=Xr,"selectionStart"in p&&Gc(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),Qi&&Xi(Qi,p)||(Qi=p,p=No(Yc,"onSelect"),0<p.length&&(o=new $c("onSelect","select",null,o,h),i.push({event:o,listeners:p}),o.target=Xr)))}function Io(i,o){var h={};return h[i.toLowerCase()]=o.toLowerCase(),h["Webkit"+i]="webkit"+o,h["Moz"+i]="moz"+o,h}var Qr={animationend:Io("Animation","AnimationEnd"),animationiteration:Io("Animation","AnimationIteration"),animationstart:Io("Animation","AnimationStart"),transitionend:Io("Transition","TransitionEnd")},Xc={},Hf={};u&&(Hf=document.createElement("div").style,"AnimationEvent"in window||(delete Qr.animationend.animation,delete Qr.animationiteration.animation,delete Qr.animationstart.animation),"TransitionEvent"in window||delete Qr.transitionend.transition);function Eo(i){if(Xc[i])return Xc[i];if(!Qr[i])return i;var o=Qr[i],h;for(h in o)if(o.hasOwnProperty(h)&&h in Hf)return Xc[i]=o[h];return i}var Kf=Eo("animationend"),Gf=Eo("animationiteration"),Yf=Eo("animationstart"),Jf=Eo("transitionend"),Xf=new Map,Qf="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Bs(i,o){Xf.set(i,o),a(o,[i])}for(var Qc=0;Qc<Qf.length;Qc++){var Zc=Qf[Qc],c0=Zc.toLowerCase(),u0=Zc[0].toUpperCase()+Zc.slice(1);Bs(c0,"on"+u0)}Bs(Kf,"onAnimationEnd"),Bs(Gf,"onAnimationIteration"),Bs(Yf,"onAnimationStart"),Bs("dblclick","onDoubleClick"),Bs("focusin","onFocus"),Bs("focusout","onBlur"),Bs(Jf,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Zi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),d0=new Set("cancel close invalid load scroll toggle".split(" ").concat(Zi));function Zf(i,o,h){var p=i.type||"unknown-event";i.currentTarget=h,cb(p,o,void 0,i),i.currentTarget=null}function ep(i,o){o=(o&4)!==0;for(var h=0;h<i.length;h++){var p=i[h],v=p.event;p=p.listeners;e:{var w=void 0;if(o)for(var P=p.length-1;0<=P;P--){var O=p[P],L=O.instance,K=O.currentTarget;if(O=O.listener,L!==w&&v.isPropagationStopped())break e;Zf(v,O,K),w=L}else for(P=0;P<p.length;P++){if(O=p[P],L=O.instance,K=O.currentTarget,O=O.listener,L!==w&&v.isPropagationStopped())break e;Zf(v,O,K),w=L}}}if(fo)throw i=Tc,fo=!1,Tc=null,i}function Je(i,o){var h=o[ou];h===void 0&&(h=o[ou]=new Set);var p=i+"__bubble";h.has(p)||(tp(o,i,2,!1),h.add(p))}function eu(i,o,h){var p=0;o&&(p|=4),tp(h,i,p,o)}var To="_reactListening"+Math.random().toString(36).slice(2);function ea(i){if(!i[To]){i[To]=!0,s.forEach(function(h){h!=="selectionchange"&&(d0.has(h)||eu(h,!1,i),eu(h,!0,i))});var o=i.nodeType===9?i:i.ownerDocument;o===null||o[To]||(o[To]=!0,eu("selectionchange",!1,o))}}function tp(i,o,h,p){switch(Sf(o)){case 1:var v=jb;break;case 4:v=Cb;break;default:v=Dc}h=v.bind(null,o,h,i),v=void 0,!Os||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(v=!0),p?v!==void 0?i.addEventListener(o,h,{capture:!0,passive:v}):i.addEventListener(o,h,!0):v!==void 0?i.addEventListener(o,h,{passive:v}):i.addEventListener(o,h,!1)}function tu(i,o,h,p,v){var w=p;if((o&1)===0&&(o&2)===0&&p!==null)e:for(;;){if(p===null)return;var P=p.tag;if(P===3||P===4){var O=p.stateNode.containerInfo;if(O===v||O.nodeType===8&&O.parentNode===v)break;if(P===4)for(P=p.return;P!==null;){var L=P.tag;if((L===3||L===4)&&(L=P.stateNode.containerInfo,L===v||L.nodeType===8&&L.parentNode===v))return;P=P.return}for(;O!==null;){if(P=gr(O),P===null)return;if(L=P.tag,L===5||L===6){p=w=P;continue e}O=O.parentNode}}p=p.return}cs(function(){var K=w,Z=Se(h),te=[];e:{var Q=Xf.get(i);if(Q!==void 0){var ue=$c,fe=i;switch(i){case"keypress":if(So(h)===0)break e;case"keydown":case"keyup":ue=zb;break;case"focusin":fe="focus",ue=Wc;break;case"focusout":fe="blur",ue=Wc;break;case"beforeblur":case"afterblur":ue=Wc;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ue=Pf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ue=Eb;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ue=Vb;break;case Kf:case Gf:case Yf:ue=Ab;break;case Jf:ue=Hb;break;case"scroll":ue=Pb;break;case"wheel":ue=Gb;break;case"copy":case"cut":case"paste":ue=Rb;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ue=Ef}var me=(o&4)!==0,ft=!me&&i==="scroll",V=me?Q!==null?Q+"Capture":null:Q;me=[];for(var $=K,q;$!==null;){q=$;var se=q.stateNode;if(q.tag===5&&se!==null&&(q=se,V!==null&&(se=Pn($,V),se!=null&&me.push(ta($,se,q)))),ft)break;$=$.return}0<me.length&&(Q=new ue(Q,fe,null,h,Z),te.push({event:Q,listeners:me}))}}if((o&7)===0){e:{if(Q=i==="mouseover"||i==="pointerover",ue=i==="mouseout"||i==="pointerout",Q&&h!==W&&(fe=h.relatedTarget||h.fromElement)&&(gr(fe)||fe[us]))break e;if((ue||Q)&&(Q=Z.window===Z?Z:(Q=Z.ownerDocument)?Q.defaultView||Q.parentWindow:window,ue?(fe=h.relatedTarget||h.toElement,ue=K,fe=fe?gr(fe):null,fe!==null&&(ft=mr(fe),fe!==ft||fe.tag!==5&&fe.tag!==6)&&(fe=null)):(ue=null,fe=K),ue!==fe)){if(me=Pf,se="onMouseLeave",V="onMouseEnter",$="mouse",(i==="pointerout"||i==="pointerover")&&(me=Ef,se="onPointerLeave",V="onPointerEnter",$="pointer"),ft=ue==null?Q:ti(ue),q=fe==null?Q:ti(fe),Q=new me(se,$+"leave",ue,h,Z),Q.target=ft,Q.relatedTarget=q,se=null,gr(Z)===K&&(me=new me(V,$+"enter",fe,h,Z),me.target=q,me.relatedTarget=ft,se=me),ft=se,ue&&fe)t:{for(me=ue,V=fe,$=0,q=me;q;q=Zr(q))$++;for(q=0,se=V;se;se=Zr(se))q++;for(;0<$-q;)me=Zr(me),$--;for(;0<q-$;)V=Zr(V),q--;for(;$--;){if(me===V||V!==null&&me===V.alternate)break t;me=Zr(me),V=Zr(V)}me=null}else me=null;ue!==null&&np(te,Q,ue,me,!1),fe!==null&&ft!==null&&np(te,ft,fe,me,!0)}}e:{if(Q=K?ti(K):window,ue=Q.nodeName&&Q.nodeName.toLowerCase(),ue==="select"||ue==="input"&&Q.type==="file")var ye=t0;else if(Mf(Q))if(Df)ye=i0;else{ye=s0;var xe=n0}else(ue=Q.nodeName)&&ue.toLowerCase()==="input"&&(Q.type==="checkbox"||Q.type==="radio")&&(ye=r0);if(ye&&(ye=ye(i,K))){Lf(te,ye,h,Z);break e}xe&&xe(i,Q,K),i==="focusout"&&(xe=Q._wrapperState)&&xe.controlled&&Q.type==="number"&&Ut(Q,"number",Q.value)}switch(xe=K?ti(K):window,i){case"focusin":(Mf(xe)||xe.contentEditable==="true")&&(Xr=xe,Yc=K,Qi=null);break;case"focusout":Qi=Yc=Xr=null;break;case"mousedown":Jc=!0;break;case"contextmenu":case"mouseup":case"dragend":Jc=!1,qf(te,h,Z);break;case"selectionchange":if(l0)break;case"keydown":case"keyup":qf(te,h,Z)}var be;if(qc)e:{switch(i){case"compositionstart":var Ce="onCompositionStart";break e;case"compositionend":Ce="onCompositionEnd";break e;case"compositionupdate":Ce="onCompositionUpdate";break e}Ce=void 0}else Jr?Of(i,h)&&(Ce="onCompositionEnd"):i==="keydown"&&h.keyCode===229&&(Ce="onCompositionStart");Ce&&(Tf&&h.locale!=="ko"&&(Jr||Ce!=="onCompositionStart"?Ce==="onCompositionEnd"&&Jr&&(be=jf()):(Fs=Z,Bc="value"in Fs?Fs.value:Fs.textContent,Jr=!0)),xe=No(K,Ce),0<xe.length&&(Ce=new If(Ce,i,null,h,Z),te.push({event:Ce,listeners:xe}),be?Ce.data=be:(be=Rf(h),be!==null&&(Ce.data=be)))),(be=Jb?Xb(i,h):Qb(i,h))&&(K=No(K,"onBeforeInput"),0<K.length&&(Z=new If("onBeforeInput","beforeinput",null,h,Z),te.push({event:Z,listeners:K}),Z.data=be))}ep(te,o)})}function ta(i,o,h){return{instance:i,listener:o,currentTarget:h}}function No(i,o){for(var h=o+"Capture",p=[];i!==null;){var v=i,w=v.stateNode;v.tag===5&&w!==null&&(v=w,w=Pn(i,h),w!=null&&p.unshift(ta(i,w,v)),w=Pn(i,o),w!=null&&p.push(ta(i,w,v))),i=i.return}return p}function Zr(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function np(i,o,h,p,v){for(var w=o._reactName,P=[];h!==null&&h!==p;){var O=h,L=O.alternate,K=O.stateNode;if(L!==null&&L===p)break;O.tag===5&&K!==null&&(O=K,v?(L=Pn(h,w),L!=null&&P.unshift(ta(h,L,O))):v||(L=Pn(h,w),L!=null&&P.push(ta(h,L,O)))),h=h.return}P.length!==0&&i.push({event:o,listeners:P})}var h0=/\r\n?/g,f0=/\u0000|\uFFFD/g;function sp(i){return(typeof i=="string"?i:""+i).replace(h0,`
`).replace(f0,"")}function Ao(i,o,h){if(o=sp(o),sp(i)!==o&&h)throw Error(n(425))}function Oo(){}var nu=null,su=null;function ru(i,o){return i==="textarea"||i==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var iu=typeof setTimeout=="function"?setTimeout:void 0,p0=typeof clearTimeout=="function"?clearTimeout:void 0,rp=typeof Promise=="function"?Promise:void 0,m0=typeof queueMicrotask=="function"?queueMicrotask:typeof rp<"u"?function(i){return rp.resolve(null).then(i).catch(g0)}:iu;function g0(i){setTimeout(function(){throw i})}function au(i,o){var h=o,p=0;do{var v=h.nextSibling;if(i.removeChild(h),v&&v.nodeType===8)if(h=v.data,h==="/$"){if(p===0){i.removeChild(v),qi(o);return}p--}else h!=="$"&&h!=="$?"&&h!=="$!"||p++;h=v}while(h);qi(o)}function $s(i){for(;i!=null;i=i.nextSibling){var o=i.nodeType;if(o===1||o===3)break;if(o===8){if(o=i.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return i}function ip(i){i=i.previousSibling;for(var o=0;i;){if(i.nodeType===8){var h=i.data;if(h==="$"||h==="$!"||h==="$?"){if(o===0)return i;o--}else h==="/$"&&o++}i=i.previousSibling}return null}var ei=Math.random().toString(36).slice(2),Jn="__reactFiber$"+ei,na="__reactProps$"+ei,us="__reactContainer$"+ei,ou="__reactEvents$"+ei,y0="__reactListeners$"+ei,v0="__reactHandles$"+ei;function gr(i){var o=i[Jn];if(o)return o;for(var h=i.parentNode;h;){if(o=h[us]||h[Jn]){if(h=o.alternate,o.child!==null||h!==null&&h.child!==null)for(i=ip(i);i!==null;){if(h=i[Jn])return h;i=ip(i)}return o}i=h,h=i.parentNode}return null}function sa(i){return i=i[Jn]||i[us],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function ti(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(n(33))}function Ro(i){return i[na]||null}var lu=[],ni=-1;function zs(i){return{current:i}}function Xe(i){0>ni||(i.current=lu[ni],lu[ni]=null,ni--)}function Ke(i,o){ni++,lu[ni]=i.current,i.current=o}var Us={},Rt=zs(Us),Yt=zs(!1),yr=Us;function si(i,o){var h=i.type.contextTypes;if(!h)return Us;var p=i.stateNode;if(p&&p.__reactInternalMemoizedUnmaskedChildContext===o)return p.__reactInternalMemoizedMaskedChildContext;var v={},w;for(w in h)v[w]=o[w];return p&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=o,i.__reactInternalMemoizedMaskedChildContext=v),v}function Jt(i){return i=i.childContextTypes,i!=null}function Mo(){Xe(Yt),Xe(Rt)}function ap(i,o,h){if(Rt.current!==Us)throw Error(n(168));Ke(Rt,o),Ke(Yt,h)}function op(i,o,h){var p=i.stateNode;if(o=o.childContextTypes,typeof p.getChildContext!="function")return h;p=p.getChildContext();for(var v in p)if(!(v in o))throw Error(n(108,Le(i)||"Unknown",v));return ie({},h,p)}function Lo(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||Us,yr=Rt.current,Ke(Rt,i),Ke(Yt,Yt.current),!0}function lp(i,o,h){var p=i.stateNode;if(!p)throw Error(n(169));h?(i=op(i,o,yr),p.__reactInternalMemoizedMergedChildContext=i,Xe(Yt),Xe(Rt),Ke(Rt,i)):Xe(Yt),Ke(Yt,h)}var ds=null,Do=!1,cu=!1;function cp(i){ds===null?ds=[i]:ds.push(i)}function x0(i){Do=!0,cp(i)}function Ws(){if(!cu&&ds!==null){cu=!0;var i=0,o=We;try{var h=ds;for(We=1;i<h.length;i++){var p=h[i];do p=p(!0);while(p!==null)}ds=null,Do=!1}catch(v){throw ds!==null&&(ds=ds.slice(i+1)),df(Nc,Ws),v}finally{We=o,cu=!1}}return null}var ri=[],ii=0,Fo=null,Bo=0,gn=[],yn=0,vr=null,hs=1,fs="";function xr(i,o){ri[ii++]=Bo,ri[ii++]=Fo,Fo=i,Bo=o}function up(i,o,h){gn[yn++]=hs,gn[yn++]=fs,gn[yn++]=vr,vr=i;var p=hs;i=fs;var v=32-En(p)-1;p&=~(1<<v),h+=1;var w=32-En(o)+v;if(30<w){var P=v-v%5;w=(p&(1<<P)-1).toString(32),p>>=P,v-=P,hs=1<<32-En(o)+v|h<<v|p,fs=w+i}else hs=1<<w|h<<v|p,fs=i}function uu(i){i.return!==null&&(xr(i,1),up(i,1,0))}function du(i){for(;i===Fo;)Fo=ri[--ii],ri[ii]=null,Bo=ri[--ii],ri[ii]=null;for(;i===vr;)vr=gn[--yn],gn[yn]=null,fs=gn[--yn],gn[yn]=null,hs=gn[--yn],gn[yn]=null}var ln=null,cn=null,et=!1,Nn=null;function dp(i,o){var h=wn(5,null,null,0);h.elementType="DELETED",h.stateNode=o,h.return=i,o=i.deletions,o===null?(i.deletions=[h],i.flags|=16):o.push(h)}function hp(i,o){switch(i.tag){case 5:var h=i.type;return o=o.nodeType!==1||h.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(i.stateNode=o,ln=i,cn=$s(o.firstChild),!0):!1;case 6:return o=i.pendingProps===""||o.nodeType!==3?null:o,o!==null?(i.stateNode=o,ln=i,cn=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(h=vr!==null?{id:hs,overflow:fs}:null,i.memoizedState={dehydrated:o,treeContext:h,retryLane:1073741824},h=wn(18,null,null,0),h.stateNode=o,h.return=i,i.child=h,ln=i,cn=null,!0):!1;default:return!1}}function hu(i){return(i.mode&1)!==0&&(i.flags&128)===0}function fu(i){if(et){var o=cn;if(o){var h=o;if(!hp(i,o)){if(hu(i))throw Error(n(418));o=$s(h.nextSibling);var p=ln;o&&hp(i,o)?dp(p,h):(i.flags=i.flags&-4097|2,et=!1,ln=i)}}else{if(hu(i))throw Error(n(418));i.flags=i.flags&-4097|2,et=!1,ln=i}}}function fp(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;ln=i}function $o(i){if(i!==ln)return!1;if(!et)return fp(i),et=!0,!1;var o;if((o=i.tag!==3)&&!(o=i.tag!==5)&&(o=i.type,o=o!=="head"&&o!=="body"&&!ru(i.type,i.memoizedProps)),o&&(o=cn)){if(hu(i))throw pp(),Error(n(418));for(;o;)dp(i,o),o=$s(o.nextSibling)}if(fp(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(n(317));e:{for(i=i.nextSibling,o=0;i;){if(i.nodeType===8){var h=i.data;if(h==="/$"){if(o===0){cn=$s(i.nextSibling);break e}o--}else h!=="$"&&h!=="$!"&&h!=="$?"||o++}i=i.nextSibling}cn=null}}else cn=ln?$s(i.stateNode.nextSibling):null;return!0}function pp(){for(var i=cn;i;)i=$s(i.nextSibling)}function ai(){cn=ln=null,et=!1}function pu(i){Nn===null?Nn=[i]:Nn.push(i)}var b0=T.ReactCurrentBatchConfig;function ra(i,o,h){if(i=h.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(h._owner){if(h=h._owner,h){if(h.tag!==1)throw Error(n(309));var p=h.stateNode}if(!p)throw Error(n(147,i));var v=p,w=""+i;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===w?o.ref:(o=function(P){var O=v.refs;P===null?delete O[w]:O[w]=P},o._stringRef=w,o)}if(typeof i!="string")throw Error(n(284));if(!h._owner)throw Error(n(290,i))}return i}function zo(i,o){throw i=Object.prototype.toString.call(o),Error(n(31,i==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":i))}function mp(i){var o=i._init;return o(i._payload)}function gp(i){function o(V,$){if(i){var q=V.deletions;q===null?(V.deletions=[$],V.flags|=16):q.push($)}}function h(V,$){if(!i)return null;for(;$!==null;)o(V,$),$=$.sibling;return null}function p(V,$){for(V=new Map;$!==null;)$.key!==null?V.set($.key,$):V.set($.index,$),$=$.sibling;return V}function v(V,$){return V=Xs(V,$),V.index=0,V.sibling=null,V}function w(V,$,q){return V.index=q,i?(q=V.alternate,q!==null?(q=q.index,q<$?(V.flags|=2,$):q):(V.flags|=2,$)):(V.flags|=1048576,$)}function P(V){return i&&V.alternate===null&&(V.flags|=2),V}function O(V,$,q,se){return $===null||$.tag!==6?($=id(q,V.mode,se),$.return=V,$):($=v($,q),$.return=V,$)}function L(V,$,q,se){var ye=q.type;return ye===E?Z(V,$,q.props.children,se,q.key):$!==null&&($.elementType===ye||typeof ye=="object"&&ye!==null&&ye.$$typeof===re&&mp(ye)===$.type)?(se=v($,q.props),se.ref=ra(V,$,q),se.return=V,se):(se=dl(q.type,q.key,q.props,null,V.mode,se),se.ref=ra(V,$,q),se.return=V,se)}function K(V,$,q,se){return $===null||$.tag!==4||$.stateNode.containerInfo!==q.containerInfo||$.stateNode.implementation!==q.implementation?($=ad(q,V.mode,se),$.return=V,$):($=v($,q.children||[]),$.return=V,$)}function Z(V,$,q,se,ye){return $===null||$.tag!==7?($=Pr(q,V.mode,se,ye),$.return=V,$):($=v($,q),$.return=V,$)}function te(V,$,q){if(typeof $=="string"&&$!==""||typeof $=="number")return $=id(""+$,V.mode,q),$.return=V,$;if(typeof $=="object"&&$!==null){switch($.$$typeof){case A:return q=dl($.type,$.key,$.props,null,V.mode,q),q.ref=ra(V,null,$),q.return=V,q;case z:return $=ad($,V.mode,q),$.return=V,$;case re:var se=$._init;return te(V,se($._payload),q)}if(At($)||ce($))return $=Pr($,V.mode,q,null),$.return=V,$;zo(V,$)}return null}function Q(V,$,q,se){var ye=$!==null?$.key:null;if(typeof q=="string"&&q!==""||typeof q=="number")return ye!==null?null:O(V,$,""+q,se);if(typeof q=="object"&&q!==null){switch(q.$$typeof){case A:return q.key===ye?L(V,$,q,se):null;case z:return q.key===ye?K(V,$,q,se):null;case re:return ye=q._init,Q(V,$,ye(q._payload),se)}if(At(q)||ce(q))return ye!==null?null:Z(V,$,q,se,null);zo(V,q)}return null}function ue(V,$,q,se,ye){if(typeof se=="string"&&se!==""||typeof se=="number")return V=V.get(q)||null,O($,V,""+se,ye);if(typeof se=="object"&&se!==null){switch(se.$$typeof){case A:return V=V.get(se.key===null?q:se.key)||null,L($,V,se,ye);case z:return V=V.get(se.key===null?q:se.key)||null,K($,V,se,ye);case re:var xe=se._init;return ue(V,$,q,xe(se._payload),ye)}if(At(se)||ce(se))return V=V.get(q)||null,Z($,V,se,ye,null);zo($,se)}return null}function fe(V,$,q,se){for(var ye=null,xe=null,be=$,Ce=$=0,jt=null;be!==null&&Ce<q.length;Ce++){be.index>Ce?(jt=be,be=null):jt=be.sibling;var Be=Q(V,be,q[Ce],se);if(Be===null){be===null&&(be=jt);break}i&&be&&Be.alternate===null&&o(V,be),$=w(Be,$,Ce),xe===null?ye=Be:xe.sibling=Be,xe=Be,be=jt}if(Ce===q.length)return h(V,be),et&&xr(V,Ce),ye;if(be===null){for(;Ce<q.length;Ce++)be=te(V,q[Ce],se),be!==null&&($=w(be,$,Ce),xe===null?ye=be:xe.sibling=be,xe=be);return et&&xr(V,Ce),ye}for(be=p(V,be);Ce<q.length;Ce++)jt=ue(be,V,Ce,q[Ce],se),jt!==null&&(i&&jt.alternate!==null&&be.delete(jt.key===null?Ce:jt.key),$=w(jt,$,Ce),xe===null?ye=jt:xe.sibling=jt,xe=jt);return i&&be.forEach(function(Qs){return o(V,Qs)}),et&&xr(V,Ce),ye}function me(V,$,q,se){var ye=ce(q);if(typeof ye!="function")throw Error(n(150));if(q=ye.call(q),q==null)throw Error(n(151));for(var xe=ye=null,be=$,Ce=$=0,jt=null,Be=q.next();be!==null&&!Be.done;Ce++,Be=q.next()){be.index>Ce?(jt=be,be=null):jt=be.sibling;var Qs=Q(V,be,Be.value,se);if(Qs===null){be===null&&(be=jt);break}i&&be&&Qs.alternate===null&&o(V,be),$=w(Qs,$,Ce),xe===null?ye=Qs:xe.sibling=Qs,xe=Qs,be=jt}if(Be.done)return h(V,be),et&&xr(V,Ce),ye;if(be===null){for(;!Be.done;Ce++,Be=q.next())Be=te(V,Be.value,se),Be!==null&&($=w(Be,$,Ce),xe===null?ye=Be:xe.sibling=Be,xe=Be);return et&&xr(V,Ce),ye}for(be=p(V,be);!Be.done;Ce++,Be=q.next())Be=ue(be,V,Ce,Be.value,se),Be!==null&&(i&&Be.alternate!==null&&be.delete(Be.key===null?Ce:Be.key),$=w(Be,$,Ce),xe===null?ye=Be:xe.sibling=Be,xe=Be);return i&&be.forEach(function(Z0){return o(V,Z0)}),et&&xr(V,Ce),ye}function ft(V,$,q,se){if(typeof q=="object"&&q!==null&&q.type===E&&q.key===null&&(q=q.props.children),typeof q=="object"&&q!==null){switch(q.$$typeof){case A:e:{for(var ye=q.key,xe=$;xe!==null;){if(xe.key===ye){if(ye=q.type,ye===E){if(xe.tag===7){h(V,xe.sibling),$=v(xe,q.props.children),$.return=V,V=$;break e}}else if(xe.elementType===ye||typeof ye=="object"&&ye!==null&&ye.$$typeof===re&&mp(ye)===xe.type){h(V,xe.sibling),$=v(xe,q.props),$.ref=ra(V,xe,q),$.return=V,V=$;break e}h(V,xe);break}else o(V,xe);xe=xe.sibling}q.type===E?($=Pr(q.props.children,V.mode,se,q.key),$.return=V,V=$):(se=dl(q.type,q.key,q.props,null,V.mode,se),se.ref=ra(V,$,q),se.return=V,V=se)}return P(V);case z:e:{for(xe=q.key;$!==null;){if($.key===xe)if($.tag===4&&$.stateNode.containerInfo===q.containerInfo&&$.stateNode.implementation===q.implementation){h(V,$.sibling),$=v($,q.children||[]),$.return=V,V=$;break e}else{h(V,$);break}else o(V,$);$=$.sibling}$=ad(q,V.mode,se),$.return=V,V=$}return P(V);case re:return xe=q._init,ft(V,$,xe(q._payload),se)}if(At(q))return fe(V,$,q,se);if(ce(q))return me(V,$,q,se);zo(V,q)}return typeof q=="string"&&q!==""||typeof q=="number"?(q=""+q,$!==null&&$.tag===6?(h(V,$.sibling),$=v($,q),$.return=V,V=$):(h(V,$),$=id(q,V.mode,se),$.return=V,V=$),P(V)):h(V,$)}return ft}var oi=gp(!0),yp=gp(!1),Uo=zs(null),Wo=null,li=null,mu=null;function gu(){mu=li=Wo=null}function yu(i){var o=Uo.current;Xe(Uo),i._currentValue=o}function vu(i,o,h){for(;i!==null;){var p=i.alternate;if((i.childLanes&o)!==o?(i.childLanes|=o,p!==null&&(p.childLanes|=o)):p!==null&&(p.childLanes&o)!==o&&(p.childLanes|=o),i===h)break;i=i.return}}function ci(i,o){Wo=i,mu=li=null,i=i.dependencies,i!==null&&i.firstContext!==null&&((i.lanes&o)!==0&&(Xt=!0),i.firstContext=null)}function vn(i){var o=i._currentValue;if(mu!==i)if(i={context:i,memoizedValue:o,next:null},li===null){if(Wo===null)throw Error(n(308));li=i,Wo.dependencies={lanes:0,firstContext:i}}else li=li.next=i;return o}var br=null;function xu(i){br===null?br=[i]:br.push(i)}function vp(i,o,h,p){var v=o.interleaved;return v===null?(h.next=h,xu(o)):(h.next=v.next,v.next=h),o.interleaved=h,ps(i,p)}function ps(i,o){i.lanes|=o;var h=i.alternate;for(h!==null&&(h.lanes|=o),h=i,i=i.return;i!==null;)i.childLanes|=o,h=i.alternate,h!==null&&(h.childLanes|=o),h=i,i=i.return;return h.tag===3?h.stateNode:null}var Vs=!1;function bu(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function xp(i,o){i=i.updateQueue,o.updateQueue===i&&(o.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function ms(i,o){return{eventTime:i,lane:o,tag:0,payload:null,callback:null,next:null}}function qs(i,o,h){var p=i.updateQueue;if(p===null)return null;if(p=p.shared,(Me&2)!==0){var v=p.pending;return v===null?o.next=o:(o.next=v.next,v.next=o),p.pending=o,ps(i,h)}return v=p.interleaved,v===null?(o.next=o,xu(p)):(o.next=v.next,v.next=o),p.interleaved=o,ps(i,h)}function Vo(i,o,h){if(o=o.updateQueue,o!==null&&(o=o.shared,(h&4194240)!==0)){var p=o.lanes;p&=i.pendingLanes,h|=p,o.lanes=h,Rc(i,h)}}function bp(i,o){var h=i.updateQueue,p=i.alternate;if(p!==null&&(p=p.updateQueue,h===p)){var v=null,w=null;if(h=h.firstBaseUpdate,h!==null){do{var P={eventTime:h.eventTime,lane:h.lane,tag:h.tag,payload:h.payload,callback:h.callback,next:null};w===null?v=w=P:w=w.next=P,h=h.next}while(h!==null);w===null?v=w=o:w=w.next=o}else v=w=o;h={baseState:p.baseState,firstBaseUpdate:v,lastBaseUpdate:w,shared:p.shared,effects:p.effects},i.updateQueue=h;return}i=h.lastBaseUpdate,i===null?h.firstBaseUpdate=o:i.next=o,h.lastBaseUpdate=o}function qo(i,o,h,p){var v=i.updateQueue;Vs=!1;var w=v.firstBaseUpdate,P=v.lastBaseUpdate,O=v.shared.pending;if(O!==null){v.shared.pending=null;var L=O,K=L.next;L.next=null,P===null?w=K:P.next=K,P=L;var Z=i.alternate;Z!==null&&(Z=Z.updateQueue,O=Z.lastBaseUpdate,O!==P&&(O===null?Z.firstBaseUpdate=K:O.next=K,Z.lastBaseUpdate=L))}if(w!==null){var te=v.baseState;P=0,Z=K=L=null,O=w;do{var Q=O.lane,ue=O.eventTime;if((p&Q)===Q){Z!==null&&(Z=Z.next={eventTime:ue,lane:0,tag:O.tag,payload:O.payload,callback:O.callback,next:null});e:{var fe=i,me=O;switch(Q=o,ue=h,me.tag){case 1:if(fe=me.payload,typeof fe=="function"){te=fe.call(ue,te,Q);break e}te=fe;break e;case 3:fe.flags=fe.flags&-65537|128;case 0:if(fe=me.payload,Q=typeof fe=="function"?fe.call(ue,te,Q):fe,Q==null)break e;te=ie({},te,Q);break e;case 2:Vs=!0}}O.callback!==null&&O.lane!==0&&(i.flags|=64,Q=v.effects,Q===null?v.effects=[O]:Q.push(O))}else ue={eventTime:ue,lane:Q,tag:O.tag,payload:O.payload,callback:O.callback,next:null},Z===null?(K=Z=ue,L=te):Z=Z.next=ue,P|=Q;if(O=O.next,O===null){if(O=v.shared.pending,O===null)break;Q=O,O=Q.next,Q.next=null,v.lastBaseUpdate=Q,v.shared.pending=null}}while(!0);if(Z===null&&(L=te),v.baseState=L,v.firstBaseUpdate=K,v.lastBaseUpdate=Z,o=v.shared.interleaved,o!==null){v=o;do P|=v.lane,v=v.next;while(v!==o)}else w===null&&(v.shared.lanes=0);kr|=P,i.lanes=P,i.memoizedState=te}}function wp(i,o,h){if(i=o.effects,o.effects=null,i!==null)for(o=0;o<i.length;o++){var p=i[o],v=p.callback;if(v!==null){if(p.callback=null,p=h,typeof v!="function")throw Error(n(191,v));v.call(p)}}}var ia={},Xn=zs(ia),aa=zs(ia),oa=zs(ia);function wr(i){if(i===ia)throw Error(n(174));return i}function wu(i,o){switch(Ke(oa,o),Ke(aa,i),Ke(Xn,ia),i=o.nodeType,i){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:qn(null,"");break;default:i=i===8?o.parentNode:o,o=i.namespaceURI||null,i=i.tagName,o=qn(o,i)}Xe(Xn),Ke(Xn,o)}function ui(){Xe(Xn),Xe(aa),Xe(oa)}function _p(i){wr(oa.current);var o=wr(Xn.current),h=qn(o,i.type);o!==h&&(Ke(aa,i),Ke(Xn,h))}function _u(i){aa.current===i&&(Xe(Xn),Xe(aa))}var rt=zs(0);function Ho(i){for(var o=i;o!==null;){if(o.tag===13){var h=o.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||h.data==="$?"||h.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var ku=[];function Su(){for(var i=0;i<ku.length;i++)ku[i]._workInProgressVersionPrimary=null;ku.length=0}var Ko=T.ReactCurrentDispatcher,ju=T.ReactCurrentBatchConfig,_r=0,it=null,xt=null,kt=null,Go=!1,la=!1,ca=0,w0=0;function Mt(){throw Error(n(321))}function Cu(i,o){if(o===null)return!1;for(var h=0;h<o.length&&h<i.length;h++)if(!Tn(i[h],o[h]))return!1;return!0}function Pu(i,o,h,p,v,w){if(_r=w,it=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,Ko.current=i===null||i.memoizedState===null?j0:C0,i=h(p,v),la){w=0;do{if(la=!1,ca=0,25<=w)throw Error(n(301));w+=1,kt=xt=null,o.updateQueue=null,Ko.current=P0,i=h(p,v)}while(la)}if(Ko.current=Xo,o=xt!==null&&xt.next!==null,_r=0,kt=xt=it=null,Go=!1,o)throw Error(n(300));return i}function Iu(){var i=ca!==0;return ca=0,i}function Qn(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return kt===null?it.memoizedState=kt=i:kt=kt.next=i,kt}function xn(){if(xt===null){var i=it.alternate;i=i!==null?i.memoizedState:null}else i=xt.next;var o=kt===null?it.memoizedState:kt.next;if(o!==null)kt=o,xt=i;else{if(i===null)throw Error(n(310));xt=i,i={memoizedState:xt.memoizedState,baseState:xt.baseState,baseQueue:xt.baseQueue,queue:xt.queue,next:null},kt===null?it.memoizedState=kt=i:kt=kt.next=i}return kt}function ua(i,o){return typeof o=="function"?o(i):o}function Eu(i){var o=xn(),h=o.queue;if(h===null)throw Error(n(311));h.lastRenderedReducer=i;var p=xt,v=p.baseQueue,w=h.pending;if(w!==null){if(v!==null){var P=v.next;v.next=w.next,w.next=P}p.baseQueue=v=w,h.pending=null}if(v!==null){w=v.next,p=p.baseState;var O=P=null,L=null,K=w;do{var Z=K.lane;if((_r&Z)===Z)L!==null&&(L=L.next={lane:0,action:K.action,hasEagerState:K.hasEagerState,eagerState:K.eagerState,next:null}),p=K.hasEagerState?K.eagerState:i(p,K.action);else{var te={lane:Z,action:K.action,hasEagerState:K.hasEagerState,eagerState:K.eagerState,next:null};L===null?(O=L=te,P=p):L=L.next=te,it.lanes|=Z,kr|=Z}K=K.next}while(K!==null&&K!==w);L===null?P=p:L.next=O,Tn(p,o.memoizedState)||(Xt=!0),o.memoizedState=p,o.baseState=P,o.baseQueue=L,h.lastRenderedState=p}if(i=h.interleaved,i!==null){v=i;do w=v.lane,it.lanes|=w,kr|=w,v=v.next;while(v!==i)}else v===null&&(h.lanes=0);return[o.memoizedState,h.dispatch]}function Tu(i){var o=xn(),h=o.queue;if(h===null)throw Error(n(311));h.lastRenderedReducer=i;var p=h.dispatch,v=h.pending,w=o.memoizedState;if(v!==null){h.pending=null;var P=v=v.next;do w=i(w,P.action),P=P.next;while(P!==v);Tn(w,o.memoizedState)||(Xt=!0),o.memoizedState=w,o.baseQueue===null&&(o.baseState=w),h.lastRenderedState=w}return[w,p]}function kp(){}function Sp(i,o){var h=it,p=xn(),v=o(),w=!Tn(p.memoizedState,v);if(w&&(p.memoizedState=v,Xt=!0),p=p.queue,Nu(Pp.bind(null,h,p,i),[i]),p.getSnapshot!==o||w||kt!==null&&kt.memoizedState.tag&1){if(h.flags|=2048,da(9,Cp.bind(null,h,p,v,o),void 0,null),St===null)throw Error(n(349));(_r&30)!==0||jp(h,o,v)}return v}function jp(i,o,h){i.flags|=16384,i={getSnapshot:o,value:h},o=it.updateQueue,o===null?(o={lastEffect:null,stores:null},it.updateQueue=o,o.stores=[i]):(h=o.stores,h===null?o.stores=[i]:h.push(i))}function Cp(i,o,h,p){o.value=h,o.getSnapshot=p,Ip(o)&&Ep(i)}function Pp(i,o,h){return h(function(){Ip(o)&&Ep(i)})}function Ip(i){var o=i.getSnapshot;i=i.value;try{var h=o();return!Tn(i,h)}catch{return!0}}function Ep(i){var o=ps(i,1);o!==null&&Mn(o,i,1,-1)}function Tp(i){var o=Qn();return typeof i=="function"&&(i=i()),o.memoizedState=o.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ua,lastRenderedState:i},o.queue=i,i=i.dispatch=S0.bind(null,it,i),[o.memoizedState,i]}function da(i,o,h,p){return i={tag:i,create:o,destroy:h,deps:p,next:null},o=it.updateQueue,o===null?(o={lastEffect:null,stores:null},it.updateQueue=o,o.lastEffect=i.next=i):(h=o.lastEffect,h===null?o.lastEffect=i.next=i:(p=h.next,h.next=i,i.next=p,o.lastEffect=i)),i}function Np(){return xn().memoizedState}function Yo(i,o,h,p){var v=Qn();it.flags|=i,v.memoizedState=da(1|o,h,void 0,p===void 0?null:p)}function Jo(i,o,h,p){var v=xn();p=p===void 0?null:p;var w=void 0;if(xt!==null){var P=xt.memoizedState;if(w=P.destroy,p!==null&&Cu(p,P.deps)){v.memoizedState=da(o,h,w,p);return}}it.flags|=i,v.memoizedState=da(1|o,h,w,p)}function Ap(i,o){return Yo(8390656,8,i,o)}function Nu(i,o){return Jo(2048,8,i,o)}function Op(i,o){return Jo(4,2,i,o)}function Rp(i,o){return Jo(4,4,i,o)}function Mp(i,o){if(typeof o=="function")return i=i(),o(i),function(){o(null)};if(o!=null)return i=i(),o.current=i,function(){o.current=null}}function Lp(i,o,h){return h=h!=null?h.concat([i]):null,Jo(4,4,Mp.bind(null,o,i),h)}function Au(){}function Dp(i,o){var h=xn();o=o===void 0?null:o;var p=h.memoizedState;return p!==null&&o!==null&&Cu(o,p[1])?p[0]:(h.memoizedState=[i,o],i)}function Fp(i,o){var h=xn();o=o===void 0?null:o;var p=h.memoizedState;return p!==null&&o!==null&&Cu(o,p[1])?p[0]:(i=i(),h.memoizedState=[i,o],i)}function Bp(i,o,h){return(_r&21)===0?(i.baseState&&(i.baseState=!1,Xt=!0),i.memoizedState=h):(Tn(h,o)||(h=mf(),it.lanes|=h,kr|=h,i.baseState=!0),o)}function _0(i,o){var h=We;We=h!==0&&4>h?h:4,i(!0);var p=ju.transition;ju.transition={};try{i(!1),o()}finally{We=h,ju.transition=p}}function $p(){return xn().memoizedState}function k0(i,o,h){var p=Ys(i);if(h={lane:p,action:h,hasEagerState:!1,eagerState:null,next:null},zp(i))Up(o,h);else if(h=vp(i,o,h,p),h!==null){var v=qt();Mn(h,i,p,v),Wp(h,o,p)}}function S0(i,o,h){var p=Ys(i),v={lane:p,action:h,hasEagerState:!1,eagerState:null,next:null};if(zp(i))Up(o,v);else{var w=i.alternate;if(i.lanes===0&&(w===null||w.lanes===0)&&(w=o.lastRenderedReducer,w!==null))try{var P=o.lastRenderedState,O=w(P,h);if(v.hasEagerState=!0,v.eagerState=O,Tn(O,P)){var L=o.interleaved;L===null?(v.next=v,xu(o)):(v.next=L.next,L.next=v),o.interleaved=v;return}}catch{}h=vp(i,o,v,p),h!==null&&(v=qt(),Mn(h,i,p,v),Wp(h,o,p))}}function zp(i){var o=i.alternate;return i===it||o!==null&&o===it}function Up(i,o){la=Go=!0;var h=i.pending;h===null?o.next=o:(o.next=h.next,h.next=o),i.pending=o}function Wp(i,o,h){if((h&4194240)!==0){var p=o.lanes;p&=i.pendingLanes,h|=p,o.lanes=h,Rc(i,h)}}var Xo={readContext:vn,useCallback:Mt,useContext:Mt,useEffect:Mt,useImperativeHandle:Mt,useInsertionEffect:Mt,useLayoutEffect:Mt,useMemo:Mt,useReducer:Mt,useRef:Mt,useState:Mt,useDebugValue:Mt,useDeferredValue:Mt,useTransition:Mt,useMutableSource:Mt,useSyncExternalStore:Mt,useId:Mt,unstable_isNewReconciler:!1},j0={readContext:vn,useCallback:function(i,o){return Qn().memoizedState=[i,o===void 0?null:o],i},useContext:vn,useEffect:Ap,useImperativeHandle:function(i,o,h){return h=h!=null?h.concat([i]):null,Yo(4194308,4,Mp.bind(null,o,i),h)},useLayoutEffect:function(i,o){return Yo(4194308,4,i,o)},useInsertionEffect:function(i,o){return Yo(4,2,i,o)},useMemo:function(i,o){var h=Qn();return o=o===void 0?null:o,i=i(),h.memoizedState=[i,o],i},useReducer:function(i,o,h){var p=Qn();return o=h!==void 0?h(o):o,p.memoizedState=p.baseState=o,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:o},p.queue=i,i=i.dispatch=k0.bind(null,it,i),[p.memoizedState,i]},useRef:function(i){var o=Qn();return i={current:i},o.memoizedState=i},useState:Tp,useDebugValue:Au,useDeferredValue:function(i){return Qn().memoizedState=i},useTransition:function(){var i=Tp(!1),o=i[0];return i=_0.bind(null,i[1]),Qn().memoizedState=i,[o,i]},useMutableSource:function(){},useSyncExternalStore:function(i,o,h){var p=it,v=Qn();if(et){if(h===void 0)throw Error(n(407));h=h()}else{if(h=o(),St===null)throw Error(n(349));(_r&30)!==0||jp(p,o,h)}v.memoizedState=h;var w={value:h,getSnapshot:o};return v.queue=w,Ap(Pp.bind(null,p,w,i),[i]),p.flags|=2048,da(9,Cp.bind(null,p,w,h,o),void 0,null),h},useId:function(){var i=Qn(),o=St.identifierPrefix;if(et){var h=fs,p=hs;h=(p&~(1<<32-En(p)-1)).toString(32)+h,o=":"+o+"R"+h,h=ca++,0<h&&(o+="H"+h.toString(32)),o+=":"}else h=w0++,o=":"+o+"r"+h.toString(32)+":";return i.memoizedState=o},unstable_isNewReconciler:!1},C0={readContext:vn,useCallback:Dp,useContext:vn,useEffect:Nu,useImperativeHandle:Lp,useInsertionEffect:Op,useLayoutEffect:Rp,useMemo:Fp,useReducer:Eu,useRef:Np,useState:function(){return Eu(ua)},useDebugValue:Au,useDeferredValue:function(i){var o=xn();return Bp(o,xt.memoizedState,i)},useTransition:function(){var i=Eu(ua)[0],o=xn().memoizedState;return[i,o]},useMutableSource:kp,useSyncExternalStore:Sp,useId:$p,unstable_isNewReconciler:!1},P0={readContext:vn,useCallback:Dp,useContext:vn,useEffect:Nu,useImperativeHandle:Lp,useInsertionEffect:Op,useLayoutEffect:Rp,useMemo:Fp,useReducer:Tu,useRef:Np,useState:function(){return Tu(ua)},useDebugValue:Au,useDeferredValue:function(i){var o=xn();return xt===null?o.memoizedState=i:Bp(o,xt.memoizedState,i)},useTransition:function(){var i=Tu(ua)[0],o=xn().memoizedState;return[i,o]},useMutableSource:kp,useSyncExternalStore:Sp,useId:$p,unstable_isNewReconciler:!1};function An(i,o){if(i&&i.defaultProps){o=ie({},o),i=i.defaultProps;for(var h in i)o[h]===void 0&&(o[h]=i[h]);return o}return o}function Ou(i,o,h,p){o=i.memoizedState,h=h(p,o),h=h==null?o:ie({},o,h),i.memoizedState=h,i.lanes===0&&(i.updateQueue.baseState=h)}var Qo={isMounted:function(i){return(i=i._reactInternals)?mr(i)===i:!1},enqueueSetState:function(i,o,h){i=i._reactInternals;var p=qt(),v=Ys(i),w=ms(p,v);w.payload=o,h!=null&&(w.callback=h),o=qs(i,w,v),o!==null&&(Mn(o,i,v,p),Vo(o,i,v))},enqueueReplaceState:function(i,o,h){i=i._reactInternals;var p=qt(),v=Ys(i),w=ms(p,v);w.tag=1,w.payload=o,h!=null&&(w.callback=h),o=qs(i,w,v),o!==null&&(Mn(o,i,v,p),Vo(o,i,v))},enqueueForceUpdate:function(i,o){i=i._reactInternals;var h=qt(),p=Ys(i),v=ms(h,p);v.tag=2,o!=null&&(v.callback=o),o=qs(i,v,p),o!==null&&(Mn(o,i,p,h),Vo(o,i,p))}};function Vp(i,o,h,p,v,w,P){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(p,w,P):o.prototype&&o.prototype.isPureReactComponent?!Xi(h,p)||!Xi(v,w):!0}function qp(i,o,h){var p=!1,v=Us,w=o.contextType;return typeof w=="object"&&w!==null?w=vn(w):(v=Jt(o)?yr:Rt.current,p=o.contextTypes,w=(p=p!=null)?si(i,v):Us),o=new o(h,w),i.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=Qo,i.stateNode=o,o._reactInternals=i,p&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=v,i.__reactInternalMemoizedMaskedChildContext=w),o}function Hp(i,o,h,p){i=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(h,p),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(h,p),o.state!==i&&Qo.enqueueReplaceState(o,o.state,null)}function Ru(i,o,h,p){var v=i.stateNode;v.props=h,v.state=i.memoizedState,v.refs={},bu(i);var w=o.contextType;typeof w=="object"&&w!==null?v.context=vn(w):(w=Jt(o)?yr:Rt.current,v.context=si(i,w)),v.state=i.memoizedState,w=o.getDerivedStateFromProps,typeof w=="function"&&(Ou(i,o,w,h),v.state=i.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(o=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),o!==v.state&&Qo.enqueueReplaceState(v,v.state,null),qo(i,h,v,p),v.state=i.memoizedState),typeof v.componentDidMount=="function"&&(i.flags|=4194308)}function di(i,o){try{var h="",p=o;do h+=ge(p),p=p.return;while(p);var v=h}catch(w){v=`
Error generating stack: `+w.message+`
`+w.stack}return{value:i,source:o,stack:v,digest:null}}function Mu(i,o,h){return{value:i,source:null,stack:h??null,digest:o??null}}function Lu(i,o){try{console.error(o.value)}catch(h){setTimeout(function(){throw h})}}var I0=typeof WeakMap=="function"?WeakMap:Map;function Kp(i,o,h){h=ms(-1,h),h.tag=3,h.payload={element:null};var p=o.value;return h.callback=function(){il||(il=!0,Xu=p),Lu(i,o)},h}function Gp(i,o,h){h=ms(-1,h),h.tag=3;var p=i.type.getDerivedStateFromError;if(typeof p=="function"){var v=o.value;h.payload=function(){return p(v)},h.callback=function(){Lu(i,o)}}var w=i.stateNode;return w!==null&&typeof w.componentDidCatch=="function"&&(h.callback=function(){Lu(i,o),typeof p!="function"&&(Ks===null?Ks=new Set([this]):Ks.add(this));var P=o.stack;this.componentDidCatch(o.value,{componentStack:P!==null?P:""})}),h}function Yp(i,o,h){var p=i.pingCache;if(p===null){p=i.pingCache=new I0;var v=new Set;p.set(o,v)}else v=p.get(o),v===void 0&&(v=new Set,p.set(o,v));v.has(h)||(v.add(h),i=U0.bind(null,i,o,h),o.then(i,i))}function Jp(i){do{var o;if((o=i.tag===13)&&(o=i.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return i;i=i.return}while(i!==null);return null}function Xp(i,o,h,p,v){return(i.mode&1)===0?(i===o?i.flags|=65536:(i.flags|=128,h.flags|=131072,h.flags&=-52805,h.tag===1&&(h.alternate===null?h.tag=17:(o=ms(-1,1),o.tag=2,qs(h,o,1))),h.lanes|=1),i):(i.flags|=65536,i.lanes=v,i)}var E0=T.ReactCurrentOwner,Xt=!1;function Vt(i,o,h,p){o.child=i===null?yp(o,null,h,p):oi(o,i.child,h,p)}function Qp(i,o,h,p,v){h=h.render;var w=o.ref;return ci(o,v),p=Pu(i,o,h,p,w,v),h=Iu(),i!==null&&!Xt?(o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~v,gs(i,o,v)):(et&&h&&uu(o),o.flags|=1,Vt(i,o,p,v),o.child)}function Zp(i,o,h,p,v){if(i===null){var w=h.type;return typeof w=="function"&&!rd(w)&&w.defaultProps===void 0&&h.compare===null&&h.defaultProps===void 0?(o.tag=15,o.type=w,em(i,o,w,p,v)):(i=dl(h.type,null,p,o,o.mode,v),i.ref=o.ref,i.return=o,o.child=i)}if(w=i.child,(i.lanes&v)===0){var P=w.memoizedProps;if(h=h.compare,h=h!==null?h:Xi,h(P,p)&&i.ref===o.ref)return gs(i,o,v)}return o.flags|=1,i=Xs(w,p),i.ref=o.ref,i.return=o,o.child=i}function em(i,o,h,p,v){if(i!==null){var w=i.memoizedProps;if(Xi(w,p)&&i.ref===o.ref)if(Xt=!1,o.pendingProps=p=w,(i.lanes&v)!==0)(i.flags&131072)!==0&&(Xt=!0);else return o.lanes=i.lanes,gs(i,o,v)}return Du(i,o,h,p,v)}function tm(i,o,h){var p=o.pendingProps,v=p.children,w=i!==null?i.memoizedState:null;if(p.mode==="hidden")if((o.mode&1)===0)o.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ke(fi,un),un|=h;else{if((h&1073741824)===0)return i=w!==null?w.baseLanes|h:h,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:i,cachePool:null,transitions:null},o.updateQueue=null,Ke(fi,un),un|=i,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},p=w!==null?w.baseLanes:h,Ke(fi,un),un|=p}else w!==null?(p=w.baseLanes|h,o.memoizedState=null):p=h,Ke(fi,un),un|=p;return Vt(i,o,v,h),o.child}function nm(i,o){var h=o.ref;(i===null&&h!==null||i!==null&&i.ref!==h)&&(o.flags|=512,o.flags|=2097152)}function Du(i,o,h,p,v){var w=Jt(h)?yr:Rt.current;return w=si(o,w),ci(o,v),h=Pu(i,o,h,p,w,v),p=Iu(),i!==null&&!Xt?(o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~v,gs(i,o,v)):(et&&p&&uu(o),o.flags|=1,Vt(i,o,h,v),o.child)}function sm(i,o,h,p,v){if(Jt(h)){var w=!0;Lo(o)}else w=!1;if(ci(o,v),o.stateNode===null)el(i,o),qp(o,h,p),Ru(o,h,p,v),p=!0;else if(i===null){var P=o.stateNode,O=o.memoizedProps;P.props=O;var L=P.context,K=h.contextType;typeof K=="object"&&K!==null?K=vn(K):(K=Jt(h)?yr:Rt.current,K=si(o,K));var Z=h.getDerivedStateFromProps,te=typeof Z=="function"||typeof P.getSnapshotBeforeUpdate=="function";te||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(O!==p||L!==K)&&Hp(o,P,p,K),Vs=!1;var Q=o.memoizedState;P.state=Q,qo(o,p,P,v),L=o.memoizedState,O!==p||Q!==L||Yt.current||Vs?(typeof Z=="function"&&(Ou(o,h,Z,p),L=o.memoizedState),(O=Vs||Vp(o,h,O,p,Q,L,K))?(te||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount()),typeof P.componentDidMount=="function"&&(o.flags|=4194308)):(typeof P.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=p,o.memoizedState=L),P.props=p,P.state=L,P.context=K,p=O):(typeof P.componentDidMount=="function"&&(o.flags|=4194308),p=!1)}else{P=o.stateNode,xp(i,o),O=o.memoizedProps,K=o.type===o.elementType?O:An(o.type,O),P.props=K,te=o.pendingProps,Q=P.context,L=h.contextType,typeof L=="object"&&L!==null?L=vn(L):(L=Jt(h)?yr:Rt.current,L=si(o,L));var ue=h.getDerivedStateFromProps;(Z=typeof ue=="function"||typeof P.getSnapshotBeforeUpdate=="function")||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(O!==te||Q!==L)&&Hp(o,P,p,L),Vs=!1,Q=o.memoizedState,P.state=Q,qo(o,p,P,v);var fe=o.memoizedState;O!==te||Q!==fe||Yt.current||Vs?(typeof ue=="function"&&(Ou(o,h,ue,p),fe=o.memoizedState),(K=Vs||Vp(o,h,K,p,Q,fe,L)||!1)?(Z||typeof P.UNSAFE_componentWillUpdate!="function"&&typeof P.componentWillUpdate!="function"||(typeof P.componentWillUpdate=="function"&&P.componentWillUpdate(p,fe,L),typeof P.UNSAFE_componentWillUpdate=="function"&&P.UNSAFE_componentWillUpdate(p,fe,L)),typeof P.componentDidUpdate=="function"&&(o.flags|=4),typeof P.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof P.componentDidUpdate!="function"||O===i.memoizedProps&&Q===i.memoizedState||(o.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||O===i.memoizedProps&&Q===i.memoizedState||(o.flags|=1024),o.memoizedProps=p,o.memoizedState=fe),P.props=p,P.state=fe,P.context=L,p=K):(typeof P.componentDidUpdate!="function"||O===i.memoizedProps&&Q===i.memoizedState||(o.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||O===i.memoizedProps&&Q===i.memoizedState||(o.flags|=1024),p=!1)}return Fu(i,o,h,p,w,v)}function Fu(i,o,h,p,v,w){nm(i,o);var P=(o.flags&128)!==0;if(!p&&!P)return v&&lp(o,h,!1),gs(i,o,w);p=o.stateNode,E0.current=o;var O=P&&typeof h.getDerivedStateFromError!="function"?null:p.render();return o.flags|=1,i!==null&&P?(o.child=oi(o,i.child,null,w),o.child=oi(o,null,O,w)):Vt(i,o,O,w),o.memoizedState=p.state,v&&lp(o,h,!0),o.child}function rm(i){var o=i.stateNode;o.pendingContext?ap(i,o.pendingContext,o.pendingContext!==o.context):o.context&&ap(i,o.context,!1),wu(i,o.containerInfo)}function im(i,o,h,p,v){return ai(),pu(v),o.flags|=256,Vt(i,o,h,p),o.child}var Bu={dehydrated:null,treeContext:null,retryLane:0};function $u(i){return{baseLanes:i,cachePool:null,transitions:null}}function am(i,o,h){var p=o.pendingProps,v=rt.current,w=!1,P=(o.flags&128)!==0,O;if((O=P)||(O=i!==null&&i.memoizedState===null?!1:(v&2)!==0),O?(w=!0,o.flags&=-129):(i===null||i.memoizedState!==null)&&(v|=1),Ke(rt,v&1),i===null)return fu(o),i=o.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?((o.mode&1)===0?o.lanes=1:i.data==="$!"?o.lanes=8:o.lanes=1073741824,null):(P=p.children,i=p.fallback,w?(p=o.mode,w=o.child,P={mode:"hidden",children:P},(p&1)===0&&w!==null?(w.childLanes=0,w.pendingProps=P):w=hl(P,p,0,null),i=Pr(i,p,h,null),w.return=o,i.return=o,w.sibling=i,o.child=w,o.child.memoizedState=$u(h),o.memoizedState=Bu,i):zu(o,P));if(v=i.memoizedState,v!==null&&(O=v.dehydrated,O!==null))return T0(i,o,P,p,O,v,h);if(w){w=p.fallback,P=o.mode,v=i.child,O=v.sibling;var L={mode:"hidden",children:p.children};return(P&1)===0&&o.child!==v?(p=o.child,p.childLanes=0,p.pendingProps=L,o.deletions=null):(p=Xs(v,L),p.subtreeFlags=v.subtreeFlags&14680064),O!==null?w=Xs(O,w):(w=Pr(w,P,h,null),w.flags|=2),w.return=o,p.return=o,p.sibling=w,o.child=p,p=w,w=o.child,P=i.child.memoizedState,P=P===null?$u(h):{baseLanes:P.baseLanes|h,cachePool:null,transitions:P.transitions},w.memoizedState=P,w.childLanes=i.childLanes&~h,o.memoizedState=Bu,p}return w=i.child,i=w.sibling,p=Xs(w,{mode:"visible",children:p.children}),(o.mode&1)===0&&(p.lanes=h),p.return=o,p.sibling=null,i!==null&&(h=o.deletions,h===null?(o.deletions=[i],o.flags|=16):h.push(i)),o.child=p,o.memoizedState=null,p}function zu(i,o){return o=hl({mode:"visible",children:o},i.mode,0,null),o.return=i,i.child=o}function Zo(i,o,h,p){return p!==null&&pu(p),oi(o,i.child,null,h),i=zu(o,o.pendingProps.children),i.flags|=2,o.memoizedState=null,i}function T0(i,o,h,p,v,w,P){if(h)return o.flags&256?(o.flags&=-257,p=Mu(Error(n(422))),Zo(i,o,P,p)):o.memoizedState!==null?(o.child=i.child,o.flags|=128,null):(w=p.fallback,v=o.mode,p=hl({mode:"visible",children:p.children},v,0,null),w=Pr(w,v,P,null),w.flags|=2,p.return=o,w.return=o,p.sibling=w,o.child=p,(o.mode&1)!==0&&oi(o,i.child,null,P),o.child.memoizedState=$u(P),o.memoizedState=Bu,w);if((o.mode&1)===0)return Zo(i,o,P,null);if(v.data==="$!"){if(p=v.nextSibling&&v.nextSibling.dataset,p)var O=p.dgst;return p=O,w=Error(n(419)),p=Mu(w,p,void 0),Zo(i,o,P,p)}if(O=(P&i.childLanes)!==0,Xt||O){if(p=St,p!==null){switch(P&-P){case 4:v=2;break;case 16:v=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:v=32;break;case 536870912:v=268435456;break;default:v=0}v=(v&(p.suspendedLanes|P))!==0?0:v,v!==0&&v!==w.retryLane&&(w.retryLane=v,ps(i,v),Mn(p,i,v,-1))}return sd(),p=Mu(Error(n(421))),Zo(i,o,P,p)}return v.data==="$?"?(o.flags|=128,o.child=i.child,o=W0.bind(null,i),v._reactRetry=o,null):(i=w.treeContext,cn=$s(v.nextSibling),ln=o,et=!0,Nn=null,i!==null&&(gn[yn++]=hs,gn[yn++]=fs,gn[yn++]=vr,hs=i.id,fs=i.overflow,vr=o),o=zu(o,p.children),o.flags|=4096,o)}function om(i,o,h){i.lanes|=o;var p=i.alternate;p!==null&&(p.lanes|=o),vu(i.return,o,h)}function Uu(i,o,h,p,v){var w=i.memoizedState;w===null?i.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:p,tail:h,tailMode:v}:(w.isBackwards=o,w.rendering=null,w.renderingStartTime=0,w.last=p,w.tail=h,w.tailMode=v)}function lm(i,o,h){var p=o.pendingProps,v=p.revealOrder,w=p.tail;if(Vt(i,o,p.children,h),p=rt.current,(p&2)!==0)p=p&1|2,o.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=o.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&om(i,h,o);else if(i.tag===19)om(i,h,o);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===o)break e;for(;i.sibling===null;){if(i.return===null||i.return===o)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}p&=1}if(Ke(rt,p),(o.mode&1)===0)o.memoizedState=null;else switch(v){case"forwards":for(h=o.child,v=null;h!==null;)i=h.alternate,i!==null&&Ho(i)===null&&(v=h),h=h.sibling;h=v,h===null?(v=o.child,o.child=null):(v=h.sibling,h.sibling=null),Uu(o,!1,v,h,w);break;case"backwards":for(h=null,v=o.child,o.child=null;v!==null;){if(i=v.alternate,i!==null&&Ho(i)===null){o.child=v;break}i=v.sibling,v.sibling=h,h=v,v=i}Uu(o,!0,h,null,w);break;case"together":Uu(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function el(i,o){(o.mode&1)===0&&i!==null&&(i.alternate=null,o.alternate=null,o.flags|=2)}function gs(i,o,h){if(i!==null&&(o.dependencies=i.dependencies),kr|=o.lanes,(h&o.childLanes)===0)return null;if(i!==null&&o.child!==i.child)throw Error(n(153));if(o.child!==null){for(i=o.child,h=Xs(i,i.pendingProps),o.child=h,h.return=o;i.sibling!==null;)i=i.sibling,h=h.sibling=Xs(i,i.pendingProps),h.return=o;h.sibling=null}return o.child}function N0(i,o,h){switch(o.tag){case 3:rm(o),ai();break;case 5:_p(o);break;case 1:Jt(o.type)&&Lo(o);break;case 4:wu(o,o.stateNode.containerInfo);break;case 10:var p=o.type._context,v=o.memoizedProps.value;Ke(Uo,p._currentValue),p._currentValue=v;break;case 13:if(p=o.memoizedState,p!==null)return p.dehydrated!==null?(Ke(rt,rt.current&1),o.flags|=128,null):(h&o.child.childLanes)!==0?am(i,o,h):(Ke(rt,rt.current&1),i=gs(i,o,h),i!==null?i.sibling:null);Ke(rt,rt.current&1);break;case 19:if(p=(h&o.childLanes)!==0,(i.flags&128)!==0){if(p)return lm(i,o,h);o.flags|=128}if(v=o.memoizedState,v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),Ke(rt,rt.current),p)break;return null;case 22:case 23:return o.lanes=0,tm(i,o,h)}return gs(i,o,h)}var cm,Wu,um,dm;cm=function(i,o){for(var h=o.child;h!==null;){if(h.tag===5||h.tag===6)i.appendChild(h.stateNode);else if(h.tag!==4&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===o)break;for(;h.sibling===null;){if(h.return===null||h.return===o)return;h=h.return}h.sibling.return=h.return,h=h.sibling}},Wu=function(){},um=function(i,o,h,p){var v=i.memoizedProps;if(v!==p){i=o.stateNode,wr(Xn.current);var w=null;switch(h){case"input":v=Ue(i,v),p=Ue(i,p),w=[];break;case"select":v=ie({},v,{value:void 0}),p=ie({},p,{value:void 0}),w=[];break;case"textarea":v=Ot(i,v),p=Ot(i,p),w=[];break;default:typeof v.onClick!="function"&&typeof p.onClick=="function"&&(i.onclick=Oo)}As(h,p);var P;h=null;for(K in v)if(!p.hasOwnProperty(K)&&v.hasOwnProperty(K)&&v[K]!=null)if(K==="style"){var O=v[K];for(P in O)O.hasOwnProperty(P)&&(h||(h={}),h[P]="")}else K!=="dangerouslySetInnerHTML"&&K!=="children"&&K!=="suppressContentEditableWarning"&&K!=="suppressHydrationWarning"&&K!=="autoFocus"&&(r.hasOwnProperty(K)?w||(w=[]):(w=w||[]).push(K,null));for(K in p){var L=p[K];if(O=v?.[K],p.hasOwnProperty(K)&&L!==O&&(L!=null||O!=null))if(K==="style")if(O){for(P in O)!O.hasOwnProperty(P)||L&&L.hasOwnProperty(P)||(h||(h={}),h[P]="");for(P in L)L.hasOwnProperty(P)&&O[P]!==L[P]&&(h||(h={}),h[P]=L[P])}else h||(w||(w=[]),w.push(K,h)),h=L;else K==="dangerouslySetInnerHTML"?(L=L?L.__html:void 0,O=O?O.__html:void 0,L!=null&&O!==L&&(w=w||[]).push(K,L)):K==="children"?typeof L!="string"&&typeof L!="number"||(w=w||[]).push(K,""+L):K!=="suppressContentEditableWarning"&&K!=="suppressHydrationWarning"&&(r.hasOwnProperty(K)?(L!=null&&K==="onScroll"&&Je("scroll",i),w||O===L||(w=[])):(w=w||[]).push(K,L))}h&&(w=w||[]).push("style",h);var K=w;(o.updateQueue=K)&&(o.flags|=4)}},dm=function(i,o,h,p){h!==p&&(o.flags|=4)};function ha(i,o){if(!et)switch(i.tailMode){case"hidden":o=i.tail;for(var h=null;o!==null;)o.alternate!==null&&(h=o),o=o.sibling;h===null?i.tail=null:h.sibling=null;break;case"collapsed":h=i.tail;for(var p=null;h!==null;)h.alternate!==null&&(p=h),h=h.sibling;p===null?o||i.tail===null?i.tail=null:i.tail.sibling=null:p.sibling=null}}function Lt(i){var o=i.alternate!==null&&i.alternate.child===i.child,h=0,p=0;if(o)for(var v=i.child;v!==null;)h|=v.lanes|v.childLanes,p|=v.subtreeFlags&14680064,p|=v.flags&14680064,v.return=i,v=v.sibling;else for(v=i.child;v!==null;)h|=v.lanes|v.childLanes,p|=v.subtreeFlags,p|=v.flags,v.return=i,v=v.sibling;return i.subtreeFlags|=p,i.childLanes=h,o}function A0(i,o,h){var p=o.pendingProps;switch(du(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Lt(o),null;case 1:return Jt(o.type)&&Mo(),Lt(o),null;case 3:return p=o.stateNode,ui(),Xe(Yt),Xe(Rt),Su(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(i===null||i.child===null)&&($o(o)?o.flags|=4:i===null||i.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,Nn!==null&&(ed(Nn),Nn=null))),Wu(i,o),Lt(o),null;case 5:_u(o);var v=wr(oa.current);if(h=o.type,i!==null&&o.stateNode!=null)um(i,o,h,p,v),i.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!p){if(o.stateNode===null)throw Error(n(166));return Lt(o),null}if(i=wr(Xn.current),$o(o)){p=o.stateNode,h=o.type;var w=o.memoizedProps;switch(p[Jn]=o,p[na]=w,i=(o.mode&1)!==0,h){case"dialog":Je("cancel",p),Je("close",p);break;case"iframe":case"object":case"embed":Je("load",p);break;case"video":case"audio":for(v=0;v<Zi.length;v++)Je(Zi[v],p);break;case"source":Je("error",p);break;case"img":case"image":case"link":Je("error",p),Je("load",p);break;case"details":Je("toggle",p);break;case"input":os(p,w),Je("invalid",p);break;case"select":p._wrapperState={wasMultiple:!!w.multiple},Je("invalid",p);break;case"textarea":jn(p,w),Je("invalid",p)}As(h,w),v=null;for(var P in w)if(w.hasOwnProperty(P)){var O=w[P];P==="children"?typeof O=="string"?p.textContent!==O&&(w.suppressHydrationWarning!==!0&&Ao(p.textContent,O,i),v=["children",O]):typeof O=="number"&&p.textContent!==""+O&&(w.suppressHydrationWarning!==!0&&Ao(p.textContent,O,i),v=["children",""+O]):r.hasOwnProperty(P)&&O!=null&&P==="onScroll"&&Je("scroll",p)}switch(h){case"input":Kt(p),Sn(p,w,!0);break;case"textarea":Kt(p),Cn(p);break;case"select":case"option":break;default:typeof w.onClick=="function"&&(p.onclick=Oo)}p=v,o.updateQueue=p,p!==null&&(o.flags|=4)}else{P=v.nodeType===9?v:v.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=Vn(h)),i==="http://www.w3.org/1999/xhtml"?h==="script"?(i=P.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof p.is=="string"?i=P.createElement(h,{is:p.is}):(i=P.createElement(h),h==="select"&&(P=i,p.multiple?P.multiple=!0:p.size&&(P.size=p.size))):i=P.createElementNS(i,h),i[Jn]=o,i[na]=p,cm(i,o,!1,!1),o.stateNode=i;e:{switch(P=Wt(h,p),h){case"dialog":Je("cancel",i),Je("close",i),v=p;break;case"iframe":case"object":case"embed":Je("load",i),v=p;break;case"video":case"audio":for(v=0;v<Zi.length;v++)Je(Zi[v],i);v=p;break;case"source":Je("error",i),v=p;break;case"img":case"image":case"link":Je("error",i),Je("load",i),v=p;break;case"details":Je("toggle",i),v=p;break;case"input":os(i,p),v=Ue(i,p),Je("invalid",i);break;case"option":v=p;break;case"select":i._wrapperState={wasMultiple:!!p.multiple},v=ie({},p,{value:void 0}),Je("invalid",i);break;case"textarea":jn(i,p),v=Ot(i,p),Je("invalid",i);break;default:v=p}As(h,v),O=v;for(w in O)if(O.hasOwnProperty(w)){var L=O[w];w==="style"?He(i,L):w==="dangerouslySetInnerHTML"?(L=L?L.__html:void 0,L!=null&&fr(i,L)):w==="children"?typeof L=="string"?(h!=="textarea"||L!=="")&&Kn(i,L):typeof L=="number"&&Kn(i,""+L):w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&w!=="autoFocus"&&(r.hasOwnProperty(w)?L!=null&&w==="onScroll"&&Je("scroll",i):L!=null&&C(i,w,L,P))}switch(h){case"input":Kt(i),Sn(i,p,!1);break;case"textarea":Kt(i),Cn(i);break;case"option":p.value!=null&&i.setAttribute("value",""+Te(p.value));break;case"select":i.multiple=!!p.multiple,w=p.value,w!=null?vt(i,!!p.multiple,w,!1):p.defaultValue!=null&&vt(i,!!p.multiple,p.defaultValue,!0);break;default:typeof v.onClick=="function"&&(i.onclick=Oo)}switch(h){case"button":case"input":case"select":case"textarea":p=!!p.autoFocus;break e;case"img":p=!0;break e;default:p=!1}}p&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return Lt(o),null;case 6:if(i&&o.stateNode!=null)dm(i,o,i.memoizedProps,p);else{if(typeof p!="string"&&o.stateNode===null)throw Error(n(166));if(h=wr(oa.current),wr(Xn.current),$o(o)){if(p=o.stateNode,h=o.memoizedProps,p[Jn]=o,(w=p.nodeValue!==h)&&(i=ln,i!==null))switch(i.tag){case 3:Ao(p.nodeValue,h,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&Ao(p.nodeValue,h,(i.mode&1)!==0)}w&&(o.flags|=4)}else p=(h.nodeType===9?h:h.ownerDocument).createTextNode(p),p[Jn]=o,o.stateNode=p}return Lt(o),null;case 13:if(Xe(rt),p=o.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(et&&cn!==null&&(o.mode&1)!==0&&(o.flags&128)===0)pp(),ai(),o.flags|=98560,w=!1;else if(w=$o(o),p!==null&&p.dehydrated!==null){if(i===null){if(!w)throw Error(n(318));if(w=o.memoizedState,w=w!==null?w.dehydrated:null,!w)throw Error(n(317));w[Jn]=o}else ai(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;Lt(o),w=!1}else Nn!==null&&(ed(Nn),Nn=null),w=!0;if(!w)return o.flags&65536?o:null}return(o.flags&128)!==0?(o.lanes=h,o):(p=p!==null,p!==(i!==null&&i.memoizedState!==null)&&p&&(o.child.flags|=8192,(o.mode&1)!==0&&(i===null||(rt.current&1)!==0?bt===0&&(bt=3):sd())),o.updateQueue!==null&&(o.flags|=4),Lt(o),null);case 4:return ui(),Wu(i,o),i===null&&ea(o.stateNode.containerInfo),Lt(o),null;case 10:return yu(o.type._context),Lt(o),null;case 17:return Jt(o.type)&&Mo(),Lt(o),null;case 19:if(Xe(rt),w=o.memoizedState,w===null)return Lt(o),null;if(p=(o.flags&128)!==0,P=w.rendering,P===null)if(p)ha(w,!1);else{if(bt!==0||i!==null&&(i.flags&128)!==0)for(i=o.child;i!==null;){if(P=Ho(i),P!==null){for(o.flags|=128,ha(w,!1),p=P.updateQueue,p!==null&&(o.updateQueue=p,o.flags|=4),o.subtreeFlags=0,p=h,h=o.child;h!==null;)w=h,i=p,w.flags&=14680066,P=w.alternate,P===null?(w.childLanes=0,w.lanes=i,w.child=null,w.subtreeFlags=0,w.memoizedProps=null,w.memoizedState=null,w.updateQueue=null,w.dependencies=null,w.stateNode=null):(w.childLanes=P.childLanes,w.lanes=P.lanes,w.child=P.child,w.subtreeFlags=0,w.deletions=null,w.memoizedProps=P.memoizedProps,w.memoizedState=P.memoizedState,w.updateQueue=P.updateQueue,w.type=P.type,i=P.dependencies,w.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),h=h.sibling;return Ke(rt,rt.current&1|2),o.child}i=i.sibling}w.tail!==null&&ht()>pi&&(o.flags|=128,p=!0,ha(w,!1),o.lanes=4194304)}else{if(!p)if(i=Ho(P),i!==null){if(o.flags|=128,p=!0,h=i.updateQueue,h!==null&&(o.updateQueue=h,o.flags|=4),ha(w,!0),w.tail===null&&w.tailMode==="hidden"&&!P.alternate&&!et)return Lt(o),null}else 2*ht()-w.renderingStartTime>pi&&h!==1073741824&&(o.flags|=128,p=!0,ha(w,!1),o.lanes=4194304);w.isBackwards?(P.sibling=o.child,o.child=P):(h=w.last,h!==null?h.sibling=P:o.child=P,w.last=P)}return w.tail!==null?(o=w.tail,w.rendering=o,w.tail=o.sibling,w.renderingStartTime=ht(),o.sibling=null,h=rt.current,Ke(rt,p?h&1|2:h&1),o):(Lt(o),null);case 22:case 23:return nd(),p=o.memoizedState!==null,i!==null&&i.memoizedState!==null!==p&&(o.flags|=8192),p&&(o.mode&1)!==0?(un&1073741824)!==0&&(Lt(o),o.subtreeFlags&6&&(o.flags|=8192)):Lt(o),null;case 24:return null;case 25:return null}throw Error(n(156,o.tag))}function O0(i,o){switch(du(o),o.tag){case 1:return Jt(o.type)&&Mo(),i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 3:return ui(),Xe(Yt),Xe(Rt),Su(),i=o.flags,(i&65536)!==0&&(i&128)===0?(o.flags=i&-65537|128,o):null;case 5:return _u(o),null;case 13:if(Xe(rt),i=o.memoizedState,i!==null&&i.dehydrated!==null){if(o.alternate===null)throw Error(n(340));ai()}return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 19:return Xe(rt),null;case 4:return ui(),null;case 10:return yu(o.type._context),null;case 22:case 23:return nd(),null;case 24:return null;default:return null}}var tl=!1,Dt=!1,R0=typeof WeakSet=="function"?WeakSet:Set,he=null;function hi(i,o){var h=i.ref;if(h!==null)if(typeof h=="function")try{h(null)}catch(p){ot(i,o,p)}else h.current=null}function Vu(i,o,h){try{h()}catch(p){ot(i,o,p)}}var hm=!1;function M0(i,o){if(nu=wo,i=Vf(),Gc(i)){if("selectionStart"in i)var h={start:i.selectionStart,end:i.selectionEnd};else e:{h=(h=i.ownerDocument)&&h.defaultView||window;var p=h.getSelection&&h.getSelection();if(p&&p.rangeCount!==0){h=p.anchorNode;var v=p.anchorOffset,w=p.focusNode;p=p.focusOffset;try{h.nodeType,w.nodeType}catch{h=null;break e}var P=0,O=-1,L=-1,K=0,Z=0,te=i,Q=null;t:for(;;){for(var ue;te!==h||v!==0&&te.nodeType!==3||(O=P+v),te!==w||p!==0&&te.nodeType!==3||(L=P+p),te.nodeType===3&&(P+=te.nodeValue.length),(ue=te.firstChild)!==null;)Q=te,te=ue;for(;;){if(te===i)break t;if(Q===h&&++K===v&&(O=P),Q===w&&++Z===p&&(L=P),(ue=te.nextSibling)!==null)break;te=Q,Q=te.parentNode}te=ue}h=O===-1||L===-1?null:{start:O,end:L}}else h=null}h=h||{start:0,end:0}}else h=null;for(su={focusedElem:i,selectionRange:h},wo=!1,he=o;he!==null;)if(o=he,i=o.child,(o.subtreeFlags&1028)!==0&&i!==null)i.return=o,he=i;else for(;he!==null;){o=he;try{var fe=o.alternate;if((o.flags&1024)!==0)switch(o.tag){case 0:case 11:case 15:break;case 1:if(fe!==null){var me=fe.memoizedProps,ft=fe.memoizedState,V=o.stateNode,$=V.getSnapshotBeforeUpdate(o.elementType===o.type?me:An(o.type,me),ft);V.__reactInternalSnapshotBeforeUpdate=$}break;case 3:var q=o.stateNode.containerInfo;q.nodeType===1?q.textContent="":q.nodeType===9&&q.documentElement&&q.removeChild(q.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(n(163))}}catch(se){ot(o,o.return,se)}if(i=o.sibling,i!==null){i.return=o.return,he=i;break}he=o.return}return fe=hm,hm=!1,fe}function fa(i,o,h){var p=o.updateQueue;if(p=p!==null?p.lastEffect:null,p!==null){var v=p=p.next;do{if((v.tag&i)===i){var w=v.destroy;v.destroy=void 0,w!==void 0&&Vu(o,h,w)}v=v.next}while(v!==p)}}function nl(i,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var h=o=o.next;do{if((h.tag&i)===i){var p=h.create;h.destroy=p()}h=h.next}while(h!==o)}}function qu(i){var o=i.ref;if(o!==null){var h=i.stateNode;i.tag,i=h,typeof o=="function"?o(i):o.current=i}}function fm(i){var o=i.alternate;o!==null&&(i.alternate=null,fm(o)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(o=i.stateNode,o!==null&&(delete o[Jn],delete o[na],delete o[ou],delete o[y0],delete o[v0])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function pm(i){return i.tag===5||i.tag===3||i.tag===4}function mm(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||pm(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Hu(i,o,h){var p=i.tag;if(p===5||p===6)i=i.stateNode,o?h.nodeType===8?h.parentNode.insertBefore(i,o):h.insertBefore(i,o):(h.nodeType===8?(o=h.parentNode,o.insertBefore(i,h)):(o=h,o.appendChild(i)),h=h._reactRootContainer,h!=null||o.onclick!==null||(o.onclick=Oo));else if(p!==4&&(i=i.child,i!==null))for(Hu(i,o,h),i=i.sibling;i!==null;)Hu(i,o,h),i=i.sibling}function Ku(i,o,h){var p=i.tag;if(p===5||p===6)i=i.stateNode,o?h.insertBefore(i,o):h.appendChild(i);else if(p!==4&&(i=i.child,i!==null))for(Ku(i,o,h),i=i.sibling;i!==null;)Ku(i,o,h),i=i.sibling}var Pt=null,On=!1;function Hs(i,o,h){for(h=h.child;h!==null;)gm(i,o,h),h=h.sibling}function gm(i,o,h){if(Yn&&typeof Yn.onCommitFiberUnmount=="function")try{Yn.onCommitFiberUnmount(mo,h)}catch{}switch(h.tag){case 5:Dt||hi(h,o);case 6:var p=Pt,v=On;Pt=null,Hs(i,o,h),Pt=p,On=v,Pt!==null&&(On?(i=Pt,h=h.stateNode,i.nodeType===8?i.parentNode.removeChild(h):i.removeChild(h)):Pt.removeChild(h.stateNode));break;case 18:Pt!==null&&(On?(i=Pt,h=h.stateNode,i.nodeType===8?au(i.parentNode,h):i.nodeType===1&&au(i,h),qi(i)):au(Pt,h.stateNode));break;case 4:p=Pt,v=On,Pt=h.stateNode.containerInfo,On=!0,Hs(i,o,h),Pt=p,On=v;break;case 0:case 11:case 14:case 15:if(!Dt&&(p=h.updateQueue,p!==null&&(p=p.lastEffect,p!==null))){v=p=p.next;do{var w=v,P=w.destroy;w=w.tag,P!==void 0&&((w&2)!==0||(w&4)!==0)&&Vu(h,o,P),v=v.next}while(v!==p)}Hs(i,o,h);break;case 1:if(!Dt&&(hi(h,o),p=h.stateNode,typeof p.componentWillUnmount=="function"))try{p.props=h.memoizedProps,p.state=h.memoizedState,p.componentWillUnmount()}catch(O){ot(h,o,O)}Hs(i,o,h);break;case 21:Hs(i,o,h);break;case 22:h.mode&1?(Dt=(p=Dt)||h.memoizedState!==null,Hs(i,o,h),Dt=p):Hs(i,o,h);break;default:Hs(i,o,h)}}function ym(i){var o=i.updateQueue;if(o!==null){i.updateQueue=null;var h=i.stateNode;h===null&&(h=i.stateNode=new R0),o.forEach(function(p){var v=V0.bind(null,i,p);h.has(p)||(h.add(p),p.then(v,v))})}}function Rn(i,o){var h=o.deletions;if(h!==null)for(var p=0;p<h.length;p++){var v=h[p];try{var w=i,P=o,O=P;e:for(;O!==null;){switch(O.tag){case 5:Pt=O.stateNode,On=!1;break e;case 3:Pt=O.stateNode.containerInfo,On=!0;break e;case 4:Pt=O.stateNode.containerInfo,On=!0;break e}O=O.return}if(Pt===null)throw Error(n(160));gm(w,P,v),Pt=null,On=!1;var L=v.alternate;L!==null&&(L.return=null),v.return=null}catch(K){ot(v,o,K)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)vm(o,i),o=o.sibling}function vm(i,o){var h=i.alternate,p=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(Rn(o,i),Zn(i),p&4){try{fa(3,i,i.return),nl(3,i)}catch(me){ot(i,i.return,me)}try{fa(5,i,i.return)}catch(me){ot(i,i.return,me)}}break;case 1:Rn(o,i),Zn(i),p&512&&h!==null&&hi(h,h.return);break;case 5:if(Rn(o,i),Zn(i),p&512&&h!==null&&hi(h,h.return),i.flags&32){var v=i.stateNode;try{Kn(v,"")}catch(me){ot(i,i.return,me)}}if(p&4&&(v=i.stateNode,v!=null)){var w=i.memoizedProps,P=h!==null?h.memoizedProps:w,O=i.type,L=i.updateQueue;if(i.updateQueue=null,L!==null)try{O==="input"&&w.type==="radio"&&w.name!=null&&ls(v,w),Wt(O,P);var K=Wt(O,w);for(P=0;P<L.length;P+=2){var Z=L[P],te=L[P+1];Z==="style"?He(v,te):Z==="dangerouslySetInnerHTML"?fr(v,te):Z==="children"?Kn(v,te):C(v,Z,te,K)}switch(O){case"input":Wn(v,w);break;case"textarea":Gt(v,w);break;case"select":var Q=v._wrapperState.wasMultiple;v._wrapperState.wasMultiple=!!w.multiple;var ue=w.value;ue!=null?vt(v,!!w.multiple,ue,!1):Q!==!!w.multiple&&(w.defaultValue!=null?vt(v,!!w.multiple,w.defaultValue,!0):vt(v,!!w.multiple,w.multiple?[]:"",!1))}v[na]=w}catch(me){ot(i,i.return,me)}}break;case 6:if(Rn(o,i),Zn(i),p&4){if(i.stateNode===null)throw Error(n(162));v=i.stateNode,w=i.memoizedProps;try{v.nodeValue=w}catch(me){ot(i,i.return,me)}}break;case 3:if(Rn(o,i),Zn(i),p&4&&h!==null&&h.memoizedState.isDehydrated)try{qi(o.containerInfo)}catch(me){ot(i,i.return,me)}break;case 4:Rn(o,i),Zn(i);break;case 13:Rn(o,i),Zn(i),v=i.child,v.flags&8192&&(w=v.memoizedState!==null,v.stateNode.isHidden=w,!w||v.alternate!==null&&v.alternate.memoizedState!==null||(Ju=ht())),p&4&&ym(i);break;case 22:if(Z=h!==null&&h.memoizedState!==null,i.mode&1?(Dt=(K=Dt)||Z,Rn(o,i),Dt=K):Rn(o,i),Zn(i),p&8192){if(K=i.memoizedState!==null,(i.stateNode.isHidden=K)&&!Z&&(i.mode&1)!==0)for(he=i,Z=i.child;Z!==null;){for(te=he=Z;he!==null;){switch(Q=he,ue=Q.child,Q.tag){case 0:case 11:case 14:case 15:fa(4,Q,Q.return);break;case 1:hi(Q,Q.return);var fe=Q.stateNode;if(typeof fe.componentWillUnmount=="function"){p=Q,h=Q.return;try{o=p,fe.props=o.memoizedProps,fe.state=o.memoizedState,fe.componentWillUnmount()}catch(me){ot(p,h,me)}}break;case 5:hi(Q,Q.return);break;case 22:if(Q.memoizedState!==null){wm(te);continue}}ue!==null?(ue.return=Q,he=ue):wm(te)}Z=Z.sibling}e:for(Z=null,te=i;;){if(te.tag===5){if(Z===null){Z=te;try{v=te.stateNode,K?(w=v.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none"):(O=te.stateNode,L=te.memoizedProps.style,P=L!=null&&L.hasOwnProperty("display")?L.display:null,O.style.display=Hr("display",P))}catch(me){ot(i,i.return,me)}}}else if(te.tag===6){if(Z===null)try{te.stateNode.nodeValue=K?"":te.memoizedProps}catch(me){ot(i,i.return,me)}}else if((te.tag!==22&&te.tag!==23||te.memoizedState===null||te===i)&&te.child!==null){te.child.return=te,te=te.child;continue}if(te===i)break e;for(;te.sibling===null;){if(te.return===null||te.return===i)break e;Z===te&&(Z=null),te=te.return}Z===te&&(Z=null),te.sibling.return=te.return,te=te.sibling}}break;case 19:Rn(o,i),Zn(i),p&4&&ym(i);break;case 21:break;default:Rn(o,i),Zn(i)}}function Zn(i){var o=i.flags;if(o&2){try{e:{for(var h=i.return;h!==null;){if(pm(h)){var p=h;break e}h=h.return}throw Error(n(160))}switch(p.tag){case 5:var v=p.stateNode;p.flags&32&&(Kn(v,""),p.flags&=-33);var w=mm(i);Ku(i,w,v);break;case 3:case 4:var P=p.stateNode.containerInfo,O=mm(i);Hu(i,O,P);break;default:throw Error(n(161))}}catch(L){ot(i,i.return,L)}i.flags&=-3}o&4096&&(i.flags&=-4097)}function L0(i,o,h){he=i,xm(i)}function xm(i,o,h){for(var p=(i.mode&1)!==0;he!==null;){var v=he,w=v.child;if(v.tag===22&&p){var P=v.memoizedState!==null||tl;if(!P){var O=v.alternate,L=O!==null&&O.memoizedState!==null||Dt;O=tl;var K=Dt;if(tl=P,(Dt=L)&&!K)for(he=v;he!==null;)P=he,L=P.child,P.tag===22&&P.memoizedState!==null?_m(v):L!==null?(L.return=P,he=L):_m(v);for(;w!==null;)he=w,xm(w),w=w.sibling;he=v,tl=O,Dt=K}bm(i)}else(v.subtreeFlags&8772)!==0&&w!==null?(w.return=v,he=w):bm(i)}}function bm(i){for(;he!==null;){var o=he;if((o.flags&8772)!==0){var h=o.alternate;try{if((o.flags&8772)!==0)switch(o.tag){case 0:case 11:case 15:Dt||nl(5,o);break;case 1:var p=o.stateNode;if(o.flags&4&&!Dt)if(h===null)p.componentDidMount();else{var v=o.elementType===o.type?h.memoizedProps:An(o.type,h.memoizedProps);p.componentDidUpdate(v,h.memoizedState,p.__reactInternalSnapshotBeforeUpdate)}var w=o.updateQueue;w!==null&&wp(o,w,p);break;case 3:var P=o.updateQueue;if(P!==null){if(h=null,o.child!==null)switch(o.child.tag){case 5:h=o.child.stateNode;break;case 1:h=o.child.stateNode}wp(o,P,h)}break;case 5:var O=o.stateNode;if(h===null&&o.flags&4){h=O;var L=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":L.autoFocus&&h.focus();break;case"img":L.src&&(h.src=L.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var K=o.alternate;if(K!==null){var Z=K.memoizedState;if(Z!==null){var te=Z.dehydrated;te!==null&&qi(te)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(n(163))}Dt||o.flags&512&&qu(o)}catch(Q){ot(o,o.return,Q)}}if(o===i){he=null;break}if(h=o.sibling,h!==null){h.return=o.return,he=h;break}he=o.return}}function wm(i){for(;he!==null;){var o=he;if(o===i){he=null;break}var h=o.sibling;if(h!==null){h.return=o.return,he=h;break}he=o.return}}function _m(i){for(;he!==null;){var o=he;try{switch(o.tag){case 0:case 11:case 15:var h=o.return;try{nl(4,o)}catch(L){ot(o,h,L)}break;case 1:var p=o.stateNode;if(typeof p.componentDidMount=="function"){var v=o.return;try{p.componentDidMount()}catch(L){ot(o,v,L)}}var w=o.return;try{qu(o)}catch(L){ot(o,w,L)}break;case 5:var P=o.return;try{qu(o)}catch(L){ot(o,P,L)}}}catch(L){ot(o,o.return,L)}if(o===i){he=null;break}var O=o.sibling;if(O!==null){O.return=o.return,he=O;break}he=o.return}}var D0=Math.ceil,sl=T.ReactCurrentDispatcher,Gu=T.ReactCurrentOwner,bn=T.ReactCurrentBatchConfig,Me=0,St=null,gt=null,It=0,un=0,fi=zs(0),bt=0,pa=null,kr=0,rl=0,Yu=0,ma=null,Qt=null,Ju=0,pi=1/0,ys=null,il=!1,Xu=null,Ks=null,al=!1,Gs=null,ol=0,ga=0,Qu=null,ll=-1,cl=0;function qt(){return(Me&6)!==0?ht():ll!==-1?ll:ll=ht()}function Ys(i){return(i.mode&1)===0?1:(Me&2)!==0&&It!==0?It&-It:b0.transition!==null?(cl===0&&(cl=mf()),cl):(i=We,i!==0||(i=window.event,i=i===void 0?16:Sf(i.type)),i)}function Mn(i,o,h,p){if(50<ga)throw ga=0,Qu=null,Error(n(185));$i(i,h,p),((Me&2)===0||i!==St)&&(i===St&&((Me&2)===0&&(rl|=h),bt===4&&Js(i,It)),Zt(i,p),h===1&&Me===0&&(o.mode&1)===0&&(pi=ht()+500,Do&&Ws()))}function Zt(i,o){var h=i.callbackNode;bb(i,o);var p=vo(i,i===St?It:0);if(p===0)h!==null&&hf(h),i.callbackNode=null,i.callbackPriority=0;else if(o=p&-p,i.callbackPriority!==o){if(h!=null&&hf(h),o===1)i.tag===0?x0(Sm.bind(null,i)):cp(Sm.bind(null,i)),m0(function(){(Me&6)===0&&Ws()}),h=null;else{switch(gf(p)){case 1:h=Nc;break;case 4:h=ff;break;case 16:h=po;break;case 536870912:h=pf;break;default:h=po}h=Am(h,km.bind(null,i))}i.callbackPriority=o,i.callbackNode=h}}function km(i,o){if(ll=-1,cl=0,(Me&6)!==0)throw Error(n(327));var h=i.callbackNode;if(mi()&&i.callbackNode!==h)return null;var p=vo(i,i===St?It:0);if(p===0)return null;if((p&30)!==0||(p&i.expiredLanes)!==0||o)o=ul(i,p);else{o=p;var v=Me;Me|=2;var w=Cm();(St!==i||It!==o)&&(ys=null,pi=ht()+500,jr(i,o));do try{$0();break}catch(O){jm(i,O)}while(!0);gu(),sl.current=w,Me=v,gt!==null?o=0:(St=null,It=0,o=bt)}if(o!==0){if(o===2&&(v=Ac(i),v!==0&&(p=v,o=Zu(i,v))),o===1)throw h=pa,jr(i,0),Js(i,p),Zt(i,ht()),h;if(o===6)Js(i,p);else{if(v=i.current.alternate,(p&30)===0&&!F0(v)&&(o=ul(i,p),o===2&&(w=Ac(i),w!==0&&(p=w,o=Zu(i,w))),o===1))throw h=pa,jr(i,0),Js(i,p),Zt(i,ht()),h;switch(i.finishedWork=v,i.finishedLanes=p,o){case 0:case 1:throw Error(n(345));case 2:Cr(i,Qt,ys);break;case 3:if(Js(i,p),(p&130023424)===p&&(o=Ju+500-ht(),10<o)){if(vo(i,0)!==0)break;if(v=i.suspendedLanes,(v&p)!==p){qt(),i.pingedLanes|=i.suspendedLanes&v;break}i.timeoutHandle=iu(Cr.bind(null,i,Qt,ys),o);break}Cr(i,Qt,ys);break;case 4:if(Js(i,p),(p&4194240)===p)break;for(o=i.eventTimes,v=-1;0<p;){var P=31-En(p);w=1<<P,P=o[P],P>v&&(v=P),p&=~w}if(p=v,p=ht()-p,p=(120>p?120:480>p?480:1080>p?1080:1920>p?1920:3e3>p?3e3:4320>p?4320:1960*D0(p/1960))-p,10<p){i.timeoutHandle=iu(Cr.bind(null,i,Qt,ys),p);break}Cr(i,Qt,ys);break;case 5:Cr(i,Qt,ys);break;default:throw Error(n(329))}}}return Zt(i,ht()),i.callbackNode===h?km.bind(null,i):null}function Zu(i,o){var h=ma;return i.current.memoizedState.isDehydrated&&(jr(i,o).flags|=256),i=ul(i,o),i!==2&&(o=Qt,Qt=h,o!==null&&ed(o)),i}function ed(i){Qt===null?Qt=i:Qt.push.apply(Qt,i)}function F0(i){for(var o=i;;){if(o.flags&16384){var h=o.updateQueue;if(h!==null&&(h=h.stores,h!==null))for(var p=0;p<h.length;p++){var v=h[p],w=v.getSnapshot;v=v.value;try{if(!Tn(w(),v))return!1}catch{return!1}}}if(h=o.child,o.subtreeFlags&16384&&h!==null)h.return=o,o=h;else{if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Js(i,o){for(o&=~Yu,o&=~rl,i.suspendedLanes|=o,i.pingedLanes&=~o,i=i.expirationTimes;0<o;){var h=31-En(o),p=1<<h;i[h]=-1,o&=~p}}function Sm(i){if((Me&6)!==0)throw Error(n(327));mi();var o=vo(i,0);if((o&1)===0)return Zt(i,ht()),null;var h=ul(i,o);if(i.tag!==0&&h===2){var p=Ac(i);p!==0&&(o=p,h=Zu(i,p))}if(h===1)throw h=pa,jr(i,0),Js(i,o),Zt(i,ht()),h;if(h===6)throw Error(n(345));return i.finishedWork=i.current.alternate,i.finishedLanes=o,Cr(i,Qt,ys),Zt(i,ht()),null}function td(i,o){var h=Me;Me|=1;try{return i(o)}finally{Me=h,Me===0&&(pi=ht()+500,Do&&Ws())}}function Sr(i){Gs!==null&&Gs.tag===0&&(Me&6)===0&&mi();var o=Me;Me|=1;var h=bn.transition,p=We;try{if(bn.transition=null,We=1,i)return i()}finally{We=p,bn.transition=h,Me=o,(Me&6)===0&&Ws()}}function nd(){un=fi.current,Xe(fi)}function jr(i,o){i.finishedWork=null,i.finishedLanes=0;var h=i.timeoutHandle;if(h!==-1&&(i.timeoutHandle=-1,p0(h)),gt!==null)for(h=gt.return;h!==null;){var p=h;switch(du(p),p.tag){case 1:p=p.type.childContextTypes,p!=null&&Mo();break;case 3:ui(),Xe(Yt),Xe(Rt),Su();break;case 5:_u(p);break;case 4:ui();break;case 13:Xe(rt);break;case 19:Xe(rt);break;case 10:yu(p.type._context);break;case 22:case 23:nd()}h=h.return}if(St=i,gt=i=Xs(i.current,null),It=un=o,bt=0,pa=null,Yu=rl=kr=0,Qt=ma=null,br!==null){for(o=0;o<br.length;o++)if(h=br[o],p=h.interleaved,p!==null){h.interleaved=null;var v=p.next,w=h.pending;if(w!==null){var P=w.next;w.next=v,p.next=P}h.pending=p}br=null}return i}function jm(i,o){do{var h=gt;try{if(gu(),Ko.current=Xo,Go){for(var p=it.memoizedState;p!==null;){var v=p.queue;v!==null&&(v.pending=null),p=p.next}Go=!1}if(_r=0,kt=xt=it=null,la=!1,ca=0,Gu.current=null,h===null||h.return===null){bt=1,pa=o,gt=null;break}e:{var w=i,P=h.return,O=h,L=o;if(o=It,O.flags|=32768,L!==null&&typeof L=="object"&&typeof L.then=="function"){var K=L,Z=O,te=Z.tag;if((Z.mode&1)===0&&(te===0||te===11||te===15)){var Q=Z.alternate;Q?(Z.updateQueue=Q.updateQueue,Z.memoizedState=Q.memoizedState,Z.lanes=Q.lanes):(Z.updateQueue=null,Z.memoizedState=null)}var ue=Jp(P);if(ue!==null){ue.flags&=-257,Xp(ue,P,O,w,o),ue.mode&1&&Yp(w,K,o),o=ue,L=K;var fe=o.updateQueue;if(fe===null){var me=new Set;me.add(L),o.updateQueue=me}else fe.add(L);break e}else{if((o&1)===0){Yp(w,K,o),sd();break e}L=Error(n(426))}}else if(et&&O.mode&1){var ft=Jp(P);if(ft!==null){(ft.flags&65536)===0&&(ft.flags|=256),Xp(ft,P,O,w,o),pu(di(L,O));break e}}w=L=di(L,O),bt!==4&&(bt=2),ma===null?ma=[w]:ma.push(w),w=P;do{switch(w.tag){case 3:w.flags|=65536,o&=-o,w.lanes|=o;var V=Kp(w,L,o);bp(w,V);break e;case 1:O=L;var $=w.type,q=w.stateNode;if((w.flags&128)===0&&(typeof $.getDerivedStateFromError=="function"||q!==null&&typeof q.componentDidCatch=="function"&&(Ks===null||!Ks.has(q)))){w.flags|=65536,o&=-o,w.lanes|=o;var se=Gp(w,O,o);bp(w,se);break e}}w=w.return}while(w!==null)}Im(h)}catch(ye){o=ye,gt===h&&h!==null&&(gt=h=h.return);continue}break}while(!0)}function Cm(){var i=sl.current;return sl.current=Xo,i===null?Xo:i}function sd(){(bt===0||bt===3||bt===2)&&(bt=4),St===null||(kr&268435455)===0&&(rl&268435455)===0||Js(St,It)}function ul(i,o){var h=Me;Me|=2;var p=Cm();(St!==i||It!==o)&&(ys=null,jr(i,o));do try{B0();break}catch(v){jm(i,v)}while(!0);if(gu(),Me=h,sl.current=p,gt!==null)throw Error(n(261));return St=null,It=0,bt}function B0(){for(;gt!==null;)Pm(gt)}function $0(){for(;gt!==null&&!db();)Pm(gt)}function Pm(i){var o=Nm(i.alternate,i,un);i.memoizedProps=i.pendingProps,o===null?Im(i):gt=o,Gu.current=null}function Im(i){var o=i;do{var h=o.alternate;if(i=o.return,(o.flags&32768)===0){if(h=A0(h,o,un),h!==null){gt=h;return}}else{if(h=O0(h,o),h!==null){h.flags&=32767,gt=h;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{bt=6,gt=null;return}}if(o=o.sibling,o!==null){gt=o;return}gt=o=i}while(o!==null);bt===0&&(bt=5)}function Cr(i,o,h){var p=We,v=bn.transition;try{bn.transition=null,We=1,z0(i,o,h,p)}finally{bn.transition=v,We=p}return null}function z0(i,o,h,p){do mi();while(Gs!==null);if((Me&6)!==0)throw Error(n(327));h=i.finishedWork;var v=i.finishedLanes;if(h===null)return null;if(i.finishedWork=null,i.finishedLanes=0,h===i.current)throw Error(n(177));i.callbackNode=null,i.callbackPriority=0;var w=h.lanes|h.childLanes;if(wb(i,w),i===St&&(gt=St=null,It=0),(h.subtreeFlags&2064)===0&&(h.flags&2064)===0||al||(al=!0,Am(po,function(){return mi(),null})),w=(h.flags&15990)!==0,(h.subtreeFlags&15990)!==0||w){w=bn.transition,bn.transition=null;var P=We;We=1;var O=Me;Me|=4,Gu.current=null,M0(i,h),vm(h,i),o0(su),wo=!!nu,su=nu=null,i.current=h,L0(h),hb(),Me=O,We=P,bn.transition=w}else i.current=h;if(al&&(al=!1,Gs=i,ol=v),w=i.pendingLanes,w===0&&(Ks=null),mb(h.stateNode),Zt(i,ht()),o!==null)for(p=i.onRecoverableError,h=0;h<o.length;h++)v=o[h],p(v.value,{componentStack:v.stack,digest:v.digest});if(il)throw il=!1,i=Xu,Xu=null,i;return(ol&1)!==0&&i.tag!==0&&mi(),w=i.pendingLanes,(w&1)!==0?i===Qu?ga++:(ga=0,Qu=i):ga=0,Ws(),null}function mi(){if(Gs!==null){var i=gf(ol),o=bn.transition,h=We;try{if(bn.transition=null,We=16>i?16:i,Gs===null)var p=!1;else{if(i=Gs,Gs=null,ol=0,(Me&6)!==0)throw Error(n(331));var v=Me;for(Me|=4,he=i.current;he!==null;){var w=he,P=w.child;if((he.flags&16)!==0){var O=w.deletions;if(O!==null){for(var L=0;L<O.length;L++){var K=O[L];for(he=K;he!==null;){var Z=he;switch(Z.tag){case 0:case 11:case 15:fa(8,Z,w)}var te=Z.child;if(te!==null)te.return=Z,he=te;else for(;he!==null;){Z=he;var Q=Z.sibling,ue=Z.return;if(fm(Z),Z===K){he=null;break}if(Q!==null){Q.return=ue,he=Q;break}he=ue}}}var fe=w.alternate;if(fe!==null){var me=fe.child;if(me!==null){fe.child=null;do{var ft=me.sibling;me.sibling=null,me=ft}while(me!==null)}}he=w}}if((w.subtreeFlags&2064)!==0&&P!==null)P.return=w,he=P;else e:for(;he!==null;){if(w=he,(w.flags&2048)!==0)switch(w.tag){case 0:case 11:case 15:fa(9,w,w.return)}var V=w.sibling;if(V!==null){V.return=w.return,he=V;break e}he=w.return}}var $=i.current;for(he=$;he!==null;){P=he;var q=P.child;if((P.subtreeFlags&2064)!==0&&q!==null)q.return=P,he=q;else e:for(P=$;he!==null;){if(O=he,(O.flags&2048)!==0)try{switch(O.tag){case 0:case 11:case 15:nl(9,O)}}catch(ye){ot(O,O.return,ye)}if(O===P){he=null;break e}var se=O.sibling;if(se!==null){se.return=O.return,he=se;break e}he=O.return}}if(Me=v,Ws(),Yn&&typeof Yn.onPostCommitFiberRoot=="function")try{Yn.onPostCommitFiberRoot(mo,i)}catch{}p=!0}return p}finally{We=h,bn.transition=o}}return!1}function Em(i,o,h){o=di(h,o),o=Kp(i,o,1),i=qs(i,o,1),o=qt(),i!==null&&($i(i,1,o),Zt(i,o))}function ot(i,o,h){if(i.tag===3)Em(i,i,h);else for(;o!==null;){if(o.tag===3){Em(o,i,h);break}else if(o.tag===1){var p=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(Ks===null||!Ks.has(p))){i=di(h,i),i=Gp(o,i,1),o=qs(o,i,1),i=qt(),o!==null&&($i(o,1,i),Zt(o,i));break}}o=o.return}}function U0(i,o,h){var p=i.pingCache;p!==null&&p.delete(o),o=qt(),i.pingedLanes|=i.suspendedLanes&h,St===i&&(It&h)===h&&(bt===4||bt===3&&(It&130023424)===It&&500>ht()-Ju?jr(i,0):Yu|=h),Zt(i,o)}function Tm(i,o){o===0&&((i.mode&1)===0?o=1:(o=yo,yo<<=1,(yo&130023424)===0&&(yo=4194304)));var h=qt();i=ps(i,o),i!==null&&($i(i,o,h),Zt(i,h))}function W0(i){var o=i.memoizedState,h=0;o!==null&&(h=o.retryLane),Tm(i,h)}function V0(i,o){var h=0;switch(i.tag){case 13:var p=i.stateNode,v=i.memoizedState;v!==null&&(h=v.retryLane);break;case 19:p=i.stateNode;break;default:throw Error(n(314))}p!==null&&p.delete(o),Tm(i,h)}var Nm;Nm=function(i,o,h){if(i!==null)if(i.memoizedProps!==o.pendingProps||Yt.current)Xt=!0;else{if((i.lanes&h)===0&&(o.flags&128)===0)return Xt=!1,N0(i,o,h);Xt=(i.flags&131072)!==0}else Xt=!1,et&&(o.flags&1048576)!==0&&up(o,Bo,o.index);switch(o.lanes=0,o.tag){case 2:var p=o.type;el(i,o),i=o.pendingProps;var v=si(o,Rt.current);ci(o,h),v=Pu(null,o,p,i,v,h);var w=Iu();return o.flags|=1,typeof v=="object"&&v!==null&&typeof v.render=="function"&&v.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,Jt(p)?(w=!0,Lo(o)):w=!1,o.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,bu(o),v.updater=Qo,o.stateNode=v,v._reactInternals=o,Ru(o,p,i,h),o=Fu(null,o,p,!0,w,h)):(o.tag=0,et&&w&&uu(o),Vt(null,o,v,h),o=o.child),o;case 16:p=o.elementType;e:{switch(el(i,o),i=o.pendingProps,v=p._init,p=v(p._payload),o.type=p,v=o.tag=H0(p),i=An(p,i),v){case 0:o=Du(null,o,p,i,h);break e;case 1:o=sm(null,o,p,i,h);break e;case 11:o=Qp(null,o,p,i,h);break e;case 14:o=Zp(null,o,p,An(p.type,i),h);break e}throw Error(n(306,p,""))}return o;case 0:return p=o.type,v=o.pendingProps,v=o.elementType===p?v:An(p,v),Du(i,o,p,v,h);case 1:return p=o.type,v=o.pendingProps,v=o.elementType===p?v:An(p,v),sm(i,o,p,v,h);case 3:e:{if(rm(o),i===null)throw Error(n(387));p=o.pendingProps,w=o.memoizedState,v=w.element,xp(i,o),qo(o,p,null,h);var P=o.memoizedState;if(p=P.element,w.isDehydrated)if(w={element:p,isDehydrated:!1,cache:P.cache,pendingSuspenseBoundaries:P.pendingSuspenseBoundaries,transitions:P.transitions},o.updateQueue.baseState=w,o.memoizedState=w,o.flags&256){v=di(Error(n(423)),o),o=im(i,o,p,h,v);break e}else if(p!==v){v=di(Error(n(424)),o),o=im(i,o,p,h,v);break e}else for(cn=$s(o.stateNode.containerInfo.firstChild),ln=o,et=!0,Nn=null,h=yp(o,null,p,h),o.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling;else{if(ai(),p===v){o=gs(i,o,h);break e}Vt(i,o,p,h)}o=o.child}return o;case 5:return _p(o),i===null&&fu(o),p=o.type,v=o.pendingProps,w=i!==null?i.memoizedProps:null,P=v.children,ru(p,v)?P=null:w!==null&&ru(p,w)&&(o.flags|=32),nm(i,o),Vt(i,o,P,h),o.child;case 6:return i===null&&fu(o),null;case 13:return am(i,o,h);case 4:return wu(o,o.stateNode.containerInfo),p=o.pendingProps,i===null?o.child=oi(o,null,p,h):Vt(i,o,p,h),o.child;case 11:return p=o.type,v=o.pendingProps,v=o.elementType===p?v:An(p,v),Qp(i,o,p,v,h);case 7:return Vt(i,o,o.pendingProps,h),o.child;case 8:return Vt(i,o,o.pendingProps.children,h),o.child;case 12:return Vt(i,o,o.pendingProps.children,h),o.child;case 10:e:{if(p=o.type._context,v=o.pendingProps,w=o.memoizedProps,P=v.value,Ke(Uo,p._currentValue),p._currentValue=P,w!==null)if(Tn(w.value,P)){if(w.children===v.children&&!Yt.current){o=gs(i,o,h);break e}}else for(w=o.child,w!==null&&(w.return=o);w!==null;){var O=w.dependencies;if(O!==null){P=w.child;for(var L=O.firstContext;L!==null;){if(L.context===p){if(w.tag===1){L=ms(-1,h&-h),L.tag=2;var K=w.updateQueue;if(K!==null){K=K.shared;var Z=K.pending;Z===null?L.next=L:(L.next=Z.next,Z.next=L),K.pending=L}}w.lanes|=h,L=w.alternate,L!==null&&(L.lanes|=h),vu(w.return,h,o),O.lanes|=h;break}L=L.next}}else if(w.tag===10)P=w.type===o.type?null:w.child;else if(w.tag===18){if(P=w.return,P===null)throw Error(n(341));P.lanes|=h,O=P.alternate,O!==null&&(O.lanes|=h),vu(P,h,o),P=w.sibling}else P=w.child;if(P!==null)P.return=w;else for(P=w;P!==null;){if(P===o){P=null;break}if(w=P.sibling,w!==null){w.return=P.return,P=w;break}P=P.return}w=P}Vt(i,o,v.children,h),o=o.child}return o;case 9:return v=o.type,p=o.pendingProps.children,ci(o,h),v=vn(v),p=p(v),o.flags|=1,Vt(i,o,p,h),o.child;case 14:return p=o.type,v=An(p,o.pendingProps),v=An(p.type,v),Zp(i,o,p,v,h);case 15:return em(i,o,o.type,o.pendingProps,h);case 17:return p=o.type,v=o.pendingProps,v=o.elementType===p?v:An(p,v),el(i,o),o.tag=1,Jt(p)?(i=!0,Lo(o)):i=!1,ci(o,h),qp(o,p,v),Ru(o,p,v,h),Fu(null,o,p,!0,i,h);case 19:return lm(i,o,h);case 22:return tm(i,o,h)}throw Error(n(156,o.tag))};function Am(i,o){return df(i,o)}function q0(i,o,h,p){this.tag=i,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function wn(i,o,h,p){return new q0(i,o,h,p)}function rd(i){return i=i.prototype,!(!i||!i.isReactComponent)}function H0(i){if(typeof i=="function")return rd(i)?1:0;if(i!=null){if(i=i.$$typeof,i===H)return 11;if(i===X)return 14}return 2}function Xs(i,o){var h=i.alternate;return h===null?(h=wn(i.tag,o,i.key,i.mode),h.elementType=i.elementType,h.type=i.type,h.stateNode=i.stateNode,h.alternate=i,i.alternate=h):(h.pendingProps=o,h.type=i.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=i.flags&14680064,h.childLanes=i.childLanes,h.lanes=i.lanes,h.child=i.child,h.memoizedProps=i.memoizedProps,h.memoizedState=i.memoizedState,h.updateQueue=i.updateQueue,o=i.dependencies,h.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},h.sibling=i.sibling,h.index=i.index,h.ref=i.ref,h}function dl(i,o,h,p,v,w){var P=2;if(p=i,typeof i=="function")rd(i)&&(P=1);else if(typeof i=="string")P=5;else e:switch(i){case E:return Pr(h.children,v,w,o);case D:P=8,v|=8;break;case M:return i=wn(12,h,o,v|2),i.elementType=M,i.lanes=w,i;case J:return i=wn(13,h,o,v),i.elementType=J,i.lanes=w,i;case Y:return i=wn(19,h,o,v),i.elementType=Y,i.lanes=w,i;case pe:return hl(h,v,w,o);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case N:P=10;break e;case F:P=9;break e;case H:P=11;break e;case X:P=14;break e;case re:P=16,p=null;break e}throw Error(n(130,i==null?i:typeof i,""))}return o=wn(P,h,o,v),o.elementType=i,o.type=p,o.lanes=w,o}function Pr(i,o,h,p){return i=wn(7,i,p,o),i.lanes=h,i}function hl(i,o,h,p){return i=wn(22,i,p,o),i.elementType=pe,i.lanes=h,i.stateNode={isHidden:!1},i}function id(i,o,h){return i=wn(6,i,null,o),i.lanes=h,i}function ad(i,o,h){return o=wn(4,i.children!==null?i.children:[],i.key,o),o.lanes=h,o.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},o}function K0(i,o,h,p,v){this.tag=o,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Oc(0),this.expirationTimes=Oc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Oc(0),this.identifierPrefix=p,this.onRecoverableError=v,this.mutableSourceEagerHydrationData=null}function od(i,o,h,p,v,w,P,O,L){return i=new K0(i,o,h,O,L),o===1?(o=1,w===!0&&(o|=8)):o=0,w=wn(3,null,null,o),i.current=w,w.stateNode=i,w.memoizedState={element:p,isDehydrated:h,cache:null,transitions:null,pendingSuspenseBoundaries:null},bu(w),i}function G0(i,o,h){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:z,key:p==null?null:""+p,children:i,containerInfo:o,implementation:h}}function Om(i){if(!i)return Us;i=i._reactInternals;e:{if(mr(i)!==i||i.tag!==1)throw Error(n(170));var o=i;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(Jt(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(n(171))}if(i.tag===1){var h=i.type;if(Jt(h))return op(i,h,o)}return o}function Rm(i,o,h,p,v,w,P,O,L){return i=od(h,p,!0,i,v,w,P,O,L),i.context=Om(null),h=i.current,p=qt(),v=Ys(h),w=ms(p,v),w.callback=o??null,qs(h,w,v),i.current.lanes=v,$i(i,v,p),Zt(i,p),i}function fl(i,o,h,p){var v=o.current,w=qt(),P=Ys(v);return h=Om(h),o.context===null?o.context=h:o.pendingContext=h,o=ms(w,P),o.payload={element:i},p=p===void 0?null:p,p!==null&&(o.callback=p),i=qs(v,o,P),i!==null&&(Mn(i,v,P,w),Vo(i,v,P)),P}function pl(i){return i=i.current,i.child?(i.child.tag===5,i.child.stateNode):null}function Mm(i,o){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var h=i.retryLane;i.retryLane=h!==0&&h<o?h:o}}function ld(i,o){Mm(i,o),(i=i.alternate)&&Mm(i,o)}function Y0(){return null}var Lm=typeof reportError=="function"?reportError:function(i){console.error(i)};function cd(i){this._internalRoot=i}ml.prototype.render=cd.prototype.render=function(i){var o=this._internalRoot;if(o===null)throw Error(n(409));fl(i,o,null,null)},ml.prototype.unmount=cd.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var o=i.containerInfo;Sr(function(){fl(null,i,null,null)}),o[us]=null}};function ml(i){this._internalRoot=i}ml.prototype.unstable_scheduleHydration=function(i){if(i){var o=xf();i={blockedOn:null,target:i,priority:o};for(var h=0;h<Ds.length&&o!==0&&o<Ds[h].priority;h++);Ds.splice(h,0,i),h===0&&_f(i)}};function ud(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function gl(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function Dm(){}function J0(i,o,h,p,v){if(v){if(typeof p=="function"){var w=p;p=function(){var K=pl(P);w.call(K)}}var P=Rm(o,p,i,0,null,!1,!1,"",Dm);return i._reactRootContainer=P,i[us]=P.current,ea(i.nodeType===8?i.parentNode:i),Sr(),P}for(;v=i.lastChild;)i.removeChild(v);if(typeof p=="function"){var O=p;p=function(){var K=pl(L);O.call(K)}}var L=od(i,0,!1,null,null,!1,!1,"",Dm);return i._reactRootContainer=L,i[us]=L.current,ea(i.nodeType===8?i.parentNode:i),Sr(function(){fl(o,L,h,p)}),L}function yl(i,o,h,p,v){var w=h._reactRootContainer;if(w){var P=w;if(typeof v=="function"){var O=v;v=function(){var L=pl(P);O.call(L)}}fl(o,P,i,v)}else P=J0(h,o,i,v,p);return pl(P)}yf=function(i){switch(i.tag){case 3:var o=i.stateNode;if(o.current.memoizedState.isDehydrated){var h=Bi(o.pendingLanes);h!==0&&(Rc(o,h|1),Zt(o,ht()),(Me&6)===0&&(pi=ht()+500,Ws()))}break;case 13:Sr(function(){var p=ps(i,1);if(p!==null){var v=qt();Mn(p,i,1,v)}}),ld(i,1)}},Mc=function(i){if(i.tag===13){var o=ps(i,134217728);if(o!==null){var h=qt();Mn(o,i,134217728,h)}ld(i,134217728)}},vf=function(i){if(i.tag===13){var o=Ys(i),h=ps(i,o);if(h!==null){var p=qt();Mn(h,i,o,p)}ld(i,o)}},xf=function(){return We},bf=function(i,o){var h=We;try{return We=i,o()}finally{We=h}},ze=function(i,o,h){switch(o){case"input":if(Wn(i,h),o=h.name,h.type==="radio"&&o!=null){for(h=i;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<h.length;o++){var p=h[o];if(p!==i&&p.form===i.form){var v=Ro(p);if(!v)throw Error(n(90));mn(p),Wn(p,v)}}}break;case"textarea":Gt(i,h);break;case"select":o=h.value,o!=null&&vt(i,!!h.multiple,o,!1)}},Fe=td,dt=Sr;var X0={usingClientEntryPoint:!1,Events:[sa,ti,Ro,oe,je,td]},ya={findFiberByHostInstance:gr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Q0={bundleType:ya.bundleType,version:ya.version,rendererPackageName:ya.rendererPackageName,rendererConfig:ya.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:T.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=cf(i),i===null?null:i.stateNode},findFiberByHostInstance:ya.findFiberByHostInstance||Y0,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vl.isDisabled&&vl.supportsFiber)try{mo=vl.inject(Q0),Yn=vl}catch{}}return en.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=X0,en.createPortal=function(i,o){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ud(o))throw Error(n(200));return G0(i,o,null,h)},en.createRoot=function(i,o){if(!ud(i))throw Error(n(299));var h=!1,p="",v=Lm;return o!=null&&(o.unstable_strictMode===!0&&(h=!0),o.identifierPrefix!==void 0&&(p=o.identifierPrefix),o.onRecoverableError!==void 0&&(v=o.onRecoverableError)),o=od(i,1,!1,null,null,h,!1,p,v),i[us]=o.current,ea(i.nodeType===8?i.parentNode:i),new cd(o)},en.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var o=i._reactInternals;if(o===void 0)throw typeof i.render=="function"?Error(n(188)):(i=Object.keys(i).join(","),Error(n(268,i)));return i=cf(o),i=i===null?null:i.stateNode,i},en.flushSync=function(i){return Sr(i)},en.hydrate=function(i,o,h){if(!gl(o))throw Error(n(200));return yl(null,i,o,!0,h)},en.hydrateRoot=function(i,o,h){if(!ud(i))throw Error(n(405));var p=h!=null&&h.hydratedSources||null,v=!1,w="",P=Lm;if(h!=null&&(h.unstable_strictMode===!0&&(v=!0),h.identifierPrefix!==void 0&&(w=h.identifierPrefix),h.onRecoverableError!==void 0&&(P=h.onRecoverableError)),o=Rm(o,null,i,1,h??null,v,!1,w,P),i[us]=o.current,ea(i),p)for(i=0;i<p.length;i++)h=p[i],v=h._getVersion,v=v(h._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[h,v]:o.mutableSourceEagerHydrationData.push(h,v);return new ml(o)},en.render=function(i,o,h){if(!gl(o))throw Error(n(200));return yl(null,i,o,!1,h)},en.unmountComponentAtNode=function(i){if(!gl(i))throw Error(n(40));return i._reactRootContainer?(Sr(function(){yl(null,null,i,!1,function(){i._reactRootContainer=null,i[us]=null})}),!0):!1},en.unstable_batchedUpdates=td,en.unstable_renderSubtreeIntoContainer=function(i,o,h,p){if(!gl(h))throw Error(n(200));if(i==null||i._reactInternals===void 0)throw Error(n(38));return yl(i,o,h,!1,p)},en.version="18.3.1-next-f1338f8080-20240426",en}var qm;function gv(){if(qm)return fd.exports;qm=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),fd.exports=lw(),fd.exports}var Hm;function cw(){if(Hm)return xl;Hm=1;var t=gv();return xl.createRoot=t.createRoot,xl.hydrateRoot=t.hydrateRoot,xl}var uw=cw(),dw=gv();function za(){return za=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},za.apply(this,arguments)}var tr;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(tr||(tr={}));const Km="popstate";function hw(t){t===void 0&&(t={});function e(s,r){let{pathname:a,search:l,hash:u}=s.location;return eh("",{pathname:a,search:l,hash:u},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function n(s,r){return typeof r=="string"?r:Gl(r)}return pw(e,n,null,t)}function at(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Oh(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function fw(){return Math.random().toString(36).substr(2,8)}function Gm(t,e){return{usr:t.state,key:t.key,idx:e}}function eh(t,e,n,s){return n===void 0&&(n=null),za({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Mi(e):e,{state:n,key:e&&e.key||s||fw()})}function Gl(t){let{pathname:e="/",search:n="",hash:s=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function Mi(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let s=t.indexOf("?");s>=0&&(e.search=t.substr(s),t=t.substr(0,s)),t&&(e.pathname=t)}return e}function pw(t,e,n,s){s===void 0&&(s={});let{window:r=document.defaultView,v5Compat:a=!1}=s,l=r.history,u=tr.Pop,d=null,f=m();f==null&&(f=0,l.replaceState(za({},l.state,{idx:f}),""));function m(){return(l.state||{idx:null}).idx}function g(){u=tr.Pop;let b=m(),S=b==null?null:b-f;f=b,d&&d({action:u,location:k.location,delta:S})}function y(b,S){u=tr.Push;let I=eh(k.location,b,S);f=m()+1;let C=Gm(I,f),T=k.createHref(I);try{l.pushState(C,"",T)}catch(A){if(A instanceof DOMException&&A.name==="DataCloneError")throw A;r.location.assign(T)}a&&d&&d({action:u,location:k.location,delta:1})}function x(b,S){u=tr.Replace;let I=eh(k.location,b,S);f=m();let C=Gm(I,f),T=k.createHref(I);l.replaceState(C,"",T),a&&d&&d({action:u,location:k.location,delta:0})}function _(b){let S=r.location.origin!=="null"?r.location.origin:r.location.href,I=typeof b=="string"?b:Gl(b);return I=I.replace(/ $/,"%20"),at(S,"No window.location.(origin|href) available to create URL for href: "+I),new URL(I,S)}let k={get action(){return u},get location(){return t(r,l)},listen(b){if(d)throw new Error("A history only accepts one active listener");return r.addEventListener(Km,g),d=b,()=>{r.removeEventListener(Km,g),d=null}},createHref(b){return e(r,b)},createURL:_,encodeLocation(b){let S=_(b);return{pathname:S.pathname,search:S.search,hash:S.hash}},push:y,replace:x,go(b){return l.go(b)}};return k}var Ym;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Ym||(Ym={}));function mw(t,e,n){return n===void 0&&(n="/"),gw(t,e,n)}function gw(t,e,n,s){let r=typeof e=="string"?Mi(e):e,a=Ti(r.pathname||"/",n);if(a==null)return null;let l=yv(t);yw(l);let u=null;for(let d=0;u==null&&d<l.length;++d){let f=Iw(a);u=Cw(l[d],f)}return u}function yv(t,e,n,s){e===void 0&&(e=[]),n===void 0&&(n=[]),s===void 0&&(s="");let r=(a,l,u)=>{let d={relativePath:u===void 0?a.path||"":u,caseSensitive:a.caseSensitive===!0,childrenIndex:l,route:a};d.relativePath.startsWith("/")&&(at(d.relativePath.startsWith(s),'Absolute route path "'+d.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),d.relativePath=d.relativePath.slice(s.length));let f=ar([s,d.relativePath]),m=n.concat(d);a.children&&a.children.length>0&&(at(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+f+'".')),yv(a.children,e,m,f)),!(a.path==null&&!a.index)&&e.push({path:f,score:Sw(f,a.index),routesMeta:m})};return t.forEach((a,l)=>{var u;if(a.path===""||!((u=a.path)!=null&&u.includes("?")))r(a,l);else for(let d of vv(a.path))r(a,l,d)}),e}function vv(t){let e=t.split("/");if(e.length===0)return[];let[n,...s]=e,r=n.endsWith("?"),a=n.replace(/\?$/,"");if(s.length===0)return r?[a,""]:[a];let l=vv(s.join("/")),u=[];return u.push(...l.map(d=>d===""?a:[a,d].join("/"))),r&&u.push(...l),u.map(d=>t.startsWith("/")&&d===""?"/":d)}function yw(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:jw(e.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}const vw=/^:[\w-]+$/,xw=3,bw=2,ww=1,_w=10,kw=-2,Jm=t=>t==="*";function Sw(t,e){let n=t.split("/"),s=n.length;return n.some(Jm)&&(s+=kw),e&&(s+=bw),n.filter(r=>!Jm(r)).reduce((r,a)=>r+(vw.test(a)?xw:a===""?ww:_w),s)}function jw(t,e){return t.length===e.length&&t.slice(0,-1).every((s,r)=>s===e[r])?t[t.length-1]-e[e.length-1]:0}function Cw(t,e,n){let{routesMeta:s}=t,r={},a="/",l=[];for(let u=0;u<s.length;++u){let d=s[u],f=u===s.length-1,m=a==="/"?e:e.slice(a.length)||"/",g=th({path:d.relativePath,caseSensitive:d.caseSensitive,end:f},m),y=d.route;if(!g)return null;Object.assign(r,g.params),l.push({params:r,pathname:ar([a,g.pathname]),pathnameBase:Ow(ar([a,g.pathnameBase])),route:y}),g.pathnameBase!=="/"&&(a=ar([a,g.pathnameBase]))}return l}function th(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,s]=Pw(t.path,t.caseSensitive,t.end),r=e.match(n);if(!r)return null;let a=r[0],l=a.replace(/(.)\/+$/,"$1"),u=r.slice(1);return{params:s.reduce((f,m,g)=>{let{paramName:y,isOptional:x}=m;if(y==="*"){let k=u[g]||"";l=a.slice(0,a.length-k.length).replace(/(.)\/+$/,"$1")}const _=u[g];return x&&!_?f[y]=void 0:f[y]=(_||"").replace(/%2F/g,"/"),f},{}),pathname:a,pathnameBase:l,pattern:t}}function Pw(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),Oh(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let s=[],r="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,u,d)=>(s.push({paramName:u,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(s.push({paramName:"*"}),r+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":t!==""&&t!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),s]}function Iw(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Oh(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Ti(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,s=t.charAt(n);return s&&s!=="/"?null:t.slice(n)||"/"}const Ew=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Tw=t=>Ew.test(t);function Nw(t,e){e===void 0&&(e="/");let{pathname:n,search:s="",hash:r=""}=typeof t=="string"?Mi(t):t,a;if(n)if(Tw(n))a=n;else{if(n.includes("//")){let l=n;n=n.replace(/\/\/+/g,"/"),Oh(!1,"Pathnames cannot have embedded double slashes - normalizing "+(l+" -> "+n))}n.startsWith("/")?a=Xm(n.substring(1),"/"):a=Xm(n,e)}else a=e;return{pathname:a,search:Rw(s),hash:Mw(r)}}function Xm(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function gd(t,e,n,s){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Aw(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function Rh(t,e){let n=Aw(t);return e?n.map((s,r)=>r===n.length-1?s.pathname:s.pathnameBase):n.map(s=>s.pathnameBase)}function Mh(t,e,n,s){s===void 0&&(s=!1);let r;typeof t=="string"?r=Mi(t):(r=za({},t),at(!r.pathname||!r.pathname.includes("?"),gd("?","pathname","search",r)),at(!r.pathname||!r.pathname.includes("#"),gd("#","pathname","hash",r)),at(!r.search||!r.search.includes("#"),gd("#","search","hash",r)));let a=t===""||r.pathname==="",l=a?"/":r.pathname,u;if(l==null)u=n;else{let g=e.length-1;if(!s&&l.startsWith("..")){let y=l.split("/");for(;y[0]==="..";)y.shift(),g-=1;r.pathname=y.join("/")}u=g>=0?e[g]:"/"}let d=Nw(r,u),f=l&&l!=="/"&&l.endsWith("/"),m=(a||l===".")&&n.endsWith("/");return!d.pathname.endsWith("/")&&(f||m)&&(d.pathname+="/"),d}const ar=t=>t.join("/").replace(/\/\/+/g,"/"),Ow=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),Rw=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,Mw=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function Lw(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const xv=["post","put","patch","delete"];new Set(xv);const Dw=["get",...xv];new Set(Dw);function Ua(){return Ua=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Ua.apply(this,arguments)}const hc=j.createContext(null),bv=j.createContext(null),Is=j.createContext(null),fc=j.createContext(null),rs=j.createContext({outlet:null,matches:[],isDataRoute:!1}),wv=j.createContext(null);function Fw(t,e){let{relative:n}=e===void 0?{}:e;Li()||at(!1);let{basename:s,navigator:r}=j.useContext(Is),{hash:a,pathname:l,search:u}=pc(t,{relative:n}),d=l;return s!=="/"&&(d=l==="/"?s:ar([s,l])),r.createHref({pathname:d,search:u,hash:a})}function Li(){return j.useContext(fc)!=null}function $n(){return Li()||at(!1),j.useContext(fc).location}function _v(t){j.useContext(Is).static||j.useLayoutEffect(t)}function Ht(){let{isDataRoute:t}=j.useContext(rs);return t?Zw():Bw()}function Bw(){Li()||at(!1);let t=j.useContext(hc),{basename:e,future:n,navigator:s}=j.useContext(Is),{matches:r}=j.useContext(rs),{pathname:a}=$n(),l=JSON.stringify(Rh(r,n.v7_relativeSplatPath)),u=j.useRef(!1);return _v(()=>{u.current=!0}),j.useCallback(function(f,m){if(m===void 0&&(m={}),!u.current)return;if(typeof f=="number"){s.go(f);return}let g=Mh(f,JSON.parse(l),a,m.relative==="path");t==null&&e!=="/"&&(g.pathname=g.pathname==="/"?e:ar([e,g.pathname])),(m.replace?s.replace:s.push)(g,m.state,m)},[e,s,l,a,t])}const $w=j.createContext(null);function zw(t){let e=j.useContext(rs).outlet;return e&&j.createElement($w.Provider,{value:t},e)}function zn(){let{matches:t}=j.useContext(rs),e=t[t.length-1];return e?e.params:{}}function pc(t,e){let{relative:n}=e===void 0?{}:e,{future:s}=j.useContext(Is),{matches:r}=j.useContext(rs),{pathname:a}=$n(),l=JSON.stringify(Rh(r,s.v7_relativeSplatPath));return j.useMemo(()=>Mh(t,JSON.parse(l),a,n==="path"),[t,l,a,n])}function Uw(t,e){return Ww(t,e)}function Ww(t,e,n,s){Li()||at(!1);let{navigator:r}=j.useContext(Is),{matches:a}=j.useContext(rs),l=a[a.length-1],u=l?l.params:{};l&&l.pathname;let d=l?l.pathnameBase:"/";l&&l.route;let f=$n(),m;if(e){var g;let b=typeof e=="string"?Mi(e):e;d==="/"||(g=b.pathname)!=null&&g.startsWith(d)||at(!1),m=b}else m=f;let y=m.pathname||"/",x=y;if(d!=="/"){let b=d.replace(/^\//,"").split("/");x="/"+y.replace(/^\//,"").split("/").slice(b.length).join("/")}let _=mw(t,{pathname:x}),k=Gw(_&&_.map(b=>Object.assign({},b,{params:Object.assign({},u,b.params),pathname:ar([d,r.encodeLocation?r.encodeLocation(b.pathname).pathname:b.pathname]),pathnameBase:b.pathnameBase==="/"?d:ar([d,r.encodeLocation?r.encodeLocation(b.pathnameBase).pathname:b.pathnameBase])})),a,n,s);return e&&k?j.createElement(fc.Provider,{value:{location:Ua({pathname:"/",search:"",hash:"",state:null,key:"default"},m),navigationType:tr.Pop}},k):k}function Vw(){let t=Qw(),e=Lw(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return j.createElement(j.Fragment,null,j.createElement("h2",null,"Unexpected Application Error!"),j.createElement("h3",{style:{fontStyle:"italic"}},e),n?j.createElement("pre",{style:r},n):null,null)}const qw=j.createElement(Vw,null);class Hw extends j.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?j.createElement(rs.Provider,{value:this.props.routeContext},j.createElement(wv.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Kw(t){let{routeContext:e,match:n,children:s}=t,r=j.useContext(hc);return r&&r.static&&r.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=n.route.id),j.createElement(rs.Provider,{value:e},s)}function Gw(t,e,n,s){var r;if(e===void 0&&(e=[]),n===void 0&&(n=null),s===void 0&&(s=null),t==null){var a;if(!n)return null;if(n.errors)t=n.matches;else if((a=s)!=null&&a.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let l=t,u=(r=n)==null?void 0:r.errors;if(u!=null){let m=l.findIndex(g=>g.route.id&&u?.[g.route.id]!==void 0);m>=0||at(!1),l=l.slice(0,Math.min(l.length,m+1))}let d=!1,f=-1;if(n&&s&&s.v7_partialHydration)for(let m=0;m<l.length;m++){let g=l[m];if((g.route.HydrateFallback||g.route.hydrateFallbackElement)&&(f=m),g.route.id){let{loaderData:y,errors:x}=n,_=g.route.loader&&y[g.route.id]===void 0&&(!x||x[g.route.id]===void 0);if(g.route.lazy||_){d=!0,f>=0?l=l.slice(0,f+1):l=[l[0]];break}}}return l.reduceRight((m,g,y)=>{let x,_=!1,k=null,b=null;n&&(x=u&&g.route.id?u[g.route.id]:void 0,k=g.route.errorElement||qw,d&&(f<0&&y===0?(e_("route-fallback"),_=!0,b=null):f===y&&(_=!0,b=g.route.hydrateFallbackElement||null)));let S=e.concat(l.slice(0,y+1)),I=()=>{let C;return x?C=k:_?C=b:g.route.Component?C=j.createElement(g.route.Component,null):g.route.element?C=g.route.element:C=m,j.createElement(Kw,{match:g,routeContext:{outlet:m,matches:S,isDataRoute:n!=null},children:C})};return n&&(g.route.ErrorBoundary||g.route.errorElement||y===0)?j.createElement(Hw,{location:n.location,revalidation:n.revalidation,component:k,error:x,children:I(),routeContext:{outlet:null,matches:S,isDataRoute:!0}}):I()},null)}var kv=(function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t})(kv||{}),Sv=(function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t})(Sv||{});function Yw(t){let e=j.useContext(hc);return e||at(!1),e}function Jw(t){let e=j.useContext(bv);return e||at(!1),e}function Xw(t){let e=j.useContext(rs);return e||at(!1),e}function jv(t){let e=Xw(),n=e.matches[e.matches.length-1];return n.route.id||at(!1),n.route.id}function Qw(){var t;let e=j.useContext(wv),n=Jw(),s=jv();return e!==void 0?e:(t=n.errors)==null?void 0:t[s]}function Zw(){let{router:t}=Yw(kv.UseNavigateStable),e=jv(Sv.UseNavigateStable),n=j.useRef(!1);return _v(()=>{n.current=!0}),j.useCallback(function(r,a){a===void 0&&(a={}),n.current&&(typeof r=="number"?t.navigate(r):t.navigate(r,Ua({fromRouteId:e},a)))},[t,e])}const Qm={};function e_(t,e,n){Qm[t]||(Qm[t]=!0)}function t_(t,e){t?.v7_startTransition,t?.v7_relativeSplatPath}function ks(t){let{to:e,replace:n,state:s,relative:r}=t;Li()||at(!1);let{future:a,static:l}=j.useContext(Is),{matches:u}=j.useContext(rs),{pathname:d}=$n(),f=Ht(),m=Mh(e,Rh(u,a.v7_relativeSplatPath),d,r==="path"),g=JSON.stringify(m);return j.useEffect(()=>f(JSON.parse(g),{replace:n,state:s,relative:r}),[f,g,r,n,s]),null}function nh(t){return zw(t.context)}function de(t){at(!1)}function n_(t){let{basename:e="/",children:n=null,location:s,navigationType:r=tr.Pop,navigator:a,static:l=!1,future:u}=t;Li()&&at(!1);let d=e.replace(/^\/*/,"/"),f=j.useMemo(()=>({basename:d,navigator:a,static:l,future:Ua({v7_relativeSplatPath:!1},u)}),[d,u,a,l]);typeof s=="string"&&(s=Mi(s));let{pathname:m="/",search:g="",hash:y="",state:x=null,key:_="default"}=s,k=j.useMemo(()=>{let b=Ti(m,d);return b==null?null:{location:{pathname:b,search:g,hash:y,state:x,key:_},navigationType:r}},[d,m,g,y,x,_,r]);return k==null?null:j.createElement(Is.Provider,{value:f},j.createElement(fc.Provider,{children:n,value:k}))}function s_(t){let{children:e,location:n}=t;return Uw(sh(e),n)}new Promise(()=>{});function sh(t,e){e===void 0&&(e=[]);let n=[];return j.Children.forEach(t,(s,r)=>{if(!j.isValidElement(s))return;let a=[...e,r];if(s.type===j.Fragment){n.push.apply(n,sh(s.props.children,a));return}s.type!==de&&at(!1),!s.props.index||!s.props.children||at(!1);let l={id:s.props.id||a.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(l.children=sh(s.props.children,a)),n.push(l)}),n}function Yl(){return Yl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Yl.apply(this,arguments)}function Cv(t,e){if(t==null)return{};var n={},s=Object.keys(t),r,a;for(a=0;a<s.length;a++)r=s[a],!(e.indexOf(r)>=0)&&(n[r]=t[r]);return n}function r_(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function i_(t,e){return t.button===0&&(!e||e==="_self")&&!r_(t)}function rh(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let s=t[n];return e.concat(Array.isArray(s)?s.map(r=>[n,r]):[[n,s]])},[]))}function a_(t,e){let n=rh(t);return e&&e.forEach((s,r)=>{n.has(r)||e.getAll(r).forEach(a=>{n.append(r,a)})}),n}const o_=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],l_=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],c_="6";try{window.__reactRouterVersion=c_}catch{}const u_=j.createContext({isTransitioning:!1}),d_="startTransition",Zm=iw[d_];function h_(t){let{basename:e,children:n,future:s,window:r}=t,a=j.useRef();a.current==null&&(a.current=hw({window:r,v5Compat:!0}));let l=a.current,[u,d]=j.useState({action:l.action,location:l.location}),{v7_startTransition:f}=s||{},m=j.useCallback(g=>{f&&Zm?Zm(()=>d(g)):d(g)},[d,f]);return j.useLayoutEffect(()=>l.listen(m),[l,m]),j.useEffect(()=>t_(s),[s]),j.createElement(n_,{basename:e,children:n,location:u.location,navigationType:u.action,navigator:l,future:s})}const f_=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",p_=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,st=j.forwardRef(function(e,n){let{onClick:s,relative:r,reloadDocument:a,replace:l,state:u,target:d,to:f,preventScrollReset:m,viewTransition:g}=e,y=Cv(e,o_),{basename:x}=j.useContext(Is),_,k=!1;if(typeof f=="string"&&p_.test(f)&&(_=f,f_))try{let C=new URL(window.location.href),T=f.startsWith("//")?new URL(C.protocol+f):new URL(f),A=Ti(T.pathname,x);T.origin===C.origin&&A!=null?f=A+T.search+T.hash:k=!0}catch{}let b=Fw(f,{relative:r}),S=g_(f,{replace:l,state:u,target:d,preventScrollReset:m,relative:r,viewTransition:g});function I(C){s&&s(C),C.defaultPrevented||S(C)}return j.createElement("a",Yl({},y,{href:_||b,onClick:k||a?s:I,ref:n,target:d}))}),Ra=j.forwardRef(function(e,n){let{"aria-current":s="page",caseSensitive:r=!1,className:a="",end:l=!1,style:u,to:d,viewTransition:f,children:m}=e,g=Cv(e,l_),y=pc(d,{relative:g.relative}),x=$n(),_=j.useContext(bv),{navigator:k,basename:b}=j.useContext(Is),S=_!=null&&y_(y)&&f===!0,I=k.encodeLocation?k.encodeLocation(y).pathname:y.pathname,C=x.pathname,T=_&&_.navigation&&_.navigation.location?_.navigation.location.pathname:null;r||(C=C.toLowerCase(),T=T?T.toLowerCase():null,I=I.toLowerCase()),T&&b&&(T=Ti(T,b)||T);const A=I!=="/"&&I.endsWith("/")?I.length-1:I.length;let z=C===I||!l&&C.startsWith(I)&&C.charAt(A)==="/",E=T!=null&&(T===I||!l&&T.startsWith(I)&&T.charAt(I.length)==="/"),D={isActive:z,isPending:E,isTransitioning:S},M=z?s:void 0,N;typeof a=="function"?N=a(D):N=[a,z?"active":null,E?"pending":null,S?"transitioning":null].filter(Boolean).join(" ");let F=typeof u=="function"?u(D):u;return j.createElement(st,Yl({},g,{"aria-current":M,className:N,ref:n,style:F,to:d,viewTransition:f}),typeof m=="function"?m(D):m)});var ih;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(ih||(ih={}));var eg;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(eg||(eg={}));function m_(t){let e=j.useContext(hc);return e||at(!1),e}function g_(t,e){let{target:n,replace:s,state:r,preventScrollReset:a,relative:l,viewTransition:u}=e===void 0?{}:e,d=Ht(),f=$n(),m=pc(t,{relative:l});return j.useCallback(g=>{if(i_(g,n)){g.preventDefault();let y=s!==void 0?s:Gl(f)===Gl(m);d(t,{replace:y,state:r,preventScrollReset:a,relative:l,viewTransition:u})}},[f,d,m,s,r,n,t,a,l,u])}function is(t){let e=j.useRef(rh(t)),n=j.useRef(!1),s=$n(),r=j.useMemo(()=>a_(s.search,n.current?null:e.current),[s.search]),a=Ht(),l=j.useCallback((u,d)=>{const f=rh(typeof u=="function"?u(r):u);n.current=!0,a("?"+f,d)},[a,r]);return[r,l]}function y_(t,e){e===void 0&&(e={});let n=j.useContext(u_);n==null&&at(!1);let{basename:s}=m_(ih.useViewTransitionState),r=pc(t,{relative:e.relative});if(!n.isTransitioning)return!1;let a=Ti(n.currentLocation.pathname,s)||n.currentLocation.pathname,l=Ti(n.nextLocation.pathname,s)||n.nextLocation.pathname;return th(r.pathname,l)!=null||th(r.pathname,a)!=null}var Pv={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},tg=Ps.createContext&&Ps.createContext(Pv),v_=["attr","size","title"];function x_(t,e){if(t==null)return{};var n=b_(t,e),s,r;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(r=0;r<a.length;r++)s=a[r],!(e.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(t,s)&&(n[s]=t[s])}return n}function b_(t,e){if(t==null)return{};var n={};for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){if(e.indexOf(s)>=0)continue;n[s]=t[s]}return n}function Jl(){return Jl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Jl.apply(this,arguments)}function ng(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function Xl(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?ng(Object(n),!0).forEach(function(s){w_(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ng(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function w_(t,e,n){return e=__(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function __(t){var e=k_(t,"string");return typeof e=="symbol"?e:e+""}function k_(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Iv(t){return t&&t.map((e,n)=>Ps.createElement(e.tag,Xl({key:n},e.attr),Iv(e.child)))}function qe(t){return e=>Ps.createElement(S_,Jl({attr:Xl({},t.attr)},e),Iv(t.child))}function S_(t){var e=n=>{var{attr:s,size:r,title:a}=t,l=x_(t,v_),u=r||n.size||"1em",d;return n.className&&(d=n.className),t.className&&(d=(d?d+" ":"")+t.className),Ps.createElement("svg",Jl({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,s,l,{className:d,style:Xl(Xl({color:t.color||n.color},n.style),t.style),height:u,width:u,xmlns:"http://www.w3.org/2000/svg"}),a&&Ps.createElement("title",null,a),t.children)};return tg!==void 0?Ps.createElement(tg.Consumer,null,n=>e(n)):e(Pv)}function sg(t){return qe({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"18",y1:"20",x2:"18",y2:"10"},child:[]},{tag:"line",attr:{x1:"12",y1:"20",x2:"12",y2:"4"},child:[]},{tag:"line",attr:{x1:"6",y1:"20",x2:"6",y2:"14"},child:[]}]})(t)}function j_(t){return qe({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"},child:[]},{tag:"path",attr:{d:"M13.73 21a2 2 0 0 1-3.46 0"},child:[]}]})(t)}function rg(t){return qe({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"},child:[]},{tag:"polyline",attr:{points:"3.27 6.96 12 12.01 20.73 6.96"},child:[]},{tag:"line",attr:{x1:"12",y1:"22.08",x2:"12",y2:"12"},child:[]}]})(t)}function ig(t){return qe({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"6 9 12 15 18 9"},child:[]}]})(t)}function C_(t){return qe({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"15 18 9 12 15 6"},child:[]}]})(t)}function P_(t){return qe({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"9 18 15 12 9 6"},child:[]}]})(t)}function ah(t){return qe({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"1",y:"4",width:"22",height:"16",rx:"2",ry:"2"},child:[]},{tag:"line",attr:{x1:"1",y1:"10",x2:"23",y2:"10"},child:[]}]})(t)}function yd(t){return qe({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"1",x2:"12",y2:"23"},child:[]},{tag:"path",attr:{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"},child:[]}]})(t)}function bl(t){return qe({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"},child:[]},{tag:"polyline",attr:{points:"14 2 14 8 20 8"},child:[]},{tag:"line",attr:{x1:"16",y1:"13",x2:"8",y2:"13"},child:[]},{tag:"line",attr:{x1:"16",y1:"17",x2:"8",y2:"17"},child:[]},{tag:"polyline",attr:{points:"10 9 9 9 8 9"},child:[]}]})(t)}function ag(t){return qe({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"},child:[]}]})(t)}function I_(t){return qe({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"18",cy:"18",r:"3"},child:[]},{tag:"circle",attr:{cx:"6",cy:"6",r:"3"},child:[]},{tag:"path",attr:{d:"M6 21V9a9 9 0 0 0 9 9"},child:[]}]})(t)}function E_(t){return qe({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"},child:[]},{tag:"polyline",attr:{points:"9 22 9 12 15 12 15 22"},child:[]}]})(t)}function og(t){return qe({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"12 2 2 7 12 12 22 7 12 2"},child:[]},{tag:"polyline",attr:{points:"2 17 12 22 22 17"},child:[]},{tag:"polyline",attr:{points:"2 12 12 17 22 12"},child:[]}]})(t)}function lg(t){return qe({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"8",y1:"6",x2:"21",y2:"6"},child:[]},{tag:"line",attr:{x1:"8",y1:"12",x2:"21",y2:"12"},child:[]},{tag:"line",attr:{x1:"8",y1:"18",x2:"21",y2:"18"},child:[]},{tag:"line",attr:{x1:"3",y1:"6",x2:"3.01",y2:"6"},child:[]},{tag:"line",attr:{x1:"3",y1:"12",x2:"3.01",y2:"12"},child:[]},{tag:"line",attr:{x1:"3",y1:"18",x2:"3.01",y2:"18"},child:[]}]})(t)}function T_(t){return qe({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"},child:[]},{tag:"polyline",attr:{points:"22,6 12,13 2,6"},child:[]}]})(t)}function N_(t){return qe({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"},child:[]}]})(t)}function A_(t){return qe({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"1"},child:[]},{tag:"circle",attr:{cx:"12",cy:"5",r:"1"},child:[]},{tag:"circle",attr:{cx:"12",cy:"19",r:"1"},child:[]}]})(t)}function wl(t){return qe({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"16.5",y1:"9.4",x2:"7.5",y2:"4.21"},child:[]},{tag:"path",attr:{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"},child:[]},{tag:"polyline",attr:{points:"3.27 6.96 12 12.01 20.73 6.96"},child:[]},{tag:"line",attr:{x1:"12",y1:"22.08",x2:"12",y2:"12"},child:[]}]})(t)}function vd(t){return qe({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"11",cy:"11",r:"8"},child:[]},{tag:"line",attr:{x1:"21",y1:"21",x2:"16.65",y2:"16.65"},child:[]}]})(t)}function O_(t){return qe({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"3"},child:[]},{tag:"path",attr:{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"},child:[]}]})(t)}function Ev(t){return qe({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"18",cy:"5",r:"3"},child:[]},{tag:"circle",attr:{cx:"6",cy:"12",r:"3"},child:[]},{tag:"circle",attr:{cx:"18",cy:"19",r:"3"},child:[]},{tag:"line",attr:{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"},child:[]},{tag:"line",attr:{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"},child:[]}]})(t)}function R_(t){return qe({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"},child:[]}]})(t)}function M_(t){return qe({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"5"},child:[]},{tag:"line",attr:{x1:"12",y1:"1",x2:"12",y2:"3"},child:[]},{tag:"line",attr:{x1:"12",y1:"21",x2:"12",y2:"23"},child:[]},{tag:"line",attr:{x1:"4.22",y1:"4.22",x2:"5.64",y2:"5.64"},child:[]},{tag:"line",attr:{x1:"18.36",y1:"18.36",x2:"19.78",y2:"19.78"},child:[]},{tag:"line",attr:{x1:"1",y1:"12",x2:"3",y2:"12"},child:[]},{tag:"line",attr:{x1:"21",y1:"12",x2:"23",y2:"12"},child:[]},{tag:"line",attr:{x1:"4.22",y1:"19.78",x2:"5.64",y2:"18.36"},child:[]},{tag:"line",attr:{x1:"18.36",y1:"5.64",x2:"19.78",y2:"4.22"},child:[]}]})(t)}function cg(t){return qe({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"23 18 13.5 8.5 8.5 13.5 1 6"},child:[]},{tag:"polyline",attr:{points:"17 18 23 18 23 12"},child:[]}]})(t)}function L_(t){return qe({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"23 6 13.5 15.5 8.5 10.5 1 18"},child:[]},{tag:"polyline",attr:{points:"17 6 23 6 23 12"},child:[]}]})(t)}function D_(t){return qe({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"8.5",cy:"7",r:"4"},child:[]},{tag:"polyline",attr:{points:"17 11 19 13 23 9"},child:[]}]})(t)}function F_(t){return qe({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"8.5",cy:"7",r:"4"},child:[]},{tag:"line",attr:{x1:"20",y1:"8",x2:"20",y2:"14"},child:[]},{tag:"line",attr:{x1:"23",y1:"11",x2:"17",y2:"11"},child:[]}]})(t)}function B_(t){return qe({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"12",cy:"7",r:"4"},child:[]}]})(t)}function $_(t){return qe({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"9",cy:"7",r:"4"},child:[]},{tag:"path",attr:{d:"M23 21v-2a4 4 0 0 0-3-3.87"},child:[]},{tag:"path",attr:{d:"M16 3.13a4 4 0 0 1 0 7.75"},child:[]}]})(t)}function mc(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(t);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(n[s[r]]=t[s[r]]);return n}function z_(t,e,n,s){function r(a){return a instanceof n?a:new n(function(l){l(a)})}return new(n||(n=Promise))(function(a,l){function u(m){try{f(s.next(m))}catch(g){l(g)}}function d(m){try{f(s.throw(m))}catch(g){l(g)}}function f(m){m.done?a(m.value):r(m.value).then(u,d)}f((s=s.apply(t,e||[])).next())})}const U_=t=>t?(...e)=>t(...e):(...e)=>fetch(...e);class Lh extends Error{constructor(e,n="FunctionsError",s){super(e),this.name=n,this.context=s}}class W_ extends Lh{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class ug extends Lh{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class dg extends Lh{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var oh;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(oh||(oh={}));class V_{constructor(e,{headers:n={},customFetch:s,region:r=oh.Any}={}){this.url=e,this.headers=n,this.region=r,this.fetch=U_(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return z_(this,arguments,void 0,function*(n,s={}){var r;let a,l;try{const{headers:u,method:d,body:f,signal:m,timeout:g}=s;let y={},{region:x}=s;x||(x=this.region);const _=new URL(`${this.url}/${n}`);x&&x!=="any"&&(y["x-region"]=x,_.searchParams.set("forceFunctionRegion",x));let k;f&&(u&&!Object.prototype.hasOwnProperty.call(u,"Content-Type")||!u)?typeof Blob<"u"&&f instanceof Blob||f instanceof ArrayBuffer?(y["Content-Type"]="application/octet-stream",k=f):typeof f=="string"?(y["Content-Type"]="text/plain",k=f):typeof FormData<"u"&&f instanceof FormData?k=f:(y["Content-Type"]="application/json",k=JSON.stringify(f)):f&&typeof f!="string"&&!(typeof Blob<"u"&&f instanceof Blob)&&!(f instanceof ArrayBuffer)&&!(typeof FormData<"u"&&f instanceof FormData)?k=JSON.stringify(f):k=f;let b=m;g&&(l=new AbortController,a=setTimeout(()=>l.abort(),g),m?(b=l.signal,m.addEventListener("abort",()=>l.abort())):b=l.signal);const S=yield this.fetch(_.toString(),{method:d||"POST",headers:Object.assign(Object.assign(Object.assign({},y),this.headers),u),body:k,signal:b}).catch(A=>{throw new W_(A)}),I=S.headers.get("x-relay-error");if(I&&I==="true")throw new ug(S);if(!S.ok)throw new dg(S);let C=((r=S.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),T;return C==="application/json"?T=yield S.json():C==="application/octet-stream"||C==="application/pdf"?T=yield S.blob():C==="text/event-stream"?T=S:C==="multipart/form-data"?T=yield S.formData():T=yield S.text(),{data:T,error:null,response:S}}catch(u){return{data:null,error:u,response:u instanceof dg||u instanceof ug?u.context:void 0}}finally{a&&clearTimeout(a)}})}}var q_=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}},H_=class{constructor(t){var e,n,s;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(e=t.shouldThrowOnError)!==null&&e!==void 0?e:!1,this.signal=t.signal,this.isMaybeSingle=(n=t.isMaybeSingle)!==null&&n!==void 0?n:!1,this.urlLengthLimit=(s=t.urlLengthLimit)!==null&&s!==void 0?s:8e3,t.fetch?this.fetch=t.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,e){return this.headers=new Headers(this.headers),this.headers.set(t,e),this}then(t,e){var n=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const s=this.fetch;let r=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async a=>{let l=null,u=null,d=null,f=a.status,m=a.statusText;if(a.ok){var g,y;if(n.method!=="HEAD"){var x;const S=await a.text();S===""||(n.headers.get("Accept")==="text/csv"||n.headers.get("Accept")&&(!((x=n.headers.get("Accept"))===null||x===void 0)&&x.includes("application/vnd.pgrst.plan+text"))?u=S:u=JSON.parse(S))}const k=(g=n.headers.get("Prefer"))===null||g===void 0?void 0:g.match(/count=(exact|planned|estimated)/),b=(y=a.headers.get("content-range"))===null||y===void 0?void 0:y.split("/");k&&b&&b.length>1&&(d=parseInt(b[1])),n.isMaybeSingle&&n.method==="GET"&&Array.isArray(u)&&(u.length>1?(l={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,d=null,f=406,m="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{var _;const k=await a.text();try{l=JSON.parse(k),Array.isArray(l)&&a.status===404&&(u=[],l=null,f=200,m="OK")}catch{a.status===404&&k===""?(f=204,m="No Content"):l={message:k}}if(l&&n.isMaybeSingle&&(!(l==null||(_=l.details)===null||_===void 0)&&_.includes("0 rows"))&&(l=null,f=200,m="OK"),l&&n.shouldThrowOnError)throw new q_(l)}return{error:l,data:u,count:d,status:f,statusText:m}});return this.shouldThrowOnError||(r=r.catch(a=>{var l;let u="",d="",f="";const m=a?.cause;if(m){var g,y,x,_;const S=(g=m?.message)!==null&&g!==void 0?g:"",I=(y=m?.code)!==null&&y!==void 0?y:"";u=`${(x=a?.name)!==null&&x!==void 0?x:"FetchError"}: ${a?.message}`,u+=`

Caused by: ${(_=m?.name)!==null&&_!==void 0?_:"Error"}: ${S}`,I&&(u+=` (${I})`),m?.stack&&(u+=`
${m.stack}`)}else{var k;u=(k=a?.stack)!==null&&k!==void 0?k:""}const b=this.url.toString().length;return a?.name==="AbortError"||a?.code==="ABORT_ERR"?(f="",d="Request was aborted (timeout or manual cancellation)",b>this.urlLengthLimit&&(d+=`. Note: Your request URL is ${b} characters, which may exceed server limits. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [many IDs])), consider using an RPC function to pass values server-side.`)):(m?.name==="HeadersOverflowError"||m?.code==="UND_ERR_HEADERS_OVERFLOW")&&(f="",d="HTTP headers exceeded server limits (typically 16KB)",b>this.urlLengthLimit&&(d+=`. Your request URL is ${b} characters. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [200+ IDs])), consider using an RPC function instead.`)),{error:{message:`${(l=a?.name)!==null&&l!==void 0?l:"FetchError"}: ${a?.message}`,details:u,hint:d,code:f},data:null,count:null,status:0,statusText:""}})),r.then(t,e)}returns(){return this}overrideTypes(){return this}},K_=class extends H_{select(t){let e=!1;const n=(t??"*").split("").map(s=>/\s/.test(s)&&!e?"":(s==='"'&&(e=!e),s)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:e=!0,nullsFirst:n,foreignTable:s,referencedTable:r=s}={}){const a=r?`${r}.order`:"order",l=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${l?`${l},`:""}${t}.${e?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:e,referencedTable:n=e}={}){const s=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(s,`${t}`),this}range(t,e,{foreignTable:n,referencedTable:s=n}={}){const r=typeof s>"u"?"offset":`${s}.offset`,a=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(r,`${t}`),this.url.searchParams.set(a,`${e-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:e=!1,settings:n=!1,buffers:s=!1,wal:r=!1,format:a="text"}={}){var l;const u=[t?"analyze":null,e?"verbose":null,n?"settings":null,s?"buffers":null,r?"wal":null].filter(Boolean).join("|"),d=(l=this.headers.get("Accept"))!==null&&l!==void 0?l:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${a}; for="${d}"; options=${u};`),a==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};const hg=new RegExp("[,()]");var Si=class extends K_{eq(t,e){return this.url.searchParams.append(t,`eq.${e}`),this}neq(t,e){return this.url.searchParams.append(t,`neq.${e}`),this}gt(t,e){return this.url.searchParams.append(t,`gt.${e}`),this}gte(t,e){return this.url.searchParams.append(t,`gte.${e}`),this}lt(t,e){return this.url.searchParams.append(t,`lt.${e}`),this}lte(t,e){return this.url.searchParams.append(t,`lte.${e}`),this}like(t,e){return this.url.searchParams.append(t,`like.${e}`),this}likeAllOf(t,e){return this.url.searchParams.append(t,`like(all).{${e.join(",")}}`),this}likeAnyOf(t,e){return this.url.searchParams.append(t,`like(any).{${e.join(",")}}`),this}ilike(t,e){return this.url.searchParams.append(t,`ilike.${e}`),this}ilikeAllOf(t,e){return this.url.searchParams.append(t,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(t,e){return this.url.searchParams.append(t,`ilike(any).{${e.join(",")}}`),this}regexMatch(t,e){return this.url.searchParams.append(t,`match.${e}`),this}regexIMatch(t,e){return this.url.searchParams.append(t,`imatch.${e}`),this}is(t,e){return this.url.searchParams.append(t,`is.${e}`),this}isDistinct(t,e){return this.url.searchParams.append(t,`isdistinct.${e}`),this}in(t,e){const n=Array.from(new Set(e)).map(s=>typeof s=="string"&&hg.test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}notIn(t,e){const n=Array.from(new Set(e)).map(s=>typeof s=="string"&&hg.test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`not.in.(${n})`),this}contains(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cs.{${e.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(e)}`),this}containedBy(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cd.{${e.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(e)}`),this}rangeGt(t,e){return this.url.searchParams.append(t,`sr.${e}`),this}rangeGte(t,e){return this.url.searchParams.append(t,`nxl.${e}`),this}rangeLt(t,e){return this.url.searchParams.append(t,`sl.${e}`),this}rangeLte(t,e){return this.url.searchParams.append(t,`nxr.${e}`),this}rangeAdjacent(t,e){return this.url.searchParams.append(t,`adj.${e}`),this}overlaps(t,e){return typeof e=="string"?this.url.searchParams.append(t,`ov.${e}`):this.url.searchParams.append(t,`ov.{${e.join(",")}}`),this}textSearch(t,e,{config:n,type:s}={}){let r="";s==="plain"?r="pl":s==="phrase"?r="ph":s==="websearch"&&(r="w");const a=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${r}fts${a}.${e}`),this}match(t){return Object.entries(t).forEach(([e,n])=>{this.url.searchParams.append(e,`eq.${n}`)}),this}not(t,e,n){return this.url.searchParams.append(t,`not.${e}.${n}`),this}or(t,{foreignTable:e,referencedTable:n=e}={}){const s=n?`${n}.or`:"or";return this.url.searchParams.append(s,`(${t})`),this}filter(t,e,n){return this.url.searchParams.append(t,`${e}.${n}`),this}},G_=class{constructor(t,{headers:e={},schema:n,fetch:s,urlLengthLimit:r=8e3}){this.url=t,this.headers=new Headers(e),this.schema=n,this.fetch=s,this.urlLengthLimit=r}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(t,e){const{head:n=!1,count:s}=e??{},r=n?"HEAD":"GET";let a=!1;const l=(t??"*").split("").map(f=>/\s/.test(f)&&!a?"":(f==='"'&&(a=!a),f)).join(""),{url:u,headers:d}=this.cloneRequestState();return u.searchParams.set("select",l),s&&d.append("Prefer",`count=${s}`),new Si({method:r,url:u,headers:d,schema:this.schema,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}insert(t,{count:e,defaultToNull:n=!0}={}){var s;const r="POST",{url:a,headers:l}=this.cloneRequestState();if(e&&l.append("Prefer",`count=${e}`),n||l.append("Prefer","missing=default"),Array.isArray(t)){const u=t.reduce((d,f)=>d.concat(Object.keys(f)),[]);if(u.length>0){const d=[...new Set(u)].map(f=>`"${f}"`);a.searchParams.set("columns",d.join(","))}}return new Si({method:r,url:a,headers:l,schema:this.schema,body:t,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch,urlLengthLimit:this.urlLengthLimit})}upsert(t,{onConflict:e,ignoreDuplicates:n=!1,count:s,defaultToNull:r=!0}={}){var a;const l="POST",{url:u,headers:d}=this.cloneRequestState();if(d.append("Prefer",`resolution=${n?"ignore":"merge"}-duplicates`),e!==void 0&&u.searchParams.set("on_conflict",e),s&&d.append("Prefer",`count=${s}`),r||d.append("Prefer","missing=default"),Array.isArray(t)){const f=t.reduce((m,g)=>m.concat(Object.keys(g)),[]);if(f.length>0){const m=[...new Set(f)].map(g=>`"${g}"`);u.searchParams.set("columns",m.join(","))}}return new Si({method:l,url:u,headers:d,schema:this.schema,body:t,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch,urlLengthLimit:this.urlLengthLimit})}update(t,{count:e}={}){var n;const s="PATCH",{url:r,headers:a}=this.cloneRequestState();return e&&a.append("Prefer",`count=${e}`),new Si({method:s,url:r,headers:a,schema:this.schema,body:t,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch,urlLengthLimit:this.urlLengthLimit})}delete({count:t}={}){var e;const n="DELETE",{url:s,headers:r}=this.cloneRequestState();return t&&r.append("Prefer",`count=${t}`),new Si({method:n,url:s,headers:r,schema:this.schema,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch,urlLengthLimit:this.urlLengthLimit})}};function Wa(t){"@babel/helpers - typeof";return Wa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wa(t)}function Y_(t,e){if(Wa(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(Wa(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function J_(t){var e=Y_(t,"string");return Wa(e)=="symbol"?e:e+""}function X_(t,e,n){return(e=J_(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fg(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function _l(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?fg(Object(n),!0).forEach(function(s){X_(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):fg(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}var Q_=class Tv{constructor(e,{headers:n={},schema:s,fetch:r,timeout:a,urlLengthLimit:l=8e3}={}){this.url=e,this.headers=new Headers(n),this.schemaName=s,this.urlLengthLimit=l;const u=r??globalThis.fetch;a!==void 0&&a>0?this.fetch=(d,f)=>{const m=new AbortController,g=setTimeout(()=>m.abort(),a),y=f?.signal;if(y){if(y.aborted)return clearTimeout(g),u(d,f);const x=()=>{clearTimeout(g),m.abort()};return y.addEventListener("abort",x,{once:!0}),u(d,_l(_l({},f),{},{signal:m.signal})).finally(()=>{clearTimeout(g),y.removeEventListener("abort",x)})}return u(d,_l(_l({},f),{},{signal:m.signal})).finally(()=>clearTimeout(g))}:this.fetch=u}from(e){if(!e||typeof e!="string"||e.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new G_(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}schema(e){return new Tv(this.url,{headers:this.headers,schema:e,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}rpc(e,n={},{head:s=!1,get:r=!1,count:a}={}){var l;let u;const d=new URL(`${this.url}/rpc/${e}`);let f;const m=x=>x!==null&&typeof x=="object"&&(!Array.isArray(x)||x.some(m)),g=s&&Object.values(n).some(m);g?(u="POST",f=n):s||r?(u=s?"HEAD":"GET",Object.entries(n).filter(([x,_])=>_!==void 0).map(([x,_])=>[x,Array.isArray(_)?`{${_.join(",")}}`:`${_}`]).forEach(([x,_])=>{d.searchParams.append(x,_)})):(u="POST",f=n);const y=new Headers(this.headers);return g?y.set("Prefer",a?`count=${a},return=minimal`:"return=minimal"):a&&y.set("Prefer",`count=${a}`),new Si({method:u,url:d,headers:y,schema:this.schemaName,body:f,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch,urlLengthLimit:this.urlLengthLimit})}};class Z_{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const n=globalThis.process;if(n){const s=n.versions;if(s&&s.node){const r=s.node,a=parseInt(r.replace(/^v/,"").split(".")[0]);return a>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${a} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${a} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let n=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(n+=`

Suggested solution: ${e.workaround}`),new Error(n)}static createWebSocket(e,n){const s=this.getWebSocketConstructor();return new s(e,n)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const ek="2.95.3",tk=`realtime-js/${ek}`,nk="1.0.0",Nv="2.0.0",pg=Nv,lh=1e4,sk=1e3,rk=100;var Zs;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Zs||(Zs={}));var wt;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(wt||(wt={}));var Fn;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Fn||(Fn={}));var ch;(function(t){t.websocket="websocket"})(ch||(ch={}));var Dr;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Dr||(Dr={}));class ik{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,n){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return n(this._binaryEncodeUserBroadcastPush(e));let s=[e.join_ref,e.ref,e.topic,e.event,e.payload];return n(JSON.stringify(s))}_binaryEncodeUserBroadcastPush(e){var n;return this._isArrayBuffer((n=e.payload)===null||n===void 0?void 0:n.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var n,s;const r=(s=(n=e.payload)===null||n===void 0?void 0:n.payload)!==null&&s!==void 0?s:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,r)}_encodeJsonUserBroadcastPush(e){var n,s;const r=(s=(n=e.payload)===null||n===void 0?void 0:n.payload)!==null&&s!==void 0?s:{},l=new TextEncoder().encode(JSON.stringify(r)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,l)}_encodeUserBroadcastPush(e,n,s){var r,a;const l=e.topic,u=(r=e.ref)!==null&&r!==void 0?r:"",d=(a=e.join_ref)!==null&&a!==void 0?a:"",f=e.payload.event,m=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},g=Object.keys(m).length===0?"":JSON.stringify(m);if(d.length>255)throw new Error(`joinRef length ${d.length} exceeds maximum of 255`);if(u.length>255)throw new Error(`ref length ${u.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`topic length ${l.length} exceeds maximum of 255`);if(f.length>255)throw new Error(`userEvent length ${f.length} exceeds maximum of 255`);if(g.length>255)throw new Error(`metadata length ${g.length} exceeds maximum of 255`);const y=this.USER_BROADCAST_PUSH_META_LENGTH+d.length+u.length+l.length+f.length+g.length,x=new ArrayBuffer(this.HEADER_LENGTH+y);let _=new DataView(x),k=0;_.setUint8(k++,this.KINDS.userBroadcastPush),_.setUint8(k++,d.length),_.setUint8(k++,u.length),_.setUint8(k++,l.length),_.setUint8(k++,f.length),_.setUint8(k++,g.length),_.setUint8(k++,n),Array.from(d,S=>_.setUint8(k++,S.charCodeAt(0))),Array.from(u,S=>_.setUint8(k++,S.charCodeAt(0))),Array.from(l,S=>_.setUint8(k++,S.charCodeAt(0))),Array.from(f,S=>_.setUint8(k++,S.charCodeAt(0))),Array.from(g,S=>_.setUint8(k++,S.charCodeAt(0)));var b=new Uint8Array(x.byteLength+s.byteLength);return b.set(new Uint8Array(x),0),b.set(new Uint8Array(s),x.byteLength),b.buffer}decode(e,n){if(this._isArrayBuffer(e)){let s=this._binaryDecode(e);return n(s)}if(typeof e=="string"){const s=JSON.parse(e),[r,a,l,u,d]=s;return n({join_ref:r,ref:a,topic:l,event:u,payload:d})}return n({})}_binaryDecode(e){const n=new DataView(e),s=n.getUint8(0),r=new TextDecoder;if(s===this.KINDS.userBroadcast)return this._decodeUserBroadcast(e,n,r)}_decodeUserBroadcast(e,n,s){const r=n.getUint8(1),a=n.getUint8(2),l=n.getUint8(3),u=n.getUint8(4);let d=this.HEADER_LENGTH+4;const f=s.decode(e.slice(d,d+r));d=d+r;const m=s.decode(e.slice(d,d+a));d=d+a;const g=s.decode(e.slice(d,d+l));d=d+l;const y=e.slice(d,e.byteLength),x=u===this.JSON_ENCODING?JSON.parse(s.decode(y)):y,_={type:this.BROADCAST_EVENT,event:m,payload:x};return l>0&&(_.meta=JSON.parse(g)),{join_ref:null,ref:null,topic:f,event:this.BROADCAST_EVENT,payload:_}}_isArrayBuffer(e){var n;return e instanceof ArrayBuffer||((n=e?.constructor)===null||n===void 0?void 0:n.name)==="ArrayBuffer"}_pick(e,n){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([s])=>n.includes(s)))}}class Av{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ge;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(Ge||(Ge={}));const mg=(t,e,n={})=>{var s;const r=(s=n.skipTypes)!==null&&s!==void 0?s:[];return e?Object.keys(e).reduce((a,l)=>(a[l]=ak(l,t,e,r),a),{}):{}},ak=(t,e,n,s)=>{const r=e.find(u=>u.name===t),a=r?.type,l=n[t];return a&&!s.includes(a)?Ov(a,l):uh(l)},Ov=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return uk(e,n)}switch(t){case Ge.bool:return ok(e);case Ge.float4:case Ge.float8:case Ge.int2:case Ge.int4:case Ge.int8:case Ge.numeric:case Ge.oid:return lk(e);case Ge.json:case Ge.jsonb:return ck(e);case Ge.timestamp:return dk(e);case Ge.abstime:case Ge.date:case Ge.daterange:case Ge.int4range:case Ge.int8range:case Ge.money:case Ge.reltime:case Ge.text:case Ge.time:case Ge.timestamptz:case Ge.timetz:case Ge.tsrange:case Ge.tstzrange:return uh(e);default:return uh(e)}},uh=t=>t,ok=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},lk=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},ck=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch{return t}return t},uk=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,s=t[n];if(t[0]==="{"&&s==="}"){let a;const l=t.slice(1,n);try{a=JSON.parse("["+l+"]")}catch{a=l?l.split(","):[]}return a.map(u=>Ov(e,u))}return t},dk=t=>typeof t=="string"?t.replace(" ","T"):t,Rv=t=>{const e=new URL(t);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class xd{constructor(e,n,s={},r=lh){this.channel=e,this.event=n,this.payload=s,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var s;return this._hasReceived(e)&&n((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var gg;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(gg||(gg={}));class Ma{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=n?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},r=>{const{onJoin:a,onLeave:l,onSync:u}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Ma.syncState(this.state,r,a,l),this.pendingDiffs.forEach(d=>{this.state=Ma.syncDiff(this.state,d,a,l)}),this.pendingDiffs=[],u()}),this.channel._on(s.diff,{},r=>{const{onJoin:a,onLeave:l,onSync:u}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(r):(this.state=Ma.syncDiff(this.state,r,a,l),u())}),this.onJoin((r,a,l)=>{this.channel._trigger("presence",{event:"join",key:r,currentPresences:a,newPresences:l})}),this.onLeave((r,a,l)=>{this.channel._trigger("presence",{event:"leave",key:r,currentPresences:a,leftPresences:l})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,s,r){const a=this.cloneDeep(e),l=this.transformState(n),u={},d={};return this.map(a,(f,m)=>{l[f]||(d[f]=m)}),this.map(l,(f,m)=>{const g=a[f];if(g){const y=m.map(b=>b.presence_ref),x=g.map(b=>b.presence_ref),_=m.filter(b=>x.indexOf(b.presence_ref)<0),k=g.filter(b=>y.indexOf(b.presence_ref)<0);_.length>0&&(u[f]=_),k.length>0&&(d[f]=k)}else u[f]=m}),this.syncDiff(a,{joins:u,leaves:d},s,r)}static syncDiff(e,n,s,r){const{joins:a,leaves:l}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return s||(s=()=>{}),r||(r=()=>{}),this.map(a,(u,d)=>{var f;const m=(f=e[u])!==null&&f!==void 0?f:[];if(e[u]=this.cloneDeep(d),m.length>0){const g=e[u].map(x=>x.presence_ref),y=m.filter(x=>g.indexOf(x.presence_ref)<0);e[u].unshift(...y)}s(u,m,d)}),this.map(l,(u,d)=>{let f=e[u];if(!f)return;const m=d.map(g=>g.presence_ref);f=f.filter(g=>m.indexOf(g.presence_ref)<0),e[u]=f,r(u,f,d),f.length===0&&delete e[u]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(s=>n(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,s)=>{const r=e[s];return"metas"in r?n[s]=r.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):n[s]=r,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var yg;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(yg||(yg={}));var La;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(La||(La={}));var ws;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(ws||(ws={}));class Pi{constructor(e,n={config:{}},s){var r,a;if(this.topic=e,this.params=n,this.socket=s,this.bindings={},this.state=wt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new xd(this,Fn.join,this.params,this.timeout),this.rejoinTimer=new Av(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=wt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(l=>l.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=wt.closed,this.socket._remove(this)}),this._onError(l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=wt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=wt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=wt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Fn.reply,{},(l,u)=>{this._trigger(this._replyEventName(u),l)}),this.presence=new Ma(this),this.broadcastEndpointURL=Rv(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((a=(r=this.params.config)===null||r===void 0?void 0:r.broadcast)===null||a===void 0)&&a.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,n=this.timeout){var s,r,a;if(this.socket.isConnected()||this.socket.connect(),this.state==wt.closed){const{config:{broadcast:l,presence:u,private:d}}=this.params,f=(r=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(x=>x.filter))!==null&&r!==void 0?r:[],m=!!this.bindings[La.PRESENCE]&&this.bindings[La.PRESENCE].length>0||((a=this.params.config.presence)===null||a===void 0?void 0:a.enabled)===!0,g={},y={broadcast:l,presence:Object.assign(Object.assign({},u),{enabled:m}),postgres_changes:f,private:d};this.socket.accessTokenValue&&(g.access_token=this.socket.accessTokenValue),this._onError(x=>e?.(ws.CHANNEL_ERROR,x)),this._onClose(()=>e?.(ws.CLOSED)),this.updateJoinPayload(Object.assign({config:y},g)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:x})=>{var _;if(this.socket._isManualToken()||this.socket.setAuth(),x===void 0){e?.(ws.SUBSCRIBED);return}else{const k=this.bindings.postgres_changes,b=(_=k?.length)!==null&&_!==void 0?_:0,S=[];for(let I=0;I<b;I++){const C=k[I],{filter:{event:T,schema:A,table:z,filter:E}}=C,D=x&&x[I];if(D&&D.event===T&&Pi.isFilterValueEqual(D.schema,A)&&Pi.isFilterValueEqual(D.table,z)&&Pi.isFilterValueEqual(D.filter,E))S.push(Object.assign(Object.assign({},C),{id:D.id}));else{this.unsubscribe(),this.state=wt.errored,e?.(ws.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=S,e&&e(ws.SUBSCRIBED);return}}).receive("error",x=>{this.state=wt.errored,e?.(ws.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(x).join(", ")||"error")))}).receive("timeout",()=>{e?.(ws.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,s){return this.state===wt.joined&&e===La.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,n,s)}async httpSend(e,n,s={}){var r;if(n==null)return Promise.reject("Payload is required for httpSend()");const a={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(a.Authorization=`Bearer ${this.socket.accessTokenValue}`);const l={method:"POST",headers:a,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:n,private:this.private}]})},u=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(r=s.timeout)!==null&&r!==void 0?r:this.timeout);if(u.status===202)return{success:!0};let d=u.statusText;try{const f=await u.json();d=f.error||f.message||d}catch{}return Promise.reject(new Error(d))}async send(e,n={}){var s,r;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:a,payload:l}=e,u={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(u.Authorization=`Bearer ${this.socket.accessTokenValue}`);const d={method:"POST",headers:u,body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:l,private:this.private}]})};try{const f=await this._fetchWithTimeout(this.broadcastEndpointURL,d,(s=n.timeout)!==null&&s!==void 0?s:this.timeout);return await((r=f.body)===null||r===void 0?void 0:r.cancel()),f.ok?"ok":"error"}catch(f){return f.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var l,u,d;const f=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((d=(u=(l=this.params)===null||l===void 0?void 0:l.config)===null||u===void 0?void 0:u.broadcast)===null||d===void 0)&&d.ack)&&a("ok"),f.receive("ok",()=>a("ok")),f.receive("error",()=>a("error")),f.receive("timeout",()=>a("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=wt.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Fn.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(r=>{s=new xd(this,Fn.leave,{},e),s.receive("ok",()=>{n(),r("ok")}).receive("timeout",()=>{n(),r("timed out")}).receive("error",()=>{r("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=wt.closed,this.bindings={}}async _fetchWithTimeout(e,n,s){const r=new AbortController,a=setTimeout(()=>r.abort(),s),l=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:r.signal}));return clearTimeout(a),l}_push(e,n,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new xd(this,e,n,s);return this._canPush()?r.send():this._addToPushBuffer(r),r}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>rk){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(e,n,s){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,s){var r,a;const l=e.toLocaleLowerCase(),{close:u,error:d,leave:f,join:m}=Fn;if(s&&[u,d,f,m].indexOf(l)>=0&&s!==this._joinRef())return;let y=this._onMessage(l,n,s);if(n&&!y)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(l)?(r=this.bindings.postgres_changes)===null||r===void 0||r.filter(x=>{var _,k,b;return((_=x.filter)===null||_===void 0?void 0:_.event)==="*"||((b=(k=x.filter)===null||k===void 0?void 0:k.event)===null||b===void 0?void 0:b.toLocaleLowerCase())===l}).map(x=>x.callback(y,s)):(a=this.bindings[l])===null||a===void 0||a.filter(x=>{var _,k,b,S,I,C;if(["broadcast","presence","postgres_changes"].includes(l))if("id"in x){const T=x.id,A=(_=x.filter)===null||_===void 0?void 0:_.event;return T&&((k=n.ids)===null||k===void 0?void 0:k.includes(T))&&(A==="*"||A?.toLocaleLowerCase()===((b=n.data)===null||b===void 0?void 0:b.type.toLocaleLowerCase()))}else{const T=(I=(S=x?.filter)===null||S===void 0?void 0:S.event)===null||I===void 0?void 0:I.toLocaleLowerCase();return T==="*"||T===((C=n?.event)===null||C===void 0?void 0:C.toLocaleLowerCase())}else return x.type.toLocaleLowerCase()===l}).map(x=>{if(typeof y=="object"&&"ids"in y){const _=y.data,{schema:k,table:b,commit_timestamp:S,type:I,errors:C}=_;y=Object.assign(Object.assign({},{schema:k,table:b,commit_timestamp:S,eventType:I,new:{},old:{},errors:C}),this._getPayloadRecords(_))}x.callback(y,s)})}_isClosed(){return this.state===wt.closed}_isJoined(){return this.state===wt.joined}_isJoining(){return this.state===wt.joining}_isLeaving(){return this.state===wt.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,s){const r=e.toLocaleLowerCase(),a={type:r,filter:n,callback:s};return this.bindings[r]?this.bindings[r].push(a):this.bindings[r]=[a],this}_off(e,n){const s=e.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(r=>{var a;return!(((a=r.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===s&&Pi.isEqual(r.filter,n))})),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const s in e)if(e[s]!==n[s])return!1;return!0}static isFilterValueEqual(e,n){return(e??void 0)===(n??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Fn.close,{},e)}_onError(e){this._on(Fn.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=wt.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=mg(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=mg(e.columns,e.old_record)),n}}const bd=()=>{},kl={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},hk=[1e3,2e3,5e3,1e4],fk=1e4,pk=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class mk{constructor(e,n){var s;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=lh,this.transport=null,this.heartbeatIntervalMs=kl.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=bd,this.ref=0,this.reconnectTimer=null,this.vsn=pg,this.logger=bd,this.conn=null,this.sendBuffer=[],this.serializer=new ik,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=r=>r?(...a)=>r(...a):(...a)=>fetch(...a),!(!((s=n?.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${e}/${ch.websocket}`,this.httpEndpoint=Rv(e),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Z_.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const n=e.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,n??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return n==="ok"&&this._remove(e),this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,n,s){this.logger(e,n,s)}connectionState(){switch(this.conn&&this.conn.readyState){case Zs.connecting:return Dr.Connecting;case Zs.open:return Dr.Open;case Zs.closing:return Dr.Closing;default:return Dr.Closed}}isConnected(){return this.connectionState()===Dr.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,n={config:{}}){const s=`realtime:${e}`,r=this.getChannels().find(a=>a.topic===s);if(r)return r;{const a=new Pi(`realtime:${e}`,n,this);return this.channels.push(a),a}}push(e){const{topic:n,event:s,payload:r,ref:a}=e,l=()=>{this.encode(e,u=>{var d;(d=this.conn)===null||d===void 0||d.send(u)})};this.log("push",`${n} ${s} (${a})`,r),this.isConnected()?l():this.sendBuffer.push(l)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(n){this.log("error","error in heartbeat callback",n)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(n){this.log("error","error in heartbeat callback",n)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(sk,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},kl.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(n){this.log("error","error in heartbeat callback",n)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,n=>{if(n.topic==="phoenix"&&n.event==="phx_reply"&&n.ref&&n.ref===this.pendingHeartbeatRef){const f=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(n.payload.status==="ok"?"ok":"error",f)}catch(m){this.log("error","error in heartbeat callback",m)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:s,event:r,payload:a,ref:l}=n,u=l?`(${l})`:"",d=a.status||"";this.log("receive",`${d} ${s} ${r} ${u}`.trim(),a),this.channels.filter(f=>f._isMember(s)).forEach(f=>f._trigger(r,a,l)),this._triggerStateCallbacks("message",n)})}_clearTimer(e){var n;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===Zs.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===Zs.open||this.conn.readyState===Zs.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(n=>{this.log("error","error waiting for auth on connect",n),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this._terminateWorker()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var n;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e);try{this.heartbeatCallback("error")}catch(n){this.log("error","error in heartbeat callback",n)}}_triggerChanError(){this.channels.forEach(e=>e._trigger(Fn.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const s=e.match(/\?/)?"&":"?",r=new URLSearchParams(n);return`${e}${s}${r}`}_workerObjectUrl(e){let n;if(e)n=e;else{const s=new Blob([pk],{type:"application/javascript"});n=URL.createObjectURL(s)}return n}_setConnectionState(e,n=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(e=null){let n,s=!1;if(e)n=e,s=!0;else if(this.accessToken)try{n=await this.accessToken()}catch(r){this.log("error","Error fetching access token from callback",r),n=this.accessTokenValue}else n=this.accessTokenValue;s?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(r=>{const a={access_token:n,version:tk};n&&r.updateJoinPayload(a),r.joinedOnce&&r._isJoined()&&r._push(Fn.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(n=>{this.log("error",`Error setting auth in ${e}`,n)})}_triggerStateCallbacks(e,n){try{this.stateChangeCallbacks[e].forEach(s=>{try{s(n)}catch(r){this.log("error",`error in ${e} callback`,r)}})}catch(s){this.log("error",`error triggering ${e} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new Av(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},kl.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var n,s,r,a,l,u,d,f,m,g,y,x;switch(this.transport=(n=e?.transport)!==null&&n!==void 0?n:null,this.timeout=(s=e?.timeout)!==null&&s!==void 0?s:lh,this.heartbeatIntervalMs=(r=e?.heartbeatIntervalMs)!==null&&r!==void 0?r:kl.HEARTBEAT_INTERVAL,this.worker=(a=e?.worker)!==null&&a!==void 0?a:!1,this.accessToken=(l=e?.accessToken)!==null&&l!==void 0?l:null,this.heartbeatCallback=(u=e?.heartbeatCallback)!==null&&u!==void 0?u:bd,this.vsn=(d=e?.vsn)!==null&&d!==void 0?d:pg,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(f=e?.reconnectAfterMs)!==null&&f!==void 0?f:(_=>hk[_-1]||fk),this.vsn){case nk:this.encode=(m=e?.encode)!==null&&m!==void 0?m:((_,k)=>k(JSON.stringify(_))),this.decode=(g=e?.decode)!==null&&g!==void 0?g:((_,k)=>k(JSON.parse(_)));break;case Nv:this.encode=(y=e?.encode)!==null&&y!==void 0?y:this.serializer.encode.bind(this.serializer),this.decode=(x=e?.decode)!==null&&x!==void 0?x:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}var Va=class extends Error{constructor(t,e){super(t),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&e.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function gk(t,e,n){const s=new URL(e,t);if(n)for(const[r,a]of Object.entries(n))a!==void 0&&s.searchParams.set(r,a);return s.toString()}async function yk(t){return!t||t.type==="none"?{}:t.type==="bearer"?{Authorization:`Bearer ${t.token}`}:t.type==="header"?{[t.name]:t.value}:t.type==="custom"?await t.getHeaders():{}}function vk(t){const e=t.fetchImpl??globalThis.fetch;return{async request({method:n,path:s,query:r,body:a,headers:l}){const u=gk(t.baseUrl,s,r),d=await yk(t.auth),f=await e(u,{method:n,headers:{...a?{"Content-Type":"application/json"}:{},...d,...l},body:a?JSON.stringify(a):void 0}),m=await f.text(),g=(f.headers.get("content-type")||"").includes("application/json"),y=g&&m?JSON.parse(m):m;if(!f.ok){const x=g?y:void 0,_=x?.error;throw new Va(_?.message??`Request failed with status ${f.status}`,{status:f.status,icebergType:_?.type,icebergCode:_?.code,details:x})}return{status:f.status,headers:f.headers,data:y}}}}function Sl(t){return t.join("")}var xk=class{constructor(t,e=""){this.client=t,this.prefix=e}async listNamespaces(t){const e=t?{parent:Sl(t.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(s=>({namespace:s}))}async createNamespace(t,e){const n={namespace:t.namespace,properties:e?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:n})).data}async dropNamespace(t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Sl(t.namespace)}`})}async loadNamespaceMetadata(t){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Sl(t.namespace)}`})).data.properties}}async namespaceExists(t){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Sl(t.namespace)}`}),!0}catch(e){if(e instanceof Va&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(t,e){try{return await this.createNamespace(t,e)}catch(n){if(n instanceof Va&&n.status===409)return;throw n}}};function gi(t){return t.join("")}var bk=class{constructor(t,e="",n){this.client=t,this.prefix=e,this.accessDelegation=n}async listTables(t){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${gi(t.namespace)}/tables`})).data.identifiers}async createTable(t,e){const n={};return this.accessDelegation&&(n["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${gi(t.namespace)}/tables`,body:e,headers:n})).data.metadata}async updateTable(t,e){const n=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${gi(t.namespace)}/tables/${t.name}`,body:e});return{"metadata-location":n.data["metadata-location"],metadata:n.data.metadata}}async dropTable(t,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${gi(t.namespace)}/tables/${t.name}`,query:{purgeRequested:String(e?.purge??!1)}})}async loadTable(t){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${gi(t.namespace)}/tables/${t.name}`,headers:e})).data.metadata}async tableExists(t){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${gi(t.namespace)}/tables/${t.name}`,headers:e}),!0}catch(n){if(n instanceof Va&&n.status===404)return!1;throw n}}async createTableIfNotExists(t,e){try{return await this.createTable(t,e)}catch(n){if(n instanceof Va&&n.status===409)return await this.loadTable({namespace:t.namespace,name:e.name});throw n}}},wk=class{constructor(t){let e="v1";t.catalogName&&(e+=`/${t.catalogName}`);const n=t.baseUrl.endsWith("/")?t.baseUrl:`${t.baseUrl}/`;this.client=vk({baseUrl:n,auth:t.auth,fetchImpl:t.fetch}),this.accessDelegation=t.accessDelegation?.join(","),this.namespaceOps=new xk(this.client,e),this.tableOps=new bk(this.client,e,this.accessDelegation)}async listNamespaces(t){return this.namespaceOps.listNamespaces(t)}async createNamespace(t,e){return this.namespaceOps.createNamespace(t,e)}async dropNamespace(t){await this.namespaceOps.dropNamespace(t)}async loadNamespaceMetadata(t){return this.namespaceOps.loadNamespaceMetadata(t)}async listTables(t){return this.tableOps.listTables(t)}async createTable(t,e){return this.tableOps.createTable(t,e)}async updateTable(t,e){return this.tableOps.updateTable(t,e)}async dropTable(t,e){await this.tableOps.dropTable(t,e)}async loadTable(t){return this.tableOps.loadTable(t)}async namespaceExists(t){return this.namespaceOps.namespaceExists(t)}async tableExists(t){return this.tableOps.tableExists(t)}async createNamespaceIfNotExists(t,e){return this.namespaceOps.createNamespaceIfNotExists(t,e)}async createTableIfNotExists(t,e){return this.tableOps.createTableIfNotExists(t,e)}},gc=class extends Error{constructor(t,e="storage",n,s){super(t),this.__isStorageError=!0,this.namespace=e,this.name=e==="vectors"?"StorageVectorsError":"StorageError",this.status=n,this.statusCode=s}};function yc(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}var jl=class extends gc{constructor(t,e,n,s="storage"){super(t,s,e,n),this.name=s==="vectors"?"StorageVectorsApiError":"StorageApiError",this.status=e,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Mv=class extends gc{constructor(t,e,n="storage"){super(t,n),this.name=n==="vectors"?"StorageVectorsUnknownError":"StorageUnknownError",this.originalError=e}};const _k=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),kk=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},dh=t=>{if(Array.isArray(t))return t.map(n=>dh(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,s])=>{const r=n.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));e[r]=dh(s)}),e},Sk=t=>!t||typeof t!="string"||t.length===0||t.length>100||t.trim()!==t||t.includes("/")||t.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(t);function qa(t){"@babel/helpers - typeof";return qa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qa(t)}function jk(t,e){if(qa(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(qa(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ck(t){var e=jk(t,"string");return qa(e)=="symbol"?e:e+""}function Pk(t,e,n){return(e=Ck(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vg(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function ke(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?vg(Object(n),!0).forEach(function(s){Pk(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):vg(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}const xg=t=>{var e;return t.msg||t.message||t.error_description||(typeof t.error=="string"?t.error:(e=t.error)===null||e===void 0?void 0:e.message)||JSON.stringify(t)},Ik=async(t,e,n,s)=>{if(t&&typeof t=="object"&&"status"in t&&"ok"in t&&typeof t.status=="number"&&!n?.noResolveJson){const r=t,a=r.status||500;if(typeof r.json=="function")r.json().then(l=>{const u=l?.statusCode||l?.code||a+"";e(new jl(xg(l),a,u,s))}).catch(()=>{if(s==="vectors"){const l=a+"";e(new jl(r.statusText||`HTTP ${a} error`,a,l,s))}else{const l=a+"";e(new jl(r.statusText||`HTTP ${a} error`,a,l,s))}});else{const l=a+"";e(new jl(r.statusText||`HTTP ${a} error`,a,l,s))}}else e(new Mv(xg(t),t,s))},Ek=(t,e,n,s)=>{const r={method:t,headers:e?.headers||{}};return t==="GET"||t==="HEAD"||!s?ke(ke({},r),n):(kk(s)?(r.headers=ke({"Content-Type":"application/json"},e?.headers),r.body=JSON.stringify(s)):r.body=s,e?.duplex&&(r.duplex=e.duplex),ke(ke({},r),n))};async function xa(t,e,n,s,r,a,l){return new Promise((u,d)=>{t(n,Ek(e,s,r,a)).then(f=>{if(!f.ok)throw f;if(s?.noResolveJson)return f;if(l==="vectors"){const m=f.headers.get("content-type");if(f.headers.get("content-length")==="0"||f.status===204)return{};if(!m||!m.includes("application/json"))return{}}return f.json()}).then(f=>u(f)).catch(f=>Ik(f,d,s,l))})}function Lv(t="storage"){return{get:async(e,n,s,r)=>xa(e,"GET",n,s,r,void 0,t),post:async(e,n,s,r,a)=>xa(e,"POST",n,r,a,s,t),put:async(e,n,s,r,a)=>xa(e,"PUT",n,r,a,s,t),head:async(e,n,s,r)=>xa(e,"HEAD",n,ke(ke({},s),{},{noResolveJson:!0}),r,void 0,t),remove:async(e,n,s,r,a)=>xa(e,"DELETE",n,r,a,s,t)}}const Tk=Lv("storage"),{get:Ha,post:Dn,put:hh,head:Nk,remove:Dh}=Tk,fn=Lv("vectors");var Di=class{constructor(t,e={},n,s="storage"){this.shouldThrowOnError=!1,this.url=t,this.headers=e,this.fetch=_k(n),this.namespace=s}throwOnError(){return this.shouldThrowOnError=!0,this}async handleOperation(t){var e=this;try{return{data:await t(),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(yc(n))return{data:null,error:n};throw n}}},Ak=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e}then(t,e){return this.execute().then(t,e)}async execute(){var t=this;try{return{data:(await t.downloadFn()).body,error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(yc(e))return{data:null,error:e};throw e}}};let Dv;Dv=Symbol.toStringTag;var Ok=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e,this[Dv]="BlobDownloadBuilder",this.promise=null}asStream(){return new Ak(this.downloadFn,this.shouldThrowOnError)}then(t,e){return this.getPromise().then(t,e)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var t=this;try{return{data:await(await t.downloadFn()).blob(),error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(yc(e))return{data:null,error:e};throw e}}};const Rk={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},bg={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var Mk=class extends Di{constructor(t,e={},n,s){super(t,e,s,"storage"),this.bucketId=n}async uploadOrUpdate(t,e,n,s){var r=this;return r.handleOperation(async()=>{let a;const l=ke(ke({},bg),s);let u=ke(ke({},r.headers),t==="POST"&&{"x-upsert":String(l.upsert)});const d=l.metadata;typeof Blob<"u"&&n instanceof Blob?(a=new FormData,a.append("cacheControl",l.cacheControl),d&&a.append("metadata",r.encodeMetadata(d)),a.append("",n)):typeof FormData<"u"&&n instanceof FormData?(a=n,a.has("cacheControl")||a.append("cacheControl",l.cacheControl),d&&!a.has("metadata")&&a.append("metadata",r.encodeMetadata(d))):(a=n,u["cache-control"]=`max-age=${l.cacheControl}`,u["content-type"]=l.contentType,d&&(u["x-metadata"]=r.toBase64(r.encodeMetadata(d))),(typeof ReadableStream<"u"&&a instanceof ReadableStream||a&&typeof a=="object"&&"pipe"in a&&typeof a.pipe=="function")&&!l.duplex&&(l.duplex="half")),s?.headers&&(u=ke(ke({},u),s.headers));const f=r._removeEmptyFolders(e),m=r._getFinalPath(f),g=await(t=="PUT"?hh:Dn)(r.fetch,`${r.url}/object/${m}`,a,ke({headers:u},l?.duplex?{duplex:l.duplex}:{}));return{path:f,id:g.Id,fullPath:g.Key}})}async upload(t,e,n){return this.uploadOrUpdate("POST",t,e,n)}async uploadToSignedUrl(t,e,n,s){var r=this;const a=r._removeEmptyFolders(t),l=r._getFinalPath(a),u=new URL(r.url+`/object/upload/sign/${l}`);return u.searchParams.set("token",e),r.handleOperation(async()=>{let d;const f=ke({upsert:bg.upsert},s),m=ke(ke({},r.headers),{"x-upsert":String(f.upsert)});return typeof Blob<"u"&&n instanceof Blob?(d=new FormData,d.append("cacheControl",f.cacheControl),d.append("",n)):typeof FormData<"u"&&n instanceof FormData?(d=n,d.append("cacheControl",f.cacheControl)):(d=n,m["cache-control"]=`max-age=${f.cacheControl}`,m["content-type"]=f.contentType),{path:a,fullPath:(await hh(r.fetch,u.toString(),d,{headers:m})).Key}})}async createSignedUploadUrl(t,e){var n=this;return n.handleOperation(async()=>{let s=n._getFinalPath(t);const r=ke({},n.headers);e?.upsert&&(r["x-upsert"]="true");const a=await Dn(n.fetch,`${n.url}/object/upload/sign/${s}`,{},{headers:r}),l=new URL(n.url+a.url),u=l.searchParams.get("token");if(!u)throw new gc("No token returned by API");return{signedUrl:l.toString(),path:t,token:u}})}async update(t,e,n){return this.uploadOrUpdate("PUT",t,e,n)}async move(t,e,n){var s=this;return s.handleOperation(async()=>await Dn(s.fetch,`${s.url}/object/move`,{bucketId:s.bucketId,sourceKey:t,destinationKey:e,destinationBucket:n?.destinationBucket},{headers:s.headers}))}async copy(t,e,n){var s=this;return s.handleOperation(async()=>({path:(await Dn(s.fetch,`${s.url}/object/copy`,{bucketId:s.bucketId,sourceKey:t,destinationKey:e,destinationBucket:n?.destinationBucket},{headers:s.headers})).Key}))}async createSignedUrl(t,e,n){var s=this;return s.handleOperation(async()=>{let r=s._getFinalPath(t),a=await Dn(s.fetch,`${s.url}/object/sign/${r}`,ke({expiresIn:e},n?.transform?{transform:n.transform}:{}),{headers:s.headers});const l=n?.download?`&download=${n.download===!0?"":n.download}`:"";return{signedUrl:encodeURI(`${s.url}${a.signedURL}${l}`)}})}async createSignedUrls(t,e,n){var s=this;return s.handleOperation(async()=>{const r=await Dn(s.fetch,`${s.url}/object/sign/${s.bucketId}`,{expiresIn:e,paths:t},{headers:s.headers}),a=n?.download?`&download=${n.download===!0?"":n.download}`:"";return r.map(l=>ke(ke({},l),{},{signedUrl:l.signedURL?encodeURI(`${s.url}${l.signedURL}${a}`):null}))})}download(t,e,n){const s=typeof e?.transform<"u"?"render/image/authenticated":"object",r=this.transformOptsToQueryString(e?.transform||{}),a=r?`?${r}`:"",l=this._getFinalPath(t),u=()=>Ha(this.fetch,`${this.url}/${s}/${l}${a}`,{headers:this.headers,noResolveJson:!0},n);return new Ok(u,this.shouldThrowOnError)}async info(t){var e=this;const n=e._getFinalPath(t);return e.handleOperation(async()=>dh(await Ha(e.fetch,`${e.url}/object/info/${n}`,{headers:e.headers})))}async exists(t){var e=this;const n=e._getFinalPath(t);try{return await Nk(e.fetch,`${e.url}/object/${n}`,{headers:e.headers}),{data:!0,error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(yc(s)&&s instanceof Mv){const r=s.originalError;if([400,404].includes(r?.status))return{data:!1,error:s}}throw s}}getPublicUrl(t,e){const n=this._getFinalPath(t),s=[],r=e?.download?`download=${e.download===!0?"":e.download}`:"";r!==""&&s.push(r);const a=typeof e?.transform<"u"?"render/image":"object",l=this.transformOptsToQueryString(e?.transform||{});l!==""&&s.push(l);let u=s.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${n}${u}`)}}}async remove(t){var e=this;return e.handleOperation(async()=>await Dh(e.fetch,`${e.url}/object/${e.bucketId}`,{prefixes:t},{headers:e.headers}))}async list(t,e,n){var s=this;return s.handleOperation(async()=>{const r=ke(ke(ke({},Rk),e),{},{prefix:t||""});return await Dn(s.fetch,`${s.url}/object/list/${s.bucketId}`,r,{headers:s.headers},n)})}async listV2(t,e){var n=this;return n.handleOperation(async()=>{const s=ke({},t);return await Dn(n.fetch,`${n.url}/object/list-v2/${n.bucketId}`,s,{headers:n.headers},e)})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const e=[];return t.width&&e.push(`width=${t.width}`),t.height&&e.push(`height=${t.height}`),t.resize&&e.push(`resize=${t.resize}`),t.format&&e.push(`format=${t.format}`),t.quality&&e.push(`quality=${t.quality}`),e.join("&")}};const Lk="2.95.3",ao={"X-Client-Info":`storage-js/${Lk}`};var Dk=class extends Di{constructor(t,e={},n,s){const r=new URL(t);s?.useNewHostname&&/supabase\.(co|in|red)$/.test(r.hostname)&&!r.hostname.includes("storage.supabase.")&&(r.hostname=r.hostname.replace("supabase.","storage.supabase."));const a=r.href.replace(/\/$/,""),l=ke(ke({},ao),e);super(a,l,n,"storage")}async listBuckets(t){var e=this;return e.handleOperation(async()=>{const n=e.listBucketOptionsToQueryString(t);return await Ha(e.fetch,`${e.url}/bucket${n}`,{headers:e.headers})})}async getBucket(t){var e=this;return e.handleOperation(async()=>await Ha(e.fetch,`${e.url}/bucket/${t}`,{headers:e.headers}))}async createBucket(t,e={public:!1}){var n=this;return n.handleOperation(async()=>await Dn(n.fetch,`${n.url}/bucket`,{id:t,name:t,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:n.headers}))}async updateBucket(t,e){var n=this;return n.handleOperation(async()=>await hh(n.fetch,`${n.url}/bucket/${t}`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:n.headers}))}async emptyBucket(t){var e=this;return e.handleOperation(async()=>await Dn(e.fetch,`${e.url}/bucket/${t}/empty`,{},{headers:e.headers}))}async deleteBucket(t){var e=this;return e.handleOperation(async()=>await Dh(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}))}listBucketOptionsToQueryString(t){const e={};return t&&("limit"in t&&(e.limit=String(t.limit)),"offset"in t&&(e.offset=String(t.offset)),t.search&&(e.search=t.search),t.sortColumn&&(e.sortColumn=t.sortColumn),t.sortOrder&&(e.sortOrder=t.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}},Fk=class extends Di{constructor(t,e={},n){const s=t.replace(/\/$/,""),r=ke(ke({},ao),e);super(s,r,n,"storage")}async createBucket(t){var e=this;return e.handleOperation(async()=>await Dn(e.fetch,`${e.url}/bucket`,{name:t},{headers:e.headers}))}async listBuckets(t){var e=this;return e.handleOperation(async()=>{const n=new URLSearchParams;t?.limit!==void 0&&n.set("limit",t.limit.toString()),t?.offset!==void 0&&n.set("offset",t.offset.toString()),t?.sortColumn&&n.set("sortColumn",t.sortColumn),t?.sortOrder&&n.set("sortOrder",t.sortOrder),t?.search&&n.set("search",t.search);const s=n.toString(),r=s?`${e.url}/bucket?${s}`:`${e.url}/bucket`;return await Ha(e.fetch,r,{headers:e.headers})})}async deleteBucket(t){var e=this;return e.handleOperation(async()=>await Dh(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}))}from(t){var e=this;if(!Sk(t))throw new gc("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const n=new wk({baseUrl:this.url,catalogName:t,auth:{type:"custom",getHeaders:async()=>e.headers},fetch:this.fetch}),s=this.shouldThrowOnError;return new Proxy(n,{get(r,a){const l=r[a];return typeof l!="function"?l:async(...u)=>{try{return{data:await l.apply(r,u),error:null}}catch(d){if(s)throw d;return{data:null,error:d}}}}})}},Bk=class extends Di{constructor(t,e={},n){const s=t.replace(/\/$/,""),r=ke(ke({},ao),{},{"Content-Type":"application/json"},e);super(s,r,n,"vectors")}async createIndex(t){var e=this;return e.handleOperation(async()=>await fn.post(e.fetch,`${e.url}/CreateIndex`,t,{headers:e.headers})||{})}async getIndex(t,e){var n=this;return n.handleOperation(async()=>await fn.post(n.fetch,`${n.url}/GetIndex`,{vectorBucketName:t,indexName:e},{headers:n.headers}))}async listIndexes(t){var e=this;return e.handleOperation(async()=>await fn.post(e.fetch,`${e.url}/ListIndexes`,t,{headers:e.headers}))}async deleteIndex(t,e){var n=this;return n.handleOperation(async()=>await fn.post(n.fetch,`${n.url}/DeleteIndex`,{vectorBucketName:t,indexName:e},{headers:n.headers})||{})}},$k=class extends Di{constructor(t,e={},n){const s=t.replace(/\/$/,""),r=ke(ke({},ao),{},{"Content-Type":"application/json"},e);super(s,r,n,"vectors")}async putVectors(t){var e=this;if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return e.handleOperation(async()=>await fn.post(e.fetch,`${e.url}/PutVectors`,t,{headers:e.headers})||{})}async getVectors(t){var e=this;return e.handleOperation(async()=>await fn.post(e.fetch,`${e.url}/GetVectors`,t,{headers:e.headers}))}async listVectors(t){var e=this;if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return e.handleOperation(async()=>await fn.post(e.fetch,`${e.url}/ListVectors`,t,{headers:e.headers}))}async queryVectors(t){var e=this;return e.handleOperation(async()=>await fn.post(e.fetch,`${e.url}/QueryVectors`,t,{headers:e.headers}))}async deleteVectors(t){var e=this;if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return e.handleOperation(async()=>await fn.post(e.fetch,`${e.url}/DeleteVectors`,t,{headers:e.headers})||{})}},zk=class extends Di{constructor(t,e={},n){const s=t.replace(/\/$/,""),r=ke(ke({},ao),{},{"Content-Type":"application/json"},e);super(s,r,n,"vectors")}async createBucket(t){var e=this;return e.handleOperation(async()=>await fn.post(e.fetch,`${e.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{})}async getBucket(t){var e=this;return e.handleOperation(async()=>await fn.post(e.fetch,`${e.url}/GetVectorBucket`,{vectorBucketName:t},{headers:e.headers}))}async listBuckets(t={}){var e=this;return e.handleOperation(async()=>await fn.post(e.fetch,`${e.url}/ListVectorBuckets`,t,{headers:e.headers}))}async deleteBucket(t){var e=this;return e.handleOperation(async()=>await fn.post(e.fetch,`${e.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{})}},Uk=class extends zk{constructor(t,e={}){super(t,e.headers||{},e.fetch)}from(t){return new Wk(this.url,this.headers,t,this.fetch)}async createBucket(t){var e=()=>super.createBucket,n=this;return e().call(n,t)}async getBucket(t){var e=()=>super.getBucket,n=this;return e().call(n,t)}async listBuckets(t={}){var e=()=>super.listBuckets,n=this;return e().call(n,t)}async deleteBucket(t){var e=()=>super.deleteBucket,n=this;return e().call(n,t)}},Wk=class extends Bk{constructor(t,e,n,s){super(t,e,s),this.vectorBucketName=n}async createIndex(t){var e=()=>super.createIndex,n=this;return e().call(n,ke(ke({},t),{},{vectorBucketName:n.vectorBucketName}))}async listIndexes(t={}){var e=()=>super.listIndexes,n=this;return e().call(n,ke(ke({},t),{},{vectorBucketName:n.vectorBucketName}))}async getIndex(t){var e=()=>super.getIndex,n=this;return e().call(n,n.vectorBucketName,t)}async deleteIndex(t){var e=()=>super.deleteIndex,n=this;return e().call(n,n.vectorBucketName,t)}index(t){return new Vk(this.url,this.headers,this.vectorBucketName,t,this.fetch)}},Vk=class extends $k{constructor(t,e,n,s,r){super(t,e,r),this.vectorBucketName=n,this.indexName=s}async putVectors(t){var e=()=>super.putVectors,n=this;return e().call(n,ke(ke({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async getVectors(t){var e=()=>super.getVectors,n=this;return e().call(n,ke(ke({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async listVectors(t={}){var e=()=>super.listVectors,n=this;return e().call(n,ke(ke({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async queryVectors(t){var e=()=>super.queryVectors,n=this;return e().call(n,ke(ke({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async deleteVectors(t){var e=()=>super.deleteVectors,n=this;return e().call(n,ke(ke({},t),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}},qk=class extends Dk{constructor(t,e={},n,s){super(t,e,n,s)}from(t){return new Mk(this.url,this.headers,t,this.fetch)}get vectors(){return new Uk(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new Fk(this.url+"/iceberg",this.headers,this.fetch)}};const Fv="2.95.3",ji=30*1e3,fh=3,wd=fh*ji,Hk="http://localhost:9999",Kk="supabase.auth.token",Gk={"X-Client-Info":`gotrue-js/${Fv}`},ph="X-Supabase-Api-Version",Bv={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Yk=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Jk=600*1e3;class Ka extends Error{constructor(e,n,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=s}}function ve(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class Xk extends Ka{constructor(e,n,s){super(e,n,s),this.name="AuthApiError",this.status=n,this.code=s}}function Qk(t){return ve(t)&&t.name==="AuthApiError"}class Fr extends Ka{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class Es extends Ka{constructor(e,n,s,r){super(e,s,r),this.name=n,this.status=s}}class dn extends Es{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function _d(t){return ve(t)&&t.name==="AuthSessionMissingError"}class yi extends Es{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Cl extends Es{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Pl extends Es{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Zk(t){return ve(t)&&t.name==="AuthImplicitGrantRedirectError"}class wg extends Es{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class eS extends Es{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class mh extends Es{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function kd(t){return ve(t)&&t.name==="AuthRetryableFetchError"}class _g extends Es{constructor(e,n,s){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=s}}class gh extends Es{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Ql="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),kg=` 	
\r=`.split(""),tS=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<kg.length;e+=1)t[kg[e].charCodeAt(0)]=-2;for(let e=0;e<Ql.length;e+=1)t[Ql[e].charCodeAt(0)]=e;return t})();function Sg(t,e,n){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;n(Ql[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;n(Ql[s]),e.queuedBits-=6}}function $v(t,e,n){const s=tS[t];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)n(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function jg(t){const e=[],n=l=>{e.push(String.fromCodePoint(l))},s={utf8seq:0,codepoint:0},r={queue:0,queuedBits:0},a=l=>{rS(l,s,n)};for(let l=0;l<t.length;l+=1)$v(t.charCodeAt(l),r,a);return e.join("")}function nS(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function sS(t,e){for(let n=0;n<t.length;n+=1){let s=t.charCodeAt(n);if(s>55295&&s<=56319){const r=(s-55296)*1024&65535;s=(t.charCodeAt(n+1)-56320&65535|r)+65536,n+=1}nS(s,e)}}function rS(t,e,n){if(e.utf8seq===0){if(t<=127){n(t);return}for(let s=1;s<6;s+=1)if((t>>7-s&1)===0){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&n(e.codepoint)}}function Ii(t){const e=[],n={queue:0,queuedBits:0},s=r=>{e.push(r)};for(let r=0;r<t.length;r+=1)$v(t.charCodeAt(r),n,s);return new Uint8Array(e)}function iS(t){const e=[];return sS(t,n=>e.push(n)),new Uint8Array(e)}function Br(t){const e=[],n={queue:0,queuedBits:0},s=r=>{e.push(r)};return t.forEach(r=>Sg(r,n,s)),Sg(null,n,s),e.join("")}function aS(t){return Math.round(Date.now()/1e3)+t}function oS(){return Symbol("auth-callback")}const Tt=()=>typeof window<"u"&&typeof document<"u",Ir={tested:!1,writable:!1},zv=()=>{if(!Tt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ir.tested)return Ir.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Ir.tested=!0,Ir.writable=!0}catch{Ir.tested=!0,Ir.writable=!1}return Ir.writable};function lS(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((r,a)=>{e[a]=r})}catch{}return n.searchParams.forEach((s,r)=>{e[r]=s}),e}const Uv=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),cS=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",Ci=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},Er=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},Et=async(t,e)=>{await t.removeItem(e)};class vc{constructor(){this.promise=new vc.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}vc.promiseConstructor=Promise;function Il(t){const e=t.split(".");if(e.length!==3)throw new gh("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!Yk.test(e[s]))throw new gh("JWT not in base64url format");return{header:JSON.parse(jg(e[0])),payload:JSON.parse(jg(e[1])),signature:Ii(e[2]),raw:{header:e[0],payload:e[1]}}}async function uS(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function dS(t,e){return new Promise((s,r)=>{(async()=>{for(let a=0;a<1/0;a++)try{const l=await t(a);if(!e(a,null,l)){s(l);return}}catch(l){if(!e(a,l)){r(l);return}}})()})}function hS(t){return("0"+t.toString(16)).substr(-2)}function fS(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=n.length;let r="";for(let a=0;a<56;a++)r+=n.charAt(Math.floor(Math.random()*s));return r}return crypto.getRandomValues(e),Array.from(e,hS).join("")}async function pS(t){const n=new TextEncoder().encode(t),s=await crypto.subtle.digest("SHA-256",n),r=new Uint8Array(s);return Array.from(r).map(a=>String.fromCharCode(a)).join("")}async function mS(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await pS(t);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function vi(t,e,n=!1){const s=fS();let r=s;n&&(r+="/PASSWORD_RECOVERY"),await Ci(t,`${e}-code-verifier`,r);const a=await mS(s);return[a,s===a?"plain":"s256"]}const gS=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function yS(t){const e=t.headers.get(ph);if(!e||!e.match(gS))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function vS(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function xS(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const bS=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function xi(t){if(!bS.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Sd(){const t={};return new Proxy(t,{get:(e,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const s=n.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function wS(t,e){return new Proxy(t,{get:(n,s,r)=>{if(s==="__isInsecureUserWarningProxy")return!0;if(typeof s=="symbol"){const a=s.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)"||a==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(n,s,r)}return!e.value&&typeof s=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(n,s,r)}})}function Cg(t){return JSON.parse(JSON.stringify(t))}const Rr=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),_S=[502,503,504];async function Pg(t){var e;if(!cS(t))throw new mh(Rr(t),0);if(_S.includes(t.status))throw new mh(Rr(t),t.status);let n;try{n=await t.json()}catch(a){throw new Fr(Rr(a),a)}let s;const r=yS(t);if(r&&r.getTime()>=Bv["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?s=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(s=n.error_code),s){if(s==="weak_password")throw new _g(Rr(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new dn}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((a,l)=>a&&typeof l=="string",!0))throw new _g(Rr(n),t.status,n.weak_password.reasons);throw new Xk(Rr(n),t.status||500,s)}const kS=(t,e,n,s)=>{const r={method:t,headers:e?.headers||{}};return t==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),r.body=JSON.stringify(s),Object.assign(Object.assign({},r),n))};async function _e(t,e,n,s){var r;const a=Object.assign({},s?.headers);a[ph]||(a[ph]=Bv["2024-01-01"].name),s?.jwt&&(a.Authorization=`Bearer ${s.jwt}`);const l=(r=s?.query)!==null&&r!==void 0?r:{};s?.redirectTo&&(l.redirect_to=s.redirectTo);const u=Object.keys(l).length?"?"+new URLSearchParams(l).toString():"",d=await SS(t,e,n+u,{headers:a,noResolveJson:s?.noResolveJson},{},s?.body);return s?.xform?s?.xform(d):{data:Object.assign({},d),error:null}}async function SS(t,e,n,s,r,a){const l=kS(e,s,r,a);let u;try{u=await t(n,Object.assign({},l))}catch(d){throw console.error(d),new mh(Rr(d),0)}if(u.ok||await Pg(u),s?.noResolveJson)return u;try{return await u.json()}catch(d){await Pg(d)}}function Ln(t){var e;let n=null;PS(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=aS(t.expires_in)));const s=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:s},error:null}}function Ig(t){const e=Ln(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,s)=>n&&typeof s=="string",!0)&&(e.data.weak_password=t.weak_password),e}function er(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function jS(t){return{data:t,error:null}}function CS(t){const{action_link:e,email_otp:n,hashed_token:s,redirect_to:r,verification_type:a}=t,l=mc(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),u={action_link:e,email_otp:n,hashed_token:s,redirect_to:r,verification_type:a},d=Object.assign({},l);return{data:{properties:u,user:d},error:null}}function Eg(t){return t}function PS(t){return t.access_token&&t.refresh_token&&t.expires_in}const jd=["global","local","others"];class IS{constructor({url:e="",headers:n={},fetch:s}){this.url=e,this.headers=n,this.fetch=Uv(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,n=jd[0]){if(jd.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${jd.join(", ")}`);try{return await _e(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(ve(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,n={}){try{return await _e(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:er})}catch(s){if(ve(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:n}=e,s=mc(e,["options"]),r=Object.assign(Object.assign({},s),n);return"newEmail"in s&&(r.new_email=s?.newEmail,delete r.newEmail),await _e(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:CS,redirectTo:n?.redirectTo})}catch(n){if(ve(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await _e(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:er})}catch(n){if(ve(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,s,r,a,l,u,d;try{const f={nextPage:null,lastPage:0,total:0},m=await _e(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(n=e?.page)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:"",per_page:(a=(r=e?.perPage)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:""},xform:Eg});if(m.error)throw m.error;const g=await m.json(),y=(l=m.headers.get("x-total-count"))!==null&&l!==void 0?l:0,x=(d=(u=m.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&d!==void 0?d:[];return x.length>0&&(x.forEach(_=>{const k=parseInt(_.split(";")[0].split("=")[1].substring(0,1)),b=JSON.parse(_.split(";")[1].split("=")[1]);f[`${b}Page`]=k}),f.total=parseInt(y)),{data:Object.assign(Object.assign({},g),f),error:null}}catch(f){if(ve(f))return{data:{users:[]},error:f};throw f}}async getUserById(e){xi(e);try{return await _e(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:er})}catch(n){if(ve(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){xi(e);try{return await _e(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:er})}catch(s){if(ve(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,n=!1){xi(e);try{return await _e(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:er})}catch(s){if(ve(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){xi(e.userId);try{const{data:n,error:s}=await _e(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:r=>({data:{factors:r},error:null})});return{data:n,error:s}}catch(n){if(ve(n))return{data:null,error:n};throw n}}async _deleteFactor(e){xi(e.userId),xi(e.id);try{return{data:await _e(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(ve(n))return{data:null,error:n};throw n}}async _listOAuthClients(e){var n,s,r,a,l,u,d;try{const f={nextPage:null,lastPage:0,total:0},m=await _e(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(n=e?.page)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:"",per_page:(a=(r=e?.perPage)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:""},xform:Eg});if(m.error)throw m.error;const g=await m.json(),y=(l=m.headers.get("x-total-count"))!==null&&l!==void 0?l:0,x=(d=(u=m.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&d!==void 0?d:[];return x.length>0&&(x.forEach(_=>{const k=parseInt(_.split(";")[0].split("=")[1].substring(0,1)),b=JSON.parse(_.split(";")[1].split("=")[1]);f[`${b}Page`]=k}),f.total=parseInt(y)),{data:Object.assign(Object.assign({},g),f),error:null}}catch(f){if(ve(f))return{data:{clients:[]},error:f};throw f}}async _createOAuthClient(e){try{return await _e(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(ve(n))return{data:null,error:n};throw n}}async _getOAuthClient(e){try{return await _e(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(ve(n))return{data:null,error:n};throw n}}async _updateOAuthClient(e,n){try{return await _e(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:n,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(ve(s))return{data:null,error:s};throw s}}async _deleteOAuthClient(e){try{return await _e(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(n){if(ve(n))return{data:null,error:n};throw n}}async _regenerateOAuthClientSecret(e){try{return await _e(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(ve(n))return{data:null,error:n};throw n}}}function Tg(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}const bi={debug:!!(globalThis&&zv()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Wv extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class ES extends Wv{}async function TS(t,e,n){bi.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),bi.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async r=>{if(r){bi.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,r.name);try{return await n()}finally{bi.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,r.name)}}else{if(e===0)throw bi.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new ES(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(bi.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}function NS(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Vv(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function AS(t){return parseInt(t,16)}function OS(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,s=>s.toString(16).padStart(2,"0")).join("")}function RS(t){var e;const{chainId:n,domain:s,expirationTime:r,issuedAt:a=new Date,nonce:l,notBefore:u,requestId:d,resources:f,scheme:m,uri:g,version:y}=t;{if(!Number.isInteger(n))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${n}`);if(!s)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(l&&l.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${l}`);if(!g)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(y!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${y}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const x=Vv(t.address),_=m?`${m}://${s}`:s,k=t.statement?`${t.statement}
`:"",b=`${_} wants you to sign in with your Ethereum account:
${x}

${k}`;let S=`URI: ${g}
Version: ${y}
Chain ID: ${n}${l?`
Nonce: ${l}`:""}
Issued At: ${a.toISOString()}`;if(r&&(S+=`
Expiration Time: ${r.toISOString()}`),u&&(S+=`
Not Before: ${u.toISOString()}`),d&&(S+=`
Request ID: ${d}`),f){let I=`
Resources:`;for(const C of f){if(!C||typeof C!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${C}`);I+=`
- ${C}`}S+=I}return`${b}
${S}`}class yt extends Error{constructor({message:e,code:n,cause:s,name:r}){var a;super(e,{cause:s}),this.__isWebAuthnError=!0,this.name=(a=r??(s instanceof Error?s.name:void 0))!==null&&a!==void 0?a:"Unknown Error",this.code=n}}class Zl extends yt{constructor(e,n){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n,message:e}),this.name="WebAuthnUnknownError",this.originalError=n}}function MS({error:t,options:e}){var n,s,r;const{publicKey:a}=e;if(!a)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new yt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((n=a.authenticatorSelection)===null||n===void 0?void 0:n.requireResidentKey)===!0)return new yt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(e.mediation==="conditional"&&((s=a.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new yt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((r=a.authenticatorSelection)===null||r===void 0?void 0:r.userVerification)==="required")return new yt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new yt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new yt({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return a.pubKeyCredParams.filter(u=>u.type==="public-key").length===0?new yt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new yt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const l=window.location.hostname;if(qv(l)){if(a.rp.id!==l)return new yt({message:`The RP ID "${a.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new yt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(a.user.id.byteLength<1||a.user.id.byteLength>64)return new yt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new yt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new yt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function LS({error:t,options:e}){const{publicKey:n}=e;if(!n)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new yt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new yt({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const s=window.location.hostname;if(qv(s)){if(n.rpId!==s)return new yt({message:`The RP ID "${n.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new yt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new yt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new yt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}class DS{createNewAbortSignal(){if(this.controller){const n=new Error("Cancelling existing WebAuthn API call for new one");n.name="AbortError",this.controller.abort(n)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const FS=new DS;function BS(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:e,user:n,excludeCredentials:s}=t,r=mc(t,["challenge","user","excludeCredentials"]),a=Ii(e).buffer,l=Object.assign(Object.assign({},n),{id:Ii(n.id).buffer}),u=Object.assign(Object.assign({},r),{challenge:a,user:l});if(s&&s.length>0){u.excludeCredentials=new Array(s.length);for(let d=0;d<s.length;d++){const f=s[d];u.excludeCredentials[d]=Object.assign(Object.assign({},f),{id:Ii(f.id).buffer,type:f.type||"public-key",transports:f.transports})}}return u}function $S(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:e,allowCredentials:n}=t,s=mc(t,["challenge","allowCredentials"]),r=Ii(e).buffer,a=Object.assign(Object.assign({},s),{challenge:r});if(n&&n.length>0){a.allowCredentials=new Array(n.length);for(let l=0;l<n.length;l++){const u=n[l];a.allowCredentials[l]=Object.assign(Object.assign({},u),{id:Ii(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return a}function zS(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const n=t;return{id:t.id,rawId:t.id,response:{attestationObject:Br(new Uint8Array(t.response.attestationObject)),clientDataJSON:Br(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(e=n.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function US(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const n=t,s=t.getClientExtensionResults(),r=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:Br(new Uint8Array(r.authenticatorData)),clientDataJSON:Br(new Uint8Array(r.clientDataJSON)),signature:Br(new Uint8Array(r.signature)),userHandle:r.userHandle?Br(new Uint8Array(r.userHandle)):void 0},type:"public-key",clientExtensionResults:s,authenticatorAttachment:(e=n.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function qv(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function Ng(){var t,e;return!!(Tt()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator?.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.get)=="function")}async function WS(t){try{const e=await navigator.credentials.create(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Zl("Browser returned unexpected credential type",e)}:{data:null,error:new Zl("Empty credential response",e)}}catch(e){return{data:null,error:MS({error:e,options:t})}}}async function VS(t){try{const e=await navigator.credentials.get(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Zl("Browser returned unexpected credential type",e)}:{data:null,error:new Zl("Empty credential response",e)}}catch(e){return{data:null,error:LS({error:e,options:t})}}}const qS={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},HS={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function ec(...t){const e=r=>r!==null&&typeof r=="object"&&!Array.isArray(r),n=r=>r instanceof ArrayBuffer||ArrayBuffer.isView(r),s={};for(const r of t)if(r)for(const a in r){const l=r[a];if(l!==void 0)if(Array.isArray(l))s[a]=l;else if(n(l))s[a]=l;else if(e(l)){const u=s[a];e(u)?s[a]=ec(u,l):s[a]=ec(l)}else s[a]=l}return s}function KS(t,e){return ec(qS,t,e||{})}function GS(t,e){return ec(HS,t,e||{})}class YS{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:n,friendlyName:s,signal:r},a){var l;try{const{data:u,error:d}=await this.client.mfa.challenge({factorId:e,webauthn:n});if(!u)return{data:null,error:d};const f=r??FS.createNewAbortSignal();if(u.webauthn.type==="create"){const{user:m}=u.webauthn.credential_options.publicKey;if(!m.name){const g=s;if(g)m.name=`${m.id}:${g}`;else{const x=(await this.client.getUser()).data.user,_=((l=x?.user_metadata)===null||l===void 0?void 0:l.name)||x?.email||x?.id||"User";m.name=`${m.id}:${_}`}}m.displayName||(m.displayName=m.name)}switch(u.webauthn.type){case"create":{const m=KS(u.webauthn.credential_options.publicKey,a?.create),{data:g,error:y}=await WS({publicKey:m,signal:f});return g?{data:{factorId:e,challengeId:u.id,webauthn:{type:u.webauthn.type,credential_response:g}},error:null}:{data:null,error:y}}case"request":{const m=GS(u.webauthn.credential_options.publicKey,a?.request),{data:g,error:y}=await VS(Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:m,signal:f}));return g?{data:{factorId:e,challengeId:u.id,webauthn:{type:u.webauthn.type,credential_response:g}},error:null}:{data:null,error:y}}}}catch(u){return ve(u)?{data:null,error:u}:{data:null,error:new Fr("Unexpected error in challenge",u)}}}async _verify({challengeId:e,factorId:n,webauthn:s}){return this.client.mfa.verify({factorId:n,challengeId:e,webauthn:s})}async _authenticate({factorId:e,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:r}={}},a){if(!n)return{data:null,error:new Ka("rpId is required for WebAuthn authentication")};try{if(!Ng())return{data:null,error:new Fr("Browser does not support WebAuthn",null)};const{data:l,error:u}=await this.challenge({factorId:e,webauthn:{rpId:n,rpOrigins:s},signal:r},{request:a});if(!l)return{data:null,error:u};const{webauthn:d}=l;return this._verify({factorId:e,challengeId:l.challengeId,webauthn:{type:d.type,rpId:n,rpOrigins:s,credential_response:d.credential_response}})}catch(l){return ve(l)?{data:null,error:l}:{data:null,error:new Fr("Unexpected error in authenticate",l)}}}async _register({friendlyName:e,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:r}={}},a){if(!n)return{data:null,error:new Ka("rpId is required for WebAuthn registration")};try{if(!Ng())return{data:null,error:new Fr("Browser does not support WebAuthn",null)};const{data:l,error:u}=await this._enroll({friendlyName:e});if(!l)return await this.client.mfa.listFactors().then(m=>{var g;return(g=m.data)===null||g===void 0?void 0:g.all.find(y=>y.factor_type==="webauthn"&&y.friendly_name===e&&y.status!=="unverified")}).then(m=>m?this.client.mfa.unenroll({factorId:m?.id}):void 0),{data:null,error:u};const{data:d,error:f}=await this._challenge({factorId:l.id,friendlyName:l.friendly_name,webauthn:{rpId:n,rpOrigins:s},signal:r},{create:a});return d?this._verify({factorId:l.id,challengeId:d.challengeId,webauthn:{rpId:n,rpOrigins:s,type:d.webauthn.type,credential_response:d.webauthn.credential_response}}):{data:null,error:f}}catch(l){return ve(l)?{data:null,error:l}:{data:null,error:new Fr("Unexpected error in register",l)}}}}NS();const JS={url:Hk,storageKey:Kk,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Gk,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function Ag(t,e,n){return await n()}const wi={};class Ga{get jwks(){var e,n;return(n=(e=wi[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(e){wi[this.storageKey]=Object.assign(Object.assign({},wi[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,n;return(n=(e=wi[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){wi[this.storageKey]=Object.assign(Object.assign({},wi[this.storageKey]),{cachedAt:e})}constructor(e){var n,s,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const a=Object.assign(Object.assign({},JS),e);if(this.storageKey=a.storageKey,this.instanceID=(n=Ga.nextInstanceID[this.storageKey])!==null&&n!==void 0?n:0,Ga.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.instanceID>0&&Tt()){const l=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(l),this.logDebugMessages&&console.trace(l)}if(this.persistSession=a.persistSession,this.autoRefreshToken=a.autoRefreshToken,this.admin=new IS({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=Uv(a.fetch),this.lock=a.lock||Ag,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,this.throwOnError=a.throwOnError,this.lockAcquireTimeout=a.lockAcquireTimeout,a.lock?this.lock=a.lock:this.persistSession&&Tt()&&(!((s=globalThis?.navigator)===null||s===void 0)&&s.locks)?this.lock=TS:this.lock=Ag,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new YS(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:zv()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Tg(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=Tg(this.memoryStorage)),Tt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l);try{await this._notifyAllSubscribers(l.data.event,l.data.session,!1)}catch(u){this._debug("#broadcastChannel","error",u)}})}this.initialize().catch(l=>{this._debug("#initialize()","error",l)})}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${Fv}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let n={},s="none";if(Tt()&&(n=lS(window.location.href),this._isImplicitGrantCallback(n)?s="implicit":await this._isPKCECallback(n)&&(s="pkce")),Tt()&&this.detectSessionInUrl&&s!=="none"){const{data:r,error:a}=await this._getSessionFromURL(n,s);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),Zk(a)){const d=(e=a.details)===null||e===void 0?void 0:e.code;if(d==="identity_already_exists"||d==="identity_not_found"||d==="single_identity_not_deletable")return{error:a}}return{error:a}}const{session:l,redirectType:u}=r;return this._debug("#_initialize()","detected session in URL",l,"redirect type",u),await this._saveSession(l),setTimeout(async()=>{u==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",l):await this._notifyAllSubscribers("SIGNED_IN",l)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return ve(n)?this._returnResult({error:n}):this._returnResult({error:new Fr("Unexpected error during initialization",n)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,s,r;try{const a=await _e(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(n=e?.options)===null||n===void 0?void 0:n.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(r=e?.options)===null||r===void 0?void 0:r.captchaToken}},xform:Ln}),{data:l,error:u}=a;if(u||!l)return this._returnResult({data:{user:null,session:null},error:u});const d=l.session,f=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",d)),this._returnResult({data:{user:f,session:d},error:null})}catch(a){if(ve(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signUp(e){var n,s,r;try{let a;if("email"in e){const{email:m,password:g,options:y}=e;let x=null,_=null;this.flowType==="pkce"&&([x,_]=await vi(this.storage,this.storageKey)),a=await _e(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:y?.emailRedirectTo,body:{email:m,password:g,data:(n=y?.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:y?.captchaToken},code_challenge:x,code_challenge_method:_},xform:Ln})}else if("phone"in e){const{phone:m,password:g,options:y}=e;a=await _e(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:m,password:g,data:(s=y?.data)!==null&&s!==void 0?s:{},channel:(r=y?.channel)!==null&&r!==void 0?r:"sms",gotrue_meta_security:{captcha_token:y?.captchaToken}},xform:Ln})}else throw new Cl("You must provide either an email or phone number and a password");const{data:l,error:u}=a;if(u||!l)return await Et(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:u});const d=l.session,f=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",d)),this._returnResult({data:{user:f,session:d},error:null})}catch(a){if(await Et(this.storage,`${this.storageKey}-code-verifier`),ve(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithPassword(e){try{let n;if("email"in e){const{email:a,password:l,options:u}=e;n=await _e(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:l,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:Ig})}else if("phone"in e){const{phone:a,password:l,options:u}=e;n=await _e(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:l,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:Ig})}else throw new Cl("You must provide either an email or phone number and a password");const{data:s,error:r}=n;if(r)return this._returnResult({data:{user:null,session:null},error:r});if(!s||!s.session||!s.user){const a=new yi;return this._returnResult({data:{user:null,session:null},error:a})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:r})}catch(n){if(ve(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithOAuth(e){var n,s,r,a;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(r=e.options)===null||r===void 0?void 0:r.queryParams,skipBrowserRedirect:(a=e.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:n}=e;switch(n){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}}async signInWithEthereum(e){var n,s,r,a,l,u,d,f,m,g,y;let x,_;if("message"in e)x=e.message,_=e.signature;else{const{chain:k,wallet:b,statement:S,options:I}=e;let C;if(Tt())if(typeof b=="object")C=b;else{const M=window;if("ethereum"in M&&typeof M.ethereum=="object"&&"request"in M.ethereum&&typeof M.ethereum.request=="function")C=M.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof b!="object"||!I?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");C=b}const T=new URL((n=I?.url)!==null&&n!==void 0?n:window.location.href),A=await C.request({method:"eth_requestAccounts"}).then(M=>M).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!A||A.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const z=Vv(A[0]);let E=(s=I?.signInWithEthereum)===null||s===void 0?void 0:s.chainId;if(!E){const M=await C.request({method:"eth_chainId"});E=AS(M)}const D={domain:T.host,address:z,statement:S,uri:T.href,version:"1",chainId:E,nonce:(r=I?.signInWithEthereum)===null||r===void 0?void 0:r.nonce,issuedAt:(l=(a=I?.signInWithEthereum)===null||a===void 0?void 0:a.issuedAt)!==null&&l!==void 0?l:new Date,expirationTime:(u=I?.signInWithEthereum)===null||u===void 0?void 0:u.expirationTime,notBefore:(d=I?.signInWithEthereum)===null||d===void 0?void 0:d.notBefore,requestId:(f=I?.signInWithEthereum)===null||f===void 0?void 0:f.requestId,resources:(m=I?.signInWithEthereum)===null||m===void 0?void 0:m.resources};x=RS(D),_=await C.request({method:"personal_sign",params:[OS(x),z]})}try{const{data:k,error:b}=await _e(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:x,signature:_},!((g=e.options)===null||g===void 0)&&g.captchaToken?{gotrue_meta_security:{captcha_token:(y=e.options)===null||y===void 0?void 0:y.captchaToken}}:null),xform:Ln});if(b)throw b;if(!k||!k.session||!k.user){const S=new yi;return this._returnResult({data:{user:null,session:null},error:S})}return k.session&&(await this._saveSession(k.session),await this._notifyAllSubscribers("SIGNED_IN",k.session)),this._returnResult({data:Object.assign({},k),error:b})}catch(k){if(ve(k))return this._returnResult({data:{user:null,session:null},error:k});throw k}}async signInWithSolana(e){var n,s,r,a,l,u,d,f,m,g,y,x;let _,k;if("message"in e)_=e.message,k=e.signature;else{const{chain:b,wallet:S,statement:I,options:C}=e;let T;if(Tt())if(typeof S=="object")T=S;else{const z=window;if("solana"in z&&typeof z.solana=="object"&&("signIn"in z.solana&&typeof z.solana.signIn=="function"||"signMessage"in z.solana&&typeof z.solana.signMessage=="function"))T=z.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof S!="object"||!C?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");T=S}const A=new URL((n=C?.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in T&&T.signIn){const z=await T.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},C?.signInWithSolana),{version:"1",domain:A.host,uri:A.href}),I?{statement:I}:null));let E;if(Array.isArray(z)&&z[0]&&typeof z[0]=="object")E=z[0];else if(z&&typeof z=="object"&&"signedMessage"in z&&"signature"in z)E=z;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in E&&"signature"in E&&(typeof E.signedMessage=="string"||E.signedMessage instanceof Uint8Array)&&E.signature instanceof Uint8Array)_=typeof E.signedMessage=="string"?E.signedMessage:new TextDecoder().decode(E.signedMessage),k=E.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in T)||typeof T.signMessage!="function"||!("publicKey"in T)||typeof T!="object"||!T.publicKey||!("toBase58"in T.publicKey)||typeof T.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");_=[`${A.host} wants you to sign in with your Solana account:`,T.publicKey.toBase58(),...I?["",I,""]:[""],"Version: 1",`URI: ${A.href}`,`Issued At: ${(r=(s=C?.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&r!==void 0?r:new Date().toISOString()}`,...!((a=C?.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${C.signInWithSolana.notBefore}`]:[],...!((l=C?.signInWithSolana)===null||l===void 0)&&l.expirationTime?[`Expiration Time: ${C.signInWithSolana.expirationTime}`]:[],...!((u=C?.signInWithSolana)===null||u===void 0)&&u.chainId?[`Chain ID: ${C.signInWithSolana.chainId}`]:[],...!((d=C?.signInWithSolana)===null||d===void 0)&&d.nonce?[`Nonce: ${C.signInWithSolana.nonce}`]:[],...!((f=C?.signInWithSolana)===null||f===void 0)&&f.requestId?[`Request ID: ${C.signInWithSolana.requestId}`]:[],...!((g=(m=C?.signInWithSolana)===null||m===void 0?void 0:m.resources)===null||g===void 0)&&g.length?["Resources",...C.signInWithSolana.resources.map(E=>`- ${E}`)]:[]].join(`
`);const z=await T.signMessage(new TextEncoder().encode(_),"utf8");if(!z||!(z instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");k=z}}try{const{data:b,error:S}=await _e(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:_,signature:Br(k)},!((y=e.options)===null||y===void 0)&&y.captchaToken?{gotrue_meta_security:{captcha_token:(x=e.options)===null||x===void 0?void 0:x.captchaToken}}:null),xform:Ln});if(S)throw S;if(!b||!b.session||!b.user){const I=new yi;return this._returnResult({data:{user:null,session:null},error:I})}return b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("SIGNED_IN",b.session)),this._returnResult({data:Object.assign({},b),error:S})}catch(b){if(ve(b))return this._returnResult({data:{user:null,session:null},error:b});throw b}}async _exchangeCodeForSession(e){const n=await Er(this.storage,`${this.storageKey}-code-verifier`),[s,r]=(n??"").split("/");try{if(!s&&this.flowType==="pkce")throw new eS;const{data:a,error:l}=await _e(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:Ln});if(await Et(this.storage,`${this.storageKey}-code-verifier`),l)throw l;if(!a||!a.session||!a.user){const u=new yi;return this._returnResult({data:{user:null,session:null,redirectType:null},error:u})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign(Object.assign({},a),{redirectType:r??null}),error:l})}catch(a){if(await Et(this.storage,`${this.storageKey}-code-verifier`),ve(a))return this._returnResult({data:{user:null,session:null,redirectType:null},error:a});throw a}}async signInWithIdToken(e){try{const{options:n,provider:s,token:r,access_token:a,nonce:l}=e,u=await _e(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:r,access_token:a,nonce:l,gotrue_meta_security:{captcha_token:n?.captchaToken}},xform:Ln}),{data:d,error:f}=u;if(f)return this._returnResult({data:{user:null,session:null},error:f});if(!d||!d.session||!d.user){const m=new yi;return this._returnResult({data:{user:null,session:null},error:m})}return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),this._returnResult({data:d,error:f})}catch(n){if(ve(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithOtp(e){var n,s,r,a,l;try{if("email"in e){const{email:u,options:d}=e;let f=null,m=null;this.flowType==="pkce"&&([f,m]=await vi(this.storage,this.storageKey));const{error:g}=await _e(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:u,data:(n=d?.data)!==null&&n!==void 0?n:{},create_user:(s=d?.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:d?.captchaToken},code_challenge:f,code_challenge_method:m},redirectTo:d?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:g})}if("phone"in e){const{phone:u,options:d}=e,{data:f,error:m}=await _e(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:u,data:(r=d?.data)!==null&&r!==void 0?r:{},create_user:(a=d?.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:d?.captchaToken},channel:(l=d?.channel)!==null&&l!==void 0?l:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:f?.message_id},error:m})}throw new Cl("You must provide either an email or phone number.")}catch(u){if(await Et(this.storage,`${this.storageKey}-code-verifier`),ve(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}}async verifyOtp(e){var n,s;try{let r,a;"options"in e&&(r=(n=e.options)===null||n===void 0?void 0:n.redirectTo,a=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:l,error:u}=await _e(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:r,xform:Ln});if(u)throw u;if(!l)throw new Error("An error occurred on token verification.");const d=l.session,f=l.user;return d?.access_token&&(await this._saveSession(d),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",d)),this._returnResult({data:{user:f,session:d},error:null})}catch(r){if(ve(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithSSO(e){var n,s,r,a,l;try{let u=null,d=null;this.flowType==="pkce"&&([u,d]=await vi(this.storage,this.storageKey));const f=await _e(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&s!==void 0?s:void 0}),!((r=e?.options)===null||r===void 0)&&r.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:u,code_challenge_method:d}),headers:this.headers,xform:jS});return!((a=f.data)===null||a===void 0)&&a.url&&Tt()&&!(!((l=e.options)===null||l===void 0)&&l.skipBrowserRedirect)&&window.location.assign(f.data.url),this._returnResult(f)}catch(u){if(await Et(this.storage,`${this.storageKey}-code-verifier`),ve(u))return this._returnResult({data:null,error:u});throw u}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:s}=e;if(s)throw s;if(!n)throw new dn;const{error:r}=await _e(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return this._returnResult({data:{user:null,session:null},error:r})})}catch(e){if(ve(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:s,type:r,options:a}=e,{error:l}=await _e(this.fetch,"POST",n,{headers:this.headers,body:{email:s,type:r,gotrue_meta_security:{captcha_token:a?.captchaToken}},redirectTo:a?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:l})}else if("phone"in e){const{phone:s,type:r,options:a}=e,{data:l,error:u}=await _e(this.fetch,"POST",n,{headers:this.headers,body:{phone:s,type:r,gotrue_meta_security:{captcha_token:a?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:l?.message_id},error:u})}throw new Cl("You must provide either an email or phone number and a type")}catch(n){if(ve(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await s,await n()))();return this.pendingInLock.push((async()=>{try{await r}catch{}})()),r}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=n();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const r=[...this.pendingInLock];await Promise.all(r),this.pendingInLock.splice(0,r.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await Er(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<wd:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.userStorage){const l=await Er(this.userStorage,this.storageKey+"-user");l?.user?e.user=l.user:e.user=Sd()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const l={value:this.suppressGetSessionWarning};e.user=wS(e.user,l),l.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:r,error:a}=await this._callRefreshToken(e.refresh_token);return a?this._returnResult({data:{session:null},error:a}):this._returnResult({data:{session:r},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const n=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return n.data.user&&(this.suppressGetSessionWarning=!0),n}async _getUser(e){try{return e?await _e(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:er}):await this._useSession(async n=>{var s,r,a;const{data:l,error:u}=n;if(u)throw u;return!(!((s=l.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new dn}:await _e(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(r=l.session)===null||r===void 0?void 0:r.access_token)!==null&&a!==void 0?a:void 0,xform:er})})}catch(n){if(ve(n))return _d(n)&&(await this._removeSession(),await Et(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:n});throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async s=>{const{data:r,error:a}=s;if(a)throw a;if(!r.session)throw new dn;const l=r.session;let u=null,d=null;this.flowType==="pkce"&&e.email!=null&&([u,d]=await vi(this.storage,this.storageKey));const{data:f,error:m}=await _e(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:u,code_challenge_method:d}),jwt:l.access_token,xform:er});if(m)throw m;return l.user=f.user,await this._saveSession(l),await this._notifyAllSubscribers("USER_UPDATED",l),this._returnResult({data:{user:l.user},error:null})})}catch(s){if(await Et(this.storage,`${this.storageKey}-code-verifier`),ve(s))return this._returnResult({data:{user:null},error:s});throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new dn;const n=Date.now()/1e3;let s=n,r=!0,a=null;const{payload:l}=Il(e.access_token);if(l.exp&&(s=l.exp,r=s<=n),r){const{data:u,error:d}=await this._callRefreshToken(e.refresh_token);if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!u)return{data:{user:null,session:null},error:null};a=u}else{const{data:u,error:d}=await this._getUser(e.access_token);if(d)return this._returnResult({data:{user:null,session:null},error:d});a={access_token:e.access_token,refresh_token:e.refresh_token,user:u.user,token_type:"bearer",expires_in:s-n,expires_at:s},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return this._returnResult({data:{user:a.user,session:a},error:null})}catch(n){if(ve(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var s;if(!e){const{data:l,error:u}=n;if(u)throw u;e=(s=l.session)!==null&&s!==void 0?s:void 0}if(!e?.refresh_token)throw new dn;const{data:r,error:a}=await this._callRefreshToken(e.refresh_token);return a?this._returnResult({data:{user:null,session:null},error:a}):r?this._returnResult({data:{user:r.user,session:r},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(n){if(ve(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async _getSessionFromURL(e,n){try{if(!Tt())throw new Pl("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Pl(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new wg("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Pl("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new wg("No code detected.");const{data:I,error:C}=await this._exchangeCodeForSession(e.code);if(C)throw C;const T=new URL(window.location.href);return T.searchParams.delete("code"),window.history.replaceState(window.history.state,"",T.toString()),{data:{session:I.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:r,access_token:a,refresh_token:l,expires_in:u,expires_at:d,token_type:f}=e;if(!a||!u||!l||!f)throw new Pl("No session defined in URL");const m=Math.round(Date.now()/1e3),g=parseInt(u);let y=m+g;d&&(y=parseInt(d));const x=y-m;x*1e3<=ji&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${x}s, should have been closer to ${g}s`);const _=y-g;m-_>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",_,y,m):m-_<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",_,y,m);const{data:k,error:b}=await this._getUser(a);if(b)throw b;const S={provider_token:s,provider_refresh_token:r,access_token:a,expires_in:g,expires_at:y,refresh_token:l,token_type:f,user:k.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:S,redirectType:e.type},error:null})}catch(s){if(ve(s))return this._returnResult({data:{session:null,redirectType:null},error:s});throw s}}_isImplicitGrantCallback(e){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){const n=await Er(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var s;const{data:r,error:a}=n;if(a&&!_d(a))return this._returnResult({error:a});const l=(s=r.session)===null||s===void 0?void 0:s.access_token;if(l){const{error:u}=await this.admin.signOut(l,e);if(u&&!(Qk(u)&&(u.status===404||u.status===401||u.status===403)||_d(u)))return this._returnResult({error:u})}return e!=="others"&&(await this._removeSession(),await Et(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const n=oS(),s={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,s),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async n=>{var s,r;try{const{data:{session:a},error:l}=n;if(l)throw l;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",e,"session",a)}catch(a){await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",a),console.error(a)}})}async resetPasswordForEmail(e,n={}){let s=null,r=null;this.flowType==="pkce"&&([s,r]=await vi(this.storage,this.storageKey,!0));try{return await _e(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:r,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(a){if(await Et(this.storage,`${this.storageKey}-code-verifier`),ve(a))return this._returnResult({data:null,error:a});throw a}}async getUserIdentities(){var e;try{const{data:n,error:s}=await this.getUser();if(s)throw s;return this._returnResult({data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(n){if(ve(n))return this._returnResult({data:null,error:n});throw n}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var n;try{const{data:s,error:r}=await this._useSession(async a=>{var l,u,d,f,m;const{data:g,error:y}=a;if(y)throw y;const x=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(l=e.options)===null||l===void 0?void 0:l.redirectTo,scopes:(u=e.options)===null||u===void 0?void 0:u.scopes,queryParams:(d=e.options)===null||d===void 0?void 0:d.queryParams,skipBrowserRedirect:!0});return await _e(this.fetch,"GET",x,{headers:this.headers,jwt:(m=(f=g.session)===null||f===void 0?void 0:f.access_token)!==null&&m!==void 0?m:void 0})});if(r)throw r;return Tt()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(s?.url),this._returnResult({data:{provider:e.provider,url:s?.url},error:null})}catch(s){if(ve(s))return this._returnResult({data:{provider:e.provider,url:null},error:s});throw s}}async linkIdentityIdToken(e){return await this._useSession(async n=>{var s;try{const{error:r,data:{session:a}}=n;if(r)throw r;const{options:l,provider:u,token:d,access_token:f,nonce:m}=e,g=await _e(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(s=a?.access_token)!==null&&s!==void 0?s:void 0,body:{provider:u,id_token:d,access_token:f,nonce:m,link_identity:!0,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:Ln}),{data:y,error:x}=g;return x?this._returnResult({data:{user:null,session:null},error:x}):!y||!y.session||!y.user?this._returnResult({data:{user:null,session:null},error:new yi}):(y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("USER_UPDATED",y.session)),this._returnResult({data:y,error:x}))}catch(r){if(await Et(this.storage,`${this.storageKey}-code-verifier`),ve(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}})}async unlinkIdentity(e){try{return await this._useSession(async n=>{var s,r;const{data:a,error:l}=n;if(l)throw l;return await _e(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(r=(s=a.session)===null||s===void 0?void 0:s.access_token)!==null&&r!==void 0?r:void 0})})}catch(n){if(ve(n))return this._returnResult({data:null,error:n});throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const s=Date.now();return await dS(async r=>(r>0&&await uS(200*Math.pow(2,r-1)),this._debug(n,"refreshing attempt",r),await _e(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Ln})),(r,a)=>{const l=200*Math.pow(2,r);return a&&kd(a)&&Date.now()+l-s<ji})}catch(s){if(this._debug(n,"error",s),ve(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",s),Tt()&&!n.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,n;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const r=await Er(this.storage,this.storageKey);if(r&&this.userStorage){let l=await Er(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!l&&(l={user:r.user},await Ci(this.userStorage,this.storageKey+"-user",l)),r.user=(e=l?.user)!==null&&e!==void 0?e:Sd()}else if(r&&!r.user&&!r.user){const l=await Er(this.storage,this.storageKey+"-user");l&&l?.user?(r.user=l.user,await Et(this.storage,this.storageKey+"-user"),await Ci(this.storage,this.storageKey,r)):r.user=Sd()}if(this._debug(s,"session from storage",r),!this._isValidSession(r)){this._debug(s,"session is not valid"),r!==null&&await this._removeSession();return}const a=((n=r.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<wd;if(this._debug(s,`session has${a?"":" not"} expired with margin of ${wd}s`),a){if(this.autoRefreshToken&&r.refresh_token){const{error:l}=await this._callRefreshToken(r.refresh_token);l&&(console.error(l),kd(l)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",l),await this._removeSession()))}}else if(r.user&&r.user.__isUserNotAvailableProxy===!0)try{const{data:l,error:u}=await this._getUser(r.access_token);!u&&l?.user?(r.user=l.user,await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(l){console.error("Error getting user data:",l),this._debug(s,"error getting user data, skipping SIGNED_IN notification",l)}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(s,"error",r),console.error(r);return}finally{this._debug(s,"end")}}async _callRefreshToken(e){var n,s;if(!e)throw new dn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new vc;const{data:a,error:l}=await this._refreshAccessToken(e);if(l)throw l;if(!a.session)throw new dn;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const u={data:a.session,error:null};return this.refreshingDeferred.resolve(u),u}catch(a){if(this._debug(r,"error",a),ve(a)){const l={data:null,error:a};return kd(a)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(l),l}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(a),a}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,n,s=!0){const r=`#_notifyAllSubscribers(${e})`;this._debug(r,"begin",n,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:n});const a=[],l=Array.from(this.stateChangeEmitters.values()).map(async u=>{try{await u.callback(e,n)}catch(d){a.push(d)}});if(await Promise.all(l),a.length>0){for(let u=0;u<a.length;u+=1)console.error(a[u]);throw a[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await Et(this.storage,`${this.storageKey}-code-verifier`);const n=Object.assign({},e),s=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&n.user&&await Ci(this.userStorage,this.storageKey+"-user",{user:n.user});const r=Object.assign({},n);delete r.user;const a=Cg(r);await Ci(this.storage,this.storageKey,a)}else{const r=Cg(n);await Ci(this.storage,this.storageKey,r)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await Et(this.storage,this.storageKey),await Et(this.storage,this.storageKey+"-code-verifier"),await Et(this.storage,this.storageKey+"-user"),this.userStorage&&await Et(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Tt()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),ji);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e);const n=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=n,n&&typeof n=="object"&&typeof n.unref=="function"?n.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(n)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e);const n=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,n&&clearTimeout(n)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:s}}=n;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const r=Math.floor((s.expires_at*1e3-e)/ji);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts ${ji}ms, refresh threshold is ${fh} ticks`),r<=fh&&await this._callRefreshToken(s.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Wv)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Tt()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>{try{await this._onVisibilityChanged(!1)}catch(e){this._debug("#visibilityChangedCallback","error",e)}},window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,s){const r=[`provider=${encodeURIComponent(n)}`];if(s?.redirectTo&&r.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s?.scopes&&r.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[a,l]=await vi(this.storage,this.storageKey),u=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(l)}`});r.push(u.toString())}if(s?.queryParams){const a=new URLSearchParams(s.queryParams);r.push(a.toString())}return s?.skipBrowserRedirect&&r.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${r.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var s;const{data:r,error:a}=n;return a?this._returnResult({data:null,error:a}):await _e(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=r?.session)===null||s===void 0?void 0:s.access_token})})}catch(n){if(ve(n))return this._returnResult({data:null,error:n});throw n}}async _enroll(e){try{return await this._useSession(async n=>{var s,r;const{data:a,error:l}=n;if(l)return this._returnResult({data:null,error:l});const u=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:d,error:f}=await _e(this.fetch,"POST",`${this.url}/factors`,{body:u,headers:this.headers,jwt:(s=a?.session)===null||s===void 0?void 0:s.access_token});return f?this._returnResult({data:null,error:f}):(e.factorType==="totp"&&d.type==="totp"&&(!((r=d?.totp)===null||r===void 0)&&r.qr_code)&&(d.totp.qr_code=`data:image/svg+xml;utf-8,${d.totp.qr_code}`),this._returnResult({data:d,error:null}))})}catch(n){if(ve(n))return this._returnResult({data:null,error:n});throw n}}async _verify(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async n=>{var s;const{data:r,error:a}=n;if(a)return this._returnResult({data:null,error:a});const l=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?zS(e.webauthn.credential_response):US(e.webauthn.credential_response)})}:{code:e.code}),{data:u,error:d}=await _e(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:l,headers:this.headers,jwt:(s=r?.session)===null||s===void 0?void 0:s.access_token});return d?this._returnResult({data:null,error:d}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+u.expires_in},u)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",u),this._returnResult({data:u,error:d}))})}catch(n){if(ve(n))return this._returnResult({data:null,error:n});throw n}})}async _challenge(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async n=>{var s;const{data:r,error:a}=n;if(a)return this._returnResult({data:null,error:a});const l=await _e(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(s=r?.session)===null||s===void 0?void 0:s.access_token});if(l.error)return l;const{data:u}=l;if(u.type!=="webauthn")return{data:u,error:null};switch(u.webauthn.type){case"create":return{data:Object.assign(Object.assign({},u),{webauthn:Object.assign(Object.assign({},u.webauthn),{credential_options:Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:BS(u.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},u),{webauthn:Object.assign(Object.assign({},u.webauthn),{credential_options:Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:$S(u.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(n){if(ve(n))return this._returnResult({data:null,error:n});throw n}})}async _challengeAndVerify(e){const{data:n,error:s}=await this._challenge({factorId:e.factorId});return s?this._returnResult({data:null,error:s}):await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){var e;const{data:{user:n},error:s}=await this.getUser();if(s)return{data:null,error:s};const r={all:[],phone:[],totp:[],webauthn:[]};for(const a of(e=n?.factors)!==null&&e!==void 0?e:[])r.all.push(a),a.status==="verified"&&r[a.factor_type].push(a);return{data:r,error:null}}async _getAuthenticatorAssuranceLevel(e){var n,s,r,a;if(e)try{const{payload:x}=Il(e);let _=null;x.aal&&(_=x.aal);let k=_;const{data:{user:b},error:S}=await this.getUser(e);if(S)return this._returnResult({data:null,error:S});((s=(n=b?.factors)===null||n===void 0?void 0:n.filter(T=>T.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(k="aal2");const C=x.amr||[];return{data:{currentLevel:_,nextLevel:k,currentAuthenticationMethods:C},error:null}}catch(x){if(ve(x))return this._returnResult({data:null,error:x});throw x}const{data:{session:l},error:u}=await this.getSession();if(u)return this._returnResult({data:null,error:u});if(!l)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:d}=Il(l.access_token);let f=null;d.aal&&(f=d.aal);let m=f;((a=(r=l.user.factors)===null||r===void 0?void 0:r.filter(x=>x.status==="verified"))!==null&&a!==void 0?a:[]).length>0&&(m="aal2");const y=d.amr||[];return{data:{currentLevel:f,nextLevel:m,currentAuthenticationMethods:y},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async n=>{const{data:{session:s},error:r}=n;return r?this._returnResult({data:null,error:r}):s?await _e(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:s.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new dn})})}catch(n){if(ve(n))return this._returnResult({data:null,error:n});throw n}}async _approveAuthorization(e,n){try{return await this._useSession(async s=>{const{data:{session:r},error:a}=s;if(a)return this._returnResult({data:null,error:a});if(!r)return this._returnResult({data:null,error:new dn});const l=await _e(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:r.access_token,body:{action:"approve"},xform:u=>({data:u,error:null})});return l.data&&l.data.redirect_url&&Tt()&&!n?.skipBrowserRedirect&&window.location.assign(l.data.redirect_url),l})}catch(s){if(ve(s))return this._returnResult({data:null,error:s});throw s}}async _denyAuthorization(e,n){try{return await this._useSession(async s=>{const{data:{session:r},error:a}=s;if(a)return this._returnResult({data:null,error:a});if(!r)return this._returnResult({data:null,error:new dn});const l=await _e(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:r.access_token,body:{action:"deny"},xform:u=>({data:u,error:null})});return l.data&&l.data.redirect_url&&Tt()&&!n?.skipBrowserRedirect&&window.location.assign(l.data.redirect_url),l})}catch(s){if(ve(s))return this._returnResult({data:null,error:s});throw s}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:n},error:s}=e;return s?this._returnResult({data:null,error:s}):n?await _e(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,xform:r=>({data:r,error:null})}):this._returnResult({data:null,error:new dn})})}catch(e){if(ve(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async n=>{const{data:{session:s},error:r}=n;return r?this._returnResult({data:null,error:r}):s?(await _e(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:s.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new dn})})}catch(n){if(ve(n))return this._returnResult({data:null,error:n});throw n}}async fetchJwk(e,n={keys:[]}){let s=n.keys.find(u=>u.kid===e);if(s)return s;const r=Date.now();if(s=this.jwks.keys.find(u=>u.kid===e),s&&this.jwks_cached_at+Jk>r)return s;const{data:a,error:l}=await _e(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(l)throw l;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=r,s=a.keys.find(u=>u.kid===e),!s)?null:s}async getClaims(e,n={}){try{let s=e;if(!s){const{data:x,error:_}=await this.getSession();if(_||!x.session)return this._returnResult({data:null,error:_});s=x.session.access_token}const{header:r,payload:a,signature:l,raw:{header:u,payload:d}}=Il(s);n?.allowExpired||vS(a.exp);const f=!r.alg||r.alg.startsWith("HS")||!r.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(r.kid,n?.keys?{keys:n.keys}:n?.jwks);if(!f){const{error:x}=await this.getUser(s);if(x)throw x;return{data:{claims:a,header:r,signature:l},error:null}}const m=xS(r.alg),g=await crypto.subtle.importKey("jwk",f,m,!0,["verify"]);if(!await crypto.subtle.verify(m,g,l,iS(`${u}.${d}`)))throw new gh("Invalid JWT signature");return{data:{claims:a,header:r,signature:l},error:null}}catch(s){if(ve(s))return this._returnResult({data:null,error:s});throw s}}}Ga.nextInstanceID={};const XS=Ga,QS="2.95.3";let Ia="";typeof Deno<"u"?Ia="deno":typeof document<"u"?Ia="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ia="react-native":Ia="node";const ZS={"X-Client-Info":`supabase-js-${Ia}/${QS}`},ej={headers:ZS},tj={schema:"public"},nj={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},sj={};function Ya(t){"@babel/helpers - typeof";return Ya=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ya(t)}function rj(t,e){if(Ya(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(Ya(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ij(t){var e=rj(t,"string");return Ya(e)=="symbol"?e:e+""}function aj(t,e,n){return(e=ij(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Og(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function lt(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Og(Object(n),!0).forEach(function(s){aj(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Og(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}const oj=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),lj=()=>Headers,cj=(t,e,n)=>{const s=oj(n),r=lj();return async(a,l)=>{var u;const d=(u=await e())!==null&&u!==void 0?u:t;let f=new r(l?.headers);return f.has("apikey")||f.set("apikey",t),f.has("Authorization")||f.set("Authorization",`Bearer ${d}`),s(a,lt(lt({},l),{},{headers:f}))}};function uj(t){return t.endsWith("/")?t:t+"/"}function dj(t,e){var n,s;const{db:r,auth:a,realtime:l,global:u}=t,{db:d,auth:f,realtime:m,global:g}=e,y={db:lt(lt({},d),r),auth:lt(lt({},f),a),realtime:lt(lt({},m),l),storage:{},global:lt(lt(lt({},g),u),{},{headers:lt(lt({},(n=g?.headers)!==null&&n!==void 0?n:{}),(s=u?.headers)!==null&&s!==void 0?s:{})}),accessToken:async()=>""};return t.accessToken?y.accessToken=t.accessToken:delete y.accessToken,y}function hj(t){const e=t?.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(uj(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var fj=class extends XS{constructor(t){super(t)}},pj=class{constructor(t,e,n){var s,r;this.supabaseUrl=t,this.supabaseKey=e;const a=hj(t);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",a),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",a),this.storageUrl=new URL("storage/v1",a),this.functionsUrl=new URL("functions/v1",a);const l=`sb-${a.hostname.split(".")[0]}-auth-token`,u={db:tj,realtime:sj,auth:lt(lt({},nj),{},{storageKey:l}),global:ej},d=dj(n??{},u);if(this.storageKey=(s=d.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(r=d.global.headers)!==null&&r!==void 0?r:{},d.accessToken)this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(m,g)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(g)} is not possible`)}});else{var f;this.auth=this._initSupabaseAuthClient((f=d.auth)!==null&&f!==void 0?f:{},this.headers,d.global.fetch)}this.fetch=cj(e,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(lt({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(m=>this.realtime.setAuth(m)).catch(m=>console.warn("Failed to set initial Realtime auth token:",m)),this.rest=new Q_(new URL("rest/v1",a).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch,timeout:d.db.timeout,urlLengthLimit:d.db.urlLengthLimit}),this.storage=new qk(this.storageUrl.href,this.headers,this.fetch,n?.storage),d.accessToken||this._listenForAuthEvents()}get functions(){return new V_(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,e={},n={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,e,n)}channel(t,e={config:{}}){return this.realtime.channel(t,e)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t=this,e,n;if(t.accessToken)return await t.accessToken();const{data:s}=await t.auth.getSession();return(e=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&e!==void 0?e:t.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:e,detectSessionInUrl:n,storage:s,userStorage:r,storageKey:a,flowType:l,lock:u,debug:d,throwOnError:f},m,g){const y={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new fj({url:this.authUrl.href,headers:lt(lt({},y),m),storageKey:a,autoRefreshToken:t,persistSession:e,detectSessionInUrl:n,storage:s,userStorage:r,flowType:l,lock:u,debug:d,throwOnError:f,fetch:g,hasCustomAuthorizationHeader:Object.keys(this.headers).some(x=>x.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new mk(this.realtimeUrl.href,lt(lt({},t),{},{params:lt(lt({},{apikey:this.supabaseKey}),t?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,e)=>{this._handleTokenChanged(t,"CLIENT",e?.access_token)})}_handleTokenChanged(t,e,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?(this.changedAccessToken=n,this.realtime.setAuth(n)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const mj=(t,e,n)=>new pj(t,e,n);function gj(){if(typeof window<"u")return!1;const t=globalThis.process;if(!t)return!1;const e=t.version;if(e==null)return!1;const n=e.match(/^v(\d+)\./);return n?parseInt(n[1],10)<=18:!1}gj()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const yj="https://vpbokueczoylouivgnin.supabase.co",vj="sb_publishable_qnne91NTAXswisfSQlObFg_NnwBiV9d",G=mj(yj,vj);async function xj({email:t,password:e}){const{data:n,error:s}=await G.auth.signInWithPassword({email:t,password:e});if(s)throw s;return n}async function bj({email:t,password:e,fullName:n,companyName:s,countryCode:r,invitationId:a}){const{data:l,error:u}=await G.auth.signUp({email:t,password:e,options:{data:{full_name:n,company_name:s,country_code:r,invitation_id:a||null}}});if(u)throw u;return l}async function wj(){const{error:t}=await G.auth.signOut();if(t)throw t}async function _j(){const{data:t,error:e}=await G.auth.getSession();if(e)throw e;return t.session}async function kj(t){const{data:e}=G.auth.onAuthStateChange((n,s)=>{t(s)});return e.subscription}async function Sj(t){const{data:e,error:n}=await G.from("usersToAccounts").select('accountId, accounts(id, name, "createdById", "billingStatus", "trialEndsAt", "subscriptionCurrentPeriodEnd")').eq("userId",t).order("accountId",{ascending:!0});if(n)throw n;return(e??[]).map(s=>({accountId:s.accountId,accountName:s.accounts?.name??"",isOriginalAccount:s.accounts?.createdById===t,billingStatus:s.accounts?.billingStatus??"trialing",trialEndsAt:s.accounts?.trialEndsAt??null,subscriptionCurrentPeriodEnd:s.accounts?.subscriptionCurrentPeriodEnd??null}))}async function jj(t){const{data:e,error:n}=await G.from("accounts").select('id, name, email, phone, address, "reportRetentionDays", "createdById"').eq("id",t).single();if(n)throw n;return e}async function Cj(t,e){const{data:n,error:s}=await G.from("accounts").update(e).eq("id",t).select('id, name, email, phone, address, "reportRetentionDays", "createdById"').single();if(s)throw s;return n}const Hv=j.createContext(null);function Pj({children:t}){const[e,n]=j.useState(null),[s,r]=j.useState(null),[a,l]=j.useState([]),[u,d]=j.useState(!0);j.useEffect(()=>{let x=!0;async function _(){const b=await _j();x&&(n(b),b?.user?.id&&await f(b.user.id,x),d(!1))}_().catch(()=>{x&&d(!1)});let k;return kj(async b=>{n(b),b?.user?.id?await f(b.user.id,!0):(r(null),l([]),localStorage.removeItem("activeAccountId")),d(!1)}).then(b=>{k=b}),()=>{x=!1,k?.unsubscribe()}},[]);async function f(x,_=!0){const k=await Sj(x);if(!_)return;l(k);const b=localStorage.getItem("activeAccountId"),S=b?Number(b):null,I=k.find(C=>C.accountId===S)??k[0]??null;r(I),I?.accountId?localStorage.setItem("activeAccountId",String(I.accountId)):localStorage.removeItem("activeAccountId")}const m=x=>{const _=Number(x),k=a.find(b=>b.accountId===_)??null;k&&(r(k),localStorage.setItem("activeAccountId",String(k.accountId)))},g=async()=>{e?.user?.id&&await f(e.user.id,!0)},y=j.useMemo(()=>({session:e,user:e?.user??null,account:s,accounts:a,isLoading:u,switchAccount:m,refreshAccounts:g,login:xj,register:bj,logout:wj}),[e,s,a,u]);return c.jsx(Hv.Provider,{value:y,children:t})}function Oe(){const t=j.useContext(Hv);if(!t)throw new Error("useAuth must be used inside AuthProvider");return t}const Ij={es:{common:{appName:"Financiera",account:"Cuenta",loading:"Cargando...",save:"Guardar",cancel:"Cancelar",logout:"Cerrar sesin",language:"Idioma",searchPlaceholder:"Buscar",workspace:"Workspace",create:"Crear",update:"Actualizar",delete:"Eliminar",edit:"Editar",backToList:"Volver al listado",actions:"Acciones",name:"Nombre",phone:"Telfono",email:"Correo",address:"Direccin",type:"Tipo",yes:"S",no:"No",empty:"Sin registros",previous:"Anterior",next:"Siguiente",page:"Pgina",of:"de",more:"Ms",expand:"Expandir men",collapse:"Colapsar men",clearFilters:"Limpiar filtros",requiredFields:"Completa los campos obligatorios.",searching:"Buscando...",searchTypeToStart:"Escribe al menos 2 caracteres para buscar",searchNoResults:"No hay resultados",genericLoadError:"No fue posible cargar los datos",genericSaveError:"No fue posible guardar los cambios"},topbar:{apps:"Aplicaciones",theme:"Cambiar tema",notifications:"Notificaciones",userMenu:"Men de usuario",noNotifications:"Sin notificaciones",pendingInvitations:"Tienes invitaciones pendientes de aceptar",goToInvitations:"Ir a invitaciones",account:"Cuenta",currentAccount:"Cuenta actual",manageAccount:"Gestionar cuenta",textSize:"Tamao de letra",density:"Espaciado",small:"Pequeo",medium:"Mediano",large:"Grande",compact:"Compacto",comfortable:"Confortable"},onboarding:{welcomeTitle:"Bienvenido al mdulo",welcomeDescription:"Te mostraremos rpidamente dnde est cada men en",start:"Comenzar gua",skip:"Omitir",finish:"Finalizar",sidebarTitle:"Men principal",sidebarText:"Aqu cambias entre grupos principales del sistema.",appMenuTitle:"Men del mdulo",appMenuText:"Aqu navegas las opciones especficas del mdulo.",actionsMenuTitle:"Acciones rpidas",actionsMenuText:"Aqu tienes acciones como crear y refrescar.",tableTitle:"Tabla del mdulo",tableText:"La tabla muestra los ltimos registros incluidos en este mdulo.",workspaceTitle:"rea de trabajo",workspaceText:"Aqu se muestra el listado, formulario o reporte del mdulo.",accountSwitchTitle:"Cambio de cuenta",accountSwitchText:"Desde aqu puedes cambiar entre cuentas con acceso.",userMenuTitle:"Men de usuario",userMenuText:"Aqu encontrars configuracin, preferencias y cierre de sesin."},sidebar:{expand:"Expandir men",collapse:"Colapsar men",core:"General",concepts:"Conceptos",transactions:"Transacciones",security:"Seguridad"},actions:{refresh:"Refrescar",newPerson:"Nuevo cliente/proveedor",newClient:"Nuevo cliente",newProvider:"Nuevo proveedor",newEmployee:"Nuevo empleado",newConcept:"Nuevo concepto",newProduct:"Nuevo producto",newIncomeConcept:"Nuevo concepto de ingreso",newExpenseConcept:"Nuevo concepto de gasto",newConceptGroup:"Nuevo grupo",newSale:"Nueva venta",newPurchase:"Nueva compra",newExpense:"Nuevo gasto",newIncome:"Nuevo ingreso",newOutgoingPayment:"Nuevo pago saliente",newIncomingPayment:"Nuevo pago entrante",newPaymentForm:"Nueva cuenta/tarjeta",newBankDeposit:"Nuevo depsito",newBankTransfer:"Nuevo traslado",newInternalObligation:"Nueva obligacin interna",newPayableConcept:"Nuevo concepto de cuentas por pagar",newProject:"Nuevo proyecto",newBudget:"Nuevo presupuesto"},auth:{loginTitle:"Iniciar sesin",registerTitle:"Crear cuenta",email:"Correo",password:"Contrasea",fullName:"Nombre completo",companyName:"Nombre de cuenta",createAccount:"Crear cuenta",login:"Entrar",goToRegister:"Crear nueva cuenta",goToLogin:"Ya tengo una cuenta",registrationSuccess:"Cuenta creada. Si tu proyecto requiere confirmacin por correo, revisa tu bandeja antes de iniciar sesin.",invalidCredentials:"Credenciales invlidas",genericError:"Ocurri un error, intenta nuevamente"},nav:{dashboard:"Dashboard",clients:"Clientes",providers:"Proveedores",persons:"Clientes/Proveedores",employees:"Empleados",planning:"Planeacin",projects:"Proyectos",budgets:"Presupuestos",products:"Productos",incomeConcepts:"Conceptos ingreso",expenseConcepts:"Conceptos gasto",conceptGroups:"Grupos",concepts:"Conceptos",sales:"Ventas",purchases:"Compras",expenses:"Gastos",incomes:"Ingresos",outgoingPayments:"Pagos salientes",incomingPayments:"Pagos entrantes",paymentForms:"Cuentas y tarjetas",internalObligations:"Obligaciones internas",bankDeposits:"Depsitos bancarios",bankTransfers:"Traslados bancarios",bankReconciliation:"Conciliacin bancaria",payableConcepts:"Conceptos CxP",reports:"Reportes",profiles:"Perfiles",admin:"Administracin"},dashboard:{title:"Panel principal",subtitle:"Base inicial lista. Contina con mdulos de negocio.",bankBalances:"Cuentas bancarias y saldos",salesMonthBar:"Ventas del mes",expensesByConceptDonut:"Gastos por concepto",incomesByConceptDonut:"Ingresos por concepto",incomeVsExpenseLine:"Ingresos vs gastos",internalObligationsByPaymentForm:"Obligaciones internas por forma de pago",incomesLine:"Ingresos",expensesLine:"Gastos"},persons:{title:"Clientes y proveedores",empty:"An no hay registros",client:"Cliente",supplier:"Proveedor"},clients:{title:"Clientes"},providers:{title:"Proveedores"},employees:{title:"Empleados",sensitiveHint:"El salario debe mostrarse slo a perfiles autorizados",isPartner:"Es socio"},concepts:{title:"Conceptos, productos y formas de pago",parentConceptId:"ID concepto padre",group:"Grupo",noGroup:"Sin grupo",groupType:"Tipo de grupo",groupTypeIncome:"Grupo de ingreso",groupTypeExpense:"Grupo de gasto",taxPercentage:"% impuesto",flags:"Clasificacin",isGroup:"Es grupo",isIncome:"Es ingreso",isExpense:"Es gasto",isProduct:"Es producto/servicio",isPaymentForm:"Es forma de pago"},conceptModules:{products:"Productos",income:"Conceptos de ingreso",expense:"Conceptos de gasto",payable:"Conceptos cuentas por pagar",groups:"Grupos de conceptos"},paymentForms:{title:"Cuentas bancarias y tarjetas",kind:"Tipo",provider:"Banco / emisor",reference:"Referencia",employee:"Empleado relacionado",createInternalPayableOnOutgoingPayment:"Crear cuenta por pagar interna al registrar pago saliente",createInternalPayableOnOutgoingPaymentShort:"Genera CxP interna",kinds:{bank_account:"Cuenta bancaria",credit_card:"Tarjeta de crdito",cashbox:"Caja / efectivo"}},internalObligations:{title:"Obligaciones internas",totalLowerThanPayments:"El total no puede ser menor a los pagos ya registrados."},bankDeposits:{title:"Registrar depsito bancario",fromCash:"Caja origen",toBankAccount:"Cuenta bancaria destino",saved:"Depsito registrado correctamente."},bankTransfers:{title:"Registrar traslado bancario",sourceTransactionId:"ID transaccin origen",fromBankAccount:"Cuenta bancaria origen",toBankAccount:"Cuenta bancaria destino",sameAccountError:"La cuenta origen y destino deben ser diferentes.",saved:"Traslado registrado correctamente."},reports:{title:"Reportes",sales:"Ventas",expenses:"Gastos",incomes:"Ingresos",budgetExecution:"Ejecucin de presupuesto",projectExecution:"Ejecucin de proyecto",budget:"Presupuesto",selectBudget:"Seleccionar presupuesto",selectProject:"Seleccionar proyecto",budgetRequired:"Selecciona un presupuesto.",projectRequired:"Selecciona un proyecto.",executed:"Ejecutado",variance:"Variacin",availableReports:"Reportes disponibles",applicableFilters:"Filtros aplicables",accountsReceivable:"Cuentas por cobrar",accountsPayable:"Cuentas por pagar",internalObligations:"Obligaciones internas",cashflow:"Flujo de caja",step1:"1. Selecciona el reporte",step2:"2. Define filtros",step3:"3. Resultado",run:"Ejecutar reporte",dateFrom:"Desde",dateTo:"Hasta",currencyFilter:"Moneda",currencyFilterHint:"Todas las monedas",totalRecords:"Total de registros",changeReportFilters:"Cambiar reporte y filtros",exportExcel:"Exportar a Excel"},projects:{title:"Proyectos",project:"Proyecto",optionalProject:"Sin proyecto",startDate:"Inicio",endDate:"Fin"},budgets:{title:"Presupuestos",periodType:"Perodo",lines:"Lneas de presupuesto",addLine:"Agregar lnea",budgetAmount:"Monto presupuestado",totalBudget:"Presupuesto total",periods:{daily:"Diario",weekly:"Semanal",monthly:"Mensual",yearly:"Anual"}},profiles:{title:"Perfiles",newProfile:"Nuevo perfil",createProfile:"Crear perfil",editProfile:"Editar perfil",duplicate:"Duplicar",canCreateUsers:"Crear usuarios",canCreateProfiles:"Crear perfiles",canVoidTransactions:"Anular transacciones",module:"Mdulo",read:"Lectura",write:"Escritura",update:"Modificacin",modules:{transactions:"Transacciones",concepts:"Conceptos",clients:"Clientes",providers:"Proveedores"}},admin:{title:"Administracin",inviteUser:"Invitar usuario existente",profile:"Perfil",selectProfile:"Seleccionar perfil",createInvite:"Crear invitacin",resendInvite:"Reenviar",invitationSent:"Invitacin enviada correctamente.",invitationResent:"Invitacin reenviada correctamente.",activeInvitationExists:"Ya existe una invitacin activa en estado enviado para este correo.",deactivateUser:"Dar de baja",userId:"Usuario",status:"Estado",expiresAt:"Vigencia hasta",processInvitation:"Procesar invitacin",invitationId:"ID de invitacin",completeSignupFromInvitation:"Completa el registro usando la invitacin.",processingInvitation:"Procesando invitacin...",invitationEmailMismatch:"El correo del usuario autenticado no coincide con la invitacin."},accountManage:{security:"Seguridad",account:"Cuenta",billing:"Membresa",users:"Usuarios",profiles:"Perfiles",invitations:"Invitaciones",settings:"Datos de cuenta",pendingInvitationsTitle:"Invitaciones pendientes",acceptInvitation:"Aceptar invitacin",invitationAccepted:"Invitacin aceptada correctamente.",accountSettingsTitle:"Configuracin de la cuenta",adminOnly:"Slo el perfil administrador puede modificar los datos de la cuenta.",accountSaved:"Datos de la cuenta actualizados.",reportRetentionDays:"Retencin de reportes (das)",reportRetentionHint:"Los archivos exportados se eliminan automticamente cada da segn esta retencin.",onboardingTextsTitle:"Textos de onboarding",onboardingTextsHint:"Puedes personalizar los textos que se muestran en la gua de bienvenida.",saveOnboardingTexts:"Guardar textos onboarding",resetOnboardingTexts:"Restablecer textos onboarding",resetOnboardingTours:"Reiniciar tours vistos",onboardingTextsSaved:"Textos de onboarding guardados.",onboardingTextsReset:"Textos de onboarding restablecidos.",onboardingToursReset:"Se reinici el estado de tours vistos."},billing:{title:"Membresa",description:"Plan base con prueba gratuita de 5 das y cobro mensual por usuario.",priceHint:"Precio estimado: USD $5 por usuario / mes.",status:"Estado",trialEndsAt:"Fin de prueba",trialDaysLeft:"Das restantes de prueba",startMembership:"Activar membresa",manageSubscription:"Gestionar suscripcin",syncSeats:"Sincronizar usuarios con PayPal",addPaymentMethod:"Gestionar mtodo de pago",cardBrand:"Proveedor",cardLast4:"Tarjeta",cardExpiry:"Vencimiento",defaultMethod:"Predeterminado",setDefaultMethod:"Definir como predeterminado",seatsSynced:"Usuarios sincronizados en PayPal.",paypalManageHint:"La gestin de mtodos de pago se realiza directamente en PayPal."},reconciliation:{title:"Conciliacin bancaria",bankAccount:"Cuenta bancaria",reportDate:"Fecha de corte",reconcileDate:"Fecha de conciliacin",reconcileDateHelp:"Se usar como la fecha para marcar el movimiento como conciliado.",currentBalance:"Saldo actual",previousBalance:"Saldo anterior (conciliado antes del rango)",periodMovementsSum:"Suma de los movimientos en el perodo seleccionado",reconcile:"Conciliar",reconciled:"Conciliada",changeReconcileDate:"Cambiar fecha conciliacin",unreconcile:"Desmarcar como conciliado"},transactions:{salesTitle:"Registro de ventas",purchasesTitle:"Registro de compras",expensesTitle:"Registro de gastos",incomesTitle:"Registro de ingresos",outgoingPaymentsTitle:"Registro de pagos salientes",incomingPaymentsTitle:"Registro de pagos entrantes",salesCreateTitle:"Crear venta",purchasesCreateTitle:"Crear compra",expensesCreateTitle:"Crear gasto",incomesCreateTitle:"Crear ingreso",outgoingPaymentsCreateTitle:"Crear pago saliente",incomingPaymentsCreateTitle:"Crear pago entrante",cash:"Contado",credit:"Crdito",optionalPerson:"Cliente/Proveedor (opcional)",providerRequired:"Selecciona un proveedor.",selectProvider:"Seleccionar proveedor",selectConcept:"Seleccionar concepto",optionalSeller:"Vendedor (opcional)",concept:"Concepto",currency:"Moneda",selectCurrency:"Seleccionar moneda",paymentMode:"Tipo de pago",paymentMethod:"Mtodo de pago",selectPaymentMethod:"Seleccionar mtodo de pago",accountPaymentForm:"Cuenta bancaria / tarjeta",selectAccountPaymentForm:"Seleccionar cuenta o tarjeta",paymentMethodRequired:"Selecciona mtodo de pago.",accountPaymentFormRequired:"Selecciona la cuenta bancaria o tarjeta utilizada.",sectionGeneral:"Datos generales",sectionPayment:"Pago",sectionAmounts:"Montos",sectionDetail:"Detalle",referenceNumber:"Nmero de referencia",viewDetail:"Ver detalle",detailTitle:"Detalle de transaccin",detailLines:"Detalle",paymentsApplied:"Pagos aplicados",newIncomingPayment:"Registrar pago entrante",newOutgoingPayment:"Registrar pago saliente",invalidPaymentAmount:"Monto de pago invlido.",invalidTransactionAmount:"Ingresa un monto mayor a cero.",missingSystemPaymentConcept:"No existe el concepto de sistema para registrar pagos.",seller:"Vendedor",description:"Descripcin",clientLookup:"Cliente",lookupPlaceholder:"Buscar cliente por nombre...",productLookup:"Producto",productLookupPlaceholder:"Buscar producto por nombre...",product:"Producto",lineTotal:"Total lnea",noLines:"No hay lneas agregadas",saleValidationError:"Selecciona un cliente y agrega al menos una lnea de detalle.",quantity:"Cantidad",amount:"Monto",minAmount:"Monto mnimo",maxAmount:"Monto mximo",price:"Precio unitario",taxPercentage:"% impuesto",discountPercentage:"% descuento",additionalCharges:"Cargos adicionales",summary:"Total calculado:",date:"Fecha",person:"Cliente/Proveedor",employee:"Empleado",total:"Total",balance:"Saldo",status:"Estado",active:"Activa",inactive:"Inactiva",deactivate:"Desactivar"}},en:{common:{appName:"Financiera",account:"Account",loading:"Loading...",save:"Save",cancel:"Cancel",logout:"Sign out",language:"Language",searchPlaceholder:"Search",workspace:"Workspace",create:"Create",update:"Update",delete:"Delete",edit:"Edit",backToList:"Back to list",actions:"Actions",name:"Name",phone:"Phone",email:"Email",address:"Address",type:"Type",yes:"Yes",no:"No",empty:"No records",previous:"Previous",next:"Next",page:"Page",of:"of",more:"More",expand:"Expand menu",collapse:"Collapse menu",clearFilters:"Clear filters",requiredFields:"Complete required fields.",searching:"Searching...",searchTypeToStart:"Type at least 2 characters to search",searchNoResults:"No results found",genericLoadError:"Could not load data",genericSaveError:"Could not save changes"},topbar:{apps:"Applications",theme:"Toggle theme",notifications:"Notifications",userMenu:"User menu",noNotifications:"No notifications",pendingInvitations:"You have pending invitations to accept",goToInvitations:"Go to invitations",account:"Account",currentAccount:"Current account",manageAccount:"Manage account",textSize:"Text size",density:"Density",small:"Small",medium:"Medium",large:"Large",compact:"Compact",comfortable:"Comfortable"},onboarding:{welcomeTitle:"Welcome to module",welcomeDescription:"We will quickly show you where each menu is in",start:"Start guide",skip:"Skip",finish:"Finish",sidebarTitle:"Main menu",sidebarText:"Switch between the main system groups here.",appMenuTitle:"Module menu",appMenuText:"Navigate module-specific options here.",actionsMenuTitle:"Quick actions",actionsMenuText:"Use quick actions like create and refresh here.",tableTitle:"Module table",tableText:"This table shows the latest records included in this module.",workspaceTitle:"Workspace",workspaceText:"The module list, form, or report is displayed here.",accountSwitchTitle:"Account switch",accountSwitchText:"Switch between accounts you can access from here.",userMenuTitle:"User menu",userMenuText:"Find settings, preferences and sign out here."},sidebar:{expand:"Expand menu",collapse:"Collapse menu",core:"Core",concepts:"Concepts",transactions:"Transactions",security:"Security"},actions:{refresh:"Refresh",newPerson:"New client/supplier",newClient:"New client",newProvider:"New supplier",newEmployee:"New employee",newConcept:"New concept",newProduct:"New product",newIncomeConcept:"New income concept",newExpenseConcept:"New expense concept",newConceptGroup:"New group",newSale:"New sale",newPurchase:"New purchase",newExpense:"New expense",newIncome:"New income",newOutgoingPayment:"New outgoing payment",newIncomingPayment:"New incoming payment",newPaymentForm:"New bank/card account",newBankDeposit:"New bank deposit",newBankTransfer:"New transfer",newInternalObligation:"New internal obligation",newPayableConcept:"New accounts payable concept",newProject:"New project",newBudget:"New budget"},auth:{loginTitle:"Sign in",registerTitle:"Create account",email:"Email",password:"Password",fullName:"Full name",companyName:"Account name",createAccount:"Create account",login:"Sign in",goToRegister:"Create new account",goToLogin:"I already have an account",registrationSuccess:"Account created. If email confirmation is enabled, confirm your email first.",invalidCredentials:"Invalid credentials",genericError:"Something went wrong, please try again"},nav:{dashboard:"Dashboard",clients:"Clients",providers:"Suppliers",persons:"Clients/Suppliers",employees:"Employees",planning:"Planning",projects:"Projects",budgets:"Budgets",products:"Products",incomeConcepts:"Income concepts",expenseConcepts:"Expense concepts",conceptGroups:"Groups",concepts:"Concepts",sales:"Sales",purchases:"Purchases",expenses:"Expenses",incomes:"Incomes",outgoingPayments:"Outgoing payments",incomingPayments:"Incoming payments",paymentForms:"Bank accounts & cards",internalObligations:"Internal obligations",bankDeposits:"Bank deposits",bankTransfers:"Bank transfers",bankReconciliation:"Bank reconciliation",payableConcepts:"AP concepts",reports:"Reports",profiles:"Profiles",admin:"Administration"},dashboard:{title:"Main dashboard",subtitle:"Initial foundation is ready. Continue building business modules.",bankBalances:"Bank accounts and balances",salesMonthBar:"Monthly sales",expensesByConceptDonut:"Expenses by concept",incomesByConceptDonut:"Incomes by concept",incomeVsExpenseLine:"Income vs expenses",internalObligationsByPaymentForm:"Internal obligations by payment form",incomesLine:"Incomes",expensesLine:"Expenses"},persons:{title:"Clients and suppliers",empty:"No records yet",client:"Client",supplier:"Supplier"},clients:{title:"Clients"},providers:{title:"Suppliers"},employees:{title:"Employees",sensitiveHint:"Salary must be visible only for authorized roles",isPartner:"Is partner"},concepts:{title:"Concepts, products and payment methods",parentConceptId:"Parent concept ID",group:"Group",noGroup:"No group",groupType:"Group type",groupTypeIncome:"Income group",groupTypeExpense:"Expense group",taxPercentage:"Tax %",flags:"Classification",isGroup:"Is group",isIncome:"Is income",isExpense:"Is expense",isProduct:"Is product/service",isPaymentForm:"Is payment form"},conceptModules:{products:"Products",income:"Income concepts",expense:"Expense concepts",payable:"Accounts payable concepts",groups:"Concept groups"},paymentForms:{title:"Bank accounts and credit cards",kind:"Type",provider:"Bank / issuer",reference:"Reference",employee:"Related employee",createInternalPayableOnOutgoingPayment:"Create internal payable when recording outgoing payment",createInternalPayableOnOutgoingPaymentShort:"Create internal AP",kinds:{bank_account:"Bank account",credit_card:"Credit card",cashbox:"Cashbox"}},internalObligations:{title:"Internal obligations",totalLowerThanPayments:"Total cannot be lower than already registered payments."},bankDeposits:{title:"Register bank deposit",fromCash:"Source cashbox",toBankAccount:"Destination bank account",saved:"Deposit registered successfully."},bankTransfers:{title:"Register bank transfer",sourceTransactionId:"Source transaction ID",fromBankAccount:"Source bank account",toBankAccount:"Destination bank account",sameAccountError:"Source and destination accounts must be different.",saved:"Transfer registered successfully."},reports:{title:"Reports",sales:"Sales",expenses:"Expenses",incomes:"Incomes",budgetExecution:"Budget execution",projectExecution:"Project execution",budget:"Budget",selectBudget:"Select budget",selectProject:"Select project",budgetRequired:"Select a budget.",projectRequired:"Select a project.",executed:"Executed",variance:"Variance",availableReports:"Available reports",applicableFilters:"Applicable filters",accountsReceivable:"Accounts receivable",accountsPayable:"Accounts payable",internalObligations:"Internal obligations",cashflow:"Cashflow",step1:"1. Select report",step2:"2. Set filters",step3:"3. Result",run:"Run report",dateFrom:"From",dateTo:"To",currencyFilter:"Currency",currencyFilterHint:"All currencies",totalRecords:"Total records",changeReportFilters:"Change report and filters",exportExcel:"Export to Excel"},projects:{title:"Projects",project:"Project",optionalProject:"No project",startDate:"Start",endDate:"End"},budgets:{title:"Budgets",periodType:"Period",lines:"Budget lines",addLine:"Add line",budgetAmount:"Budgeted amount",totalBudget:"Total budget",periods:{daily:"Daily",weekly:"Weekly",monthly:"Monthly",yearly:"Yearly"}},profiles:{title:"Profiles",newProfile:"New profile",createProfile:"Create profile",editProfile:"Edit profile",duplicate:"Duplicate",canCreateUsers:"Create users",canCreateProfiles:"Create profiles",canVoidTransactions:"Void transactions",module:"Module",read:"Read",write:"Write",update:"Update",modules:{transactions:"Transactions",concepts:"Concepts",clients:"Clients",providers:"Suppliers"}},admin:{title:"Administration",inviteUser:"Invite existing user",profile:"Profile",selectProfile:"Select profile",createInvite:"Create invitation",resendInvite:"Resend",invitationSent:"Invitation sent successfully.",invitationResent:"Invitation resent successfully.",activeInvitationExists:"An active sent invitation already exists for this email.",deactivateUser:"Deactivate",userId:"User",status:"Status",expiresAt:"Expires at",processInvitation:"Process invitation",invitationId:"Invitation ID",completeSignupFromInvitation:"Complete signup using the invitation link.",processingInvitation:"Processing invitation...",invitationEmailMismatch:"Authenticated user email does not match invitation email."},accountManage:{security:"Security",account:"Account",billing:"Membership",users:"Users",profiles:"Profiles",invitations:"Invitations",settings:"Account details",pendingInvitationsTitle:"Pending invitations",acceptInvitation:"Accept invitation",invitationAccepted:"Invitation accepted successfully.",accountSettingsTitle:"Account settings",adminOnly:"Only system admin profile can update account details.",accountSaved:"Account details updated.",reportRetentionDays:"Report retention (days)",reportRetentionHint:"Exported files are automatically deleted every day based on this retention.",onboardingTextsTitle:"Onboarding texts",onboardingTextsHint:"You can customize texts shown in the welcome guide.",saveOnboardingTexts:"Save onboarding texts",resetOnboardingTexts:"Reset onboarding texts",resetOnboardingTours:"Reset viewed tours",onboardingTextsSaved:"Onboarding texts saved.",onboardingTextsReset:"Onboarding texts reset.",onboardingToursReset:"Viewed tours state has been reset."},billing:{title:"Membership",description:"Base plan with 5-day free trial and monthly per-user billing.",priceHint:"Estimated price: USD $5 per user / month.",status:"Status",trialEndsAt:"Trial ends at",trialDaysLeft:"Trial days left",startMembership:"Start membership",manageSubscription:"Manage subscription",syncSeats:"Sync seats with PayPal",addPaymentMethod:"Manage payment method",cardBrand:"Provider",cardLast4:"Card",cardExpiry:"Expiry",defaultMethod:"Default",setDefaultMethod:"Set as default",seatsSynced:"Seats synced with PayPal.",paypalManageHint:"Payment methods are managed directly in PayPal."},reconciliation:{title:"Bank reconciliation",bankAccount:"Bank account",reportDate:"As-of date",reconcileDate:"Reconciliation date",reconcileDateHelp:"This date will be used when marking the movement as reconciled.",currentBalance:"Current balance",previousBalance:"Previous balance (reconciled before range)",periodMovementsSum:"Sum of movements in the selected period",reconcile:"Reconcile",reconciled:"Reconciled",changeReconcileDate:"Change reconciliation date",unreconcile:"Unmark as reconciled"},transactions:{salesTitle:"Sales entries",purchasesTitle:"Purchase entries",expensesTitle:"Expense entries",incomesTitle:"Income entries",outgoingPaymentsTitle:"Outgoing payments",incomingPaymentsTitle:"Incoming payments",salesCreateTitle:"Create sale",purchasesCreateTitle:"Create purchase",expensesCreateTitle:"Create expense",incomesCreateTitle:"Create income",outgoingPaymentsCreateTitle:"Create outgoing payment",incomingPaymentsCreateTitle:"Create incoming payment",cash:"Cash",credit:"Credit",optionalPerson:"Client/Supplier (optional)",providerRequired:"Select a supplier.",selectProvider:"Select supplier",selectConcept:"Select concept",optionalSeller:"Seller (optional)",concept:"Concept",currency:"Currency",selectCurrency:"Select currency",paymentMode:"Payment mode",paymentMethod:"Payment method",selectPaymentMethod:"Select payment method",accountPaymentForm:"Bank account / card",selectAccountPaymentForm:"Select bank account or card",paymentMethodRequired:"Select a payment method.",accountPaymentFormRequired:"Select the bank account or card used.",sectionGeneral:"General data",sectionPayment:"Payment",sectionAmounts:"Amounts",sectionDetail:"Detail",referenceNumber:"Reference number",viewDetail:"View detail",detailTitle:"Transaction detail",detailLines:"Detail lines",paymentsApplied:"Applied payments",newIncomingPayment:"Register incoming payment",newOutgoingPayment:"Register outgoing payment",invalidPaymentAmount:"Invalid payment amount.",invalidTransactionAmount:"Enter an amount greater than zero.",missingSystemPaymentConcept:"Missing system concept for payment registration.",seller:"Seller",description:"Description",clientLookup:"Client",lookupPlaceholder:"Search client by name...",productLookup:"Product",productLookupPlaceholder:"Search product by name...",product:"Product",lineTotal:"Line total",noLines:"No detail lines yet",saleValidationError:"Select a client and add at least one detail line.",quantity:"Quantity",amount:"Amount",minAmount:"Minimum amount",maxAmount:"Maximum amount",price:"Unit price",taxPercentage:"Tax %",discountPercentage:"Discount %",additionalCharges:"Additional charges",summary:"Calculated total:",date:"Date",person:"Client/Supplier",employee:"Employee",total:"Total",balance:"Balance",status:"Status",active:"Active",inactive:"Inactive",deactivate:"Deactivate"}}},Kv=j.createContext(null);function Ej(t,e){return e.split(".").reduce((n,s)=>n?.[s],Ij[t])}function Tj({children:t}){const[e,n]=j.useState("es"),s=j.useMemo(()=>({t:a=>Ej(e,a)??a,language:e,setLanguage:n}),[e]);return c.jsx(Kv.Provider,{value:s,children:t})}function Ee(){const t=j.useContext(Kv);if(!t)throw new Error("useI18n must be used inside I18nProvider");return t}function Rg(t){return`name.ilike.%${t}%,referenceNumber.ilike.%${t}%,deliverTo.ilike.%${t}%,deliveryAddress.ilike.%${t}%`}function Mg(t){return`name.ilike.%${t}%,phone.ilike.%${t}%,address.ilike.%${t}%`}async function Nj({accountId:t,term:e,limit:n=8}){const s=String(e||"").trim();if(!t||s.length<2)return{transactions:[],clients:[],providers:[],products:[],concepts:[],deposits:[]};const[r,a,l,u,d,f]=await Promise.allSettled([G.from("transactions").select('id, type, date, name, "referenceNumber", "isDeposit"').eq("accountId",t).eq("isActive",!0).eq("isDeposit",!1).or(Rg(s)).order("id",{ascending:!1}).limit(n),G.from("persons").select("id, type, name, phone, address").eq("accountId",t).eq("type",1).or(Mg(s)).order("id",{ascending:!1}).limit(n),G.from("persons").select("id, type, name, phone, address").eq("accountId",t).eq("type",2).or(Mg(s)).order("id",{ascending:!1}).limit(n),G.from("concepts").select("id, name, isProduct").eq("accountId",t).eq("isGroup",!1).eq("isProduct",!0).ilike("name",`%${s}%`).order("id",{ascending:!1}).limit(n),G.from("concepts").select("id, name, isProduct").eq("accountId",t).eq("isProduct",!1).ilike("name",`%${s}%`).order("id",{ascending:!1}).limit(n),G.from("transactions").select('id, date, name, "referenceNumber", total').eq("accountId",t).eq("isActive",!0).eq("isDeposit",!0).or(Rg(s)).order("id",{ascending:!1}).limit(n)]),m=g=>g.status!=="fulfilled"?[]:g.value.error?[]:g.value.data??[];return{transactions:m(r),clients:m(a),providers:m(l),products:m(u),concepts:m(d),deposits:m(f)}}async function Gv({invitationId:t,email:e}){let{data:{session:n}}=await G.auth.getSession();if(n?.access_token||(n=(await G.auth.refreshSession()).data.session),!n?.access_token)throw new Error("Missing auth session for invitation accept request.");const{data:s,error:r}=await G.functions.invoke("accept-shared-invitation",{body:{invitationId:t,email:e},headers:{Authorization:`Bearer ${n.access_token}`}});if(r)throw new Error(`Accept invitation function error: ${r.message??"unknown error"}`);if(s?.success===!1)throw new Error(`Accept invitation failed: ${s.error??"unknown function error"}`);return s}async function Yv(){async function t(r){return G.functions.invoke("list-pending-invitations",{headers:{Authorization:`Bearer ${r}`}})}let{data:{session:e}}=await G.auth.getSession();if(e?.access_token||(e=(await G.auth.refreshSession()).data.session),!e?.access_token)throw new Error("Missing auth session for pending invitations request.");let{data:n,error:s}=await t(e.access_token);if(s?.message?.includes?.("401")){const a=(await G.auth.refreshSession()).data.session?.access_token;if(a){const l=await t(a);n=l.data,s=l.error}}if(s)throw new Error(`Pending invitations function error: ${s.message??"unknown error"}`);if(n?.success===!1)throw new Error(`Pending invitations failed: ${n.error??"unknown function error"}`);return n?.invitations??[]}function Jv(t){return t==="en"?"en-US":"es-HN"}function ut(t,e="es"){if(!t)return"-";const n=Jv(e),s=String(t).trim();if(/^\d{4}-\d{2}-\d{2}$/.test(s)){const[a,l,u]=s.split("-").map(Number),d=new Date(a,l-1,u);return Number.isNaN(d.getTime())?"-":new Intl.DateTimeFormat(n,{day:"2-digit",month:"2-digit",year:"numeric"}).format(d)}const r=new Date(s);return Number.isNaN(r.getTime())?"-":new Intl.DateTimeFormat(n,{day:"2-digit",month:"2-digit",year:"numeric"}).format(r)}function Fh(t,e="es"){if(!t)return"-";const n=String(t).trim();if(/^\d{4}-\d{2}-\d{2}$/.test(n))return ut(n,e);const s=new Date(n);return Number.isNaN(s.getTime())?"-":new Intl.DateTimeFormat(Jv(e),{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(s)}const Aj={dashboard:{intro:"Este mdulo te da una vista general del negocio.",sidebarTitle:"Men principal",sidebarText:"Aqu cambias entre grupos principales del sistema.",actionsTitle:"Acciones rpidas",actionsText:"Aqu encontrars acciones como crear o refrescar.",workspaceTitle:"rea de trabajo",workspaceText:"Aqu se muestran listados, formularios y reportes.",appMenuTitle:"Accesos del app-menu",appMenuText:"Desde aqu navegas los accesos del mdulo General.",appMenuOptions:[{name:"Dashboard",description:"Resumen general y mtricas clave."},{name:"Clientes",description:"Consulta y gestin de clientes."},{name:"Proveedores",description:"Consulta y gestin de proveedores."},{name:"Empleados",description:"Consulta y gestin de empleados."}]},clients:{intro:"En este mdulo administras la base de clientes.",appMenuTitle:"Accesos del app-menu",appMenuText:"Opciones disponibles para clientes.",appMenuOptions:[{name:"Clientes",description:"Listado principal con filtros y acciones."}]},providers:{intro:"En este mdulo administras la base de proveedores.",appMenuTitle:"Accesos del app-menu",appMenuText:"Opciones disponibles para proveedores.",appMenuOptions:[{name:"Proveedores",description:"Listado principal con filtros y acciones."}]},employees:{intro:"En este mdulo gestionas empleados y datos relacionados.",appMenuTitle:"Accesos del app-menu",appMenuText:"Opciones disponibles para empleados.",appMenuOptions:[{name:"Empleados",description:"Listado y mantenimiento de empleados."}]},products:{intro:"En este mdulo administras el catlogo de productos.",appMenuTitle:"Accesos del app-menu",appMenuText:"Opciones disponibles para productos.",appMenuOptions:[{name:"Productos",description:"Listado y mantenimiento del catlogo."}]},transactions:{intro:"En este mdulo registras y consultas movimientos de negocio.",appMenuTitle:"Accesos del app-menu",appMenuText:"Opciones disponibles en transacciones.",appMenuOptions:[{name:"Ventas",description:"Registro y control de ventas."},{name:"Compras",description:"Registro y control de compras."},{name:"Gastos",description:"Registro de gastos operativos."},{name:"Ingresos",description:"Registro de ingresos adicionales."}]},concepts:{intro:"En este mdulo defines conceptos y su clasificacin.",appMenuTitle:"Accesos del app-menu",appMenuText:"Opciones disponibles para conceptos.",appMenuOptions:[{name:"Conceptos ingreso",description:"Conceptos para ingresos."},{name:"Conceptos gasto",description:"Conceptos para gastos."},{name:"Conceptos CxP",description:"Conceptos para cuentas por pagar."},{name:"Grupos",description:"Agrupadores para organizar conceptos."}]},payments:{intro:"En este mdulo gestionas pagos, bancos y conciliaciones.",appMenuTitle:"Accesos del app-menu",appMenuText:"Opciones disponibles para pagos y bancos.",appMenuOptions:[{name:"Cuentas y tarjetas",description:"Mantenimiento de cuentas y tarjetas."},{name:"Depsitos bancarios",description:"Registro de depsitos entre formas de pago."},{name:"Traslados bancarios",description:"Traslado entre cuentas bancarias con registro de doble detalle."},{name:"Obligaciones internas",description:"Control de obligaciones internas."},{name:"Conciliacin bancaria",description:"Conciliacin y saldos por fecha de corte."}]},planning:{intro:"En este mdulo gestionas proyectos y presupuestos.",appMenuTitle:"Accesos del app-menu",appMenuText:"Opciones disponibles para planeacin.",appMenuOptions:[{name:"Proyectos",description:"Creacin y seguimiento de proyectos."},{name:"Presupuestos",description:"Definicin y ejecucin presupuestaria."}]},reports:{intro:"En este mdulo ejecutas reportes financieros y operativos.",appMenuTitle:"Accesos del app-menu",appMenuText:"Opciones disponibles para reportes.",appMenuOptions:[{name:"Reportes",description:"Seleccin, filtros y ejecucin de reportes."}]},account:{intro:"En este mdulo administras usuarios, perfiles y datos de cuenta.",appMenuTitle:"Accesos del mdulo",appMenuText:"Opciones disponibles en gestionar cuenta.",appMenuOptions:[{name:"Usuarios",description:"Alta, baja e invitacin de usuarios."},{name:"Perfiles",description:"Definicin de permisos y roles."},{name:"Invitaciones",description:"Aceptacin y estado de invitaciones."},{name:"Datos de cuenta",description:"Configuracin general de la cuenta."}]}},Oj={dashboard:{intro:"This module gives you a general overview of the business.",sidebarTitle:"Main menu",sidebarText:"Switch between main system groups here.",actionsTitle:"Quick actions",actionsText:"Find quick actions like create and refresh here.",workspaceTitle:"Workspace",workspaceText:"Lists, forms and reports are displayed here.",appMenuTitle:"App-menu entries",appMenuText:"Use these entries to navigate General module options.",appMenuOptions:[{name:"Dashboard",description:"General summary and key metrics."},{name:"Clients",description:"Client list and management."},{name:"Suppliers",description:"Supplier list and management."},{name:"Employees",description:"Employee list and management."}]},clients:{intro:"This module manages your client master data.",appMenuTitle:"App-menu entries",appMenuText:"Available options for clients.",appMenuOptions:[{name:"Clients",description:"Main list with filters and actions."}]},providers:{intro:"This module manages your supplier master data.",appMenuTitle:"App-menu entries",appMenuText:"Available options for suppliers.",appMenuOptions:[{name:"Suppliers",description:"Main list with filters and actions."}]},employees:{intro:"This module manages employees and related data.",appMenuTitle:"App-menu entries",appMenuText:"Available options for employees.",appMenuOptions:[{name:"Employees",description:"Employee list and maintenance."}]},products:{intro:"This module manages your product catalog.",appMenuTitle:"App-menu entries",appMenuText:"Available options for products.",appMenuOptions:[{name:"Products",description:"Catalog list and maintenance."}]},transactions:{intro:"This module records and tracks business transactions.",appMenuTitle:"App-menu entries",appMenuText:"Available transaction options.",appMenuOptions:[{name:"Sales",description:"Sales registration and control."},{name:"Purchases",description:"Purchase registration and control."},{name:"Expenses",description:"Operational expense registration."},{name:"Incomes",description:"Additional income registration."}]},concepts:{intro:"This module defines concepts and their classification.",appMenuTitle:"App-menu entries",appMenuText:"Available concept options.",appMenuOptions:[{name:"Income concepts",description:"Concepts used for income."},{name:"Expense concepts",description:"Concepts used for expenses."},{name:"A/P concepts",description:"Concepts used for accounts payable."},{name:"Groups",description:"Groupers to organize concepts."}]},payments:{intro:"This module manages payments, banks and reconciliations.",appMenuTitle:"App-menu entries",appMenuText:"Available payment and bank options.",appMenuOptions:[{name:"Accounts and cards",description:"Maintain bank accounts and cards."},{name:"Bank deposits",description:"Record deposits between payment forms."},{name:"Bank transfers",description:"Transfer between bank accounts with two-detail registration."},{name:"Internal obligations",description:"Track internal obligations."},{name:"Bank reconciliation",description:"Reconcile balances by cutoff date."}]},planning:{intro:"This module manages projects and budgets.",appMenuTitle:"App-menu entries",appMenuText:"Available planning options.",appMenuOptions:[{name:"Projects",description:"Project creation and tracking."},{name:"Budgets",description:"Budget definition and execution."}]},reports:{intro:"This module runs financial and operational reports.",appMenuTitle:"App-menu entries",appMenuText:"Available report options.",appMenuOptions:[{name:"Reports",description:"Select, filter and run reports."}]},account:{intro:"This module manages users, profiles and account data.",appMenuTitle:"Module entries",appMenuText:"Available manage-account options.",appMenuOptions:[{name:"Users",description:"Invite, activate and deactivate users."},{name:"Profiles",description:"Define roles and permissions."},{name:"Invitations",description:"Review and accept invitations."},{name:"Account details",description:"Maintain account configuration."}]}},Lg={es:Aj,en:Oj},Rj=[{id:"dashboard",match:t=>t==="/"||t==="/dashboard",titleKey:"nav.dashboard"},{id:"clients",match:t=>t.startsWith("/clients"),titleKey:"nav.clients"},{id:"providers",match:t=>t.startsWith("/providers"),titleKey:"nav.providers"},{id:"employees",match:t=>t.startsWith("/employees"),titleKey:"nav.employees"},{id:"products",match:t=>t.startsWith("/products"),titleKey:"nav.products"},{id:"transactions",match:t=>t.startsWith("/sales")||t.startsWith("/purchases")||t.startsWith("/expenses")||t.startsWith("/incomes"),titleKey:"sidebar.transactions"},{id:"concepts",match:t=>t.startsWith("/income-concepts")||t.startsWith("/expense-concepts")||t.startsWith("/payable-concepts")||t.startsWith("/concept-groups"),titleKey:"sidebar.concepts"},{id:"payments",match:t=>t.startsWith("/payment-forms")||t.startsWith("/bank-deposits")||t.startsWith("/bank-transfers")||t.startsWith("/internal-obligations")||t.startsWith("/bank-reconciliation"),titleKey:"nav.paymentForms"},{id:"planning",match:t=>t.startsWith("/projects")||t.startsWith("/budgets"),titleKey:"nav.planning"},{id:"reports",match:t=>t.startsWith("/reports"),titleKey:"nav.reports"},{id:"account",match:t=>t.startsWith("/account"),titleKey:"topbar.manageAccount"}];function Dg(t){return`module-onboarding:${t}:done`}function Mj(t){return Rj.find(e=>e.match(t))??null}function Cd(t){return c.jsxs("div",{children:[c.jsx("p",{children:t?.appMenuText||""}),Array.isArray(t?.appMenuOptions)&&t.appMenuOptions.length>0?c.jsx("ul",{className:"onboarding-option-list",children:t.appMenuOptions.map(e=>c.jsxs("li",{children:[c.jsxs("strong",{children:[e.name,":"]})," ",e.description]},`${e.name}-${e.description}`))}):null]})}function Lj(t,e,n,s){const r=s?.sidebarTitle||n("onboarding.sidebarTitle"),a=s?.sidebarText||n("onboarding.sidebarText"),l=s?.appMenuTitle||n("onboarding.appMenuTitle"),u=s?.actionsTitle||n("onboarding.actionsMenuTitle"),d=s?.actionsText||`${n("onboarding.actionsMenuText")} ${e?`(${e})`:""}`.trim(),f=s?.workspaceTitle||n("onboarding.tableTitle"),m=s?.workspaceText||n("onboarding.tableText");return t==="dashboard"?[{selector:'[data-tour="sidebar-icons"]',title:r,body:c.jsx("p",{children:a})},{selector:'[data-tour="app-menu"]',title:l,body:Cd(s)},{selector:'[data-tour="actions-menu"]',title:u,body:c.jsx("p",{children:d})},{selector:'[data-tour="workspace"]',title:f,body:c.jsx("p",{children:m})}]:t==="account"?[{selector:'[data-tour="workspace"]',title:l,body:Cd(s)}]:[{selector:'[data-tour="app-menu"]',title:l,body:Cd(s)},{selector:'[data-tour="actions-menu"]',title:u,body:c.jsx("p",{children:d})},{selector:'[data-tour="workspace"]',title:f,body:c.jsx("p",{children:m})}]}function Dj(){const{pathname:t}=$n(),{t:e,language:n}=Ee(),[s,r]=j.useState("closed"),[a,l]=j.useState(0),[u,d]=j.useState(null),f=Lg?.[n]?n:"es",m=u?.id?Lg?.[f]?.[u.id]:null,g=u?e(u.titleKey):"",y=j.useMemo(()=>Lj(u?.id,g,e,m),[u?.id,g,e,m]);j.useEffect(()=>{const I=Mj(t);if(d(I),!I){r("closed");return}localStorage.getItem(Dg(I.id))==="1"?r("closed"):(l(0),r("welcome"))},[t]),j.useEffect(()=>{if(s!=="steps")return;const I=y[a];if(!I)return;const C=document.querySelector(I.selector);C&&C.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})},[s,a,y]);const x=()=>{u?.id&&localStorage.setItem(Dg(u.id),"1"),r("closed")},_=s==="steps"?y[a]:null,b=(_?document.querySelector(_.selector):null)?.getBoundingClientRect?.()??null,S=b?{top:`${Math.min(window.innerHeight-170,b.bottom+10)}px`,left:`${Math.max(10,Math.min(window.innerWidth-360,b.left))}px`}:{top:"50%",left:"50%",transform:"translate(-50%, -50%)"};return s==="closed"||!u?null:c.jsx("div",{className:"onboarding-overlay",role:"dialog","aria-modal":"true",children:s==="welcome"?c.jsxs("div",{className:"onboarding-card",children:[c.jsxs("h3",{children:[e("onboarding.welcomeTitle")," ",e(u.titleKey)]}),c.jsx("p",{children:m?.intro||`${e("onboarding.welcomeDescription")} ${e(u.titleKey)}.`}),c.jsxs("div",{className:"onboarding-actions",children:[c.jsx("button",{type:"button",className:"button-secondary",onClick:x,children:e("onboarding.skip")}),c.jsx("button",{type:"button",className:"button-link-primary",onClick:()=>r("steps"),children:e("onboarding.start")})]})]}):c.jsxs(c.Fragment,{children:[b?c.jsx("div",{className:"onboarding-highlight",style:{top:`${b.top-6}px`,left:`${b.left-6}px`,width:`${b.width+12}px`,height:`${b.height+12}px`}}):null,c.jsxs("div",{className:"onboarding-card onboarding-step",style:S,children:[c.jsx("h4",{children:_?.title}),_?.body,c.jsxs("small",{children:[a+1," / ",y.length]}),c.jsxs("div",{className:"onboarding-actions",children:[c.jsx("button",{type:"button",className:"button-secondary",onClick:x,children:e("onboarding.finish")}),c.jsx("button",{type:"button",className:"button-secondary",onClick:()=>l(I=>Math.max(0,I-1)),disabled:a===0,children:e("common.previous")}),c.jsx("button",{type:"button",className:"button-link-primary",onClick:()=>{if(a+1>=y.length){x();return}l(I=>I+1)},children:a+1>=y.length?e("onboarding.finish"):e("common.next")})]})]})]})})}const Vl=[{id:"core",titleKey:"sidebar.core",icon:rg,items:[{path:"/",key:"nav.dashboard",icon:rg},{path:"/clients",key:"nav.clients",icon:$_},{path:"/providers",key:"nav.providers",icon:wl},{path:"/employees",key:"nav.employees",icon:D_}]},{id:"products",titleKey:"nav.products",icon:wl,items:[{path:"/products",key:"nav.products",icon:wl}]},{id:"transactions",titleKey:"sidebar.transactions",icon:yd,items:[{path:"/sales",key:"nav.sales",icon:bl},{path:"/purchases",key:"nav.purchases",icon:wl},{path:"/expenses",key:"nav.expenses",icon:cg},{path:"/incomes",key:"nav.incomes",icon:yd}]},{id:"concepts",titleKey:"sidebar.concepts",icon:og,items:[{path:"/income-concepts",key:"nav.incomeConcepts",icon:L_},{path:"/expense-concepts",key:"nav.expenseConcepts",icon:cg},{path:"/payable-concepts",key:"nav.payableConcepts",icon:bl},{path:"/concept-groups",key:"nav.conceptGroups",icon:og}]},{id:"payments",titleKey:"nav.paymentForms",icon:ah,items:[{path:"/payment-forms",key:"nav.paymentForms",icon:ah},{path:"/bank-deposits",key:"nav.bankDeposits",icon:yd},{path:"/bank-transfers",key:"nav.bankTransfers",icon:Ev},{path:"/internal-obligations",key:"nav.internalObligations",icon:bl},{path:"/bank-reconciliation",key:"nav.bankReconciliation",icon:I_}]},{id:"planning",titleKey:"nav.planning",icon:ag,items:[{path:"/projects",key:"nav.projects",icon:ag},{path:"/budgets",key:"nav.budgets",icon:bl}]},{id:"reports",titleKey:"nav.reports",icon:sg,items:[{path:"/reports",key:"nav.reports",icon:sg}]}];function Fg(t){if(t==="/")return"core";for(const e of Vl)for(const n of e.items)if(n.path!=="/"&&t.startsWith(n.path))return e.id;return null}function Fj(t){return t.type===1?`/sales/${t.id}`:t.type===4?`/purchases/${t.id}`:t.type===2?"/expenses":t.type===3?"/incomes":t.type===5?"/purchases":t.type===6?"/sales":"/"}function Bj(){const{logout:t,user:e,account:n,accounts:s,switchAccount:r}=Oe(),{t:a,language:l,setLanguage:u}=Ee(),{pathname:d}=$n(),f=Ht(),[m,g]=j.useState(()=>localStorage.getItem("theme")==="dark"),[y,x]=j.useState(()=>localStorage.getItem("textSize")||"md"),[_,k]=j.useState(()=>localStorage.getItem("density")||"comfortable"),[b,S]=j.useState(()=>Fg(window.location.pathname)),[I,C]=j.useState(null),[T,A]=j.useState(null),[z,E]=j.useState({}),[D,M]=j.useState({}),[N,F]=j.useState({}),[H,J]=j.useState({}),[Y,X]=j.useState({}),[re,pe]=j.useState([]),[ee,ce]=j.useState(""),[ie,U]=j.useState({transactions:[],clients:[],providers:[],products:[],concepts:[],deposits:[]}),[B,le]=j.useState(!1),[ae,ge]=j.useState(window.matchMedia("(max-width: 980px)").matches),[we,Le]=j.useState(window.matchMedia("(max-width: 620px)").matches),[Te,De]=j.useState(!1),[mt,Kt]=j.useState(!1),[mn,as]=j.useState(!1),Ue=j.useRef(null),os=j.useRef(null),ls=j.useRef(null),Wn=j.useRef(null),Sn=j.useRef(null),Ut=j.useRef(null),At=j.useRef(null),vt=j.useRef(null),Ot=j.useRef(null),jn=j.useRef(null);j.useEffect(()=>{document.documentElement.setAttribute("data-theme",m?"dark":"light"),localStorage.setItem("theme",m?"dark":"light")},[m]),j.useEffect(()=>{document.documentElement.setAttribute("data-text-size",y),localStorage.setItem("textSize",y)},[y]),j.useEffect(()=>{document.documentElement.setAttribute("data-density",_),localStorage.setItem("density",_)},[_]),j.useEffect(()=>{let W=!0;return(async()=>{if(!e?.id){pe([]);return}try{const ze=await Yv();W&&pe(ze)}catch{W&&pe([])}})(),()=>{W=!1}},[e?.id]),j.useEffect(()=>{let W=!0;const Se=ee.trim();if(!n?.accountId||Se.length<2)return le(!1),U({transactions:[],clients:[],providers:[],products:[],concepts:[],deposits:[]}),()=>{W=!1};const ze=window.setTimeout(async()=>{try{le(!0);const Ze=await Nj({accountId:n.accountId,term:Se,limit:8});W&&U(Ze)}catch{W&&U({transactions:[],clients:[],providers:[],products:[],concepts:[],deposits:[]})}finally{W&&le(!1)}},280);return()=>{W=!1,window.clearTimeout(ze)}},[n?.accountId,ee]);const Gt=Vl.find(W=>W.id===b)??null,Cn=d.startsWith("/account"),Vn=j.useMemo(()=>d.startsWith("/clients")?{createPath:"/clients?create=1",createLabel:a("actions.newClient")}:d.startsWith("/providers")?{createPath:"/providers?create=1",createLabel:a("actions.newProvider")}:d.startsWith("/employees")?{createPath:"/employees?create=1",createLabel:a("actions.newEmployee")}:d.startsWith("/products")?{createPath:"/products?create=1",createLabel:a("actions.newProduct")}:d.startsWith("/payment-forms")?{createPath:"/payment-forms?create=1",createLabel:a("actions.newPaymentForm")}:d.startsWith("/bank-deposits")?{createPath:"/bank-deposits?create=1",createLabel:a("actions.newBankDeposit")}:d.startsWith("/bank-transfers")?{createPath:"/bank-transfers?create=1",createLabel:a("actions.newBankTransfer")}:d.startsWith("/internal-obligations")?{createPath:"/internal-obligations?create=1",createLabel:a("actions.newInternalObligation")}:d.startsWith("/income-concepts")?{createPath:"/income-concepts?create=1",createLabel:a("actions.newIncomeConcept")}:d.startsWith("/expense-concepts")?{createPath:"/expense-concepts?create=1",createLabel:a("actions.newExpenseConcept")}:d.startsWith("/payable-concepts")?{createPath:"/payable-concepts?create=1",createLabel:a("actions.newPayableConcept")}:d.startsWith("/concept-groups")?{createPath:"/concept-groups?create=1",createLabel:a("actions.newConceptGroup")}:d.startsWith("/sales")?{createPath:"/sales/new",createLabel:a("actions.newSale")}:d.startsWith("/purchases")?{createPath:"/purchases?create=1",createLabel:a("actions.newPurchase")}:d.startsWith("/expenses")?{createPath:"/expenses?create=1",createLabel:a("actions.newExpense")}:d.startsWith("/incomes")?{createPath:"/incomes?create=1",createLabel:a("actions.newIncome")}:d.startsWith("/projects")?{createPath:"/projects?create=1",createLabel:a("actions.newProject")}:d.startsWith("/budgets")?{createPath:"/budgets?create=1",createLabel:a("actions.newBudget")}:d.startsWith("/account")?{createPath:null,createLabel:null}:d.startsWith("/reports")?{createPath:null,createLabel:null}:{createPath:null,createLabel:null},[d,a]),qn=j.useMemo(()=>{const W=[];return Vn.createPath&&W.push({key:"create",label:Vn.createLabel,type:"link",to:Vn.createPath,main:!0,overflowable:!1}),W.push({key:"refresh",label:a("actions.refresh"),type:"button",onClick:()=>window.location.reload(),overflowable:!0}),W},[Vn,a]),Hn=j.useMemo(()=>Gt?Gt.items.filter((W,Se)=>Se>0):[],[Gt]),fr=j.useMemo(()=>qn.filter(W=>W.overflowable),[qn]),Kn=!Cn&&!!Gt,Gn=ee.trim().length>=2,Ns=j.useMemo(()=>[{key:"transactions",title:a("sidebar.transactions"),rows:(ie.transactions??[]).map(W=>({id:`tx-${W.id}`,title:W.name||`${a("sidebar.transactions")} #${W.id}`,subtitle:`${ut(W.date,l)}  ${W.referenceNumber||"-"}`,to:Fj(W)}))},{key:"clients",title:a("nav.clients"),rows:(ie.clients??[]).map(W=>({id:`client-${W.id}`,title:W.name||`#${W.id}`,subtitle:W.phone||W.address||"-",to:"/clients"}))},{key:"providers",title:a("nav.providers"),rows:(ie.providers??[]).map(W=>({id:`provider-${W.id}`,title:W.name||`#${W.id}`,subtitle:W.phone||W.address||"-",to:"/providers"}))},{key:"products",title:a("nav.products"),rows:(ie.products??[]).map(W=>({id:`product-${W.id}`,title:W.name||`#${W.id}`,subtitle:`ID ${W.id}`,to:"/products"}))},{key:"concepts",title:a("sidebar.concepts"),rows:(ie.concepts??[]).map(W=>({id:`concept-${W.id}`,title:W.name||`#${W.id}`,subtitle:`ID ${W.id}`,to:"/concept-groups"}))},{key:"deposits",title:a("nav.bankDeposits"),rows:(ie.deposits??[]).map(W=>({id:`deposit-${W.id}`,title:W.name||`${a("nav.bankDeposits")} #${W.id}`,subtitle:`${ut(W.date,l)}  ${W.referenceNumber||"-"}`,to:"/bank-deposits"}))}],[ie,a,l]),Hr=j.useMemo(()=>Ns.reduce((W,Se)=>W+Se.rows.length,0),[Ns]),He=W=>{if(!W)return{};const Se=W.getBoundingClientRect(),ze=Math.min(320,window.innerWidth-16);let Ze=Se.left;Ze+ze>window.innerWidth-8&&(Ze=window.innerWidth-ze-8),Ze=Math.max(8,Ze);const R=Math.max(8,Math.min(window.innerHeight-220,Se.bottom+8)),ne=Se.left+Se.width/2,oe=Math.max(14,Math.min(ze-20,ne-Ze-7));return{left:`${Ze}px`,right:"auto",top:`${R}px`,width:`${ze}px`,"--arrow-left":`${oe}px`}},rn=(W,Se)=>{if(T===W){A(null);return}E(He(Se)),A(W)};j.useEffect(()=>{const W=()=>{const Se=window.matchMedia("(max-width: 980px)").matches,ze=window.matchMedia("(max-width: 620px)").matches;if(ge(Se),Le(ze),Ue.current){const Ze=Ue.current.scrollWidth>Ue.current.clientWidth+4;De(ze||Ze)}else De(ze);if(os.current){const Ze=os.current.scrollWidth>os.current.clientWidth+4;Kt(ze||Ze)}else Kt(ze);if(T==="sidebar-mobile"&&E(He(ls.current)),T==="appmenu-overflow"&&E(He(Wn.current)),T==="actions-overflow"&&E(He(Sn.current)),I==="account-switch"&&M(He(vt.current)),I==="notifications"&&F(He(Ot.current)),I==="search"){const Ze=ae?At.current:Ut.current;X(He(Ze))}I==="user"&&J(He(jn.current))};return W(),window.addEventListener("resize",W),window.addEventListener("scroll",W,!0),()=>{window.removeEventListener("resize",W),window.removeEventListener("scroll",W,!0)}},[T,I,Gt,ae]),j.useEffect(()=>{const W=Fg(d);W&&S(W)},[d]),j.useEffect(()=>{const W=()=>{C(null),A(null)};window.addEventListener("click",W);const Se=ze=>{ze.key==="Escape"&&W()};return document.addEventListener("keydown",Se),()=>{window.removeEventListener("click",W),document.removeEventListener("keydown",Se)}},[]);const As=async()=>{await t()},Wt=(W,Se)=>{if(Se.stopPropagation(),W==="account-switch"&&M(He(vt.current)),W==="notifications"&&F(He(Ot.current)),W==="search"){const ze=ae?At.current:Ut.current;X(He(ze))}W==="user"&&J(He(jn.current)),C(ze=>ze===W?null:W),A(null)};return c.jsxs("div",{className:"app-shell",children:[c.jsxs("header",{className:"topbar",children:[c.jsx("div",{className:"topbar-left",children:c.jsx(st,{to:"/",className:"product-name",children:a("common.appName")})}),c.jsxs("label",{className:"search-wrap",htmlFor:"global-search",ref:Ut,onClick:W=>{W.stopPropagation();const Se=ae?At.current:Ut.current;X(He(Se)),C("search"),A(null)},children:[c.jsx("span",{className:"search-icon",children:c.jsx(vd,{})}),c.jsx("input",{id:"global-search",type:"text",placeholder:a("common.searchPlaceholder"),value:ee,onChange:W=>ce(W.target.value),onFocus:W=>{W.stopPropagation();const Se=ae?At.current:Ut.current;X(He(Se)),C("search"),A(null)}})]}),c.jsxs("div",{className:"topbar-right",children:[c.jsx("button",{className:"icon-btn mobile-search-btn",ref:At,onClick:W=>Wt("search",W),"aria-label":a("common.searchPlaceholder"),children:c.jsx(vd,{})}),c.jsx("button",{className:"icon-btn",onClick:()=>f("/"),"aria-label":a("nav.dashboard"),children:c.jsx(E_,{})}),c.jsx("button",{className:"account-switch-btn",ref:vt,"data-tour":"topbar-account-switch",onClick:W=>Wt("account-switch",W),"aria-label":a("topbar.currentAccount"),title:a("topbar.currentAccount"),children:n?.accountName||a("topbar.currentAccount")}),c.jsxs("button",{className:"icon-btn",ref:Ot,onClick:W=>Wt("notifications",W),"aria-label":a("topbar.notifications"),children:[c.jsx(j_,{}),re.length>0?c.jsx("span",{className:"notification-dot"}):null]}),c.jsx("div",{className:"user-menu-wrap",children:c.jsx("button",{className:"avatar-btn",ref:jn,"data-tour":"user-menu-button",onClick:W=>Wt("user",W),"aria-label":a("topbar.userMenu"),children:c.jsx(B_,{})})})]})]}),c.jsxs("div",{className:`floating-panel panel-right panel-anchor search-results-panel ${I==="search"?"open":""}`,style:Y,onClick:W=>W.stopPropagation(),children:[c.jsx("h3",{children:a("common.searchPlaceholder")}),ae?c.jsxs("label",{className:"search-wrap search-wrap-panel",htmlFor:"global-search-mobile",children:[c.jsx("span",{className:"search-icon",children:c.jsx(vd,{})}),c.jsx("input",{id:"global-search-mobile",type:"text",placeholder:a("common.searchPlaceholder"),value:ee,onChange:W=>ce(W.target.value)})]}):null,c.jsx("div",{className:"search-results-content",children:Gn?B?c.jsx("p",{className:"search-empty-state",children:a("common.searching")}):Hr===0?c.jsx("p",{className:"search-empty-state",children:a("common.searchNoResults")}):Ns.map(W=>W.rows.length>0?c.jsxs("section",{className:"search-result-group",children:[c.jsx("h4",{children:W.title}),c.jsx("div",{className:"search-result-list",children:W.rows.map(Se=>c.jsxs("button",{type:"button",className:"search-result-item",onClick:()=>{f(Se.to),C(null)},children:[c.jsx("span",{className:"search-result-title",children:Se.title}),c.jsx("span",{className:"search-result-subtitle",children:Se.subtitle})]},Se.id))})]},W.key):null):c.jsx("p",{className:"search-empty-state",children:a("common.searchTypeToStart")})})]}),c.jsxs("div",{className:`floating-panel panel-right panel-anchor ${I==="notifications"?"open":""}`,style:N,onClick:W=>W.stopPropagation(),children:[c.jsx("h3",{children:a("topbar.notifications")}),c.jsx("ul",{className:"panel-list",children:re.length>0?c.jsxs(c.Fragment,{children:[c.jsxs("li",{children:[a("topbar.pendingInvitations")," (",re.length,")"]}),c.jsx("li",{children:c.jsxs("button",{type:"button",className:"panel-action",onClick:()=>{f("/account/invitations"),C(null)},children:[c.jsx(lg,{})," ",a("topbar.goToInvitations")]})})]}):c.jsx("li",{children:a("topbar.noNotifications")})})]}),c.jsxs("div",{className:`floating-panel panel-right panel-anchor ${I==="account-switch"?"open":""}`,style:D,onClick:W=>W.stopPropagation(),children:[c.jsx("h3",{children:a("topbar.currentAccount")}),c.jsx("div",{className:"panel-list",children:s.length===0?c.jsx("span",{className:"panel-action disabled",children:a("common.empty")}):s.map(W=>c.jsxs("button",{type:"button",className:`panel-action ${n?.accountId===W.accountId?"active":""}`,onClick:()=>{r(W.accountId),C(null),window.location.assign("/")},children:[W.isOriginalAccount?null:c.jsx(Ev,{}),W.accountName||`${a("topbar.currentAccount")} #${W.accountId}`]},W.accountId))})]}),c.jsxs("div",{className:`floating-panel panel-right panel-anchor ${I==="user"?"open":""}`,style:H,onClick:W=>W.stopPropagation(),children:[c.jsx("h3",{children:a("topbar.account")}),c.jsxs("ul",{className:"panel-list",children:[c.jsx("li",{children:e?.email}),n?.isOriginalAccount?c.jsx("li",{className:"panel-section-separator",children:c.jsxs("button",{type:"button",className:"panel-action",onClick:()=>{f("/account"),C(null)},children:[c.jsx(lg,{})," ",a("topbar.manageAccount")]})}):null,c.jsx("li",{children:c.jsxs("button",{type:"button",className:"panel-action",onClick:()=>g(W=>!W),"aria-label":a("topbar.theme"),children:[m?c.jsx(M_,{}):c.jsx(N_,{})," ",a("topbar.theme")]})}),c.jsx("li",{children:c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:a("common.language")}),c.jsxs("select",{id:"language-select",value:l,onChange:W=>u(W.target.value),children:[c.jsx("option",{value:"es",children:"ES"}),c.jsx("option",{value:"en",children:"EN"})]})]})}),c.jsx("li",{children:c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:a("topbar.textSize")}),c.jsxs("select",{value:y,onChange:W=>x(W.target.value),children:[c.jsx("option",{value:"sm",children:a("topbar.small")}),c.jsx("option",{value:"md",children:a("topbar.medium")}),c.jsx("option",{value:"lg",children:a("topbar.large")})]})]})}),c.jsx("li",{children:c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:a("topbar.density")}),c.jsxs("select",{value:_,onChange:W=>k(W.target.value),children:[c.jsx("option",{value:"compact",children:a("topbar.compact")}),c.jsx("option",{value:"comfortable",children:a("topbar.comfortable")})]})]})}),c.jsx("li",{children:c.jsx("button",{type:"button",className:"panel-action",onClick:As,children:a("common.logout")})})]})]}),c.jsxs("main",{className:"content",children:[!Cn&&c.jsxs("aside",{className:`sidebar-icons ${mn?"force-collapsed":""}`,"data-tour":"sidebar-icons",children:[c.jsxs("button",{type:"button",className:"sidebar-collapse-btn",onClick:()=>as(W=>!W),"aria-label":a(mn?"common.expand":"common.collapse"),title:a(mn?"common.expand":"common.collapse"),children:[c.jsx("span",{className:"side-icon-glyph",children:mn?c.jsx(P_,{}):c.jsx(C_,{})}),c.jsx("span",{className:"side-icon-label",children:a(mn?"common.expand":"common.collapse")})]}),Vl.map(W=>{const Se=b===W.id,ze=W.items?.[0]?.path??"/";return c.jsx("div",{className:"sidebar-group",children:c.jsxs(Ra,{to:ze,end:ze==="/",className:`side-icon group-root ${Se?"active":""}`,onClick:()=>{S(W.id)},children:[c.jsx("span",{className:"side-icon-glyph",children:c.jsx(W.icon,{})}),c.jsx("span",{className:"side-icon-label",children:a(W.titleKey)})]})},W.id)})]}),c.jsxs("section",{className:`workspace ${Cn?"account-mode":""}`,children:[Kn&&c.jsxs("div",{className:"app-menu","data-tour":"app-menu",children:[ae?c.jsx("button",{type:"button",className:"action-btn icon-only mobile-only",ref:ls,onClick:W=>{W.stopPropagation(),rn("sidebar-mobile",ls.current)},"aria-label":"Mdulos",children:""}):null,c.jsx("div",{className:"app-menu-primary",ref:Ue,children:Gt?.items.map((W,Se)=>{const ze=Se>0;return Te&&ze?null:c.jsx(Ra,{to:W.path,end:W.path==="/",className:({isActive:R})=>`app-menu-entry ${R?"active":""}`,children:a(W.key)},W.path)})}),c.jsx("button",{type:"button",className:"action-btn overflow-trigger-btn",ref:Wn,onClick:W=>{W.stopPropagation(),rn("appmenu-overflow",Wn.current)},"aria-label":"Ms opciones de men",style:{display:Te&&Hn.length>0?"inline-flex":"none"},children:c.jsxs("span",{className:"overflow-more-btn",children:[a("common.more")," ",c.jsx(ig,{})]})})]}),!Cn&&c.jsxs("div",{className:"actions-menu","data-tour":"actions-menu",children:[c.jsx("div",{className:"actions-primary",ref:os,children:qn.map(W=>mt&&W.overflowable?null:W.type==="link"?c.jsx(st,{to:W.to,className:`action-btn ${W.main?"main":""}`,children:W.label},W.key):c.jsx("button",{type:"button",className:"action-btn overflowable",onClick:W.onClick,children:W.label},W.key))}),c.jsx("button",{type:"button",className:"action-btn overflow-trigger-btn",ref:Sn,onClick:W=>{W.stopPropagation(),rn("actions-overflow",Sn.current)},"aria-label":"Ms acciones",style:{display:mt&&fr.length>0?"inline-flex":"none"},children:c.jsxs("span",{className:"overflow-more-btn",children:[a("common.more")," ",c.jsx(ig,{})]})})]}),c.jsxs("div",{className:`floating-panel panel-toolbar panel-anchor ${T==="sidebar-mobile"?"open":""}`,style:z,onClick:W=>W.stopPropagation(),children:[c.jsx("h3",{children:"Mdulos"}),c.jsx("nav",{className:"panel-list",children:Vl.map(W=>c.jsx("button",{type:"button",className:`panel-action ${b===W.id?"active":""}`,onClick:()=>{S(W.id);const Se=W.items?.[0]?.path;Se&&d!==Se&&f(Se),A(null)},children:a(W.titleKey)},W.id))})]}),c.jsxs("div",{className:`floating-panel panel-toolbar panel-anchor ${T==="appmenu-overflow"?"open":""}`,style:z,onClick:W=>W.stopPropagation(),children:[c.jsx("h3",{children:"Men"}),c.jsx("div",{className:"panel-list",children:Hn.map(W=>c.jsx(Ra,{to:W.path,end:W.path==="/",className:({isActive:Se})=>`panel-action ${Se?"active":""}`,onClick:()=>A(null),children:a(W.key)},W.path))})]}),!Cn&&c.jsxs("div",{className:`floating-panel panel-toolbar panel-anchor ${T==="actions-overflow"?"open":""}`,style:z,onClick:W=>W.stopPropagation(),children:[c.jsx("h3",{children:"Acciones"}),c.jsx("div",{className:"panel-list",children:fr.map(W=>c.jsx("button",{type:"button",className:"panel-action",onClick:()=>{W.onClick?.(),A(null)},children:W.label},W.key))})]}),c.jsx("div",{className:"workspace-body single-column","data-tour":"workspace",children:Cn?c.jsx(nh,{}):c.jsx("section",{className:"generic-panel",children:c.jsx(nh,{})})})]})]}),c.jsx(Dj,{})]})}function $j({children:t}){const{user:e,account:n,isLoading:s}=Oe(),{t:r}=Ee(),a=$n();if(s)return c.jsx("p",{className:"screen-message",children:r("common.loading")});if(!e)return c.jsx(ks,{to:"/login",replace:!0});const l=n?.trialEndsAt?new Date(n.trialEndsAt).getTime():null,u=l?Date.now()>l:!1,d=n?.billingStatus==="active",f=a.pathname.startsWith("/account");return u&&!d&&!f?c.jsx(ks,{to:"/account/billing",replace:!0}):t}function zj(){const{login:t,user:e}=Oe(),{t:n}=Ee(),[s,r]=j.useState({email:"",password:""}),[a,l]=j.useState(""),[u,d]=j.useState(!1);if(e)return c.jsx(ks,{to:"/",replace:!0});const f=g=>{const{name:y,value:x}=g.target;r(_=>({..._,[y]:x}))},m=async g=>{g.preventDefault(),l(""),d(!0);try{await t(s)}catch{l(n("auth.invalidCredentials"))}finally{d(!1)}};return c.jsx("div",{className:"auth-page",children:c.jsxs("form",{className:"auth-card",onSubmit:m,children:[c.jsx("h1",{children:n("auth.loginTitle")}),c.jsx("label",{htmlFor:"email",children:n("auth.email")}),c.jsx("input",{id:"email",name:"email",type:"email",value:s.email,onChange:f,required:!0}),c.jsx("label",{htmlFor:"password",children:n("auth.password")}),c.jsx("input",{id:"password",name:"password",type:"password",value:s.password,onChange:f,required:!0}),a&&c.jsx("p",{className:"error-text",children:a}),c.jsx("button",{type:"submit",disabled:u,children:n("auth.login")}),c.jsx(st,{to:"/register",children:n("auth.goToRegister")})]})})}const Bg={fullName:"",companyName:"",email:"",password:"",countryCode:"",invitationId:""};function Uj(){const{register:t,user:e}=Oe(),{t:n}=Ee(),[s,r]=j.useState(Bg),[a,l]=j.useState(""),[u,d]=j.useState(""),[f,m]=j.useState(!1),[g,y]=j.useState(!1);if(j.useEffect(()=>{const k=navigator.language||"en-US",b=k.includes("-")?k.split("-")[1].toUpperCase():"US",S=new URLSearchParams(window.location.search),I=S.get("invitationId")||"",C=S.get("email")||"";y(!!(I&&C)),r(T=>({...T,countryCode:b,invitationId:I,email:C||T.email}))},[]),e)return c.jsx(ks,{to:"/",replace:!0});const x=k=>{const{name:b,value:S}=k.target;r(I=>({...I,[b]:S}))},_=async k=>{k.preventDefault(),l(""),d(""),m(!0);try{await t(s),d(n("auth.registrationSuccess")),r(Bg)}catch{l(n("auth.genericError"))}finally{m(!1)}};return c.jsx("div",{className:"auth-page",children:c.jsxs("form",{className:"auth-card",onSubmit:_,children:[c.jsx("h1",{children:n("auth.registerTitle")}),c.jsx("label",{htmlFor:"fullName",children:n("auth.fullName")}),c.jsx("input",{id:"fullName",name:"fullName",value:s.fullName,onChange:x,required:!0}),c.jsx("label",{htmlFor:"companyName",children:n("auth.companyName")}),c.jsx("input",{id:"companyName",name:"companyName",value:s.companyName,onChange:x,required:!0}),c.jsx("label",{htmlFor:"email",children:n("auth.email")}),c.jsx("input",{id:"email",name:"email",type:"email",value:s.email,onChange:x,readOnly:g,required:!0}),c.jsx("label",{htmlFor:"password",children:n("auth.password")}),c.jsx("input",{id:"password",name:"password",type:"password",minLength:8,value:s.password,onChange:x,required:!0}),a&&c.jsx("p",{className:"error-text",children:a}),u&&c.jsx("p",{className:"success-text",children:u}),c.jsx("button",{type:"submit",disabled:f,children:n("auth.createAccount")}),c.jsx(st,{to:"/login",children:n("auth.goToLogin")})]})})}async function Wj(){let{data:{session:t}}=await G.auth.getSession();if((!t?.access_token||!t?.expires_at||t.expires_at*1e3<=Date.now()+6e4)&&(t=(await G.auth.refreshSession()).data.session),!t?.access_token)throw new Error("Missing auth session.");return t.access_token}async function Bh(t,e){const n="https://vpbokueczoylouivgnin.supabase.co",s="sb_publishable_qnne91NTAXswisfSQlObFg_NnwBiV9d",r=await Wj(),a=await fetch(`${n}/functions/v1/${t}`,{method:"POST",headers:{"Content-Type":"application/json",apikey:s,Authorization:`Bearer ${r}`},body:JSON.stringify(e)});let l;try{l=await a.json()}catch{l=null}if(!a.ok)throw new Error(l?.error??`Billing request failed (${a.status})`);if(!l?.success)throw new Error(l?.error??"Billing request failed.");return l}function Vj({accountId:t,appUrl:e}){return Bh("create-billing-checkout",{accountId:t,appUrl:e})}function qj({accountId:t,appUrl:e}){return Bh("create-billing-portal",{accountId:t,appUrl:e})}function $h({accountId:t}){return Bh("sync-billing-seats",{accountId:t})}function Hj(){const{t}=Ee(),{invitationId:e}=zn(),{user:n,account:s,switchAccount:r,refreshAccounts:a}=Oe(),l=Ht(),[u,d]=j.useState(""),[f,m]=j.useState(!1),y=new URLSearchParams(window.location.search).get("email")||"";j.useEffect(()=>{if(!(!n?.email||!e||!y)){if(n.email.toLowerCase()!==y.toLowerCase()){d(t("admin.invitationEmailMismatch"));return}x()}},[n?.email,e,y]);const x=async()=>{try{m(!0);const _=await Gv({invitationId:Number(e),email:y.toLowerCase()}),k=Number(_?.accountId||0);k&&(await $h({accountId:k}).catch(()=>null),await a?.(),r?.(k)),l("/")}catch{d(t("common.genericSaveError"))}finally{m(!1)}};return c.jsx("div",{className:"auth-page",children:c.jsxs("div",{className:"auth-card",children:[c.jsx("h1",{children:t("admin.processInvitation")}),c.jsxs("p",{children:[t("admin.invitationId"),": ",c.jsx("strong",{children:e})]}),c.jsxs("p",{children:[t("common.email"),": ",c.jsx("strong",{children:y||"-"})]}),u&&c.jsx("p",{className:"error-text",children:u}),n?c.jsx("p",{children:t(f?"common.loading":"admin.processingInvitation")}):c.jsxs(c.Fragment,{children:[c.jsx("p",{children:t("admin.completeSignupFromInvitation")}),c.jsx(st,{to:`/register?invitationId=${e}&email=${encodeURIComponent(y)}`,children:t("auth.createAccount")})]})]})})}function oo(t){return t+.5|0}const nr=(t,e,n)=>Math.max(Math.min(t,n),e);function Ea(t){return nr(oo(t*2.55),0,255)}function or(t){return nr(oo(t*255),0,255)}function _s(t){return nr(oo(t/2.55)/100,0,1)}function $g(t){return nr(oo(t*100),0,100)}const _n={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},yh=[..."0123456789ABCDEF"],Kj=t=>yh[t&15],Gj=t=>yh[(t&240)>>4]+yh[t&15],El=t=>(t&240)>>4===(t&15),Yj=t=>El(t.r)&&El(t.g)&&El(t.b)&&El(t.a);function Jj(t){var e=t.length,n;return t[0]==="#"&&(e===4||e===5?n={r:255&_n[t[1]]*17,g:255&_n[t[2]]*17,b:255&_n[t[3]]*17,a:e===5?_n[t[4]]*17:255}:(e===7||e===9)&&(n={r:_n[t[1]]<<4|_n[t[2]],g:_n[t[3]]<<4|_n[t[4]],b:_n[t[5]]<<4|_n[t[6]],a:e===9?_n[t[7]]<<4|_n[t[8]]:255})),n}const Xj=(t,e)=>t<255?e(t):"";function Qj(t){var e=Yj(t)?Kj:Gj;return t?"#"+e(t.r)+e(t.g)+e(t.b)+Xj(t.a,e):void 0}const Zj=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function Xv(t,e,n){const s=e*Math.min(n,1-n),r=(a,l=(a+t/30)%12)=>n-s*Math.max(Math.min(l-3,9-l,1),-1);return[r(0),r(8),r(4)]}function eC(t,e,n){const s=(r,a=(r+t/60)%6)=>n-n*e*Math.max(Math.min(a,4-a,1),0);return[s(5),s(3),s(1)]}function tC(t,e,n){const s=Xv(t,1,.5);let r;for(e+n>1&&(r=1/(e+n),e*=r,n*=r),r=0;r<3;r++)s[r]*=1-e-n,s[r]+=e;return s}function nC(t,e,n,s,r){return t===r?(e-n)/s+(e<n?6:0):e===r?(n-t)/s+2:(t-e)/s+4}function zh(t){const n=t.r/255,s=t.g/255,r=t.b/255,a=Math.max(n,s,r),l=Math.min(n,s,r),u=(a+l)/2;let d,f,m;return a!==l&&(m=a-l,f=u>.5?m/(2-a-l):m/(a+l),d=nC(n,s,r,m,a),d=d*60+.5),[d|0,f||0,u]}function Uh(t,e,n,s){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,n,s)).map(or)}function Wh(t,e,n){return Uh(Xv,t,e,n)}function sC(t,e,n){return Uh(tC,t,e,n)}function rC(t,e,n){return Uh(eC,t,e,n)}function Qv(t){return(t%360+360)%360}function iC(t){const e=Zj.exec(t);let n=255,s;if(!e)return;e[5]!==s&&(n=e[6]?Ea(+e[5]):or(+e[5]));const r=Qv(+e[2]),a=+e[3]/100,l=+e[4]/100;return e[1]==="hwb"?s=sC(r,a,l):e[1]==="hsv"?s=rC(r,a,l):s=Wh(r,a,l),{r:s[0],g:s[1],b:s[2],a:n}}function aC(t,e){var n=zh(t);n[0]=Qv(n[0]+e),n=Wh(n),t.r=n[0],t.g=n[1],t.b=n[2]}function oC(t){if(!t)return;const e=zh(t),n=e[0],s=$g(e[1]),r=$g(e[2]);return t.a<255?`hsla(${n}, ${s}%, ${r}%, ${_s(t.a)})`:`hsl(${n}, ${s}%, ${r}%)`}const zg={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},Ug={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function lC(){const t={},e=Object.keys(Ug),n=Object.keys(zg);let s,r,a,l,u;for(s=0;s<e.length;s++){for(l=u=e[s],r=0;r<n.length;r++)a=n[r],u=u.replace(a,zg[a]);a=parseInt(Ug[l],16),t[u]=[a>>16&255,a>>8&255,a&255]}return t}let Tl;function cC(t){Tl||(Tl=lC(),Tl.transparent=[0,0,0,0]);const e=Tl[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const uC=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function dC(t){const e=uC.exec(t);let n=255,s,r,a;if(e){if(e[7]!==s){const l=+e[7];n=e[8]?Ea(l):nr(l*255,0,255)}return s=+e[1],r=+e[3],a=+e[5],s=255&(e[2]?Ea(s):nr(s,0,255)),r=255&(e[4]?Ea(r):nr(r,0,255)),a=255&(e[6]?Ea(a):nr(a,0,255)),{r:s,g:r,b:a,a:n}}}function hC(t){return t&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${_s(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`)}const Pd=t=>t<=.0031308?t*12.92:Math.pow(t,1/2.4)*1.055-.055,_i=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function fC(t,e,n){const s=_i(_s(t.r)),r=_i(_s(t.g)),a=_i(_s(t.b));return{r:or(Pd(s+n*(_i(_s(e.r))-s))),g:or(Pd(r+n*(_i(_s(e.g))-r))),b:or(Pd(a+n*(_i(_s(e.b))-a))),a:t.a+n*(e.a-t.a)}}function Nl(t,e,n){if(t){let s=zh(t);s[e]=Math.max(0,Math.min(s[e]+s[e]*n,e===0?360:1)),s=Wh(s),t.r=s[0],t.g=s[1],t.b=s[2]}}function Zv(t,e){return t&&Object.assign(e||{},t)}function Wg(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=or(t[3]))):(e=Zv(t,{r:0,g:0,b:0,a:1}),e.a=or(e.a)),e}function pC(t){return t.charAt(0)==="r"?dC(t):iC(t)}class Ja{constructor(e){if(e instanceof Ja)return e;const n=typeof e;let s;n==="object"?s=Wg(e):n==="string"&&(s=Jj(e)||cC(e)||pC(e)),this._rgb=s,this._valid=!!s}get valid(){return this._valid}get rgb(){var e=Zv(this._rgb);return e&&(e.a=_s(e.a)),e}set rgb(e){this._rgb=Wg(e)}rgbString(){return this._valid?hC(this._rgb):void 0}hexString(){return this._valid?Qj(this._rgb):void 0}hslString(){return this._valid?oC(this._rgb):void 0}mix(e,n){if(e){const s=this.rgb,r=e.rgb;let a;const l=n===a?.5:n,u=2*l-1,d=s.a-r.a,f=((u*d===-1?u:(u+d)/(1+u*d))+1)/2;a=1-f,s.r=255&f*s.r+a*r.r+.5,s.g=255&f*s.g+a*r.g+.5,s.b=255&f*s.b+a*r.b+.5,s.a=l*s.a+(1-l)*r.a,this.rgb=s}return this}interpolate(e,n){return e&&(this._rgb=fC(this._rgb,e._rgb,n)),this}clone(){return new Ja(this.rgb)}alpha(e){return this._rgb.a=or(e),this}clearer(e){const n=this._rgb;return n.a*=1-e,this}greyscale(){const e=this._rgb,n=oo(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=n,this}opaquer(e){const n=this._rgb;return n.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return Nl(this._rgb,2,e),this}darken(e){return Nl(this._rgb,2,-e),this}saturate(e){return Nl(this._rgb,1,e),this}desaturate(e){return Nl(this._rgb,1,-e),this}rotate(e){return aC(this._rgb,e),this}}function vs(){}const mC=(()=>{let t=0;return()=>t++})();function Ae(t){return t==null}function tt(t){if(Array.isArray&&Array.isArray(t))return!0;const e=Object.prototype.toString.call(t);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function Re(t){return t!==null&&Object.prototype.toString.call(t)==="[object Object]"}function ct(t){return(typeof t=="number"||t instanceof Number)&&isFinite(+t)}function hn(t,e){return ct(t)?t:e}function Pe(t,e){return typeof t>"u"?e:t}const gC=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100:+t/e,ex=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100*e:+t;function Ye(t,e,n){if(t&&typeof t.call=="function")return t.apply(n,e)}function Ve(t,e,n,s){let r,a,l;if(tt(t))for(a=t.length,r=0;r<a;r++)e.call(n,t[r],r);else if(Re(t))for(l=Object.keys(t),a=l.length,r=0;r<a;r++)e.call(n,t[l[r]],l[r])}function tc(t,e){let n,s,r,a;if(!t||!e||t.length!==e.length)return!1;for(n=0,s=t.length;n<s;++n)if(r=t[n],a=e[n],r.datasetIndex!==a.datasetIndex||r.index!==a.index)return!1;return!0}function nc(t){if(tt(t))return t.map(nc);if(Re(t)){const e=Object.create(null),n=Object.keys(t),s=n.length;let r=0;for(;r<s;++r)e[n[r]]=nc(t[n[r]]);return e}return t}function tx(t){return["__proto__","prototype","constructor"].indexOf(t)===-1}function yC(t,e,n,s){if(!tx(t))return;const r=e[t],a=n[t];Re(r)&&Re(a)?Xa(r,a,s):e[t]=nc(a)}function Xa(t,e,n){const s=tt(e)?e:[e],r=s.length;if(!Re(t))return t;n=n||{};const a=n.merger||yC;let l;for(let u=0;u<r;++u){if(l=s[u],!Re(l))continue;const d=Object.keys(l);for(let f=0,m=d.length;f<m;++f)a(d[f],t,l,n)}return t}function Da(t,e){return Xa(t,e,{merger:vC})}function vC(t,e,n){if(!tx(t))return;const s=e[t],r=n[t];Re(s)&&Re(r)?Da(s,r):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=nc(r))}const Vg={"":t=>t,x:t=>t.x,y:t=>t.y};function xC(t){const e=t.split("."),n=[];let s="";for(const r of e)s+=r,s.endsWith("\\")?s=s.slice(0,-1)+".":(n.push(s),s="");return n}function bC(t){const e=xC(t);return n=>{for(const s of e){if(s==="")break;n=n&&n[s]}return n}}function lr(t,e){return(Vg[e]||(Vg[e]=bC(e)))(t)}function Vh(t){return t.charAt(0).toUpperCase()+t.slice(1)}const Qa=t=>typeof t<"u",cr=t=>typeof t=="function",qg=(t,e)=>{if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0};function wC(t){return t.type==="mouseup"||t.type==="click"||t.type==="contextmenu"}const $e=Math.PI,Qe=2*$e,_C=Qe+$e,sc=Number.POSITIVE_INFINITY,kC=$e/180,pt=$e/2,Tr=$e/4,Hg=$e*2/3,sr=Math.log10,ss=Math.sign;function Fa(t,e,n){return Math.abs(t-e)<n}function Kg(t){const e=Math.round(t);t=Fa(t,e,t/1e3)?e:t;const n=Math.pow(10,Math.floor(sr(t))),s=t/n;return(s<=1?1:s<=2?2:s<=5?5:10)*n}function SC(t){const e=[],n=Math.sqrt(t);let s;for(s=1;s<n;s++)t%s===0&&(e.push(s),e.push(t/s));return n===(n|0)&&e.push(n),e.sort((r,a)=>r-a).pop(),e}function jC(t){return typeof t=="symbol"||typeof t=="object"&&t!==null&&!(Symbol.toPrimitive in t||"toString"in t||"valueOf"in t)}function Ni(t){return!jC(t)&&!isNaN(parseFloat(t))&&isFinite(t)}function CC(t,e){const n=Math.round(t);return n-e<=t&&n+e>=t}function nx(t,e,n){let s,r,a;for(s=0,r=t.length;s<r;s++)a=t[s][n],isNaN(a)||(e.min=Math.min(e.min,a),e.max=Math.max(e.max,a))}function Bn(t){return t*($e/180)}function qh(t){return t*(180/$e)}function Gg(t){if(!ct(t))return;let e=1,n=0;for(;Math.round(t*e)/e!==t;)e*=10,n++;return n}function sx(t,e){const n=e.x-t.x,s=e.y-t.y,r=Math.sqrt(n*n+s*s);let a=Math.atan2(s,n);return a<-.5*$e&&(a+=Qe),{angle:a,distance:r}}function vh(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function PC(t,e){return(t-e+_C)%Qe-$e}function Bt(t){return(t%Qe+Qe)%Qe}function Za(t,e,n,s){const r=Bt(t),a=Bt(e),l=Bt(n),u=Bt(a-r),d=Bt(l-r),f=Bt(r-a),m=Bt(r-l);return r===a||r===l||s&&a===l||u>d&&f<m}function Ct(t,e,n){return Math.max(e,Math.min(n,t))}function IC(t){return Ct(t,-32768,32767)}function Ss(t,e,n,s=1e-6){return t>=Math.min(e,n)-s&&t<=Math.max(e,n)+s}function Hh(t,e,n){n=n||(l=>t[l]<e);let s=t.length-1,r=0,a;for(;s-r>1;)a=r+s>>1,n(a)?r=a:s=a;return{lo:r,hi:s}}const js=(t,e,n,s)=>Hh(t,n,s?r=>{const a=t[r][e];return a<n||a===n&&t[r+1][e]===n}:r=>t[r][e]<n),EC=(t,e,n)=>Hh(t,n,s=>t[s][e]>=n);function TC(t,e,n){let s=0,r=t.length;for(;s<r&&t[s]<e;)s++;for(;r>s&&t[r-1]>n;)r--;return s>0||r<t.length?t.slice(s,r):t}const rx=["push","pop","shift","splice","unshift"];function NC(t,e){if(t._chartjs){t._chartjs.listeners.push(e);return}Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),rx.forEach(n=>{const s="_onData"+Vh(n),r=t[n];Object.defineProperty(t,n,{configurable:!0,enumerable:!1,value(...a){const l=r.apply(this,a);return t._chartjs.listeners.forEach(u=>{typeof u[s]=="function"&&u[s](...a)}),l}})})}function Yg(t,e){const n=t._chartjs;if(!n)return;const s=n.listeners,r=s.indexOf(e);r!==-1&&s.splice(r,1),!(s.length>0)&&(rx.forEach(a=>{delete t[a]}),delete t._chartjs)}function ix(t){const e=new Set(t);return e.size===t.length?t:Array.from(e)}const ax=(function(){return typeof window>"u"?function(t){return t()}:window.requestAnimationFrame})();function ox(t,e){let n=[],s=!1;return function(...r){n=r,s||(s=!0,ax.call(window,()=>{s=!1,t.apply(e,n)}))}}function AC(t,e){let n;return function(...s){return e?(clearTimeout(n),n=setTimeout(t,e,s)):t.apply(this,s),e}}const Kh=t=>t==="start"?"left":t==="end"?"right":"center",Ft=(t,e,n)=>t==="start"?e:t==="end"?n:(e+n)/2,OC=(t,e,n,s)=>t===(s?"left":"right")?n:t==="center"?(e+n)/2:e;function lx(t,e,n){const s=e.length;let r=0,a=s;if(t._sorted){const{iScale:l,vScale:u,_parsed:d}=t,f=t.dataset&&t.dataset.options?t.dataset.options.spanGaps:null,m=l.axis,{min:g,max:y,minDefined:x,maxDefined:_}=l.getUserBounds();if(x){if(r=Math.min(js(d,m,g).lo,n?s:js(e,m,l.getPixelForValue(g)).lo),f){const k=d.slice(0,r+1).reverse().findIndex(b=>!Ae(b[u.axis]));r-=Math.max(0,k)}r=Ct(r,0,s-1)}if(_){let k=Math.max(js(d,l.axis,y,!0).hi+1,n?0:js(e,m,l.getPixelForValue(y),!0).hi+1);if(f){const b=d.slice(k-1).findIndex(S=>!Ae(S[u.axis]));k+=Math.max(0,b)}a=Ct(k,r,s)-r}else a=s-r}return{start:r,count:a}}function cx(t){const{xScale:e,yScale:n,_scaleRanges:s}=t,r={xmin:e.min,xmax:e.max,ymin:n.min,ymax:n.max};if(!s)return t._scaleRanges=r,!0;const a=s.xmin!==e.min||s.xmax!==e.max||s.ymin!==n.min||s.ymax!==n.max;return Object.assign(s,r),a}const Al=t=>t===0||t===1,Jg=(t,e,n)=>-(Math.pow(2,10*(t-=1))*Math.sin((t-e)*Qe/n)),Xg=(t,e,n)=>Math.pow(2,-10*t)*Math.sin((t-e)*Qe/n)+1,Ba={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>-Math.cos(t*pt)+1,easeOutSine:t=>Math.sin(t*pt),easeInOutSine:t=>-.5*(Math.cos($e*t)-1),easeInExpo:t=>t===0?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>t===1?1:-Math.pow(2,-10*t)+1,easeInOutExpo:t=>Al(t)?t:t<.5?.5*Math.pow(2,10*(t*2-1)):.5*(-Math.pow(2,-10*(t*2-1))+2),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>Al(t)?t:Jg(t,.075,.3),easeOutElastic:t=>Al(t)?t:Xg(t,.075,.3),easeInOutElastic(t){return Al(t)?t:t<.5?.5*Jg(t*2,.1125,.45):.5+.5*Xg(t*2-1,.1125,.45)},easeInBack(t){return t*t*((1.70158+1)*t-1.70158)},easeOutBack(t){return(t-=1)*t*((1.70158+1)*t+1.70158)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?.5*(t*t*(((e*=1.525)+1)*t-e)):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},easeInBounce:t=>1-Ba.easeOutBounce(1-t),easeOutBounce(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInOutBounce:t=>t<.5?Ba.easeInBounce(t*2)*.5:Ba.easeOutBounce(t*2-1)*.5+.5};function Gh(t){if(t&&typeof t=="object"){const e=t.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function Qg(t){return Gh(t)?t:new Ja(t)}function Id(t){return Gh(t)?t:new Ja(t).saturate(.5).darken(.1).hexString()}const RC=["x","y","borderWidth","radius","tension"],MC=["color","borderColor","backgroundColor"];function LC(t){t.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),t.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),t.set("animations",{colors:{type:"color",properties:MC},numbers:{type:"number",properties:RC}}),t.describe("animations",{_fallback:"animation"}),t.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function DC(t){t.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const Zg=new Map;function FC(t,e){e=e||{};const n=t+JSON.stringify(e);let s=Zg.get(n);return s||(s=new Intl.NumberFormat(t,e),Zg.set(n,s)),s}function lo(t,e,n){return FC(e,n).format(t)}const ux={values(t){return tt(t)?t:""+t},numeric(t,e,n){if(t===0)return"0";const s=this.chart.options.locale;let r,a=t;if(n.length>1){const f=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(f<1e-4||f>1e15)&&(r="scientific"),a=BC(t,n)}const l=sr(Math.abs(a)),u=isNaN(l)?1:Math.max(Math.min(-1*Math.floor(l),20),0),d={notation:r,minimumFractionDigits:u,maximumFractionDigits:u};return Object.assign(d,this.options.ticks.format),lo(t,s,d)},logarithmic(t,e,n){if(t===0)return"0";const s=n[e].significand||t/Math.pow(10,Math.floor(sr(t)));return[1,2,3,5,10,15].includes(s)||e>.8*n.length?ux.numeric.call(this,t,e,n):""}};function BC(t,e){let n=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(n)>=1&&t!==Math.floor(t)&&(n=t-Math.floor(t)),n}var xc={formatters:ux};function $C(t){t.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,n)=>n.lineWidth,tickColor:(e,n)=>n.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:xc.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),t.route("scale.ticks","color","","color"),t.route("scale.grid","color","","borderColor"),t.route("scale.border","color","","borderColor"),t.route("scale.title","color","","color"),t.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),t.describe("scales",{_fallback:"scale"}),t.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const Wr=Object.create(null),xh=Object.create(null);function $a(t,e){if(!e)return t;const n=e.split(".");for(let s=0,r=n.length;s<r;++s){const a=n[s];t=t[a]||(t[a]=Object.create(null))}return t}function Ed(t,e,n){return typeof e=="string"?Xa($a(t,e),n):Xa($a(t,""),e)}class zC{constructor(e,n){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=s=>s.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(s,r)=>Id(r.backgroundColor),this.hoverBorderColor=(s,r)=>Id(r.borderColor),this.hoverColor=(s,r)=>Id(r.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(n)}set(e,n){return Ed(this,e,n)}get(e){return $a(this,e)}describe(e,n){return Ed(xh,e,n)}override(e,n){return Ed(Wr,e,n)}route(e,n,s,r){const a=$a(this,e),l=$a(this,s),u="_"+n;Object.defineProperties(a,{[u]:{value:a[n],writable:!0},[n]:{enumerable:!0,get(){const d=this[u],f=l[r];return Re(d)?Object.assign({},f,d):Pe(d,f)},set(d){this[u]=d}}})}apply(e){e.forEach(n=>n(this))}}var nt=new zC({_scriptable:t=>!t.startsWith("on"),_indexable:t=>t!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[LC,DC,$C]);function UC(t){return!t||Ae(t.size)||Ae(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}function rc(t,e,n,s,r){let a=e[r];return a||(a=e[r]=t.measureText(r).width,n.push(r)),a>s&&(s=a),s}function WC(t,e,n,s){s=s||{};let r=s.data=s.data||{},a=s.garbageCollect=s.garbageCollect||[];s.font!==e&&(r=s.data={},a=s.garbageCollect=[],s.font=e),t.save(),t.font=e;let l=0;const u=n.length;let d,f,m,g,y;for(d=0;d<u;d++)if(g=n[d],g!=null&&!tt(g))l=rc(t,r,a,l,g);else if(tt(g))for(f=0,m=g.length;f<m;f++)y=g[f],y!=null&&!tt(y)&&(l=rc(t,r,a,l,y));t.restore();const x=a.length/2;if(x>n.length){for(d=0;d<x;d++)delete r[a[d]];a.splice(0,x)}return l}function Nr(t,e,n){const s=t.currentDevicePixelRatio,r=n!==0?Math.max(n/2,.5):0;return Math.round((e-r)*s)/s+r}function ey(t,e){!e&&!t||(e=e||t.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore())}function bh(t,e,n,s){dx(t,e,n,s,null)}function dx(t,e,n,s,r){let a,l,u,d,f,m,g,y;const x=e.pointStyle,_=e.rotation,k=e.radius;let b=(_||0)*kC;if(x&&typeof x=="object"&&(a=x.toString(),a==="[object HTMLImageElement]"||a==="[object HTMLCanvasElement]")){t.save(),t.translate(n,s),t.rotate(b),t.drawImage(x,-x.width/2,-x.height/2,x.width,x.height),t.restore();return}if(!(isNaN(k)||k<=0)){switch(t.beginPath(),x){default:r?t.ellipse(n,s,r/2,k,0,0,Qe):t.arc(n,s,k,0,Qe),t.closePath();break;case"triangle":m=r?r/2:k,t.moveTo(n+Math.sin(b)*m,s-Math.cos(b)*k),b+=Hg,t.lineTo(n+Math.sin(b)*m,s-Math.cos(b)*k),b+=Hg,t.lineTo(n+Math.sin(b)*m,s-Math.cos(b)*k),t.closePath();break;case"rectRounded":f=k*.516,d=k-f,l=Math.cos(b+Tr)*d,g=Math.cos(b+Tr)*(r?r/2-f:d),u=Math.sin(b+Tr)*d,y=Math.sin(b+Tr)*(r?r/2-f:d),t.arc(n-g,s-u,f,b-$e,b-pt),t.arc(n+y,s-l,f,b-pt,b),t.arc(n+g,s+u,f,b,b+pt),t.arc(n-y,s+l,f,b+pt,b+$e),t.closePath();break;case"rect":if(!_){d=Math.SQRT1_2*k,m=r?r/2:d,t.rect(n-m,s-d,2*m,2*d);break}b+=Tr;case"rectRot":g=Math.cos(b)*(r?r/2:k),l=Math.cos(b)*k,u=Math.sin(b)*k,y=Math.sin(b)*(r?r/2:k),t.moveTo(n-g,s-u),t.lineTo(n+y,s-l),t.lineTo(n+g,s+u),t.lineTo(n-y,s+l),t.closePath();break;case"crossRot":b+=Tr;case"cross":g=Math.cos(b)*(r?r/2:k),l=Math.cos(b)*k,u=Math.sin(b)*k,y=Math.sin(b)*(r?r/2:k),t.moveTo(n-g,s-u),t.lineTo(n+g,s+u),t.moveTo(n+y,s-l),t.lineTo(n-y,s+l);break;case"star":g=Math.cos(b)*(r?r/2:k),l=Math.cos(b)*k,u=Math.sin(b)*k,y=Math.sin(b)*(r?r/2:k),t.moveTo(n-g,s-u),t.lineTo(n+g,s+u),t.moveTo(n+y,s-l),t.lineTo(n-y,s+l),b+=Tr,g=Math.cos(b)*(r?r/2:k),l=Math.cos(b)*k,u=Math.sin(b)*k,y=Math.sin(b)*(r?r/2:k),t.moveTo(n-g,s-u),t.lineTo(n+g,s+u),t.moveTo(n+y,s-l),t.lineTo(n-y,s+l);break;case"line":l=r?r/2:Math.cos(b)*k,u=Math.sin(b)*k,t.moveTo(n-l,s-u),t.lineTo(n+l,s+u);break;case"dash":t.moveTo(n,s),t.lineTo(n+Math.cos(b)*(r?r/2:k),s+Math.sin(b)*k);break;case!1:t.closePath();break}t.fill(),e.borderWidth>0&&t.stroke()}}function Cs(t,e,n){return n=n||.5,!e||t&&t.x>e.left-n&&t.x<e.right+n&&t.y>e.top-n&&t.y<e.bottom+n}function bc(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function wc(t){t.restore()}function VC(t,e,n,s,r){if(!e)return t.lineTo(n.x,n.y);if(r==="middle"){const a=(e.x+n.x)/2;t.lineTo(a,e.y),t.lineTo(a,n.y)}else r==="after"!=!!s?t.lineTo(e.x,n.y):t.lineTo(n.x,e.y);t.lineTo(n.x,n.y)}function qC(t,e,n,s){if(!e)return t.lineTo(n.x,n.y);t.bezierCurveTo(s?e.cp1x:e.cp2x,s?e.cp1y:e.cp2y,s?n.cp2x:n.cp1x,s?n.cp2y:n.cp1y,n.x,n.y)}function HC(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]),Ae(e.rotation)||t.rotate(e.rotation),e.color&&(t.fillStyle=e.color),e.textAlign&&(t.textAlign=e.textAlign),e.textBaseline&&(t.textBaseline=e.textBaseline)}function KC(t,e,n,s,r){if(r.strikethrough||r.underline){const a=t.measureText(s),l=e-a.actualBoundingBoxLeft,u=e+a.actualBoundingBoxRight,d=n-a.actualBoundingBoxAscent,f=n+a.actualBoundingBoxDescent,m=r.strikethrough?(d+f)/2:f;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=r.decorationWidth||2,t.moveTo(l,m),t.lineTo(u,m),t.stroke()}}function GC(t,e){const n=t.fillStyle;t.fillStyle=e.color,t.fillRect(e.left,e.top,e.width,e.height),t.fillStyle=n}function Vr(t,e,n,s,r,a={}){const l=tt(e)?e:[e],u=a.strokeWidth>0&&a.strokeColor!=="";let d,f;for(t.save(),t.font=r.string,HC(t,a),d=0;d<l.length;++d)f=l[d],a.backdrop&&GC(t,a.backdrop),u&&(a.strokeColor&&(t.strokeStyle=a.strokeColor),Ae(a.strokeWidth)||(t.lineWidth=a.strokeWidth),t.strokeText(f,n,s,a.maxWidth)),t.fillText(f,n,s,a.maxWidth),KC(t,n,s,f,a),s+=Number(r.lineHeight);t.restore()}function eo(t,e){const{x:n,y:s,w:r,h:a,radius:l}=e;t.arc(n+l.topLeft,s+l.topLeft,l.topLeft,1.5*$e,$e,!0),t.lineTo(n,s+a-l.bottomLeft),t.arc(n+l.bottomLeft,s+a-l.bottomLeft,l.bottomLeft,$e,pt,!0),t.lineTo(n+r-l.bottomRight,s+a),t.arc(n+r-l.bottomRight,s+a-l.bottomRight,l.bottomRight,pt,0,!0),t.lineTo(n+r,s+l.topRight),t.arc(n+r-l.topRight,s+l.topRight,l.topRight,0,-pt,!0),t.lineTo(n+l.topLeft,s)}const YC=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,JC=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function XC(t,e){const n=(""+t).match(YC);if(!n||n[1]==="normal")return e*1.2;switch(t=+n[2],n[3]){case"px":return t;case"%":t/=100;break}return e*t}const QC=t=>+t||0;function Yh(t,e){const n={},s=Re(e),r=s?Object.keys(e):e,a=Re(t)?s?l=>Pe(t[l],t[e[l]]):l=>t[l]:()=>t;for(const l of r)n[l]=QC(a(l));return n}function hx(t){return Yh(t,{top:"y",right:"x",bottom:"y",left:"x"})}function zr(t){return Yh(t,["topLeft","topRight","bottomLeft","bottomRight"])}function zt(t){const e=hx(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function _t(t,e){t=t||{},e=e||nt.font;let n=Pe(t.size,e.size);typeof n=="string"&&(n=parseInt(n,10));let s=Pe(t.style,e.style);s&&!(""+s).match(JC)&&(console.warn('Invalid font style specified: "'+s+'"'),s=void 0);const r={family:Pe(t.family,e.family),lineHeight:XC(Pe(t.lineHeight,e.lineHeight),n),size:n,style:s,weight:Pe(t.weight,e.weight),string:""};return r.string=UC(r),r}function Ta(t,e,n,s){let r,a,l;for(r=0,a=t.length;r<a;++r)if(l=t[r],l!==void 0&&l!==void 0)return l}function ZC(t,e,n){const{min:s,max:r}=t,a=ex(e,(r-s)/2),l=(u,d)=>n&&u===0?0:u+d;return{min:l(s,-Math.abs(a)),max:l(r,a)}}function dr(t,e){return Object.assign(Object.create(t),e)}function Jh(t,e=[""],n,s,r=()=>t[0]){const a=n||t;typeof s>"u"&&(s=gx("_fallback",t));const l={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:a,_fallback:s,_getTarget:r,override:u=>Jh([u,...t],e,a,s)};return new Proxy(l,{deleteProperty(u,d){return delete u[d],delete u._keys,delete t[0][d],!0},get(u,d){return px(u,d,()=>oP(d,e,t,u))},getOwnPropertyDescriptor(u,d){return Reflect.getOwnPropertyDescriptor(u._scopes[0],d)},getPrototypeOf(){return Reflect.getPrototypeOf(t[0])},has(u,d){return ny(u).includes(d)},ownKeys(u){return ny(u)},set(u,d,f){const m=u._storage||(u._storage=r());return u[d]=m[d]=f,delete u._keys,!0}})}function Ai(t,e,n,s){const r={_cacheable:!1,_proxy:t,_context:e,_subProxy:n,_stack:new Set,_descriptors:fx(t,s),setContext:a=>Ai(t,a,n,s),override:a=>Ai(t.override(a),e,n,s)};return new Proxy(r,{deleteProperty(a,l){return delete a[l],delete t[l],!0},get(a,l,u){return px(a,l,()=>tP(a,l,u))},getOwnPropertyDescriptor(a,l){return a._descriptors.allKeys?Reflect.has(t,l)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,l)},getPrototypeOf(){return Reflect.getPrototypeOf(t)},has(a,l){return Reflect.has(t,l)},ownKeys(){return Reflect.ownKeys(t)},set(a,l,u){return t[l]=u,delete a[l],!0}})}function fx(t,e={scriptable:!0,indexable:!0}){const{_scriptable:n=e.scriptable,_indexable:s=e.indexable,_allKeys:r=e.allKeys}=t;return{allKeys:r,scriptable:n,indexable:s,isScriptable:cr(n)?n:()=>n,isIndexable:cr(s)?s:()=>s}}const eP=(t,e)=>t?t+Vh(e):e,Xh=(t,e)=>Re(e)&&t!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function px(t,e,n){if(Object.prototype.hasOwnProperty.call(t,e)||e==="constructor")return t[e];const s=n();return t[e]=s,s}function tP(t,e,n){const{_proxy:s,_context:r,_subProxy:a,_descriptors:l}=t;let u=s[e];return cr(u)&&l.isScriptable(e)&&(u=nP(e,u,t,n)),tt(u)&&u.length&&(u=sP(e,u,t,l.isIndexable)),Xh(e,u)&&(u=Ai(u,r,a&&a[e],l)),u}function nP(t,e,n,s){const{_proxy:r,_context:a,_subProxy:l,_stack:u}=n;if(u.has(t))throw new Error("Recursion detected: "+Array.from(u).join("->")+"->"+t);u.add(t);let d=e(a,l||s);return u.delete(t),Xh(t,d)&&(d=Qh(r._scopes,r,t,d)),d}function sP(t,e,n,s){const{_proxy:r,_context:a,_subProxy:l,_descriptors:u}=n;if(typeof a.index<"u"&&s(t))return e[a.index%e.length];if(Re(e[0])){const d=e,f=r._scopes.filter(m=>m!==d);e=[];for(const m of d){const g=Qh(f,r,t,m);e.push(Ai(g,a,l&&l[t],u))}}return e}function mx(t,e,n){return cr(t)?t(e,n):t}const rP=(t,e)=>t===!0?e:typeof t=="string"?lr(e,t):void 0;function iP(t,e,n,s,r){for(const a of e){const l=rP(n,a);if(l){t.add(l);const u=mx(l._fallback,n,r);if(typeof u<"u"&&u!==n&&u!==s)return u}else if(l===!1&&typeof s<"u"&&n!==s)return null}return!1}function Qh(t,e,n,s){const r=e._rootScopes,a=mx(e._fallback,n,s),l=[...t,...r],u=new Set;u.add(s);let d=ty(u,l,n,a||n,s);return d===null||typeof a<"u"&&a!==n&&(d=ty(u,l,a,d,s),d===null)?!1:Jh(Array.from(u),[""],r,a,()=>aP(e,n,s))}function ty(t,e,n,s,r){for(;n;)n=iP(t,e,n,s,r);return n}function aP(t,e,n){const s=t._getTarget();e in s||(s[e]={});const r=s[e];return tt(r)&&Re(n)?n:r||{}}function oP(t,e,n,s){let r;for(const a of e)if(r=gx(eP(a,t),n),typeof r<"u")return Xh(t,r)?Qh(n,s,t,r):r}function gx(t,e){for(const n of e){if(!n)continue;const s=n[t];if(typeof s<"u")return s}}function ny(t){let e=t._keys;return e||(e=t._keys=lP(t._scopes)),e}function lP(t){const e=new Set;for(const n of t)for(const s of Object.keys(n).filter(r=>!r.startsWith("_")))e.add(s);return Array.from(e)}function yx(t,e,n,s){const{iScale:r}=t,{key:a="r"}=this._parsing,l=new Array(s);let u,d,f,m;for(u=0,d=s;u<d;++u)f=u+n,m=e[f],l[u]={r:r.parse(lr(m,a),f)};return l}const cP=Number.EPSILON||1e-14,Oi=(t,e)=>e<t.length&&!t[e].skip&&t[e],vx=t=>t==="x"?"y":"x";function uP(t,e,n,s){const r=t.skip?e:t,a=e,l=n.skip?e:n,u=vh(a,r),d=vh(l,a);let f=u/(u+d),m=d/(u+d);f=isNaN(f)?0:f,m=isNaN(m)?0:m;const g=s*f,y=s*m;return{previous:{x:a.x-g*(l.x-r.x),y:a.y-g*(l.y-r.y)},next:{x:a.x+y*(l.x-r.x),y:a.y+y*(l.y-r.y)}}}function dP(t,e,n){const s=t.length;let r,a,l,u,d,f=Oi(t,0);for(let m=0;m<s-1;++m)if(d=f,f=Oi(t,m+1),!(!d||!f)){if(Fa(e[m],0,cP)){n[m]=n[m+1]=0;continue}r=n[m]/e[m],a=n[m+1]/e[m],u=Math.pow(r,2)+Math.pow(a,2),!(u<=9)&&(l=3/Math.sqrt(u),n[m]=r*l*e[m],n[m+1]=a*l*e[m])}}function hP(t,e,n="x"){const s=vx(n),r=t.length;let a,l,u,d=Oi(t,0);for(let f=0;f<r;++f){if(l=u,u=d,d=Oi(t,f+1),!u)continue;const m=u[n],g=u[s];l&&(a=(m-l[n])/3,u[`cp1${n}`]=m-a,u[`cp1${s}`]=g-a*e[f]),d&&(a=(d[n]-m)/3,u[`cp2${n}`]=m+a,u[`cp2${s}`]=g+a*e[f])}}function fP(t,e="x"){const n=vx(e),s=t.length,r=Array(s).fill(0),a=Array(s);let l,u,d,f=Oi(t,0);for(l=0;l<s;++l)if(u=d,d=f,f=Oi(t,l+1),!!d){if(f){const m=f[e]-d[e];r[l]=m!==0?(f[n]-d[n])/m:0}a[l]=u?f?ss(r[l-1])!==ss(r[l])?0:(r[l-1]+r[l])/2:r[l-1]:r[l]}dP(t,r,a),hP(t,a,e)}function Ol(t,e,n){return Math.max(Math.min(t,n),e)}function pP(t,e){let n,s,r,a,l,u=Cs(t[0],e);for(n=0,s=t.length;n<s;++n)l=a,a=u,u=n<s-1&&Cs(t[n+1],e),a&&(r=t[n],l&&(r.cp1x=Ol(r.cp1x,e.left,e.right),r.cp1y=Ol(r.cp1y,e.top,e.bottom)),u&&(r.cp2x=Ol(r.cp2x,e.left,e.right),r.cp2y=Ol(r.cp2y,e.top,e.bottom)))}function mP(t,e,n,s,r){let a,l,u,d;if(e.spanGaps&&(t=t.filter(f=>!f.skip)),e.cubicInterpolationMode==="monotone")fP(t,r);else{let f=s?t[t.length-1]:t[0];for(a=0,l=t.length;a<l;++a)u=t[a],d=uP(f,u,t[Math.min(a+1,l-(s?0:1))%l],e.tension),u.cp1x=d.previous.x,u.cp1y=d.previous.y,u.cp2x=d.next.x,u.cp2y=d.next.y,f=u}e.capBezierPoints&&pP(t,n)}function Zh(){return typeof window<"u"&&typeof document<"u"}function ef(t){let e=t.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function ic(t,e,n){let s;return typeof t=="string"?(s=parseInt(t,10),t.indexOf("%")!==-1&&(s=s/100*e.parentNode[n])):s=t,s}const _c=t=>t.ownerDocument.defaultView.getComputedStyle(t,null);function gP(t,e){return _c(t).getPropertyValue(e)}const yP=["top","right","bottom","left"];function Ur(t,e,n){const s={};n=n?"-"+n:"";for(let r=0;r<4;r++){const a=yP[r];s[a]=parseFloat(t[e+"-"+a+n])||0}return s.width=s.left+s.right,s.height=s.top+s.bottom,s}const vP=(t,e,n)=>(t>0||e>0)&&(!n||!n.shadowRoot);function xP(t,e){const n=t.touches,s=n&&n.length?n[0]:t,{offsetX:r,offsetY:a}=s;let l=!1,u,d;if(vP(r,a,t.target))u=r,d=a;else{const f=e.getBoundingClientRect();u=s.clientX-f.left,d=s.clientY-f.top,l=!0}return{x:u,y:d,box:l}}function Mr(t,e){if("native"in t)return t;const{canvas:n,currentDevicePixelRatio:s}=e,r=_c(n),a=r.boxSizing==="border-box",l=Ur(r,"padding"),u=Ur(r,"border","width"),{x:d,y:f,box:m}=xP(t,n),g=l.left+(m&&u.left),y=l.top+(m&&u.top);let{width:x,height:_}=e;return a&&(x-=l.width+u.width,_-=l.height+u.height),{x:Math.round((d-g)/x*n.width/s),y:Math.round((f-y)/_*n.height/s)}}function bP(t,e,n){let s,r;if(e===void 0||n===void 0){const a=t&&ef(t);if(!a)e=t.clientWidth,n=t.clientHeight;else{const l=a.getBoundingClientRect(),u=_c(a),d=Ur(u,"border","width"),f=Ur(u,"padding");e=l.width-f.width-d.width,n=l.height-f.height-d.height,s=ic(u.maxWidth,a,"clientWidth"),r=ic(u.maxHeight,a,"clientHeight")}}return{width:e,height:n,maxWidth:s||sc,maxHeight:r||sc}}const rr=t=>Math.round(t*10)/10;function wP(t,e,n,s){const r=_c(t),a=Ur(r,"margin"),l=ic(r.maxWidth,t,"clientWidth")||sc,u=ic(r.maxHeight,t,"clientHeight")||sc,d=bP(t,e,n);let{width:f,height:m}=d;if(r.boxSizing==="content-box"){const y=Ur(r,"border","width"),x=Ur(r,"padding");f-=x.width+y.width,m-=x.height+y.height}return f=Math.max(0,f-a.width),m=Math.max(0,s?f/s:m-a.height),f=rr(Math.min(f,l,d.maxWidth)),m=rr(Math.min(m,u,d.maxHeight)),f&&!m&&(m=rr(f/2)),(e!==void 0||n!==void 0)&&s&&d.height&&m>d.height&&(m=d.height,f=rr(Math.floor(m*s))),{width:f,height:m}}function sy(t,e,n){const s=e||1,r=rr(t.height*s),a=rr(t.width*s);t.height=rr(t.height),t.width=rr(t.width);const l=t.canvas;return l.style&&(n||!l.style.height&&!l.style.width)&&(l.style.height=`${t.height}px`,l.style.width=`${t.width}px`),t.currentDevicePixelRatio!==s||l.height!==r||l.width!==a?(t.currentDevicePixelRatio=s,l.height=r,l.width=a,t.ctx.setTransform(s,0,0,s,0,0),!0):!1}const _P=(function(){let t=!1;try{const e={get passive(){return t=!0,!1}};Zh()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return t})();function ry(t,e){const n=gP(t,e),s=n&&n.match(/^(\d+)(\.\d+)?px$/);return s?+s[1]:void 0}function Lr(t,e,n,s){return{x:t.x+n*(e.x-t.x),y:t.y+n*(e.y-t.y)}}function kP(t,e,n,s){return{x:t.x+n*(e.x-t.x),y:s==="middle"?n<.5?t.y:e.y:s==="after"?n<1?t.y:e.y:n>0?e.y:t.y}}function SP(t,e,n,s){const r={x:t.cp2x,y:t.cp2y},a={x:e.cp1x,y:e.cp1y},l=Lr(t,r,n),u=Lr(r,a,n),d=Lr(a,e,n),f=Lr(l,u,n),m=Lr(u,d,n);return Lr(f,m,n)}const jP=function(t,e){return{x(n){return t+t+e-n},setWidth(n){e=n},textAlign(n){return n==="center"?n:n==="right"?"left":"right"},xPlus(n,s){return n-s},leftForLtr(n,s){return n-s}}},CP=function(){return{x(t){return t},setWidth(t){},textAlign(t){return t},xPlus(t,e){return t+e},leftForLtr(t,e){return t}}};function Ei(t,e,n){return t?jP(e,n):CP()}function xx(t,e){let n,s;(e==="ltr"||e==="rtl")&&(n=t.canvas.style,s=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",e,"important"),t.prevTextDirection=s)}function bx(t,e){e!==void 0&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}function wx(t){return t==="angle"?{between:Za,compare:PC,normalize:Bt}:{between:Ss,compare:(e,n)=>e-n,normalize:e=>e}}function iy({start:t,end:e,count:n,loop:s,style:r}){return{start:t%n,end:e%n,loop:s&&(e-t+1)%n===0,style:r}}function PP(t,e,n){const{property:s,start:r,end:a}=n,{between:l,normalize:u}=wx(s),d=e.length;let{start:f,end:m,loop:g}=t,y,x;if(g){for(f+=d,m+=d,y=0,x=d;y<x&&l(u(e[f%d][s]),r,a);++y)f--,m--;f%=d,m%=d}return m<f&&(m+=d),{start:f,end:m,loop:g,style:t.style}}function _x(t,e,n){if(!n)return[t];const{property:s,start:r,end:a}=n,l=e.length,{compare:u,between:d,normalize:f}=wx(s),{start:m,end:g,loop:y,style:x}=PP(t,e,n),_=[];let k=!1,b=null,S,I,C;const T=()=>d(r,C,S)&&u(r,C)!==0,A=()=>u(a,S)===0||d(a,C,S),z=()=>k||T(),E=()=>!k||A();for(let D=m,M=m;D<=g;++D)I=e[D%l],!I.skip&&(S=f(I[s]),S!==C&&(k=d(S,r,a),b===null&&z()&&(b=u(S,r)===0?D:M),b!==null&&E()&&(_.push(iy({start:b,end:D,loop:y,count:l,style:x})),b=null),M=D,C=S));return b!==null&&_.push(iy({start:b,end:g,loop:y,count:l,style:x})),_}function kx(t,e){const n=[],s=t.segments;for(let r=0;r<s.length;r++){const a=_x(s[r],t.points,e);a.length&&n.push(...a)}return n}function IP(t,e,n,s){let r=0,a=e-1;if(n&&!s)for(;r<e&&!t[r].skip;)r++;for(;r<e&&t[r].skip;)r++;for(r%=e,n&&(a+=r);a>r&&t[a%e].skip;)a--;return a%=e,{start:r,end:a}}function EP(t,e,n,s){const r=t.length,a=[];let l=e,u=t[e],d;for(d=e+1;d<=n;++d){const f=t[d%r];f.skip||f.stop?u.skip||(s=!1,a.push({start:e%r,end:(d-1)%r,loop:s}),e=l=f.stop?d:null):(l=d,u.skip&&(e=d)),u=f}return l!==null&&a.push({start:e%r,end:l%r,loop:s}),a}function TP(t,e){const n=t.points,s=t.options.spanGaps,r=n.length;if(!r)return[];const a=!!t._loop,{start:l,end:u}=IP(n,r,a,s);if(s===!0)return ay(t,[{start:l,end:u,loop:a}],n,e);const d=u<l?u+r:u,f=!!t._fullLoop&&l===0&&u===r-1;return ay(t,EP(n,l,d,f),n,e)}function ay(t,e,n,s){return!s||!s.setContext||!n?e:NP(t,e,n,s)}function NP(t,e,n,s){const r=t._chart.getContext(),a=oy(t.options),{_datasetIndex:l,options:{spanGaps:u}}=t,d=n.length,f=[];let m=a,g=e[0].start,y=g;function x(_,k,b,S){const I=u?-1:1;if(_!==k){for(_+=d;n[_%d].skip;)_-=I;for(;n[k%d].skip;)k+=I;_%d!==k%d&&(f.push({start:_%d,end:k%d,loop:b,style:S}),m=S,g=k%d)}}for(const _ of e){g=u?g:_.start;let k=n[g%d],b;for(y=g+1;y<=_.end;y++){const S=n[y%d];b=oy(s.setContext(dr(r,{type:"segment",p0:k,p1:S,p0DataIndex:(y-1)%d,p1DataIndex:y%d,datasetIndex:l}))),AP(b,m)&&x(g,y-1,_.loop,m),k=S,m=b}g<y-1&&x(g,y-1,_.loop,m)}return f}function oy(t){return{backgroundColor:t.backgroundColor,borderCapStyle:t.borderCapStyle,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderJoinStyle:t.borderJoinStyle,borderWidth:t.borderWidth,borderColor:t.borderColor}}function AP(t,e){if(!e)return!1;const n=[],s=function(r,a){return Gh(a)?(n.includes(a)||n.push(a),n.indexOf(a)):a};return JSON.stringify(t,s)!==JSON.stringify(e,s)}function Rl(t,e,n){return t.options.clip?t[n]:e[n]}function OP(t,e){const{xScale:n,yScale:s}=t;return n&&s?{left:Rl(n,e,"left"),right:Rl(n,e,"right"),top:Rl(s,e,"top"),bottom:Rl(s,e,"bottom")}:e}function Sx(t,e){const n=e._clip;if(n.disabled)return!1;const s=OP(e,t.chartArea);return{left:n.left===!1?0:s.left-(n.left===!0?0:n.left),right:n.right===!1?t.width:s.right+(n.right===!0?0:n.right),top:n.top===!1?0:s.top-(n.top===!0?0:n.top),bottom:n.bottom===!1?t.height:s.bottom+(n.bottom===!0?0:n.bottom)}}class RP{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,n,s,r){const a=n.listeners[r],l=n.duration;a.forEach(u=>u({chart:e,initial:n.initial,numSteps:l,currentStep:Math.min(s-n.start,l)}))}_refresh(){this._request||(this._running=!0,this._request=ax.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let n=0;this._charts.forEach((s,r)=>{if(!s.running||!s.items.length)return;const a=s.items;let l=a.length-1,u=!1,d;for(;l>=0;--l)d=a[l],d._active?(d._total>s.duration&&(s.duration=d._total),d.tick(e),u=!0):(a[l]=a[a.length-1],a.pop());u&&(r.draw(),this._notify(r,s,e,"progress")),a.length||(s.running=!1,this._notify(r,s,e,"complete"),s.initial=!1),n+=a.length}),this._lastDate=e,n===0&&(this._running=!1)}_getAnims(e){const n=this._charts;let s=n.get(e);return s||(s={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},n.set(e,s)),s}listen(e,n,s){this._getAnims(e).listeners[n].push(s)}add(e,n){!n||!n.length||this._getAnims(e).items.push(...n)}has(e){return this._getAnims(e).items.length>0}start(e){const n=this._charts.get(e);n&&(n.running=!0,n.start=Date.now(),n.duration=n.items.reduce((s,r)=>Math.max(s,r._duration),0),this._refresh())}running(e){if(!this._running)return!1;const n=this._charts.get(e);return!(!n||!n.running||!n.items.length)}stop(e){const n=this._charts.get(e);if(!n||!n.items.length)return;const s=n.items;let r=s.length-1;for(;r>=0;--r)s[r].cancel();n.items=[],this._notify(e,n,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var xs=new RP;const ly="transparent",MP={boolean(t,e,n){return n>.5?e:t},color(t,e,n){const s=Qg(t||ly),r=s.valid&&Qg(e||ly);return r&&r.valid?r.mix(s,n).hexString():e},number(t,e,n){return t+(e-t)*n}};class LP{constructor(e,n,s,r){const a=n[s];r=Ta([e.to,r,a,e.from]);const l=Ta([e.from,a,r]);this._active=!0,this._fn=e.fn||MP[e.type||typeof l],this._easing=Ba[e.easing]||Ba.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=n,this._prop=s,this._from=l,this._to=r,this._promises=void 0}active(){return this._active}update(e,n,s){if(this._active){this._notify(!1);const r=this._target[this._prop],a=s-this._start,l=this._duration-a;this._start=s,this._duration=Math.floor(Math.max(l,e.duration)),this._total+=a,this._loop=!!e.loop,this._to=Ta([e.to,n,r,e.from]),this._from=Ta([e.from,r,n])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const n=e-this._start,s=this._duration,r=this._prop,a=this._from,l=this._loop,u=this._to;let d;if(this._active=a!==u&&(l||n<s),!this._active){this._target[r]=u,this._notify(!0);return}if(n<0){this._target[r]=a;return}d=n/s%2,d=l&&d>1?2-d:d,d=this._easing(Math.min(1,Math.max(0,d))),this._target[r]=this._fn(a,u,d)}wait(){const e=this._promises||(this._promises=[]);return new Promise((n,s)=>{e.push({res:n,rej:s})})}_notify(e){const n=e?"res":"rej",s=this._promises||[];for(let r=0;r<s.length;r++)s[r][n]()}}class jx{constructor(e,n){this._chart=e,this._properties=new Map,this.configure(n)}configure(e){if(!Re(e))return;const n=Object.keys(nt.animation),s=this._properties;Object.getOwnPropertyNames(e).forEach(r=>{const a=e[r];if(!Re(a))return;const l={};for(const u of n)l[u]=a[u];(tt(a.properties)&&a.properties||[r]).forEach(u=>{(u===r||!s.has(u))&&s.set(u,l)})})}_animateOptions(e,n){const s=n.options,r=FP(e,s);if(!r)return[];const a=this._createAnimations(r,s);return s.$shared&&DP(e.options.$animations,s).then(()=>{e.options=s},()=>{}),a}_createAnimations(e,n){const s=this._properties,r=[],a=e.$animations||(e.$animations={}),l=Object.keys(n),u=Date.now();let d;for(d=l.length-1;d>=0;--d){const f=l[d];if(f.charAt(0)==="$")continue;if(f==="options"){r.push(...this._animateOptions(e,n));continue}const m=n[f];let g=a[f];const y=s.get(f);if(g)if(y&&g.active()){g.update(y,m,u);continue}else g.cancel();if(!y||!y.duration){e[f]=m;continue}a[f]=g=new LP(y,e,f,m),r.push(g)}return r}update(e,n){if(this._properties.size===0){Object.assign(e,n);return}const s=this._createAnimations(e,n);if(s.length)return xs.add(this._chart,s),!0}}function DP(t,e){const n=[],s=Object.keys(e);for(let r=0;r<s.length;r++){const a=t[s[r]];a&&a.active()&&n.push(a.wait())}return Promise.all(n)}function FP(t,e){if(!e)return;let n=t.options;if(!n){t.options=e;return}return n.$shared&&(t.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n}function cy(t,e){const n=t&&t.options||{},s=n.reverse,r=n.min===void 0?e:0,a=n.max===void 0?e:0;return{start:s?a:r,end:s?r:a}}function BP(t,e,n){if(n===!1)return!1;const s=cy(t,n),r=cy(e,n);return{top:r.end,right:s.end,bottom:r.start,left:s.start}}function $P(t){let e,n,s,r;return Re(t)?(e=t.top,n=t.right,s=t.bottom,r=t.left):e=n=s=r=t,{top:e,right:n,bottom:s,left:r,disabled:t===!1}}function Cx(t,e){const n=[],s=t._getSortedDatasetMetas(e);let r,a;for(r=0,a=s.length;r<a;++r)n.push(s[r].index);return n}function uy(t,e,n,s={}){const r=t.keys,a=s.mode==="single";let l,u,d,f;if(e===null)return;let m=!1;for(l=0,u=r.length;l<u;++l){if(d=+r[l],d===n){if(m=!0,s.all)continue;break}f=t.values[d],ct(f)&&(a||e===0||ss(e)===ss(f))&&(e+=f)}return!m&&!s.all?0:e}function zP(t,e){const{iScale:n,vScale:s}=e,r=n.axis==="x"?"x":"y",a=s.axis==="x"?"x":"y",l=Object.keys(t),u=new Array(l.length);let d,f,m;for(d=0,f=l.length;d<f;++d)m=l[d],u[d]={[r]:m,[a]:t[m]};return u}function Td(t,e){const n=t&&t.options.stacked;return n||n===void 0&&e.stack!==void 0}function UP(t,e,n){return`${t.id}.${e.id}.${n.stack||n.type}`}function WP(t){const{min:e,max:n,minDefined:s,maxDefined:r}=t.getUserBounds();return{min:s?e:Number.NEGATIVE_INFINITY,max:r?n:Number.POSITIVE_INFINITY}}function VP(t,e,n){const s=t[e]||(t[e]={});return s[n]||(s[n]={})}function dy(t,e,n,s){for(const r of e.getMatchingVisibleMetas(s).reverse()){const a=t[r.index];if(n&&a>0||!n&&a<0)return r.index}return null}function hy(t,e){const{chart:n,_cachedMeta:s}=t,r=n._stacks||(n._stacks={}),{iScale:a,vScale:l,index:u}=s,d=a.axis,f=l.axis,m=UP(a,l,s),g=e.length;let y;for(let x=0;x<g;++x){const _=e[x],{[d]:k,[f]:b}=_,S=_._stacks||(_._stacks={});y=S[f]=VP(r,m,k),y[u]=b,y._top=dy(y,l,!0,s.type),y._bottom=dy(y,l,!1,s.type);const I=y._visualValues||(y._visualValues={});I[u]=b}}function Nd(t,e){const n=t.scales;return Object.keys(n).filter(s=>n[s].axis===e).shift()}function qP(t,e){return dr(t,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function HP(t,e,n){return dr(t,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:n,index:e,mode:"default",type:"data"})}function ba(t,e){const n=t.controller.index,s=t.vScale&&t.vScale.axis;if(s){e=e||t._parsed;for(const r of e){const a=r._stacks;if(!a||a[s]===void 0||a[s][n]===void 0)return;delete a[s][n],a[s]._visualValues!==void 0&&a[s]._visualValues[n]!==void 0&&delete a[s]._visualValues[n]}}}const Ad=t=>t==="reset"||t==="none",fy=(t,e)=>e?t:Object.assign({},t),KP=(t,e,n)=>t&&!e.hidden&&e._stacked&&{keys:Cx(n,!0),values:null};class hr{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(e,n){this.chart=e,this._ctx=e.ctx,this.index=n,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=Td(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&ba(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,n=this._cachedMeta,s=this.getDataset(),r=(g,y,x,_)=>g==="x"?y:g==="r"?_:x,a=n.xAxisID=Pe(s.xAxisID,Nd(e,"x")),l=n.yAxisID=Pe(s.yAxisID,Nd(e,"y")),u=n.rAxisID=Pe(s.rAxisID,Nd(e,"r")),d=n.indexAxis,f=n.iAxisID=r(d,a,l,u),m=n.vAxisID=r(d,l,a,u);n.xScale=this.getScaleForId(a),n.yScale=this.getScaleForId(l),n.rScale=this.getScaleForId(u),n.iScale=this.getScaleForId(f),n.vScale=this.getScaleForId(m)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const n=this._cachedMeta;return e===n.iScale?n.vScale:n.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&Yg(this._data,this),e._stacked&&ba(e)}_dataCheck(){const e=this.getDataset(),n=e.data||(e.data=[]),s=this._data;if(Re(n)){const r=this._cachedMeta;this._data=zP(n,r)}else if(s!==n){if(s){Yg(s,this);const r=this._cachedMeta;ba(r),r._parsed=[]}n&&Object.isExtensible(n)&&NC(n,this),this._syncList=[],this._data=n}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const n=this._cachedMeta,s=this.getDataset();let r=!1;this._dataCheck();const a=n._stacked;n._stacked=Td(n.vScale,n),n.stack!==s.stack&&(r=!0,ba(n),n.stack=s.stack),this._resyncElements(e),(r||a!==n._stacked)&&(hy(this,n._parsed),n._stacked=Td(n.vScale,n))}configure(){const e=this.chart.config,n=e.datasetScopeKeys(this._type),s=e.getOptionScopes(this.getDataset(),n,!0);this.options=e.createResolver(s,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,n){const{_cachedMeta:s,_data:r}=this,{iScale:a,_stacked:l}=s,u=a.axis;let d=e===0&&n===r.length?!0:s._sorted,f=e>0&&s._parsed[e-1],m,g,y;if(this._parsing===!1)s._parsed=r,s._sorted=!0,y=r;else{tt(r[e])?y=this.parseArrayData(s,r,e,n):Re(r[e])?y=this.parseObjectData(s,r,e,n):y=this.parsePrimitiveData(s,r,e,n);const x=()=>g[u]===null||f&&g[u]<f[u];for(m=0;m<n;++m)s._parsed[m+e]=g=y[m],d&&(x()&&(d=!1),f=g);s._sorted=d}l&&hy(this,y)}parsePrimitiveData(e,n,s,r){const{iScale:a,vScale:l}=e,u=a.axis,d=l.axis,f=a.getLabels(),m=a===l,g=new Array(r);let y,x,_;for(y=0,x=r;y<x;++y)_=y+s,g[y]={[u]:m||a.parse(f[_],_),[d]:l.parse(n[_],_)};return g}parseArrayData(e,n,s,r){const{xScale:a,yScale:l}=e,u=new Array(r);let d,f,m,g;for(d=0,f=r;d<f;++d)m=d+s,g=n[m],u[d]={x:a.parse(g[0],m),y:l.parse(g[1],m)};return u}parseObjectData(e,n,s,r){const{xScale:a,yScale:l}=e,{xAxisKey:u="x",yAxisKey:d="y"}=this._parsing,f=new Array(r);let m,g,y,x;for(m=0,g=r;m<g;++m)y=m+s,x=n[y],f[m]={x:a.parse(lr(x,u),y),y:l.parse(lr(x,d),y)};return f}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,n,s){const r=this.chart,a=this._cachedMeta,l=n[e.axis],u={keys:Cx(r,!0),values:n._stacks[e.axis]._visualValues};return uy(u,l,a.index,{mode:s})}updateRangeFromParsed(e,n,s,r){const a=s[n.axis];let l=a===null?NaN:a;const u=r&&s._stacks[n.axis];r&&u&&(r.values=u,l=uy(r,a,this._cachedMeta.index)),e.min=Math.min(e.min,l),e.max=Math.max(e.max,l)}getMinMax(e,n){const s=this._cachedMeta,r=s._parsed,a=s._sorted&&e===s.iScale,l=r.length,u=this._getOtherScale(e),d=KP(n,s,this.chart),f={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:m,max:g}=WP(u);let y,x;function _(){x=r[y];const k=x[u.axis];return!ct(x[e.axis])||m>k||g<k}for(y=0;y<l&&!(!_()&&(this.updateRangeFromParsed(f,e,x,d),a));++y);if(a){for(y=l-1;y>=0;--y)if(!_()){this.updateRangeFromParsed(f,e,x,d);break}}return f}getAllParsedValues(e){const n=this._cachedMeta._parsed,s=[];let r,a,l;for(r=0,a=n.length;r<a;++r)l=n[r][e.axis],ct(l)&&s.push(l);return s}getMaxOverflow(){return!1}getLabelAndValue(e){const n=this._cachedMeta,s=n.iScale,r=n.vScale,a=this.getParsed(e);return{label:s?""+s.getLabelForValue(a[s.axis]):"",value:r?""+r.getLabelForValue(a[r.axis]):""}}_update(e){const n=this._cachedMeta;this.update(e||"default"),n._clip=$P(Pe(this.options.clip,BP(n.xScale,n.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,n=this.chart,s=this._cachedMeta,r=s.data||[],a=n.chartArea,l=[],u=this._drawStart||0,d=this._drawCount||r.length-u,f=this.options.drawActiveElementsOnTop;let m;for(s.dataset&&s.dataset.draw(e,a,u,d),m=u;m<u+d;++m){const g=r[m];g.hidden||(g.active&&f?l.push(g):g.draw(e,a))}for(m=0;m<l.length;++m)l[m].draw(e,a)}getStyle(e,n){const s=n?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(s):this.resolveDataElementOptions(e||0,s)}getContext(e,n,s){const r=this.getDataset();let a;if(e>=0&&e<this._cachedMeta.data.length){const l=this._cachedMeta.data[e];a=l.$context||(l.$context=HP(this.getContext(),e,l)),a.parsed=this.getParsed(e),a.raw=r.data[e],a.index=a.dataIndex=e}else a=this.$context||(this.$context=qP(this.chart.getContext(),this.index)),a.dataset=r,a.index=a.datasetIndex=this.index;return a.active=!!n,a.mode=s,a}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,n){return this._resolveElementOptions(this.dataElementType.id,n,e)}_resolveElementOptions(e,n="default",s){const r=n==="active",a=this._cachedDataOpts,l=e+"-"+n,u=a[l],d=this.enableOptionSharing&&Qa(s);if(u)return fy(u,d);const f=this.chart.config,m=f.datasetElementScopeKeys(this._type,e),g=r?[`${e}Hover`,"hover",e,""]:[e,""],y=f.getOptionScopes(this.getDataset(),m),x=Object.keys(nt.elements[e]),_=()=>this.getContext(s,r,n),k=f.resolveNamedOptions(y,x,_,g);return k.$shared&&(k.$shared=d,a[l]=Object.freeze(fy(k,d))),k}_resolveAnimations(e,n,s){const r=this.chart,a=this._cachedDataOpts,l=`animation-${n}`,u=a[l];if(u)return u;let d;if(r.options.animation!==!1){const m=this.chart.config,g=m.datasetAnimationScopeKeys(this._type,n),y=m.getOptionScopes(this.getDataset(),g);d=m.createResolver(y,this.getContext(e,s,n))}const f=new jx(r,d&&d.animations);return d&&d._cacheable&&(a[l]=Object.freeze(f)),f}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,n){return!n||Ad(e)||this.chart._animationsDisabled}_getSharedOptions(e,n){const s=this.resolveDataElementOptions(e,n),r=this._sharedOptions,a=this.getSharedOptions(s),l=this.includeOptions(n,a)||a!==r;return this.updateSharedOptions(a,n,s),{sharedOptions:a,includeOptions:l}}updateElement(e,n,s,r){Ad(r)?Object.assign(e,s):this._resolveAnimations(n,r).update(e,s)}updateSharedOptions(e,n,s){e&&!Ad(n)&&this._resolveAnimations(void 0,n).update(e,s)}_setStyle(e,n,s,r){e.active=r;const a=this.getStyle(n,r);this._resolveAnimations(n,s,r).update(e,{options:!r&&this.getSharedOptions(a)||a})}removeHoverStyle(e,n,s){this._setStyle(e,s,"active",!1)}setHoverStyle(e,n,s){this._setStyle(e,s,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const n=this._data,s=this._cachedMeta.data;for(const[u,d,f]of this._syncList)this[u](d,f);this._syncList=[];const r=s.length,a=n.length,l=Math.min(a,r);l&&this.parse(0,l),a>r?this._insertElements(r,a-r,e):a<r&&this._removeElements(a,r-a)}_insertElements(e,n,s=!0){const r=this._cachedMeta,a=r.data,l=e+n;let u;const d=f=>{for(f.length+=n,u=f.length-1;u>=l;u--)f[u]=f[u-n]};for(d(a),u=e;u<l;++u)a[u]=new this.dataElementType;this._parsing&&d(r._parsed),this.parse(e,n),s&&this.updateElements(a,e,n,"reset")}updateElements(e,n,s,r){}_removeElements(e,n){const s=this._cachedMeta;if(this._parsing){const r=s._parsed.splice(e,n);s._stacked&&ba(s,r)}s.data.splice(e,n)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[n,s,r]=e;this[n](s,r)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,n){n&&this._sync(["_removeElements",e,n]);const s=arguments.length-2;s&&this._sync(["_insertElements",e,s])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function GP(t,e){if(!t._cache.$bar){const n=t.getMatchingVisibleMetas(e);let s=[];for(let r=0,a=n.length;r<a;r++)s=s.concat(n[r].controller.getAllParsedValues(t));t._cache.$bar=ix(s.sort((r,a)=>r-a))}return t._cache.$bar}function YP(t){const e=t.iScale,n=GP(e,t.type);let s=e._length,r,a,l,u;const d=()=>{l===32767||l===-32768||(Qa(u)&&(s=Math.min(s,Math.abs(l-u)||s)),u=l)};for(r=0,a=n.length;r<a;++r)l=e.getPixelForValue(n[r]),d();for(u=void 0,r=0,a=e.ticks.length;r<a;++r)l=e.getPixelForTick(r),d();return s}function JP(t,e,n,s){const r=n.barThickness;let a,l;return Ae(r)?(a=e.min*n.categoryPercentage,l=n.barPercentage):(a=r*s,l=1),{chunk:a/s,ratio:l,start:e.pixels[t]-a/2}}function XP(t,e,n,s){const r=e.pixels,a=r[t];let l=t>0?r[t-1]:null,u=t<r.length-1?r[t+1]:null;const d=n.categoryPercentage;l===null&&(l=a-(u===null?e.end-e.start:u-a)),u===null&&(u=a+a-l);const f=a-(a-Math.min(l,u))/2*d;return{chunk:Math.abs(u-l)/2*d/s,ratio:n.barPercentage,start:f}}function QP(t,e,n,s){const r=n.parse(t[0],s),a=n.parse(t[1],s),l=Math.min(r,a),u=Math.max(r,a);let d=l,f=u;Math.abs(l)>Math.abs(u)&&(d=u,f=l),e[n.axis]=f,e._custom={barStart:d,barEnd:f,start:r,end:a,min:l,max:u}}function Px(t,e,n,s){return tt(t)?QP(t,e,n,s):e[n.axis]=n.parse(t,s),e}function py(t,e,n,s){const r=t.iScale,a=t.vScale,l=r.getLabels(),u=r===a,d=[];let f,m,g,y;for(f=n,m=n+s;f<m;++f)y=e[f],g={},g[r.axis]=u||r.parse(l[f],f),d.push(Px(y,g,a,f));return d}function Od(t){return t&&t.barStart!==void 0&&t.barEnd!==void 0}function ZP(t,e,n){return t!==0?ss(t):(e.isHorizontal()?1:-1)*(e.min>=n?1:-1)}function eI(t){let e,n,s,r,a;return t.horizontal?(e=t.base>t.x,n="left",s="right"):(e=t.base<t.y,n="bottom",s="top"),e?(r="end",a="start"):(r="start",a="end"),{start:n,end:s,reverse:e,top:r,bottom:a}}function tI(t,e,n,s){let r=e.borderSkipped;const a={};if(!r){t.borderSkipped=a;return}if(r===!0){t.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:l,end:u,reverse:d,top:f,bottom:m}=eI(t);r==="middle"&&n&&(t.enableBorderRadius=!0,(n._top||0)===s?r=f:(n._bottom||0)===s?r=m:(a[my(m,l,u,d)]=!0,r=f)),a[my(r,l,u,d)]=!0,t.borderSkipped=a}function my(t,e,n,s){return s?(t=nI(t,e,n),t=gy(t,n,e)):t=gy(t,e,n),t}function nI(t,e,n){return t===e?n:t===n?e:t}function gy(t,e,n){return t==="start"?e:t==="end"?n:t}function sI(t,{inflateAmount:e},n){t.inflateAmount=e==="auto"?n===1?.33:0:e}class rI extends hr{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(e,n,s,r){return py(e,n,s,r)}parseArrayData(e,n,s,r){return py(e,n,s,r)}parseObjectData(e,n,s,r){const{iScale:a,vScale:l}=e,{xAxisKey:u="x",yAxisKey:d="y"}=this._parsing,f=a.axis==="x"?u:d,m=l.axis==="x"?u:d,g=[];let y,x,_,k;for(y=s,x=s+r;y<x;++y)k=n[y],_={},_[a.axis]=a.parse(lr(k,f),y),g.push(Px(lr(k,m),_,l,y));return g}updateRangeFromParsed(e,n,s,r){super.updateRangeFromParsed(e,n,s,r);const a=s._custom;a&&n===this._cachedMeta.vScale&&(e.min=Math.min(e.min,a.min),e.max=Math.max(e.max,a.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const n=this._cachedMeta,{iScale:s,vScale:r}=n,a=this.getParsed(e),l=a._custom,u=Od(l)?"["+l.start+", "+l.end+"]":""+r.getLabelForValue(a[r.axis]);return{label:""+s.getLabelForValue(a[s.axis]),value:u}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const n=this._cachedMeta;this.updateElements(n.data,0,n.data.length,e)}updateElements(e,n,s,r){const a=r==="reset",{index:l,_cachedMeta:{vScale:u}}=this,d=u.getBasePixel(),f=u.isHorizontal(),m=this._getRuler(),{sharedOptions:g,includeOptions:y}=this._getSharedOptions(n,r);for(let x=n;x<n+s;x++){const _=this.getParsed(x),k=a||Ae(_[u.axis])?{base:d,head:d}:this._calculateBarValuePixels(x),b=this._calculateBarIndexPixels(x,m),S=(_._stacks||{})[u.axis],I={horizontal:f,base:k.base,enableBorderRadius:!S||Od(_._custom)||l===S._top||l===S._bottom,x:f?k.head:b.center,y:f?b.center:k.head,height:f?b.size:Math.abs(k.size),width:f?Math.abs(k.size):b.size};y&&(I.options=g||this.resolveDataElementOptions(x,e[x].active?"active":r));const C=I.options||e[x].options;tI(I,C,S,l),sI(I,C,m.ratio),this.updateElement(e[x],x,I,r)}}_getStacks(e,n){const{iScale:s}=this._cachedMeta,r=s.getMatchingVisibleMetas(this._type).filter(m=>m.controller.options.grouped),a=s.options.stacked,l=[],u=this._cachedMeta.controller.getParsed(n),d=u&&u[s.axis],f=m=>{const g=m._parsed.find(x=>x[s.axis]===d),y=g&&g[m.vScale.axis];if(Ae(y)||isNaN(y))return!0};for(const m of r)if(!(n!==void 0&&f(m))&&((a===!1||l.indexOf(m.stack)===-1||a===void 0&&m.stack===void 0)&&l.push(m.stack),m.index===e))break;return l.length||l.push(void 0),l}_getStackCount(e){return this._getStacks(void 0,e).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const e=this.chart.scales,n=this.chart.options.indexAxis;return Object.keys(e).filter(s=>e[s].axis===n).shift()}_getAxis(){const e={},n=this.getFirstScaleIdForIndexAxis();for(const s of this.chart.data.datasets)e[Pe(this.chart.options.indexAxis==="x"?s.xAxisID:s.yAxisID,n)]=!0;return Object.keys(e)}_getStackIndex(e,n,s){const r=this._getStacks(e,s),a=n!==void 0?r.indexOf(n):-1;return a===-1?r.length-1:a}_getRuler(){const e=this.options,n=this._cachedMeta,s=n.iScale,r=[];let a,l;for(a=0,l=n.data.length;a<l;++a)r.push(s.getPixelForValue(this.getParsed(a)[s.axis],a));const u=e.barThickness;return{min:u||YP(n),pixels:r,start:s._startPixel,end:s._endPixel,stackCount:this._getStackCount(),scale:s,grouped:e.grouped,ratio:u?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:n,_stacked:s,index:r},options:{base:a,minBarLength:l}}=this,u=a||0,d=this.getParsed(e),f=d._custom,m=Od(f);let g=d[n.axis],y=0,x=s?this.applyStack(n,d,s):g,_,k;x!==g&&(y=x-g,x=g),m&&(g=f.barStart,x=f.barEnd-f.barStart,g!==0&&ss(g)!==ss(f.barEnd)&&(y=0),y+=g);const b=!Ae(a)&&!m?a:y;let S=n.getPixelForValue(b);if(this.chart.getDataVisibility(e)?_=n.getPixelForValue(y+x):_=S,k=_-S,Math.abs(k)<l){k=ZP(k,n,u)*l,g===u&&(S-=k/2);const I=n.getPixelForDecimal(0),C=n.getPixelForDecimal(1),T=Math.min(I,C),A=Math.max(I,C);S=Math.max(Math.min(S,A),T),_=S+k,s&&!m&&(d._stacks[n.axis]._visualValues[r]=n.getValueForPixel(_)-n.getValueForPixel(S))}if(S===n.getPixelForValue(u)){const I=ss(k)*n.getLineWidthForValue(u)/2;S+=I,k-=I}return{size:k,base:S,head:_,center:_+k/2}}_calculateBarIndexPixels(e,n){const s=n.scale,r=this.options,a=r.skipNull,l=Pe(r.maxBarThickness,1/0);let u,d;const f=this._getAxisCount();if(n.grouped){const m=a?this._getStackCount(e):n.stackCount,g=r.barThickness==="flex"?XP(e,n,r,m*f):JP(e,n,r,m*f),y=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,x=this._getAxis().indexOf(Pe(y,this.getFirstScaleIdForIndexAxis())),_=this._getStackIndex(this.index,this._cachedMeta.stack,a?e:void 0)+x;u=g.start+g.chunk*_+g.chunk/2,d=Math.min(l,g.chunk*g.ratio)}else u=s.getPixelForValue(this.getParsed(e)[s.axis],e),d=Math.min(l,n.min*n.ratio);return{base:u-d/2,head:u+d/2,center:u,size:d}}draw(){const e=this._cachedMeta,n=e.vScale,s=e.data,r=s.length;let a=0;for(;a<r;++a)this.getParsed(a)[n.axis]!==null&&!s[a].hidden&&s[a].draw(this._ctx)}}class iI extends hr{static id="bubble";static defaults={datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}};static overrides={scales:{x:{type:"linear"},y:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(e,n,s,r){const a=super.parsePrimitiveData(e,n,s,r);for(let l=0;l<a.length;l++)a[l]._custom=this.resolveDataElementOptions(l+s).radius;return a}parseArrayData(e,n,s,r){const a=super.parseArrayData(e,n,s,r);for(let l=0;l<a.length;l++){const u=n[s+l];a[l]._custom=Pe(u[2],this.resolveDataElementOptions(l+s).radius)}return a}parseObjectData(e,n,s,r){const a=super.parseObjectData(e,n,s,r);for(let l=0;l<a.length;l++){const u=n[s+l];a[l]._custom=Pe(u&&u.r&&+u.r,this.resolveDataElementOptions(l+s).radius)}return a}getMaxOverflow(){const e=this._cachedMeta.data;let n=0;for(let s=e.length-1;s>=0;--s)n=Math.max(n,e[s].size(this.resolveDataElementOptions(s))/2);return n>0&&n}getLabelAndValue(e){const n=this._cachedMeta,s=this.chart.data.labels||[],{xScale:r,yScale:a}=n,l=this.getParsed(e),u=r.getLabelForValue(l.x),d=a.getLabelForValue(l.y),f=l._custom;return{label:s[e]||"",value:"("+u+", "+d+(f?", "+f:"")+")"}}update(e){const n=this._cachedMeta.data;this.updateElements(n,0,n.length,e)}updateElements(e,n,s,r){const a=r==="reset",{iScale:l,vScale:u}=this._cachedMeta,{sharedOptions:d,includeOptions:f}=this._getSharedOptions(n,r),m=l.axis,g=u.axis;for(let y=n;y<n+s;y++){const x=e[y],_=!a&&this.getParsed(y),k={},b=k[m]=a?l.getPixelForDecimal(.5):l.getPixelForValue(_[m]),S=k[g]=a?u.getBasePixel():u.getPixelForValue(_[g]);k.skip=isNaN(b)||isNaN(S),f&&(k.options=d||this.resolveDataElementOptions(y,x.active?"active":r),a&&(k.options.radius=0)),this.updateElement(x,y,k,r)}}resolveDataElementOptions(e,n){const s=this.getParsed(e);let r=super.resolveDataElementOptions(e,n);r.$shared&&(r=Object.assign({},r,{$shared:!1}));const a=r.radius;return n!=="active"&&(r.radius=0),r.radius+=Pe(s&&s._custom,a),r}}function aI(t,e,n){let s=1,r=1,a=0,l=0;if(e<Qe){const u=t,d=u+e,f=Math.cos(u),m=Math.sin(u),g=Math.cos(d),y=Math.sin(d),x=(C,T,A)=>Za(C,u,d,!0)?1:Math.max(T,T*n,A,A*n),_=(C,T,A)=>Za(C,u,d,!0)?-1:Math.min(T,T*n,A,A*n),k=x(0,f,g),b=x(pt,m,y),S=_($e,f,g),I=_($e+pt,m,y);s=(k-S)/2,r=(b-I)/2,a=-(k+S)/2,l=-(b+I)/2}return{ratioX:s,ratioY:r,offsetX:a,offsetY:l}}class tf extends hr{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const n=e.data,{labels:{pointStyle:s,textAlign:r,color:a,useBorderRadius:l,borderRadius:u}}=e.legend.options;return n.labels.length&&n.datasets.length?n.labels.map((d,f)=>{const g=e.getDatasetMeta(0).controller.getStyle(f);return{text:d,fillStyle:g.backgroundColor,fontColor:a,hidden:!e.getDataVisibility(f),lineDash:g.borderDash,lineDashOffset:g.borderDashOffset,lineJoin:g.borderJoinStyle,lineWidth:g.borderWidth,strokeStyle:g.borderColor,textAlign:r,pointStyle:s,borderRadius:l&&(u||g.borderRadius),index:f}}):[]}},onClick(e,n,s){s.chart.toggleDataVisibility(n.index),s.chart.update()}}}};constructor(e,n){super(e,n),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,n){const s=this.getDataset().data,r=this._cachedMeta;if(this._parsing===!1)r._parsed=s;else{let a=d=>+s[d];if(Re(s[e])){const{key:d="value"}=this._parsing;a=f=>+lr(s[f],d)}let l,u;for(l=e,u=e+n;l<u;++l)r._parsed[l]=a(l)}}_getRotation(){return Bn(this.options.rotation-90)}_getCircumference(){return Bn(this.options.circumference)}_getRotationExtents(){let e=Qe,n=-Qe;for(let s=0;s<this.chart.data.datasets.length;++s)if(this.chart.isDatasetVisible(s)&&this.chart.getDatasetMeta(s).type===this._type){const r=this.chart.getDatasetMeta(s).controller,a=r._getRotation(),l=r._getCircumference();e=Math.min(e,a),n=Math.max(n,a+l)}return{rotation:e,circumference:n-e}}update(e){const n=this.chart,{chartArea:s}=n,r=this._cachedMeta,a=r.data,l=this.getMaxBorderWidth()+this.getMaxOffset(a)+this.options.spacing,u=Math.max((Math.min(s.width,s.height)-l)/2,0),d=Math.min(gC(this.options.cutout,u),1),f=this._getRingWeight(this.index),{circumference:m,rotation:g}=this._getRotationExtents(),{ratioX:y,ratioY:x,offsetX:_,offsetY:k}=aI(g,m,d),b=(s.width-l)/y,S=(s.height-l)/x,I=Math.max(Math.min(b,S)/2,0),C=ex(this.options.radius,I),T=Math.max(C*d,0),A=(C-T)/this._getVisibleDatasetWeightTotal();this.offsetX=_*C,this.offsetY=k*C,r.total=this.calculateTotal(),this.outerRadius=C-A*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-A*f,0),this.updateElements(a,0,a.length,e)}_circumference(e,n){const s=this.options,r=this._cachedMeta,a=this._getCircumference();return n&&s.animation.animateRotate||!this.chart.getDataVisibility(e)||r._parsed[e]===null||r.data[e].hidden?0:this.calculateCircumference(r._parsed[e]*a/Qe)}updateElements(e,n,s,r){const a=r==="reset",l=this.chart,u=l.chartArea,f=l.options.animation,m=(u.left+u.right)/2,g=(u.top+u.bottom)/2,y=a&&f.animateScale,x=y?0:this.innerRadius,_=y?0:this.outerRadius,{sharedOptions:k,includeOptions:b}=this._getSharedOptions(n,r);let S=this._getRotation(),I;for(I=0;I<n;++I)S+=this._circumference(I,a);for(I=n;I<n+s;++I){const C=this._circumference(I,a),T=e[I],A={x:m+this.offsetX,y:g+this.offsetY,startAngle:S,endAngle:S+C,circumference:C,outerRadius:_,innerRadius:x};b&&(A.options=k||this.resolveDataElementOptions(I,T.active?"active":r)),S+=C,this.updateElement(T,I,A,r)}}calculateTotal(){const e=this._cachedMeta,n=e.data;let s=0,r;for(r=0;r<n.length;r++){const a=e._parsed[r];a!==null&&!isNaN(a)&&this.chart.getDataVisibility(r)&&!n[r].hidden&&(s+=Math.abs(a))}return s}calculateCircumference(e){const n=this._cachedMeta.total;return n>0&&!isNaN(e)?Qe*(Math.abs(e)/n):0}getLabelAndValue(e){const n=this._cachedMeta,s=this.chart,r=s.data.labels||[],a=lo(n._parsed[e],s.options.locale);return{label:r[e]||"",value:a}}getMaxBorderWidth(e){let n=0;const s=this.chart;let r,a,l,u,d;if(!e){for(r=0,a=s.data.datasets.length;r<a;++r)if(s.isDatasetVisible(r)){l=s.getDatasetMeta(r),e=l.data,u=l.controller;break}}if(!e)return 0;for(r=0,a=e.length;r<a;++r)d=u.resolveDataElementOptions(r),d.borderAlign!=="inner"&&(n=Math.max(n,d.borderWidth||0,d.hoverBorderWidth||0));return n}getMaxOffset(e){let n=0;for(let s=0,r=e.length;s<r;++s){const a=this.resolveDataElementOptions(s);n=Math.max(n,a.offset||0,a.hoverOffset||0)}return n}_getRingWeightOffset(e){let n=0;for(let s=0;s<e;++s)this.chart.isDatasetVisible(s)&&(n+=this._getRingWeight(s));return n}_getRingWeight(e){return Math.max(Pe(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}class oI extends hr{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const n=this._cachedMeta,{dataset:s,data:r=[],_dataset:a}=n,l=this.chart._animationsDisabled;let{start:u,count:d}=lx(n,r,l);this._drawStart=u,this._drawCount=d,cx(n)&&(u=0,d=r.length),s._chart=this.chart,s._datasetIndex=this.index,s._decimated=!!a._decimated,s.points=r;const f=this.resolveDatasetElementOptions(e);this.options.showLine||(f.borderWidth=0),f.segment=this.options.segment,this.updateElement(s,void 0,{animated:!l,options:f},e),this.updateElements(r,u,d,e)}updateElements(e,n,s,r){const a=r==="reset",{iScale:l,vScale:u,_stacked:d,_dataset:f}=this._cachedMeta,{sharedOptions:m,includeOptions:g}=this._getSharedOptions(n,r),y=l.axis,x=u.axis,{spanGaps:_,segment:k}=this.options,b=Ni(_)?_:Number.POSITIVE_INFINITY,S=this.chart._animationsDisabled||a||r==="none",I=n+s,C=e.length;let T=n>0&&this.getParsed(n-1);for(let A=0;A<C;++A){const z=e[A],E=S?z:{};if(A<n||A>=I){E.skip=!0;continue}const D=this.getParsed(A),M=Ae(D[x]),N=E[y]=l.getPixelForValue(D[y],A),F=E[x]=a||M?u.getBasePixel():u.getPixelForValue(d?this.applyStack(u,D,d):D[x],A);E.skip=isNaN(N)||isNaN(F)||M,E.stop=A>0&&Math.abs(D[y]-T[y])>b,k&&(E.parsed=D,E.raw=f.data[A]),g&&(E.options=m||this.resolveDataElementOptions(A,z.active?"active":r)),S||this.updateElement(z,A,E,r),T=D}}getMaxOverflow(){const e=this._cachedMeta,n=e.dataset,s=n.options&&n.options.borderWidth||0,r=e.data||[];if(!r.length)return s;const a=r[0].size(this.resolveDataElementOptions(0)),l=r[r.length-1].size(this.resolveDataElementOptions(r.length-1));return Math.max(s,a,l)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}class Ix extends hr{static id="polarArea";static defaults={dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const n=e.data;if(n.labels.length&&n.datasets.length){const{labels:{pointStyle:s,color:r}}=e.legend.options;return n.labels.map((a,l)=>{const d=e.getDatasetMeta(0).controller.getStyle(l);return{text:a,fillStyle:d.backgroundColor,strokeStyle:d.borderColor,fontColor:r,lineWidth:d.borderWidth,pointStyle:s,hidden:!e.getDataVisibility(l),index:l}})}return[]}},onClick(e,n,s){s.chart.toggleDataVisibility(n.index),s.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}};constructor(e,n){super(e,n),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(e){const n=this._cachedMeta,s=this.chart,r=s.data.labels||[],a=lo(n._parsed[e].r,s.options.locale);return{label:r[e]||"",value:a}}parseObjectData(e,n,s,r){return yx.bind(this)(e,n,s,r)}update(e){const n=this._cachedMeta.data;this._updateRadius(),this.updateElements(n,0,n.length,e)}getMinMax(){const e=this._cachedMeta,n={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return e.data.forEach((s,r)=>{const a=this.getParsed(r).r;!isNaN(a)&&this.chart.getDataVisibility(r)&&(a<n.min&&(n.min=a),a>n.max&&(n.max=a))}),n}_updateRadius(){const e=this.chart,n=e.chartArea,s=e.options,r=Math.min(n.right-n.left,n.bottom-n.top),a=Math.max(r/2,0),l=Math.max(s.cutoutPercentage?a/100*s.cutoutPercentage:1,0),u=(a-l)/e.getVisibleDatasetCount();this.outerRadius=a-u*this.index,this.innerRadius=this.outerRadius-u}updateElements(e,n,s,r){const a=r==="reset",l=this.chart,d=l.options.animation,f=this._cachedMeta.rScale,m=f.xCenter,g=f.yCenter,y=f.getIndexAngle(0)-.5*$e;let x=y,_;const k=360/this.countVisibleElements();for(_=0;_<n;++_)x+=this._computeAngle(_,r,k);for(_=n;_<n+s;_++){const b=e[_];let S=x,I=x+this._computeAngle(_,r,k),C=l.getDataVisibility(_)?f.getDistanceFromCenterForValue(this.getParsed(_).r):0;x=I,a&&(d.animateScale&&(C=0),d.animateRotate&&(S=I=y));const T={x:m,y:g,innerRadius:0,outerRadius:C,startAngle:S,endAngle:I,options:this.resolveDataElementOptions(_,b.active?"active":r)};this.updateElement(b,_,T,r)}}countVisibleElements(){const e=this._cachedMeta;let n=0;return e.data.forEach((s,r)=>{!isNaN(this.getParsed(r).r)&&this.chart.getDataVisibility(r)&&n++}),n}_computeAngle(e,n,s){return this.chart.getDataVisibility(e)?Bn(this.resolveDataElementOptions(e,n).angle||s):0}}class lI extends tf{static id="pie";static defaults={cutout:0,rotation:0,circumference:360,radius:"100%"}}class cI extends hr{static id="radar";static defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}};static overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};getLabelAndValue(e){const n=this._cachedMeta.vScale,s=this.getParsed(e);return{label:n.getLabels()[e],value:""+n.getLabelForValue(s[n.axis])}}parseObjectData(e,n,s,r){return yx.bind(this)(e,n,s,r)}update(e){const n=this._cachedMeta,s=n.dataset,r=n.data||[],a=n.iScale.getLabels();if(s.points=r,e!=="resize"){const l=this.resolveDatasetElementOptions(e);this.options.showLine||(l.borderWidth=0);const u={_loop:!0,_fullLoop:a.length===r.length,options:l};this.updateElement(s,void 0,u,e)}this.updateElements(r,0,r.length,e)}updateElements(e,n,s,r){const a=this._cachedMeta.rScale,l=r==="reset";for(let u=n;u<n+s;u++){const d=e[u],f=this.resolveDataElementOptions(u,d.active?"active":r),m=a.getPointPositionForValue(u,this.getParsed(u).r),g=l?a.xCenter:m.x,y=l?a.yCenter:m.y,x={x:g,y,angle:m.angle,skip:isNaN(g)||isNaN(y),options:f};this.updateElement(d,u,x,r)}}}class uI extends hr{static id="scatter";static defaults={datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1};static overrides={interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}};getLabelAndValue(e){const n=this._cachedMeta,s=this.chart.data.labels||[],{xScale:r,yScale:a}=n,l=this.getParsed(e),u=r.getLabelForValue(l.x),d=a.getLabelForValue(l.y);return{label:s[e]||"",value:"("+u+", "+d+")"}}update(e){const n=this._cachedMeta,{data:s=[]}=n,r=this.chart._animationsDisabled;let{start:a,count:l}=lx(n,s,r);if(this._drawStart=a,this._drawCount=l,cx(n)&&(a=0,l=s.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:u,_dataset:d}=n;u._chart=this.chart,u._datasetIndex=this.index,u._decimated=!!d._decimated,u.points=s;const f=this.resolveDatasetElementOptions(e);f.segment=this.options.segment,this.updateElement(u,void 0,{animated:!r,options:f},e)}else this.datasetElementType&&(delete n.dataset,this.datasetElementType=!1);this.updateElements(s,a,l,e)}addElements(){const{showLine:e}=this.options;!this.datasetElementType&&e&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(e,n,s,r){const a=r==="reset",{iScale:l,vScale:u,_stacked:d,_dataset:f}=this._cachedMeta,m=this.resolveDataElementOptions(n,r),g=this.getSharedOptions(m),y=this.includeOptions(r,g),x=l.axis,_=u.axis,{spanGaps:k,segment:b}=this.options,S=Ni(k)?k:Number.POSITIVE_INFINITY,I=this.chart._animationsDisabled||a||r==="none";let C=n>0&&this.getParsed(n-1);for(let T=n;T<n+s;++T){const A=e[T],z=this.getParsed(T),E=I?A:{},D=Ae(z[_]),M=E[x]=l.getPixelForValue(z[x],T),N=E[_]=a||D?u.getBasePixel():u.getPixelForValue(d?this.applyStack(u,z,d):z[_],T);E.skip=isNaN(M)||isNaN(N)||D,E.stop=T>0&&Math.abs(z[x]-C[x])>S,b&&(E.parsed=z,E.raw=f.data[T]),y&&(E.options=g||this.resolveDataElementOptions(T,A.active?"active":r)),I||this.updateElement(A,T,E,r),C=z}this.updateSharedOptions(g,r,m)}getMaxOverflow(){const e=this._cachedMeta,n=e.data||[];if(!this.options.showLine){let u=0;for(let d=n.length-1;d>=0;--d)u=Math.max(u,n[d].size(this.resolveDataElementOptions(d))/2);return u>0&&u}const s=e.dataset,r=s.options&&s.options.borderWidth||0;if(!n.length)return r;const a=n[0].size(this.resolveDataElementOptions(0)),l=n[n.length-1].size(this.resolveDataElementOptions(n.length-1));return Math.max(r,a,l)/2}}var dI=Object.freeze({__proto__:null,BarController:rI,BubbleController:iI,DoughnutController:tf,LineController:oI,PieController:lI,PolarAreaController:Ix,RadarController:cI,ScatterController:uI});function Ar(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class nf{static override(e){Object.assign(nf.prototype,e)}options;constructor(e){this.options=e||{}}init(){}formats(){return Ar()}parse(){return Ar()}format(){return Ar()}add(){return Ar()}diff(){return Ar()}startOf(){return Ar()}endOf(){return Ar()}}var hI={_date:nf};function fI(t,e,n,s){const{controller:r,data:a,_sorted:l}=t,u=r._cachedMeta.iScale,d=t.dataset&&t.dataset.options?t.dataset.options.spanGaps:null;if(u&&e===u.axis&&e!=="r"&&l&&a.length){const f=u._reversePixels?EC:js;if(s){if(r._sharedOptions){const m=a[0],g=typeof m.getRange=="function"&&m.getRange(e);if(g){const y=f(a,e,n-g),x=f(a,e,n+g);return{lo:y.lo,hi:x.hi}}}}else{const m=f(a,e,n);if(d){const{vScale:g}=r._cachedMeta,{_parsed:y}=t,x=y.slice(0,m.lo+1).reverse().findIndex(k=>!Ae(k[g.axis]));m.lo-=Math.max(0,x);const _=y.slice(m.hi).findIndex(k=>!Ae(k[g.axis]));m.hi+=Math.max(0,_)}return m}}return{lo:0,hi:a.length-1}}function kc(t,e,n,s,r){const a=t.getSortedVisibleDatasetMetas(),l=n[e];for(let u=0,d=a.length;u<d;++u){const{index:f,data:m}=a[u],{lo:g,hi:y}=fI(a[u],e,l,r);for(let x=g;x<=y;++x){const _=m[x];_.skip||s(_,f,x)}}}function pI(t){const e=t.indexOf("x")!==-1,n=t.indexOf("y")!==-1;return function(s,r){const a=e?Math.abs(s.x-r.x):0,l=n?Math.abs(s.y-r.y):0;return Math.sqrt(Math.pow(a,2)+Math.pow(l,2))}}function Rd(t,e,n,s,r){const a=[];return!r&&!t.isPointInArea(e)||kc(t,n,e,function(u,d,f){!r&&!Cs(u,t.chartArea,0)||u.inRange(e.x,e.y,s)&&a.push({element:u,datasetIndex:d,index:f})},!0),a}function mI(t,e,n,s){let r=[];function a(l,u,d){const{startAngle:f,endAngle:m}=l.getProps(["startAngle","endAngle"],s),{angle:g}=sx(l,{x:e.x,y:e.y});Za(g,f,m)&&r.push({element:l,datasetIndex:u,index:d})}return kc(t,n,e,a),r}function gI(t,e,n,s,r,a){let l=[];const u=pI(n);let d=Number.POSITIVE_INFINITY;function f(m,g,y){const x=m.inRange(e.x,e.y,r);if(s&&!x)return;const _=m.getCenterPoint(r);if(!(!!a||t.isPointInArea(_))&&!x)return;const b=u(e,_);b<d?(l=[{element:m,datasetIndex:g,index:y}],d=b):b===d&&l.push({element:m,datasetIndex:g,index:y})}return kc(t,n,e,f),l}function Md(t,e,n,s,r,a){return!a&&!t.isPointInArea(e)?[]:n==="r"&&!s?mI(t,e,n,r):gI(t,e,n,s,r,a)}function yy(t,e,n,s,r){const a=[],l=n==="x"?"inXRange":"inYRange";let u=!1;return kc(t,n,e,(d,f,m)=>{d[l]&&d[l](e[n],r)&&(a.push({element:d,datasetIndex:f,index:m}),u=u||d.inRange(e.x,e.y,r))}),s&&!u?[]:a}var yI={modes:{index(t,e,n,s){const r=Mr(e,t),a=n.axis||"x",l=n.includeInvisible||!1,u=n.intersect?Rd(t,r,a,s,l):Md(t,r,a,!1,s,l),d=[];return u.length?(t.getSortedVisibleDatasetMetas().forEach(f=>{const m=u[0].index,g=f.data[m];g&&!g.skip&&d.push({element:g,datasetIndex:f.index,index:m})}),d):[]},dataset(t,e,n,s){const r=Mr(e,t),a=n.axis||"xy",l=n.includeInvisible||!1;let u=n.intersect?Rd(t,r,a,s,l):Md(t,r,a,!1,s,l);if(u.length>0){const d=u[0].datasetIndex,f=t.getDatasetMeta(d).data;u=[];for(let m=0;m<f.length;++m)u.push({element:f[m],datasetIndex:d,index:m})}return u},point(t,e,n,s){const r=Mr(e,t),a=n.axis||"xy",l=n.includeInvisible||!1;return Rd(t,r,a,s,l)},nearest(t,e,n,s){const r=Mr(e,t),a=n.axis||"xy",l=n.includeInvisible||!1;return Md(t,r,a,n.intersect,s,l)},x(t,e,n,s){const r=Mr(e,t);return yy(t,r,"x",n.intersect,s)},y(t,e,n,s){const r=Mr(e,t);return yy(t,r,"y",n.intersect,s)}}};const Ex=["left","top","right","bottom"];function wa(t,e){return t.filter(n=>n.pos===e)}function vy(t,e){return t.filter(n=>Ex.indexOf(n.pos)===-1&&n.box.axis===e)}function _a(t,e){return t.sort((n,s)=>{const r=e?s:n,a=e?n:s;return r.weight===a.weight?r.index-a.index:r.weight-a.weight})}function vI(t){const e=[];let n,s,r,a,l,u;for(n=0,s=(t||[]).length;n<s;++n)r=t[n],{position:a,options:{stack:l,stackWeight:u=1}}=r,e.push({index:n,box:r,pos:a,horizontal:r.isHorizontal(),weight:r.weight,stack:l&&a+l,stackWeight:u});return e}function xI(t){const e={};for(const n of t){const{stack:s,pos:r,stackWeight:a}=n;if(!s||!Ex.includes(r))continue;const l=e[s]||(e[s]={count:0,placed:0,weight:0,size:0});l.count++,l.weight+=a}return e}function bI(t,e){const n=xI(t),{vBoxMaxWidth:s,hBoxMaxHeight:r}=e;let a,l,u;for(a=0,l=t.length;a<l;++a){u=t[a];const{fullSize:d}=u.box,f=n[u.stack],m=f&&u.stackWeight/f.weight;u.horizontal?(u.width=m?m*s:d&&e.availableWidth,u.height=r):(u.width=s,u.height=m?m*r:d&&e.availableHeight)}return n}function wI(t){const e=vI(t),n=_a(e.filter(f=>f.box.fullSize),!0),s=_a(wa(e,"left"),!0),r=_a(wa(e,"right")),a=_a(wa(e,"top"),!0),l=_a(wa(e,"bottom")),u=vy(e,"x"),d=vy(e,"y");return{fullSize:n,leftAndTop:s.concat(a),rightAndBottom:r.concat(d).concat(l).concat(u),chartArea:wa(e,"chartArea"),vertical:s.concat(r).concat(d),horizontal:a.concat(l).concat(u)}}function xy(t,e,n,s){return Math.max(t[n],e[n])+Math.max(t[s],e[s])}function Tx(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function _I(t,e,n,s){const{pos:r,box:a}=n,l=t.maxPadding;if(!Re(r)){n.size&&(t[r]-=n.size);const g=s[n.stack]||{size:0,count:1};g.size=Math.max(g.size,n.horizontal?a.height:a.width),n.size=g.size/g.count,t[r]+=n.size}a.getPadding&&Tx(l,a.getPadding());const u=Math.max(0,e.outerWidth-xy(l,t,"left","right")),d=Math.max(0,e.outerHeight-xy(l,t,"top","bottom")),f=u!==t.w,m=d!==t.h;return t.w=u,t.h=d,n.horizontal?{same:f,other:m}:{same:m,other:f}}function kI(t){const e=t.maxPadding;function n(s){const r=Math.max(e[s]-t[s],0);return t[s]+=r,r}t.y+=n("top"),t.x+=n("left"),n("right"),n("bottom")}function SI(t,e){const n=e.maxPadding;function s(r){const a={left:0,top:0,right:0,bottom:0};return r.forEach(l=>{a[l]=Math.max(e[l],n[l])}),a}return s(t?["left","right"]:["top","bottom"])}function Na(t,e,n,s){const r=[];let a,l,u,d,f,m;for(a=0,l=t.length,f=0;a<l;++a){u=t[a],d=u.box,d.update(u.width||e.w,u.height||e.h,SI(u.horizontal,e));const{same:g,other:y}=_I(e,n,u,s);f|=g&&r.length,m=m||y,d.fullSize||r.push(u)}return f&&Na(r,e,n,s)||m}function Ml(t,e,n,s,r){t.top=n,t.left=e,t.right=e+s,t.bottom=n+r,t.width=s,t.height=r}function by(t,e,n,s){const r=n.padding;let{x:a,y:l}=e;for(const u of t){const d=u.box,f=s[u.stack]||{placed:0,weight:1},m=u.stackWeight/f.weight||1;if(u.horizontal){const g=e.w*m,y=f.size||d.height;Qa(f.start)&&(l=f.start),d.fullSize?Ml(d,r.left,l,n.outerWidth-r.right-r.left,y):Ml(d,e.left+f.placed,l,g,y),f.start=l,f.placed+=g,l=d.bottom}else{const g=e.h*m,y=f.size||d.width;Qa(f.start)&&(a=f.start),d.fullSize?Ml(d,a,r.top,y,n.outerHeight-r.bottom-r.top):Ml(d,a,e.top+f.placed,y,g),f.start=a,f.placed+=g,a=d.right}}e.x=a,e.y=l}var $t={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(n){e.draw(n)}}]},t.boxes.push(e)},removeBox(t,e){const n=t.boxes?t.boxes.indexOf(e):-1;n!==-1&&t.boxes.splice(n,1)},configure(t,e,n){e.fullSize=n.fullSize,e.position=n.position,e.weight=n.weight},update(t,e,n,s){if(!t)return;const r=zt(t.options.layout.padding),a=Math.max(e-r.width,0),l=Math.max(n-r.height,0),u=wI(t.boxes),d=u.vertical,f=u.horizontal;Ve(t.boxes,k=>{typeof k.beforeLayout=="function"&&k.beforeLayout()});const m=d.reduce((k,b)=>b.box.options&&b.box.options.display===!1?k:k+1,0)||1,g=Object.freeze({outerWidth:e,outerHeight:n,padding:r,availableWidth:a,availableHeight:l,vBoxMaxWidth:a/2/m,hBoxMaxHeight:l/2}),y=Object.assign({},r);Tx(y,zt(s));const x=Object.assign({maxPadding:y,w:a,h:l,x:r.left,y:r.top},r),_=bI(d.concat(f),g);Na(u.fullSize,x,g,_),Na(d,x,g,_),Na(f,x,g,_)&&Na(d,x,g,_),kI(x),by(u.leftAndTop,x,g,_),x.x+=x.w,x.y+=x.h,by(u.rightAndBottom,x,g,_),t.chartArea={left:x.left,top:x.top,right:x.left+x.w,bottom:x.top+x.h,height:x.h,width:x.w},Ve(u.chartArea,k=>{const b=k.box;Object.assign(b,t.chartArea),b.update(x.w,x.h,{left:0,top:0,right:0,bottom:0})})}};class Nx{acquireContext(e,n){}releaseContext(e){return!1}addEventListener(e,n,s){}removeEventListener(e,n,s){}getDevicePixelRatio(){return 1}getMaximumSize(e,n,s,r){return n=Math.max(0,n||e.width),s=s||e.height,{width:n,height:Math.max(0,r?Math.floor(n/r):s)}}isAttached(e){return!0}updateConfig(e){}}class jI extends Nx{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const ql="$chartjs",CI={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},wy=t=>t===null||t==="";function PI(t,e){const n=t.style,s=t.getAttribute("height"),r=t.getAttribute("width");if(t[ql]={initial:{height:s,width:r,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",wy(r)){const a=ry(t,"width");a!==void 0&&(t.width=a)}if(wy(s))if(t.style.height==="")t.height=t.width/(e||2);else{const a=ry(t,"height");a!==void 0&&(t.height=a)}return t}const Ax=_P?{passive:!0}:!1;function II(t,e,n){t&&t.addEventListener(e,n,Ax)}function EI(t,e,n){t&&t.canvas&&t.canvas.removeEventListener(e,n,Ax)}function TI(t,e){const n=CI[t.type]||t.type,{x:s,y:r}=Mr(t,e);return{type:n,chart:e,native:t,x:s!==void 0?s:null,y:r!==void 0?r:null}}function ac(t,e){for(const n of t)if(n===e||n.contains(e))return!0}function NI(t,e,n){const s=t.canvas,r=new MutationObserver(a=>{let l=!1;for(const u of a)l=l||ac(u.addedNodes,s),l=l&&!ac(u.removedNodes,s);l&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}function AI(t,e,n){const s=t.canvas,r=new MutationObserver(a=>{let l=!1;for(const u of a)l=l||ac(u.removedNodes,s),l=l&&!ac(u.addedNodes,s);l&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}const to=new Map;let _y=0;function Ox(){const t=window.devicePixelRatio;t!==_y&&(_y=t,to.forEach((e,n)=>{n.currentDevicePixelRatio!==t&&e()}))}function OI(t,e){to.size||window.addEventListener("resize",Ox),to.set(t,e)}function RI(t){to.delete(t),to.size||window.removeEventListener("resize",Ox)}function MI(t,e,n){const s=t.canvas,r=s&&ef(s);if(!r)return;const a=ox((u,d)=>{const f=r.clientWidth;n(u,d),f<r.clientWidth&&n()},window),l=new ResizeObserver(u=>{const d=u[0],f=d.contentRect.width,m=d.contentRect.height;f===0&&m===0||a(f,m)});return l.observe(r),OI(t,a),l}function Ld(t,e,n){n&&n.disconnect(),e==="resize"&&RI(t)}function LI(t,e,n){const s=t.canvas,r=ox(a=>{t.ctx!==null&&n(TI(a,t))},t);return II(s,e,r),r}class DI extends Nx{acquireContext(e,n){const s=e&&e.getContext&&e.getContext("2d");return s&&s.canvas===e?(PI(e,n),s):null}releaseContext(e){const n=e.canvas;if(!n[ql])return!1;const s=n[ql].initial;["height","width"].forEach(a=>{const l=s[a];Ae(l)?n.removeAttribute(a):n.setAttribute(a,l)});const r=s.style||{};return Object.keys(r).forEach(a=>{n.style[a]=r[a]}),n.width=n.width,delete n[ql],!0}addEventListener(e,n,s){this.removeEventListener(e,n);const r=e.$proxies||(e.$proxies={}),l={attach:NI,detach:AI,resize:MI}[n]||LI;r[n]=l(e,n,s)}removeEventListener(e,n){const s=e.$proxies||(e.$proxies={}),r=s[n];if(!r)return;({attach:Ld,detach:Ld,resize:Ld}[n]||EI)(e,n,r),s[n]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,n,s,r){return wP(e,n,s,r)}isAttached(e){const n=e&&ef(e);return!!(n&&n.isConnected)}}function FI(t){return!Zh()||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas?jI:DI}class Ts{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(e){const{x:n,y:s}=this.getProps(["x","y"],e);return{x:n,y:s}}hasValue(){return Ni(this.x)&&Ni(this.y)}getProps(e,n){const s=this.$animations;if(!n||!s)return this;const r={};return e.forEach(a=>{r[a]=s[a]&&s[a].active()?s[a]._to:this[a]}),r}}function BI(t,e){const n=t.options.ticks,s=$I(t),r=Math.min(n.maxTicksLimit||s,s),a=n.major.enabled?UI(e):[],l=a.length,u=a[0],d=a[l-1],f=[];if(l>r)return WI(e,f,a,l/r),f;const m=zI(a,e,r);if(l>0){let g,y;const x=l>1?Math.round((d-u)/(l-1)):null;for(Ll(e,f,m,Ae(x)?0:u-x,u),g=0,y=l-1;g<y;g++)Ll(e,f,m,a[g],a[g+1]);return Ll(e,f,m,d,Ae(x)?e.length:d+x),f}return Ll(e,f,m),f}function $I(t){const e=t.options.offset,n=t._tickSize(),s=t._length/n+(e?0:1),r=t._maxLength/n;return Math.floor(Math.min(s,r))}function zI(t,e,n){const s=VI(t),r=e.length/n;if(!s)return Math.max(r,1);const a=SC(s);for(let l=0,u=a.length-1;l<u;l++){const d=a[l];if(d>r)return d}return Math.max(r,1)}function UI(t){const e=[];let n,s;for(n=0,s=t.length;n<s;n++)t[n].major&&e.push(n);return e}function WI(t,e,n,s){let r=0,a=n[0],l;for(s=Math.ceil(s),l=0;l<t.length;l++)l===a&&(e.push(t[l]),r++,a=n[r*s])}function Ll(t,e,n,s,r){const a=Pe(s,0),l=Math.min(Pe(r,t.length),t.length);let u=0,d,f,m;for(n=Math.ceil(n),r&&(d=r-s,n=d/Math.floor(d/n)),m=a;m<0;)u++,m=Math.round(a+u*n);for(f=Math.max(a,0);f<l;f++)f===m&&(e.push(t[f]),u++,m=Math.round(a+u*n))}function VI(t){const e=t.length;let n,s;if(e<2)return!1;for(s=t[0],n=1;n<e;++n)if(t[n]-t[n-1]!==s)return!1;return s}const qI=t=>t==="left"?"right":t==="right"?"left":t,ky=(t,e,n)=>e==="top"||e==="left"?t[e]+n:t[e]-n,Sy=(t,e)=>Math.min(e||t,t);function jy(t,e){const n=[],s=t.length/e,r=t.length;let a=0;for(;a<r;a+=s)n.push(t[Math.floor(a)]);return n}function HI(t,e,n){const s=t.ticks.length,r=Math.min(e,s-1),a=t._startPixel,l=t._endPixel,u=1e-6;let d=t.getPixelForTick(r),f;if(!(n&&(s===1?f=Math.max(d-a,l-d):e===0?f=(t.getPixelForTick(1)-d)/2:f=(d-t.getPixelForTick(r-1))/2,d+=r<e?f:-f,d<a-u||d>l+u)))return d}function KI(t,e){Ve(t,n=>{const s=n.gc,r=s.length/2;let a;if(r>e){for(a=0;a<r;++a)delete n.data[s[a]];s.splice(0,r)}})}function ka(t){return t.drawTicks?t.tickLength:0}function Cy(t,e){if(!t.display)return 0;const n=_t(t.font,e),s=zt(t.padding);return(tt(t.text)?t.text.length:1)*n.lineHeight+s.height}function GI(t,e){return dr(t,{scale:e,type:"scale"})}function YI(t,e,n){return dr(t,{tick:n,index:e,type:"tick"})}function JI(t,e,n){let s=Kh(t);return(n&&e!=="right"||!n&&e==="right")&&(s=qI(s)),s}function XI(t,e,n,s){const{top:r,left:a,bottom:l,right:u,chart:d}=t,{chartArea:f,scales:m}=d;let g=0,y,x,_;const k=l-r,b=u-a;if(t.isHorizontal()){if(x=Ft(s,a,u),Re(n)){const S=Object.keys(n)[0],I=n[S];_=m[S].getPixelForValue(I)+k-e}else n==="center"?_=(f.bottom+f.top)/2+k-e:_=ky(t,n,e);y=u-a}else{if(Re(n)){const S=Object.keys(n)[0],I=n[S];x=m[S].getPixelForValue(I)-b+e}else n==="center"?x=(f.left+f.right)/2-b+e:x=ky(t,n,e);_=Ft(s,l,r),g=n==="left"?-pt:pt}return{titleX:x,titleY:_,maxWidth:y,rotation:g}}class qr extends Ts{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,n){return e}getUserBounds(){let{_userMin:e,_userMax:n,_suggestedMin:s,_suggestedMax:r}=this;return e=hn(e,Number.POSITIVE_INFINITY),n=hn(n,Number.NEGATIVE_INFINITY),s=hn(s,Number.POSITIVE_INFINITY),r=hn(r,Number.NEGATIVE_INFINITY),{min:hn(e,s),max:hn(n,r),minDefined:ct(e),maxDefined:ct(n)}}getMinMax(e){let{min:n,max:s,minDefined:r,maxDefined:a}=this.getUserBounds(),l;if(r&&a)return{min:n,max:s};const u=this.getMatchingVisibleMetas();for(let d=0,f=u.length;d<f;++d)l=u[d].controller.getMinMax(this,e),r||(n=Math.min(n,l.min)),a||(s=Math.max(s,l.max));return n=a&&n>s?s:n,s=r&&n>s?n:s,{min:hn(n,hn(s,n)),max:hn(s,hn(n,s))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Ye(this.options.beforeUpdate,[this])}update(e,n,s){const{beginAtZero:r,grace:a,ticks:l}=this.options,u=l.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=n,this._margins=s=Object.assign({left:0,right:0,top:0,bottom:0},s),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+s.left+s.right:this.height+s.top+s.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=ZC(this,a,r),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const d=u<this.ticks.length;this._convertTicksToLabels(d?jy(this.ticks,u):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),l.display&&(l.autoSkip||l.source==="auto")&&(this.ticks=BI(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),d&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,n,s;this.isHorizontal()?(n=this.left,s=this.right):(n=this.top,s=this.bottom,e=!e),this._startPixel=n,this._endPixel=s,this._reversePixels=e,this._length=s-n,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Ye(this.options.afterUpdate,[this])}beforeSetDimensions(){Ye(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Ye(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),Ye(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Ye(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const n=this.options.ticks;let s,r,a;for(s=0,r=e.length;s<r;s++)a=e[s],a.label=Ye(n.callback,[a.value,s,e],this)}afterTickToLabelConversion(){Ye(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Ye(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,n=e.ticks,s=Sy(this.ticks.length,e.ticks.maxTicksLimit),r=n.minRotation||0,a=n.maxRotation;let l=r,u,d,f;if(!this._isVisible()||!n.display||r>=a||s<=1||!this.isHorizontal()){this.labelRotation=r;return}const m=this._getLabelSizes(),g=m.widest.width,y=m.highest.height,x=Ct(this.chart.width-g,0,this.maxWidth);u=e.offset?this.maxWidth/s:x/(s-1),g+6>u&&(u=x/(s-(e.offset?.5:1)),d=this.maxHeight-ka(e.grid)-n.padding-Cy(e.title,this.chart.options.font),f=Math.sqrt(g*g+y*y),l=qh(Math.min(Math.asin(Ct((m.highest.height+6)/u,-1,1)),Math.asin(Ct(d/f,-1,1))-Math.asin(Ct(y/f,-1,1)))),l=Math.max(r,Math.min(a,l))),this.labelRotation=l}afterCalculateLabelRotation(){Ye(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Ye(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:n,options:{ticks:s,title:r,grid:a}}=this,l=this._isVisible(),u=this.isHorizontal();if(l){const d=Cy(r,n.options.font);if(u?(e.width=this.maxWidth,e.height=ka(a)+d):(e.height=this.maxHeight,e.width=ka(a)+d),s.display&&this.ticks.length){const{first:f,last:m,widest:g,highest:y}=this._getLabelSizes(),x=s.padding*2,_=Bn(this.labelRotation),k=Math.cos(_),b=Math.sin(_);if(u){const S=s.mirror?0:b*g.width+k*y.height;e.height=Math.min(this.maxHeight,e.height+S+x)}else{const S=s.mirror?0:k*g.width+b*y.height;e.width=Math.min(this.maxWidth,e.width+S+x)}this._calculatePadding(f,m,b,k)}}this._handleMargins(),u?(this.width=this._length=n.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=n.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,n,s,r){const{ticks:{align:a,padding:l},position:u}=this.options,d=this.labelRotation!==0,f=u!=="top"&&this.axis==="x";if(this.isHorizontal()){const m=this.getPixelForTick(0)-this.left,g=this.right-this.getPixelForTick(this.ticks.length-1);let y=0,x=0;d?f?(y=r*e.width,x=s*n.height):(y=s*e.height,x=r*n.width):a==="start"?x=n.width:a==="end"?y=e.width:a!=="inner"&&(y=e.width/2,x=n.width/2),this.paddingLeft=Math.max((y-m+l)*this.width/(this.width-m),0),this.paddingRight=Math.max((x-g+l)*this.width/(this.width-g),0)}else{let m=n.height/2,g=e.height/2;a==="start"?(m=0,g=e.height):a==="end"&&(m=n.height,g=0),this.paddingTop=m+l,this.paddingBottom=g+l}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Ye(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:n}=this.options;return n==="top"||n==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let n,s;for(n=0,s=e.length;n<s;n++)Ae(e[n].label)&&(e.splice(n,1),s--,n--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const n=this.options.ticks.sampleSize;let s=this.ticks;n<s.length&&(s=jy(s,n)),this._labelSizes=e=this._computeLabelSizes(s,s.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,n,s){const{ctx:r,_longestTextCache:a}=this,l=[],u=[],d=Math.floor(n/Sy(n,s));let f=0,m=0,g,y,x,_,k,b,S,I,C,T,A;for(g=0;g<n;g+=d){if(_=e[g].label,k=this._resolveTickFontOptions(g),r.font=b=k.string,S=a[b]=a[b]||{data:{},gc:[]},I=k.lineHeight,C=T=0,!Ae(_)&&!tt(_))C=rc(r,S.data,S.gc,C,_),T=I;else if(tt(_))for(y=0,x=_.length;y<x;++y)A=_[y],!Ae(A)&&!tt(A)&&(C=rc(r,S.data,S.gc,C,A),T+=I);l.push(C),u.push(T),f=Math.max(C,f),m=Math.max(T,m)}KI(a,n);const z=l.indexOf(f),E=u.indexOf(m),D=M=>({width:l[M]||0,height:u[M]||0});return{first:D(0),last:D(n-1),widest:D(z),highest:D(E),widths:l,heights:u}}getLabelForValue(e){return e}getPixelForValue(e,n){return NaN}getValueForPixel(e){}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const n=this._startPixel+e*this._length;return IC(this._alignToPixels?Nr(this.chart,n,0):n)}getDecimalForPixel(e){const n=(e-this._startPixel)/this._length;return this._reversePixels?1-n:n}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:n}=this;return e<0&&n<0?n:e>0&&n>0?e:0}getContext(e){const n=this.ticks||[];if(e>=0&&e<n.length){const s=n[e];return s.$context||(s.$context=YI(this.getContext(),e,s))}return this.$context||(this.$context=GI(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,n=Bn(this.labelRotation),s=Math.abs(Math.cos(n)),r=Math.abs(Math.sin(n)),a=this._getLabelSizes(),l=e.autoSkipPadding||0,u=a?a.widest.width+l:0,d=a?a.highest.height+l:0;return this.isHorizontal()?d*s>u*r?u/s:d/r:d*r<u*s?d/s:u/r}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const n=this.axis,s=this.chart,r=this.options,{grid:a,position:l,border:u}=r,d=a.offset,f=this.isHorizontal(),g=this.ticks.length+(d?1:0),y=ka(a),x=[],_=u.setContext(this.getContext()),k=_.display?_.width:0,b=k/2,S=function(re){return Nr(s,re,k)};let I,C,T,A,z,E,D,M,N,F,H,J;if(l==="top")I=S(this.bottom),E=this.bottom-y,M=I-b,F=S(e.top)+b,J=e.bottom;else if(l==="bottom")I=S(this.top),F=e.top,J=S(e.bottom)-b,E=I+b,M=this.top+y;else if(l==="left")I=S(this.right),z=this.right-y,D=I-b,N=S(e.left)+b,H=e.right;else if(l==="right")I=S(this.left),N=e.left,H=S(e.right)-b,z=I+b,D=this.left+y;else if(n==="x"){if(l==="center")I=S((e.top+e.bottom)/2+.5);else if(Re(l)){const re=Object.keys(l)[0],pe=l[re];I=S(this.chart.scales[re].getPixelForValue(pe))}F=e.top,J=e.bottom,E=I+b,M=E+y}else if(n==="y"){if(l==="center")I=S((e.left+e.right)/2);else if(Re(l)){const re=Object.keys(l)[0],pe=l[re];I=S(this.chart.scales[re].getPixelForValue(pe))}z=I-b,D=z-y,N=e.left,H=e.right}const Y=Pe(r.ticks.maxTicksLimit,g),X=Math.max(1,Math.ceil(g/Y));for(C=0;C<g;C+=X){const re=this.getContext(C),pe=a.setContext(re),ee=u.setContext(re),ce=pe.lineWidth,ie=pe.color,U=ee.dash||[],B=ee.dashOffset,le=pe.tickWidth,ae=pe.tickColor,ge=pe.tickBorderDash||[],we=pe.tickBorderDashOffset;T=HI(this,C,d),T!==void 0&&(A=Nr(s,T,ce),f?z=D=N=H=A:E=M=F=J=A,x.push({tx1:z,ty1:E,tx2:D,ty2:M,x1:N,y1:F,x2:H,y2:J,width:ce,color:ie,borderDash:U,borderDashOffset:B,tickWidth:le,tickColor:ae,tickBorderDash:ge,tickBorderDashOffset:we}))}return this._ticksLength=g,this._borderValue=I,x}_computeLabelItems(e){const n=this.axis,s=this.options,{position:r,ticks:a}=s,l=this.isHorizontal(),u=this.ticks,{align:d,crossAlign:f,padding:m,mirror:g}=a,y=ka(s.grid),x=y+m,_=g?-m:x,k=-Bn(this.labelRotation),b=[];let S,I,C,T,A,z,E,D,M,N,F,H,J="middle";if(r==="top")z=this.bottom-_,E=this._getXAxisLabelAlignment();else if(r==="bottom")z=this.top+_,E=this._getXAxisLabelAlignment();else if(r==="left"){const X=this._getYAxisLabelAlignment(y);E=X.textAlign,A=X.x}else if(r==="right"){const X=this._getYAxisLabelAlignment(y);E=X.textAlign,A=X.x}else if(n==="x"){if(r==="center")z=(e.top+e.bottom)/2+x;else if(Re(r)){const X=Object.keys(r)[0],re=r[X];z=this.chart.scales[X].getPixelForValue(re)+x}E=this._getXAxisLabelAlignment()}else if(n==="y"){if(r==="center")A=(e.left+e.right)/2-x;else if(Re(r)){const X=Object.keys(r)[0],re=r[X];A=this.chart.scales[X].getPixelForValue(re)}E=this._getYAxisLabelAlignment(y).textAlign}n==="y"&&(d==="start"?J="top":d==="end"&&(J="bottom"));const Y=this._getLabelSizes();for(S=0,I=u.length;S<I;++S){C=u[S],T=C.label;const X=a.setContext(this.getContext(S));D=this.getPixelForTick(S)+a.labelOffset,M=this._resolveTickFontOptions(S),N=M.lineHeight,F=tt(T)?T.length:1;const re=F/2,pe=X.color,ee=X.textStrokeColor,ce=X.textStrokeWidth;let ie=E;l?(A=D,E==="inner"&&(S===I-1?ie=this.options.reverse?"left":"right":S===0?ie=this.options.reverse?"right":"left":ie="center"),r==="top"?f==="near"||k!==0?H=-F*N+N/2:f==="center"?H=-Y.highest.height/2-re*N+N:H=-Y.highest.height+N/2:f==="near"||k!==0?H=N/2:f==="center"?H=Y.highest.height/2-re*N:H=Y.highest.height-F*N,g&&(H*=-1),k!==0&&!X.showLabelBackdrop&&(A+=N/2*Math.sin(k))):(z=D,H=(1-F)*N/2);let U;if(X.showLabelBackdrop){const B=zt(X.backdropPadding),le=Y.heights[S],ae=Y.widths[S];let ge=H-B.top,we=0-B.left;switch(J){case"middle":ge-=le/2;break;case"bottom":ge-=le;break}switch(E){case"center":we-=ae/2;break;case"right":we-=ae;break;case"inner":S===I-1?we-=ae:S>0&&(we-=ae/2);break}U={left:we,top:ge,width:ae+B.width,height:le+B.height,color:X.backdropColor}}b.push({label:T,font:M,textOffset:H,options:{rotation:k,color:pe,strokeColor:ee,strokeWidth:ce,textAlign:ie,textBaseline:J,translation:[A,z],backdrop:U}})}return b}_getXAxisLabelAlignment(){const{position:e,ticks:n}=this.options;if(-Bn(this.labelRotation))return e==="top"?"left":"right";let r="center";return n.align==="start"?r="left":n.align==="end"?r="right":n.align==="inner"&&(r="inner"),r}_getYAxisLabelAlignment(e){const{position:n,ticks:{crossAlign:s,mirror:r,padding:a}}=this.options,l=this._getLabelSizes(),u=e+a,d=l.widest.width;let f,m;return n==="left"?r?(m=this.right+a,s==="near"?f="left":s==="center"?(f="center",m+=d/2):(f="right",m+=d)):(m=this.right-u,s==="near"?f="right":s==="center"?(f="center",m-=d/2):(f="left",m=this.left)):n==="right"?r?(m=this.left+a,s==="near"?f="right":s==="center"?(f="center",m-=d/2):(f="left",m-=d)):(m=this.left+u,s==="near"?f="left":s==="center"?(f="center",m+=d/2):(f="right",m=this.right)):f="right",{textAlign:f,x:m}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,n=this.options.position;if(n==="left"||n==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(n==="top"||n==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:n},left:s,top:r,width:a,height:l}=this;n&&(e.save(),e.fillStyle=n,e.fillRect(s,r,a,l),e.restore())}getLineWidthForValue(e){const n=this.options.grid;if(!this._isVisible()||!n.display)return 0;const r=this.ticks.findIndex(a=>a.value===e);return r>=0?n.setContext(this.getContext(r)).lineWidth:0}drawGrid(e){const n=this.options.grid,s=this.ctx,r=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let a,l;const u=(d,f,m)=>{!m.width||!m.color||(s.save(),s.lineWidth=m.width,s.strokeStyle=m.color,s.setLineDash(m.borderDash||[]),s.lineDashOffset=m.borderDashOffset,s.beginPath(),s.moveTo(d.x,d.y),s.lineTo(f.x,f.y),s.stroke(),s.restore())};if(n.display)for(a=0,l=r.length;a<l;++a){const d=r[a];n.drawOnChartArea&&u({x:d.x1,y:d.y1},{x:d.x2,y:d.y2},d),n.drawTicks&&u({x:d.tx1,y:d.ty1},{x:d.tx2,y:d.ty2},{color:d.tickColor,width:d.tickWidth,borderDash:d.tickBorderDash,borderDashOffset:d.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:n,options:{border:s,grid:r}}=this,a=s.setContext(this.getContext()),l=s.display?a.width:0;if(!l)return;const u=r.setContext(this.getContext(0)).lineWidth,d=this._borderValue;let f,m,g,y;this.isHorizontal()?(f=Nr(e,this.left,l)-l/2,m=Nr(e,this.right,u)+u/2,g=y=d):(g=Nr(e,this.top,l)-l/2,y=Nr(e,this.bottom,u)+u/2,f=m=d),n.save(),n.lineWidth=a.width,n.strokeStyle=a.color,n.beginPath(),n.moveTo(f,g),n.lineTo(m,y),n.stroke(),n.restore()}drawLabels(e){if(!this.options.ticks.display)return;const s=this.ctx,r=this._computeLabelArea();r&&bc(s,r);const a=this.getLabelItems(e);for(const l of a){const u=l.options,d=l.font,f=l.label,m=l.textOffset;Vr(s,f,0,m,d,u)}r&&wc(s)}drawTitle(){const{ctx:e,options:{position:n,title:s,reverse:r}}=this;if(!s.display)return;const a=_t(s.font),l=zt(s.padding),u=s.align;let d=a.lineHeight/2;n==="bottom"||n==="center"||Re(n)?(d+=l.bottom,tt(s.text)&&(d+=a.lineHeight*(s.text.length-1))):d+=l.top;const{titleX:f,titleY:m,maxWidth:g,rotation:y}=XI(this,d,n,u);Vr(e,s.text,0,0,a,{color:s.color,maxWidth:g,rotation:y,textAlign:JI(u,n,r),textBaseline:"middle",translation:[f,m]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,n=e.ticks&&e.ticks.z||0,s=Pe(e.grid&&e.grid.z,-1),r=Pe(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==qr.prototype.draw?[{z:n,draw:a=>{this.draw(a)}}]:[{z:s,draw:a=>{this.drawBackground(),this.drawGrid(a),this.drawTitle()}},{z:r,draw:()=>{this.drawBorder()}},{z:n,draw:a=>{this.drawLabels(a)}}]}getMatchingVisibleMetas(e){const n=this.chart.getSortedVisibleDatasetMetas(),s=this.axis+"AxisID",r=[];let a,l;for(a=0,l=n.length;a<l;++a){const u=n[a];u[s]===this.id&&(!e||u.type===e)&&r.push(u)}return r}_resolveTickFontOptions(e){const n=this.options.ticks.setContext(this.getContext(e));return _t(n.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class Dl{constructor(e,n,s){this.type=e,this.scope=n,this.override=s,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const n=Object.getPrototypeOf(e);let s;e1(n)&&(s=this.register(n));const r=this.items,a=e.id,l=this.scope+"."+a;if(!a)throw new Error("class does not have id: "+e);return a in r||(r[a]=e,QI(e,l,s),this.override&&nt.override(e.id,e.overrides)),l}get(e){return this.items[e]}unregister(e){const n=this.items,s=e.id,r=this.scope;s in n&&delete n[s],r&&s in nt[r]&&(delete nt[r][s],this.override&&delete Wr[s])}}function QI(t,e,n){const s=Xa(Object.create(null),[n?nt.get(n):{},nt.get(e),t.defaults]);nt.set(e,s),t.defaultRoutes&&ZI(e,t.defaultRoutes),t.descriptors&&nt.describe(e,t.descriptors)}function ZI(t,e){Object.keys(e).forEach(n=>{const s=n.split("."),r=s.pop(),a=[t].concat(s).join("."),l=e[n].split("."),u=l.pop(),d=l.join(".");nt.route(a,r,d,u)})}function e1(t){return"id"in t&&"defaults"in t}class t1{constructor(){this.controllers=new Dl(hr,"datasets",!0),this.elements=new Dl(Ts,"elements"),this.plugins=new Dl(Object,"plugins"),this.scales=new Dl(qr,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,n,s){[...n].forEach(r=>{const a=s||this._getRegistryForType(r);s||a.isForType(r)||a===this.plugins&&r.id?this._exec(e,a,r):Ve(r,l=>{const u=s||this._getRegistryForType(l);this._exec(e,u,l)})})}_exec(e,n,s){const r=Vh(e);Ye(s["before"+r],[],s),n[e](s),Ye(s["after"+r],[],s)}_getRegistryForType(e){for(let n=0;n<this._typedRegistries.length;n++){const s=this._typedRegistries[n];if(s.isForType(e))return s}return this.plugins}_get(e,n,s){const r=n.get(e);if(r===void 0)throw new Error('"'+e+'" is not a registered '+s+".");return r}}var ns=new t1;class n1{constructor(){this._init=void 0}notify(e,n,s,r){if(n==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install")),this._init===void 0)return;const a=r?this._descriptors(e).filter(r):this._descriptors(e),l=this._notify(a,e,n,s);return n==="afterDestroy"&&(this._notify(a,e,"stop"),this._notify(this._init,e,"uninstall"),this._init=void 0),l}_notify(e,n,s,r){r=r||{};for(const a of e){const l=a.plugin,u=l[s],d=[n,r,a.options];if(Ye(u,d,l)===!1&&r.cancelable)return!1}return!0}invalidate(){Ae(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const n=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),n}_createDescriptors(e,n){const s=e&&e.config,r=Pe(s.options&&s.options.plugins,{}),a=s1(s);return r===!1&&!n?[]:i1(e,a,r,n)}_notifyStateChanges(e){const n=this._oldCache||[],s=this._cache,r=(a,l)=>a.filter(u=>!l.some(d=>u.plugin.id===d.plugin.id));this._notify(r(n,s),e,"stop"),this._notify(r(s,n),e,"start")}}function s1(t){const e={},n=[],s=Object.keys(ns.plugins.items);for(let a=0;a<s.length;a++)n.push(ns.getPlugin(s[a]));const r=t.plugins||[];for(let a=0;a<r.length;a++){const l=r[a];n.indexOf(l)===-1&&(n.push(l),e[l.id]=!0)}return{plugins:n,localIds:e}}function r1(t,e){return!e&&t===!1?null:t===!0?{}:t}function i1(t,{plugins:e,localIds:n},s,r){const a=[],l=t.getContext();for(const u of e){const d=u.id,f=r1(s[d],r);f!==null&&a.push({plugin:u,options:a1(t.config,{plugin:u,local:n[d]},f,l)})}return a}function a1(t,{plugin:e,local:n},s,r){const a=t.pluginScopeKeys(e),l=t.getOptionScopes(s,a);return n&&e.defaults&&l.push(e.defaults),t.createResolver(l,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function wh(t,e){const n=nt.datasets[t]||{};return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||n.indexAxis||"x"}function o1(t,e){let n=t;return t==="_index_"?n=e:t==="_value_"&&(n=e==="x"?"y":"x"),n}function l1(t,e){return t===e?"_index_":"_value_"}function Py(t){if(t==="x"||t==="y"||t==="r")return t}function c1(t){if(t==="top"||t==="bottom")return"x";if(t==="left"||t==="right")return"y"}function _h(t,...e){if(Py(t))return t;for(const n of e){const s=n.axis||c1(n.position)||t.length>1&&Py(t[0].toLowerCase());if(s)return s}throw new Error(`Cannot determine type of '${t}' axis. Please provide 'axis' or 'position' option.`)}function Iy(t,e,n){if(n[e+"AxisID"]===t)return{axis:e}}function u1(t,e){if(e.data&&e.data.datasets){const n=e.data.datasets.filter(s=>s.xAxisID===t||s.yAxisID===t);if(n.length)return Iy(t,"x",n[0])||Iy(t,"y",n[0])}return{}}function d1(t,e){const n=Wr[t.type]||{scales:{}},s=e.scales||{},r=wh(t.type,e),a=Object.create(null);return Object.keys(s).forEach(l=>{const u=s[l];if(!Re(u))return console.error(`Invalid scale configuration for scale: ${l}`);if(u._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${l}`);const d=_h(l,u,u1(l,t),nt.scales[u.type]),f=l1(d,r),m=n.scales||{};a[l]=Da(Object.create(null),[{axis:d},u,m[d],m[f]])}),t.data.datasets.forEach(l=>{const u=l.type||t.type,d=l.indexAxis||wh(u,e),m=(Wr[u]||{}).scales||{};Object.keys(m).forEach(g=>{const y=o1(g,d),x=l[y+"AxisID"]||y;a[x]=a[x]||Object.create(null),Da(a[x],[{axis:y},s[x],m[g]])})}),Object.keys(a).forEach(l=>{const u=a[l];Da(u,[nt.scales[u.type],nt.scale])}),a}function Rx(t){const e=t.options||(t.options={});e.plugins=Pe(e.plugins,{}),e.scales=d1(t,e)}function Mx(t){return t=t||{},t.datasets=t.datasets||[],t.labels=t.labels||[],t}function h1(t){return t=t||{},t.data=Mx(t.data),Rx(t),t}const Ey=new Map,Lx=new Set;function Fl(t,e){let n=Ey.get(t);return n||(n=e(),Ey.set(t,n),Lx.add(n)),n}const Sa=(t,e,n)=>{const s=lr(e,n);s!==void 0&&t.add(s)};class f1{constructor(e){this._config=h1(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=Mx(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),Rx(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return Fl(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,n){return Fl(`${e}.transition.${n}`,()=>[[`datasets.${e}.transitions.${n}`,`transitions.${n}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,n){return Fl(`${e}-${n}`,()=>[[`datasets.${e}.elements.${n}`,`datasets.${e}`,`elements.${n}`,""]])}pluginScopeKeys(e){const n=e.id,s=this.type;return Fl(`${s}-plugin-${n}`,()=>[[`plugins.${n}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,n){const s=this._scopeCache;let r=s.get(e);return(!r||n)&&(r=new Map,s.set(e,r)),r}getOptionScopes(e,n,s){const{options:r,type:a}=this,l=this._cachedScopes(e,s),u=l.get(n);if(u)return u;const d=new Set;n.forEach(m=>{e&&(d.add(e),m.forEach(g=>Sa(d,e,g))),m.forEach(g=>Sa(d,r,g)),m.forEach(g=>Sa(d,Wr[a]||{},g)),m.forEach(g=>Sa(d,nt,g)),m.forEach(g=>Sa(d,xh,g))});const f=Array.from(d);return f.length===0&&f.push(Object.create(null)),Lx.has(n)&&l.set(n,f),f}chartOptionScopes(){const{options:e,type:n}=this;return[e,Wr[n]||{},nt.datasets[n]||{},{type:n},nt,xh]}resolveNamedOptions(e,n,s,r=[""]){const a={$shared:!0},{resolver:l,subPrefixes:u}=Ty(this._resolverCache,e,r);let d=l;if(m1(l,n)){a.$shared=!1,s=cr(s)?s():s;const f=this.createResolver(e,s,u);d=Ai(l,s,f)}for(const f of n)a[f]=d[f];return a}createResolver(e,n,s=[""],r){const{resolver:a}=Ty(this._resolverCache,e,s);return Re(n)?Ai(a,n,void 0,r):a}}function Ty(t,e,n){let s=t.get(e);s||(s=new Map,t.set(e,s));const r=n.join();let a=s.get(r);return a||(a={resolver:Jh(e,n),subPrefixes:n.filter(u=>!u.toLowerCase().includes("hover"))},s.set(r,a)),a}const p1=t=>Re(t)&&Object.getOwnPropertyNames(t).some(e=>cr(t[e]));function m1(t,e){const{isScriptable:n,isIndexable:s}=fx(t);for(const r of e){const a=n(r),l=s(r),u=(l||a)&&t[r];if(a&&(cr(u)||p1(u))||l&&tt(u))return!0}return!1}var g1="4.5.1";const y1=["top","bottom","left","right","chartArea"];function Ny(t,e){return t==="top"||t==="bottom"||y1.indexOf(t)===-1&&e==="x"}function Ay(t,e){return function(n,s){return n[t]===s[t]?n[e]-s[e]:n[t]-s[t]}}function Oy(t){const e=t.chart,n=e.options.animation;e.notifyPlugins("afterRender"),Ye(n&&n.onComplete,[t],e)}function v1(t){const e=t.chart,n=e.options.animation;Ye(n&&n.onProgress,[t],e)}function Dx(t){return Zh()&&typeof t=="string"?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const Hl={},Ry=t=>{const e=Dx(t);return Object.values(Hl).filter(n=>n.canvas===e).pop()};function x1(t,e,n){const s=Object.keys(t);for(const r of s){const a=+r;if(a>=e){const l=t[r];delete t[r],(n>0||a>e)&&(t[a+n]=l)}}}function b1(t,e,n,s){return!n||t.type==="mouseout"?null:s?e:t}class sf{static defaults=nt;static instances=Hl;static overrides=Wr;static registry=ns;static version=g1;static getChart=Ry;static register(...e){ns.add(...e),My()}static unregister(...e){ns.remove(...e),My()}constructor(e,n){const s=this.config=new f1(n),r=Dx(e),a=Ry(r);if(a)throw new Error("Canvas is already in use. Chart with ID '"+a.id+"' must be destroyed before the canvas with ID '"+a.canvas.id+"' can be reused.");const l=s.createResolver(s.chartOptionScopes(),this.getContext());this.platform=new(s.platform||FI(r)),this.platform.updateConfig(s);const u=this.platform.acquireContext(r,l.aspectRatio),d=u&&u.canvas,f=d&&d.height,m=d&&d.width;if(this.id=mC(),this.ctx=u,this.canvas=d,this.width=m,this.height=f,this._options=l,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new n1,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=AC(g=>this.update(g),l.resizeDelay||0),this._dataChanges=[],Hl[this.id]=this,!u||!d){console.error("Failed to create chart: can't acquire context from the given item");return}xs.listen(this,"complete",Oy),xs.listen(this,"progress",v1),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:n},width:s,height:r,_aspectRatio:a}=this;return Ae(e)?n&&a?a:r?s/r:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return ns}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():sy(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return ey(this.canvas,this.ctx),this}stop(){return xs.stop(this),this}resize(e,n){xs.running(this)?this._resizeBeforeDraw={width:e,height:n}:this._resize(e,n)}_resize(e,n){const s=this.options,r=this.canvas,a=s.maintainAspectRatio&&this.aspectRatio,l=this.platform.getMaximumSize(r,e,n,a),u=s.devicePixelRatio||this.platform.getDevicePixelRatio(),d=this.width?"resize":"attach";this.width=l.width,this.height=l.height,this._aspectRatio=this.aspectRatio,sy(this,u,!0)&&(this.notifyPlugins("resize",{size:l}),Ye(s.onResize,[this,l],this),this.attached&&this._doResize(d)&&this.render())}ensureScalesHaveIDs(){const n=this.options.scales||{};Ve(n,(s,r)=>{s.id=r})}buildOrUpdateScales(){const e=this.options,n=e.scales,s=this.scales,r=Object.keys(s).reduce((l,u)=>(l[u]=!1,l),{});let a=[];n&&(a=a.concat(Object.keys(n).map(l=>{const u=n[l],d=_h(l,u),f=d==="r",m=d==="x";return{options:u,dposition:f?"chartArea":m?"bottom":"left",dtype:f?"radialLinear":m?"category":"linear"}}))),Ve(a,l=>{const u=l.options,d=u.id,f=_h(d,u),m=Pe(u.type,l.dtype);(u.position===void 0||Ny(u.position,f)!==Ny(l.dposition))&&(u.position=l.dposition),r[d]=!0;let g=null;if(d in s&&s[d].type===m)g=s[d];else{const y=ns.getScale(m);g=new y({id:d,type:m,ctx:this.ctx,chart:this}),s[g.id]=g}g.init(u,e)}),Ve(r,(l,u)=>{l||delete s[u]}),Ve(s,l=>{$t.configure(this,l,l.options),$t.addBox(this,l)})}_updateMetasets(){const e=this._metasets,n=this.data.datasets.length,s=e.length;if(e.sort((r,a)=>r.index-a.index),s>n){for(let r=n;r<s;++r)this._destroyDatasetMeta(r);e.splice(n,s-n)}this._sortedMetasets=e.slice(0).sort(Ay("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:n}}=this;e.length>n.length&&delete this._stacks,e.forEach((s,r)=>{n.filter(a=>a===s._dataset).length===0&&this._destroyDatasetMeta(r)})}buildOrUpdateControllers(){const e=[],n=this.data.datasets;let s,r;for(this._removeUnreferencedMetasets(),s=0,r=n.length;s<r;s++){const a=n[s];let l=this.getDatasetMeta(s);const u=a.type||this.config.type;if(l.type&&l.type!==u&&(this._destroyDatasetMeta(s),l=this.getDatasetMeta(s)),l.type=u,l.indexAxis=a.indexAxis||wh(u,this.options),l.order=a.order||0,l.index=s,l.label=""+a.label,l.visible=this.isDatasetVisible(s),l.controller)l.controller.updateIndex(s),l.controller.linkScales();else{const d=ns.getController(u),{datasetElementType:f,dataElementType:m}=nt.datasets[u];Object.assign(d,{dataElementType:ns.getElement(m),datasetElementType:f&&ns.getElement(f)}),l.controller=new d(this,s),e.push(l.controller)}}return this._updateMetasets(),e}_resetElements(){Ve(this.data.datasets,(e,n)=>{this.getDatasetMeta(n).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const n=this.config;n.update();const s=this._options=n.createResolver(n.chartOptionScopes(),this.getContext()),r=this._animationsDisabled=!s.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const a=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let l=0;for(let f=0,m=this.data.datasets.length;f<m;f++){const{controller:g}=this.getDatasetMeta(f),y=!r&&a.indexOf(g)===-1;g.buildOrUpdateElements(y),l=Math.max(+g.getMaxOverflow(),l)}l=this._minPadding=s.layout.autoPadding?l:0,this._updateLayout(l),r||Ve(a,f=>{f.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(Ay("z","_idx"));const{_active:u,_lastEvent:d}=this;d?this._eventHandler(d,!0):u.length&&this._updateHoverStyles(u,u,!0),this.render()}_updateScales(){Ve(this.scales,e=>{$t.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,n=new Set(Object.keys(this._listeners)),s=new Set(e.events);(!qg(n,s)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,n=this._getUniformDataChanges()||[];for(const{method:s,start:r,count:a}of n){const l=s==="_removeElements"?-a:a;x1(e,r,l)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const n=this.data.datasets.length,s=a=>new Set(e.filter(l=>l[0]===a).map((l,u)=>u+","+l.splice(1).join(","))),r=s(0);for(let a=1;a<n;a++)if(!qg(r,s(a)))return;return Array.from(r).map(a=>a.split(",")).map(a=>({method:a[1],start:+a[2],count:+a[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;$t.update(this,this.width,this.height,e);const n=this.chartArea,s=n.width<=0||n.height<=0;this._layers=[],Ve(this.boxes,r=>{s&&r.position==="chartArea"||(r.configure&&r.configure(),this._layers.push(...r._layers()))},this),this._layers.forEach((r,a)=>{r._idx=a}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let n=0,s=this.data.datasets.length;n<s;++n)this.getDatasetMeta(n).controller.configure();for(let n=0,s=this.data.datasets.length;n<s;++n)this._updateDataset(n,cr(e)?e({datasetIndex:n}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,n){const s=this.getDatasetMeta(e),r={meta:s,index:e,mode:n,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",r)!==!1&&(s.controller._update(n),r.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",r))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(xs.has(this)?this.attached&&!xs.running(this)&&xs.start(this):(this.draw(),Oy({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:s,height:r}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(s,r)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const n=this._layers;for(e=0;e<n.length&&n[e].z<=0;++e)n[e].draw(this.chartArea);for(this._drawDatasets();e<n.length;++e)n[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const n=this._sortedMetasets,s=[];let r,a;for(r=0,a=n.length;r<a;++r){const l=n[r];(!e||l.visible)&&s.push(l)}return s}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let n=e.length-1;n>=0;--n)this._drawDataset(e[n]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const n=this.ctx,s={meta:e,index:e.index,cancelable:!0},r=Sx(this,e);this.notifyPlugins("beforeDatasetDraw",s)!==!1&&(r&&bc(n,r),e.controller.draw(),r&&wc(n),s.cancelable=!1,this.notifyPlugins("afterDatasetDraw",s))}isPointInArea(e){return Cs(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,n,s,r){const a=yI.modes[n];return typeof a=="function"?a(this,e,s,r):[]}getDatasetMeta(e){const n=this.data.datasets[e],s=this._metasets;let r=s.filter(a=>a&&a._dataset===n).pop();return r||(r={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:n&&n.order||0,index:e,_dataset:n,_parsed:[],_sorted:!1},s.push(r)),r}getContext(){return this.$context||(this.$context=dr(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const n=this.data.datasets[e];if(!n)return!1;const s=this.getDatasetMeta(e);return typeof s.hidden=="boolean"?!s.hidden:!n.hidden}setDatasetVisibility(e,n){const s=this.getDatasetMeta(e);s.hidden=!n}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,n,s){const r=s?"show":"hide",a=this.getDatasetMeta(e),l=a.controller._resolveAnimations(void 0,r);Qa(n)?(a.data[n].hidden=!s,this.update()):(this.setDatasetVisibility(e,s),l.update(a,{visible:s}),this.update(u=>u.datasetIndex===e?r:void 0))}hide(e,n){this._updateVisibility(e,n,!1)}show(e,n){this._updateVisibility(e,n,!0)}_destroyDatasetMeta(e){const n=this._metasets[e];n&&n.controller&&n.controller._destroy(),delete this._metasets[e]}_stop(){let e,n;for(this.stop(),xs.remove(this),e=0,n=this.data.datasets.length;e<n;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:n}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),ey(e,n),this.platform.releaseContext(n),this.canvas=null,this.ctx=null),delete Hl[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,n=this.platform,s=(a,l)=>{n.addEventListener(this,a,l),e[a]=l},r=(a,l,u)=>{a.offsetX=l,a.offsetY=u,this._eventHandler(a)};Ve(this.options.events,a=>s(a,r))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,n=this.platform,s=(d,f)=>{n.addEventListener(this,d,f),e[d]=f},r=(d,f)=>{e[d]&&(n.removeEventListener(this,d,f),delete e[d])},a=(d,f)=>{this.canvas&&this.resize(d,f)};let l;const u=()=>{r("attach",u),this.attached=!0,this.resize(),s("resize",a),s("detach",l)};l=()=>{this.attached=!1,r("resize",a),this._stop(),this._resize(0,0),s("attach",u)},n.isAttached(this.canvas)?u():l()}unbindEvents(){Ve(this._listeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._listeners={},Ve(this._responsiveListeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,n,s){const r=s?"set":"remove";let a,l,u,d;for(n==="dataset"&&(a=this.getDatasetMeta(e[0].datasetIndex),a.controller["_"+r+"DatasetHoverStyle"]()),u=0,d=e.length;u<d;++u){l=e[u];const f=l&&this.getDatasetMeta(l.datasetIndex).controller;f&&f[r+"HoverStyle"](l.element,l.datasetIndex,l.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const n=this._active||[],s=e.map(({datasetIndex:a,index:l})=>{const u=this.getDatasetMeta(a);if(!u)throw new Error("No dataset found at index "+a);return{datasetIndex:a,element:u.data[l],index:l}});!tc(s,n)&&(this._active=s,this._lastEvent=null,this._updateHoverStyles(s,n))}notifyPlugins(e,n,s){return this._plugins.notify(this,e,n,s)}isPluginEnabled(e){return this._plugins._cache.filter(n=>n.plugin.id===e).length===1}_updateHoverStyles(e,n,s){const r=this.options.hover,a=(d,f)=>d.filter(m=>!f.some(g=>m.datasetIndex===g.datasetIndex&&m.index===g.index)),l=a(n,e),u=s?e:a(e,n);l.length&&this.updateHoverStyle(l,r.mode,!1),u.length&&r.mode&&this.updateHoverStyle(u,r.mode,!0)}_eventHandler(e,n){const s={event:e,replay:n,cancelable:!0,inChartArea:this.isPointInArea(e)},r=l=>(l.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",s,r)===!1)return;const a=this._handleEvent(e,n,s.inChartArea);return s.cancelable=!1,this.notifyPlugins("afterEvent",s,r),(a||s.changed)&&this.render(),this}_handleEvent(e,n,s){const{_active:r=[],options:a}=this,l=n,u=this._getActiveElements(e,r,s,l),d=wC(e),f=b1(e,this._lastEvent,s,d);s&&(this._lastEvent=null,Ye(a.onHover,[e,u,this],this),d&&Ye(a.onClick,[e,u,this],this));const m=!tc(u,r);return(m||n)&&(this._active=u,this._updateHoverStyles(u,r,n)),this._lastEvent=f,m}_getActiveElements(e,n,s,r){if(e.type==="mouseout")return[];if(!s)return n;const a=this.options.hover;return this.getElementsAtEventForMode(e,a.mode,a,r)}}function My(){return Ve(sf.instances,t=>t._plugins.invalidate())}function w1(t,e,n){const{startAngle:s,x:r,y:a,outerRadius:l,innerRadius:u,options:d}=e,{borderWidth:f,borderJoinStyle:m}=d,g=Math.min(f/l,Bt(s-n));if(t.beginPath(),t.arc(r,a,l-f/2,s+g/2,n-g/2),u>0){const y=Math.min(f/u,Bt(s-n));t.arc(r,a,u+f/2,n-y/2,s+y/2,!0)}else{const y=Math.min(f/2,l*Bt(s-n));if(m==="round")t.arc(r,a,y,n-$e/2,s+$e/2,!0);else if(m==="bevel"){const x=2*y*y,_=-x*Math.cos(n+$e/2)+r,k=-x*Math.sin(n+$e/2)+a,b=x*Math.cos(s+$e/2)+r,S=x*Math.sin(s+$e/2)+a;t.lineTo(_,k),t.lineTo(b,S)}}t.closePath(),t.moveTo(0,0),t.rect(0,0,t.canvas.width,t.canvas.height),t.clip("evenodd")}function _1(t,e,n){const{startAngle:s,pixelMargin:r,x:a,y:l,outerRadius:u,innerRadius:d}=e;let f=r/u;t.beginPath(),t.arc(a,l,u,s-f,n+f),d>r?(f=r/d,t.arc(a,l,d,n+f,s-f,!0)):t.arc(a,l,r,n+pt,s-pt),t.closePath(),t.clip()}function k1(t){return Yh(t,["outerStart","outerEnd","innerStart","innerEnd"])}function S1(t,e,n,s){const r=k1(t.options.borderRadius),a=(n-e)/2,l=Math.min(a,s*e/2),u=d=>{const f=(n-Math.min(a,d))*s/2;return Ct(d,0,Math.min(a,f))};return{outerStart:u(r.outerStart),outerEnd:u(r.outerEnd),innerStart:Ct(r.innerStart,0,l),innerEnd:Ct(r.innerEnd,0,l)}}function ki(t,e,n,s){return{x:n+t*Math.cos(e),y:s+t*Math.sin(e)}}function oc(t,e,n,s,r,a){const{x:l,y:u,startAngle:d,pixelMargin:f,innerRadius:m}=e,g=Math.max(e.outerRadius+s+n-f,0),y=m>0?m+s+n+f:0;let x=0;const _=r-d;if(s){const X=m>0?m-s:0,re=g>0?g-s:0,pe=(X+re)/2,ee=pe!==0?_*pe/(pe+s):_;x=(_-ee)/2}const k=Math.max(.001,_*g-n/$e)/g,b=(_-k)/2,S=d+b+x,I=r-b-x,{outerStart:C,outerEnd:T,innerStart:A,innerEnd:z}=S1(e,y,g,I-S),E=g-C,D=g-T,M=S+C/E,N=I-T/D,F=y+A,H=y+z,J=S+A/F,Y=I-z/H;if(t.beginPath(),a){const X=(M+N)/2;if(t.arc(l,u,g,M,X),t.arc(l,u,g,X,N),T>0){const ce=ki(D,N,l,u);t.arc(ce.x,ce.y,T,N,I+pt)}const re=ki(H,I,l,u);if(t.lineTo(re.x,re.y),z>0){const ce=ki(H,Y,l,u);t.arc(ce.x,ce.y,z,I+pt,Y+Math.PI)}const pe=(I-z/y+(S+A/y))/2;if(t.arc(l,u,y,I-z/y,pe,!0),t.arc(l,u,y,pe,S+A/y,!0),A>0){const ce=ki(F,J,l,u);t.arc(ce.x,ce.y,A,J+Math.PI,S-pt)}const ee=ki(E,S,l,u);if(t.lineTo(ee.x,ee.y),C>0){const ce=ki(E,M,l,u);t.arc(ce.x,ce.y,C,S-pt,M)}}else{t.moveTo(l,u);const X=Math.cos(M)*g+l,re=Math.sin(M)*g+u;t.lineTo(X,re);const pe=Math.cos(N)*g+l,ee=Math.sin(N)*g+u;t.lineTo(pe,ee)}t.closePath()}function j1(t,e,n,s,r){const{fullCircles:a,startAngle:l,circumference:u}=e;let d=e.endAngle;if(a){oc(t,e,n,s,d,r);for(let f=0;f<a;++f)t.fill();isNaN(u)||(d=l+(u%Qe||Qe))}return oc(t,e,n,s,d,r),t.fill(),d}function C1(t,e,n,s,r){const{fullCircles:a,startAngle:l,circumference:u,options:d}=e,{borderWidth:f,borderJoinStyle:m,borderDash:g,borderDashOffset:y,borderRadius:x}=d,_=d.borderAlign==="inner";if(!f)return;t.setLineDash(g||[]),t.lineDashOffset=y,_?(t.lineWidth=f*2,t.lineJoin=m||"round"):(t.lineWidth=f,t.lineJoin=m||"bevel");let k=e.endAngle;if(a){oc(t,e,n,s,k,r);for(let b=0;b<a;++b)t.stroke();isNaN(u)||(k=l+(u%Qe||Qe))}_&&_1(t,e,k),d.selfJoin&&k-l>=$e&&x===0&&m!=="miter"&&w1(t,e,k),a||(oc(t,e,n,s,k,r),t.stroke())}class P1 extends Ts{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:e=>e!=="borderDash"};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(e){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,n,s){const r=this.getProps(["x","y"],s),{angle:a,distance:l}=sx(r,{x:e,y:n}),{startAngle:u,endAngle:d,innerRadius:f,outerRadius:m,circumference:g}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],s),y=(this.options.spacing+this.options.borderWidth)/2,x=Pe(g,d-u),_=Za(a,u,d)&&u!==d,k=x>=Qe||_,b=Ss(l,f+y,m+y);return k&&b}getCenterPoint(e){const{x:n,y:s,startAngle:r,endAngle:a,innerRadius:l,outerRadius:u}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],e),{offset:d,spacing:f}=this.options,m=(r+a)/2,g=(l+u+f+d)/2;return{x:n+Math.cos(m)*g,y:s+Math.sin(m)*g}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){const{options:n,circumference:s}=this,r=(n.offset||0)/4,a=(n.spacing||0)/2,l=n.circular;if(this.pixelMargin=n.borderAlign==="inner"?.33:0,this.fullCircles=s>Qe?Math.floor(s/Qe):0,s===0||this.innerRadius<0||this.outerRadius<0)return;e.save();const u=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(u)*r,Math.sin(u)*r);const d=1-Math.sin(Math.min($e,s||0)),f=r*d;e.fillStyle=n.backgroundColor,e.strokeStyle=n.borderColor,j1(e,this,f,a,l),C1(e,this,f,a,l),e.restore()}}function Fx(t,e,n=e){t.lineCap=Pe(n.borderCapStyle,e.borderCapStyle),t.setLineDash(Pe(n.borderDash,e.borderDash)),t.lineDashOffset=Pe(n.borderDashOffset,e.borderDashOffset),t.lineJoin=Pe(n.borderJoinStyle,e.borderJoinStyle),t.lineWidth=Pe(n.borderWidth,e.borderWidth),t.strokeStyle=Pe(n.borderColor,e.borderColor)}function I1(t,e,n){t.lineTo(n.x,n.y)}function E1(t){return t.stepped?VC:t.tension||t.cubicInterpolationMode==="monotone"?qC:I1}function Bx(t,e,n={}){const s=t.length,{start:r=0,end:a=s-1}=n,{start:l,end:u}=e,d=Math.max(r,l),f=Math.min(a,u),m=r<l&&a<l||r>u&&a>u;return{count:s,start:d,loop:e.loop,ilen:f<d&&!m?s+f-d:f-d}}function T1(t,e,n,s){const{points:r,options:a}=e,{count:l,start:u,loop:d,ilen:f}=Bx(r,n,s),m=E1(a);let{move:g=!0,reverse:y}=s||{},x,_,k;for(x=0;x<=f;++x)_=r[(u+(y?f-x:x))%l],!_.skip&&(g?(t.moveTo(_.x,_.y),g=!1):m(t,k,_,y,a.stepped),k=_);return d&&(_=r[(u+(y?f:0))%l],m(t,k,_,y,a.stepped)),!!d}function N1(t,e,n,s){const r=e.points,{count:a,start:l,ilen:u}=Bx(r,n,s),{move:d=!0,reverse:f}=s||{};let m=0,g=0,y,x,_,k,b,S;const I=T=>(l+(f?u-T:T))%a,C=()=>{k!==b&&(t.lineTo(m,b),t.lineTo(m,k),t.lineTo(m,S))};for(d&&(x=r[I(0)],t.moveTo(x.x,x.y)),y=0;y<=u;++y){if(x=r[I(y)],x.skip)continue;const T=x.x,A=x.y,z=T|0;z===_?(A<k?k=A:A>b&&(b=A),m=(g*m+T)/++g):(C(),t.lineTo(T,A),_=z,g=0,k=b=A),S=A}C()}function kh(t){const e=t.options,n=e.borderDash&&e.borderDash.length;return!t._decimated&&!t._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!n?N1:T1}function A1(t){return t.stepped?kP:t.tension||t.cubicInterpolationMode==="monotone"?SP:Lr}function O1(t,e,n,s){let r=e._path;r||(r=e._path=new Path2D,e.path(r,n,s)&&r.closePath()),Fx(t,e.options),t.stroke(r)}function R1(t,e,n,s){const{segments:r,options:a}=e,l=kh(e);for(const u of r)Fx(t,a,u.style),t.beginPath(),l(t,e,u,{start:n,end:n+s-1})&&t.closePath(),t.stroke()}const M1=typeof Path2D=="function";function L1(t,e,n,s){M1&&!e.options.segment?O1(t,e,n,s):R1(t,e,n,s)}class Sc extends Ts{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"};constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,n){const s=this.options;if((s.tension||s.cubicInterpolationMode==="monotone")&&!s.stepped&&!this._pointsUpdated){const r=s.spanGaps?this._loop:this._fullLoop;mP(this._points,s,e,r,n),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=TP(this,this.options.segment))}first(){const e=this.segments,n=this.points;return e.length&&n[e[0].start]}last(){const e=this.segments,n=this.points,s=e.length;return s&&n[e[s-1].end]}interpolate(e,n){const s=this.options,r=e[n],a=this.points,l=kx(this,{property:n,start:r,end:r});if(!l.length)return;const u=[],d=A1(s);let f,m;for(f=0,m=l.length;f<m;++f){const{start:g,end:y}=l[f],x=a[g],_=a[y];if(x===_){u.push(x);continue}const k=Math.abs((r-x[n])/(_[n]-x[n])),b=d(x,_,k,s.stepped);b[n]=e[n],u.push(b)}return u.length===1?u[0]:u}pathSegment(e,n,s){return kh(this)(e,this,n,s)}path(e,n,s){const r=this.segments,a=kh(this);let l=this._loop;n=n||0,s=s||this.points.length-n;for(const u of r)l&=a(e,this,u,{start:n,end:n+s-1});return!!l}draw(e,n,s,r){const a=this.options||{};(this.points||[]).length&&a.borderWidth&&(e.save(),L1(e,this,s,r),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function Ly(t,e,n,s){const r=t.options,{[n]:a}=t.getProps([n],s);return Math.abs(e-a)<r.radius+r.hitRadius}class D1 extends Ts{static id="point";parsed;skip;stop;static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,n,s){const r=this.options,{x:a,y:l}=this.getProps(["x","y"],s);return Math.pow(e-a,2)+Math.pow(n-l,2)<Math.pow(r.hitRadius+r.radius,2)}inXRange(e,n){return Ly(this,e,"x",n)}inYRange(e,n){return Ly(this,e,"y",n)}getCenterPoint(e){const{x:n,y:s}=this.getProps(["x","y"],e);return{x:n,y:s}}size(e){e=e||this.options||{};let n=e.radius||0;n=Math.max(n,n&&e.hoverRadius||0);const s=n&&e.borderWidth||0;return(n+s)*2}draw(e,n){const s=this.options;this.skip||s.radius<.1||!Cs(this,n,this.size(s)/2)||(e.strokeStyle=s.borderColor,e.lineWidth=s.borderWidth,e.fillStyle=s.backgroundColor,bh(e,s,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}function $x(t,e){const{x:n,y:s,base:r,width:a,height:l}=t.getProps(["x","y","base","width","height"],e);let u,d,f,m,g;return t.horizontal?(g=l/2,u=Math.min(n,r),d=Math.max(n,r),f=s-g,m=s+g):(g=a/2,u=n-g,d=n+g,f=Math.min(s,r),m=Math.max(s,r)),{left:u,top:f,right:d,bottom:m}}function ir(t,e,n,s){return t?0:Ct(e,n,s)}function F1(t,e,n){const s=t.options.borderWidth,r=t.borderSkipped,a=hx(s);return{t:ir(r.top,a.top,0,n),r:ir(r.right,a.right,0,e),b:ir(r.bottom,a.bottom,0,n),l:ir(r.left,a.left,0,e)}}function B1(t,e,n){const{enableBorderRadius:s}=t.getProps(["enableBorderRadius"]),r=t.options.borderRadius,a=zr(r),l=Math.min(e,n),u=t.borderSkipped,d=s||Re(r);return{topLeft:ir(!d||u.top||u.left,a.topLeft,0,l),topRight:ir(!d||u.top||u.right,a.topRight,0,l),bottomLeft:ir(!d||u.bottom||u.left,a.bottomLeft,0,l),bottomRight:ir(!d||u.bottom||u.right,a.bottomRight,0,l)}}function $1(t){const e=$x(t),n=e.right-e.left,s=e.bottom-e.top,r=F1(t,n/2,s/2),a=B1(t,n/2,s/2);return{outer:{x:e.left,y:e.top,w:n,h:s,radius:a},inner:{x:e.left+r.l,y:e.top+r.t,w:n-r.l-r.r,h:s-r.t-r.b,radius:{topLeft:Math.max(0,a.topLeft-Math.max(r.t,r.l)),topRight:Math.max(0,a.topRight-Math.max(r.t,r.r)),bottomLeft:Math.max(0,a.bottomLeft-Math.max(r.b,r.l)),bottomRight:Math.max(0,a.bottomRight-Math.max(r.b,r.r))}}}}function Dd(t,e,n,s){const r=e===null,a=n===null,u=t&&!(r&&a)&&$x(t,s);return u&&(r||Ss(e,u.left,u.right))&&(a||Ss(n,u.top,u.bottom))}function z1(t){return t.topLeft||t.topRight||t.bottomLeft||t.bottomRight}function U1(t,e){t.rect(e.x,e.y,e.w,e.h)}function Fd(t,e,n={}){const s=t.x!==n.x?-e:0,r=t.y!==n.y?-e:0,a=(t.x+t.w!==n.x+n.w?e:0)-s,l=(t.y+t.h!==n.y+n.h?e:0)-r;return{x:t.x+s,y:t.y+r,w:t.w+a,h:t.h+l,radius:t.radius}}class W1 extends Ts{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:n,options:{borderColor:s,backgroundColor:r}}=this,{inner:a,outer:l}=$1(this),u=z1(l.radius)?eo:U1;e.save(),(l.w!==a.w||l.h!==a.h)&&(e.beginPath(),u(e,Fd(l,n,a)),e.clip(),u(e,Fd(a,-n,l)),e.fillStyle=s,e.fill("evenodd")),e.beginPath(),u(e,Fd(a,n)),e.fillStyle=r,e.fill(),e.restore()}inRange(e,n,s){return Dd(this,e,n,s)}inXRange(e,n){return Dd(this,e,null,n)}inYRange(e,n){return Dd(this,null,e,n)}getCenterPoint(e){const{x:n,y:s,base:r,horizontal:a}=this.getProps(["x","y","base","horizontal"],e);return{x:a?(n+r)/2:n,y:a?s:(s+r)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}var V1=Object.freeze({__proto__:null,ArcElement:P1,BarElement:W1,LineElement:Sc,PointElement:D1});const Sh=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],Dy=Sh.map(t=>t.replace("rgb(","rgba(").replace(")",", 0.5)"));function zx(t){return Sh[t%Sh.length]}function Ux(t){return Dy[t%Dy.length]}function q1(t,e){return t.borderColor=zx(e),t.backgroundColor=Ux(e),++e}function H1(t,e){return t.backgroundColor=t.data.map(()=>zx(e++)),e}function K1(t,e){return t.backgroundColor=t.data.map(()=>Ux(e++)),e}function G1(t){let e=0;return(n,s)=>{const r=t.getDatasetMeta(s).controller;r instanceof tf?e=H1(n,e):r instanceof Ix?e=K1(n,e):r&&(e=q1(n,e))}}function Fy(t){let e;for(e in t)if(t[e].borderColor||t[e].backgroundColor)return!0;return!1}function Y1(t){return t&&(t.borderColor||t.backgroundColor)}function J1(){return nt.borderColor!=="rgba(0,0,0,0.1)"||nt.backgroundColor!=="rgba(0,0,0,0.1)"}var X1={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(t,e,n){if(!n.enabled)return;const{data:{datasets:s},options:r}=t.config,{elements:a}=r,l=Fy(s)||Y1(r)||a&&Fy(a)||J1();if(!n.forceOverride&&l)return;const u=G1(t);s.forEach(u)}};function Q1(t,e,n,s,r){const a=r.samples||s;if(a>=n)return t.slice(e,e+n);const l=[],u=(n-2)/(a-2);let d=0;const f=e+n-1;let m=e,g,y,x,_,k;for(l[d++]=t[m],g=0;g<a-2;g++){let b=0,S=0,I;const C=Math.floor((g+1)*u)+1+e,T=Math.min(Math.floor((g+2)*u)+1,n)+e,A=T-C;for(I=C;I<T;I++)b+=t[I].x,S+=t[I].y;b/=A,S/=A;const z=Math.floor(g*u)+1+e,E=Math.min(Math.floor((g+1)*u)+1,n)+e,{x:D,y:M}=t[m];for(x=_=-1,I=z;I<E;I++)_=.5*Math.abs((D-b)*(t[I].y-M)-(D-t[I].x)*(S-M)),_>x&&(x=_,y=t[I],k=I);l[d++]=y,m=k}return l[d++]=t[f],l}function Z1(t,e,n,s){let r=0,a=0,l,u,d,f,m,g,y,x,_,k;const b=[],S=e+n-1,I=t[e].x,T=t[S].x-I;for(l=e;l<e+n;++l){u=t[l],d=(u.x-I)/T*s,f=u.y;const A=d|0;if(A===m)f<_?(_=f,g=l):f>k&&(k=f,y=l),r=(a*r+u.x)/++a;else{const z=l-1;if(!Ae(g)&&!Ae(y)){const E=Math.min(g,y),D=Math.max(g,y);E!==x&&E!==z&&b.push({...t[E],x:r}),D!==x&&D!==z&&b.push({...t[D],x:r})}l>0&&z!==x&&b.push(t[z]),b.push(u),m=A,a=0,_=k=f,g=y=x=l}}return b}function Wx(t){if(t._decimated){const e=t._data;delete t._decimated,delete t._data,Object.defineProperty(t,"data",{configurable:!0,enumerable:!0,writable:!0,value:e})}}function By(t){t.data.datasets.forEach(e=>{Wx(e)})}function eE(t,e){const n=e.length;let s=0,r;const{iScale:a}=t,{min:l,max:u,minDefined:d,maxDefined:f}=a.getUserBounds();return d&&(s=Ct(js(e,a.axis,l).lo,0,n-1)),f?r=Ct(js(e,a.axis,u).hi+1,s,n)-s:r=n-s,{start:s,count:r}}var tE={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(t,e,n)=>{if(!n.enabled){By(t);return}const s=t.width;t.data.datasets.forEach((r,a)=>{const{_data:l,indexAxis:u}=r,d=t.getDatasetMeta(a),f=l||r.data;if(Ta([u,t.options.indexAxis])==="y"||!d.controller.supportsDecimation)return;const m=t.scales[d.xAxisID];if(m.type!=="linear"&&m.type!=="time"||t.options.parsing)return;let{start:g,count:y}=eE(d,f);const x=n.threshold||4*s;if(y<=x){Wx(r);return}Ae(l)&&(r._data=f,delete r.data,Object.defineProperty(r,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(k){this._data=k}}));let _;switch(n.algorithm){case"lttb":_=Q1(f,g,y,s,n);break;case"min-max":_=Z1(f,g,y,s);break;default:throw new Error(`Unsupported decimation algorithm '${n.algorithm}'`)}r._decimated=_})},destroy(t){By(t)}};function nE(t,e,n){const s=t.segments,r=t.points,a=e.points,l=[];for(const u of s){let{start:d,end:f}=u;f=jc(d,f,r);const m=jh(n,r[d],r[f],u.loop);if(!e.segments){l.push({source:u,target:m,start:r[d],end:r[f]});continue}const g=kx(e,m);for(const y of g){const x=jh(n,a[y.start],a[y.end],y.loop),_=_x(u,r,x);for(const k of _)l.push({source:k,target:y,start:{[n]:$y(m,x,"start",Math.max)},end:{[n]:$y(m,x,"end",Math.min)}})}}return l}function jh(t,e,n,s){if(s)return;let r=e[t],a=n[t];return t==="angle"&&(r=Bt(r),a=Bt(a)),{property:t,start:r,end:a}}function sE(t,e){const{x:n=null,y:s=null}=t||{},r=e.points,a=[];return e.segments.forEach(({start:l,end:u})=>{u=jc(l,u,r);const d=r[l],f=r[u];s!==null?(a.push({x:d.x,y:s}),a.push({x:f.x,y:s})):n!==null&&(a.push({x:n,y:d.y}),a.push({x:n,y:f.y}))}),a}function jc(t,e,n){for(;e>t;e--){const s=n[e];if(!isNaN(s.x)&&!isNaN(s.y))break}return e}function $y(t,e,n,s){return t&&e?s(t[n],e[n]):t?t[n]:e?e[n]:0}function Vx(t,e){let n=[],s=!1;return tt(t)?(s=!0,n=t):n=sE(t,e),n.length?new Sc({points:n,options:{tension:0},_loop:s,_fullLoop:s}):null}function zy(t){return t&&t.fill!==!1}function rE(t,e,n){let r=t[e].fill;const a=[e];let l;if(!n)return r;for(;r!==!1&&a.indexOf(r)===-1;){if(!ct(r))return r;if(l=t[r],!l)return!1;if(l.visible)return r;a.push(r),r=l.fill}return!1}function iE(t,e,n){const s=cE(t);if(Re(s))return isNaN(s.value)?!1:s;let r=parseFloat(s);return ct(r)&&Math.floor(r)===r?aE(s[0],e,r,n):["origin","start","end","stack","shape"].indexOf(s)>=0&&s}function aE(t,e,n,s){return(t==="-"||t==="+")&&(n=e+n),n===e||n<0||n>=s?!1:n}function oE(t,e){let n=null;return t==="start"?n=e.bottom:t==="end"?n=e.top:Re(t)?n=e.getPixelForValue(t.value):e.getBasePixel&&(n=e.getBasePixel()),n}function lE(t,e,n){let s;return t==="start"?s=n:t==="end"?s=e.options.reverse?e.min:e.max:Re(t)?s=t.value:s=e.getBaseValue(),s}function cE(t){const e=t.options,n=e.fill;let s=Pe(n&&n.target,n);return s===void 0&&(s=!!e.backgroundColor),s===!1||s===null?!1:s===!0?"origin":s}function uE(t){const{scale:e,index:n,line:s}=t,r=[],a=s.segments,l=s.points,u=dE(e,n);u.push(Vx({x:null,y:e.bottom},s));for(let d=0;d<a.length;d++){const f=a[d];for(let m=f.start;m<=f.end;m++)hE(r,l[m],u)}return new Sc({points:r,options:{}})}function dE(t,e){const n=[],s=t.getMatchingVisibleMetas("line");for(let r=0;r<s.length;r++){const a=s[r];if(a.index===e)break;a.hidden||n.unshift(a.dataset)}return n}function hE(t,e,n){const s=[];for(let r=0;r<n.length;r++){const a=n[r],{first:l,last:u,point:d}=fE(a,e,"x");if(!(!d||l&&u)){if(l)s.unshift(d);else if(t.push(d),!u)break}}t.push(...s)}function fE(t,e,n){const s=t.interpolate(e,n);if(!s)return{};const r=s[n],a=t.segments,l=t.points;let u=!1,d=!1;for(let f=0;f<a.length;f++){const m=a[f],g=l[m.start][n],y=l[m.end][n];if(Ss(r,g,y)){u=r===g,d=r===y;break}}return{first:u,last:d,point:s}}class qx{constructor(e){this.x=e.x,this.y=e.y,this.radius=e.radius}pathSegment(e,n,s){const{x:r,y:a,radius:l}=this;return n=n||{start:0,end:Qe},e.arc(r,a,l,n.end,n.start,!0),!s.bounds}interpolate(e){const{x:n,y:s,radius:r}=this,a=e.angle;return{x:n+Math.cos(a)*r,y:s+Math.sin(a)*r,angle:a}}}function pE(t){const{chart:e,fill:n,line:s}=t;if(ct(n))return mE(e,n);if(n==="stack")return uE(t);if(n==="shape")return!0;const r=gE(t);return r instanceof qx?r:Vx(r,s)}function mE(t,e){const n=t.getDatasetMeta(e);return n&&t.isDatasetVisible(e)?n.dataset:null}function gE(t){return(t.scale||{}).getPointPositionForValue?vE(t):yE(t)}function yE(t){const{scale:e={},fill:n}=t,s=oE(n,e);if(ct(s)){const r=e.isHorizontal();return{x:r?s:null,y:r?null:s}}return null}function vE(t){const{scale:e,fill:n}=t,s=e.options,r=e.getLabels().length,a=s.reverse?e.max:e.min,l=lE(n,e,a),u=[];if(s.grid.circular){const d=e.getPointPositionForValue(0,a);return new qx({x:d.x,y:d.y,radius:e.getDistanceFromCenterForValue(l)})}for(let d=0;d<r;++d)u.push(e.getPointPositionForValue(d,l));return u}function Bd(t,e,n){const s=pE(e),{chart:r,index:a,line:l,scale:u,axis:d}=e,f=l.options,m=f.fill,g=f.backgroundColor,{above:y=g,below:x=g}=m||{},_=r.getDatasetMeta(a),k=Sx(r,_);s&&l.points.length&&(bc(t,n),xE(t,{line:l,target:s,above:y,below:x,area:n,scale:u,axis:d,clip:k}),wc(t))}function xE(t,e){const{line:n,target:s,above:r,below:a,area:l,scale:u,clip:d}=e,f=n._loop?"angle":e.axis;t.save();let m=a;a!==r&&(f==="x"?(Uy(t,s,l.top),$d(t,{line:n,target:s,color:r,scale:u,property:f,clip:d}),t.restore(),t.save(),Uy(t,s,l.bottom)):f==="y"&&(Wy(t,s,l.left),$d(t,{line:n,target:s,color:a,scale:u,property:f,clip:d}),t.restore(),t.save(),Wy(t,s,l.right),m=r)),$d(t,{line:n,target:s,color:m,scale:u,property:f,clip:d}),t.restore()}function Uy(t,e,n){const{segments:s,points:r}=e;let a=!0,l=!1;t.beginPath();for(const u of s){const{start:d,end:f}=u,m=r[d],g=r[jc(d,f,r)];a?(t.moveTo(m.x,m.y),a=!1):(t.lineTo(m.x,n),t.lineTo(m.x,m.y)),l=!!e.pathSegment(t,u,{move:l}),l?t.closePath():t.lineTo(g.x,n)}t.lineTo(e.first().x,n),t.closePath(),t.clip()}function Wy(t,e,n){const{segments:s,points:r}=e;let a=!0,l=!1;t.beginPath();for(const u of s){const{start:d,end:f}=u,m=r[d],g=r[jc(d,f,r)];a?(t.moveTo(m.x,m.y),a=!1):(t.lineTo(n,m.y),t.lineTo(m.x,m.y)),l=!!e.pathSegment(t,u,{move:l}),l?t.closePath():t.lineTo(n,g.y)}t.lineTo(n,e.first().y),t.closePath(),t.clip()}function $d(t,e){const{line:n,target:s,property:r,color:a,scale:l,clip:u}=e,d=nE(n,s,r);for(const{source:f,target:m,start:g,end:y}of d){const{style:{backgroundColor:x=a}={}}=f,_=s!==!0;t.save(),t.fillStyle=x,bE(t,l,u,_&&jh(r,g,y)),t.beginPath();const k=!!n.pathSegment(t,f);let b;if(_){k?t.closePath():Vy(t,s,y,r);const S=!!s.pathSegment(t,m,{move:k,reverse:!0});b=k&&S,b||Vy(t,s,g,r)}t.closePath(),t.fill(b?"evenodd":"nonzero"),t.restore()}}function bE(t,e,n,s){const r=e.chart.chartArea,{property:a,start:l,end:u}=s||{};if(a==="x"||a==="y"){let d,f,m,g;a==="x"?(d=l,f=r.top,m=u,g=r.bottom):(d=r.left,f=l,m=r.right,g=u),t.beginPath(),n&&(d=Math.max(d,n.left),m=Math.min(m,n.right),f=Math.max(f,n.top),g=Math.min(g,n.bottom)),t.rect(d,f,m-d,g-f),t.clip()}}function Vy(t,e,n,s){const r=e.interpolate(n,s);r&&t.lineTo(r.x,r.y)}var wE={id:"filler",afterDatasetsUpdate(t,e,n){const s=(t.data.datasets||[]).length,r=[];let a,l,u,d;for(l=0;l<s;++l)a=t.getDatasetMeta(l),u=a.dataset,d=null,u&&u.options&&u instanceof Sc&&(d={visible:t.isDatasetVisible(l),index:l,fill:iE(u,l,s),chart:t,axis:a.controller.options.indexAxis,scale:a.vScale,line:u}),a.$filler=d,r.push(d);for(l=0;l<s;++l)d=r[l],!(!d||d.fill===!1)&&(d.fill=rE(r,l,n.propagate))},beforeDraw(t,e,n){const s=n.drawTime==="beforeDraw",r=t.getSortedVisibleDatasetMetas(),a=t.chartArea;for(let l=r.length-1;l>=0;--l){const u=r[l].$filler;u&&(u.line.updateControlPoints(a,u.axis),s&&u.fill&&Bd(t.ctx,u,a))}},beforeDatasetsDraw(t,e,n){if(n.drawTime!=="beforeDatasetsDraw")return;const s=t.getSortedVisibleDatasetMetas();for(let r=s.length-1;r>=0;--r){const a=s[r].$filler;zy(a)&&Bd(t.ctx,a,t.chartArea)}},beforeDatasetDraw(t,e,n){const s=e.meta.$filler;!zy(s)||n.drawTime!=="beforeDatasetDraw"||Bd(t.ctx,s,t.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const qy=(t,e)=>{let{boxHeight:n=e,boxWidth:s=e}=t;return t.usePointStyle&&(n=Math.min(n,e),s=t.pointStyleWidth||Math.min(s,e)),{boxWidth:s,boxHeight:n,itemHeight:Math.max(e,n)}},_E=(t,e)=>t!==null&&e!==null&&t.datasetIndex===e.datasetIndex&&t.index===e.index;class Hy extends Ts{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,n,s){this.maxWidth=e,this.maxHeight=n,this._margins=s,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let n=Ye(e.generateLabels,[this.chart],this)||[];e.filter&&(n=n.filter(s=>e.filter(s,this.chart.data))),e.sort&&(n=n.sort((s,r)=>e.sort(s,r,this.chart.data))),this.options.reverse&&n.reverse(),this.legendItems=n}fit(){const{options:e,ctx:n}=this;if(!e.display){this.width=this.height=0;return}const s=e.labels,r=_t(s.font),a=r.size,l=this._computeTitleHeight(),{boxWidth:u,itemHeight:d}=qy(s,a);let f,m;n.font=r.string,this.isHorizontal()?(f=this.maxWidth,m=this._fitRows(l,a,u,d)+10):(m=this.maxHeight,f=this._fitCols(l,r,u,d)+10),this.width=Math.min(f,e.maxWidth||this.maxWidth),this.height=Math.min(m,e.maxHeight||this.maxHeight)}_fitRows(e,n,s,r){const{ctx:a,maxWidth:l,options:{labels:{padding:u}}}=this,d=this.legendHitBoxes=[],f=this.lineWidths=[0],m=r+u;let g=e;a.textAlign="left",a.textBaseline="middle";let y=-1,x=-m;return this.legendItems.forEach((_,k)=>{const b=s+n/2+a.measureText(_.text).width;(k===0||f[f.length-1]+b+2*u>l)&&(g+=m,f[f.length-(k>0?0:1)]=0,x+=m,y++),d[k]={left:0,top:x,row:y,width:b,height:r},f[f.length-1]+=b+u}),g}_fitCols(e,n,s,r){const{ctx:a,maxHeight:l,options:{labels:{padding:u}}}=this,d=this.legendHitBoxes=[],f=this.columnSizes=[],m=l-e;let g=u,y=0,x=0,_=0,k=0;return this.legendItems.forEach((b,S)=>{const{itemWidth:I,itemHeight:C}=kE(s,n,a,b,r);S>0&&x+C+2*u>m&&(g+=y+u,f.push({width:y,height:x}),_+=y+u,k++,y=x=0),d[S]={left:_,top:x,col:k,width:I,height:C},y=Math.max(y,I),x+=C+u}),g+=y,f.push({width:y,height:x}),g}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:n,options:{align:s,labels:{padding:r},rtl:a}}=this,l=Ei(a,this.left,this.width);if(this.isHorizontal()){let u=0,d=Ft(s,this.left+r,this.right-this.lineWidths[u]);for(const f of n)u!==f.row&&(u=f.row,d=Ft(s,this.left+r,this.right-this.lineWidths[u])),f.top+=this.top+e+r,f.left=l.leftForLtr(l.x(d),f.width),d+=f.width+r}else{let u=0,d=Ft(s,this.top+e+r,this.bottom-this.columnSizes[u].height);for(const f of n)f.col!==u&&(u=f.col,d=Ft(s,this.top+e+r,this.bottom-this.columnSizes[u].height)),f.top=d,f.left+=this.left+r,f.left=l.leftForLtr(l.x(f.left),f.width),d+=f.height+r}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;bc(e,this),this._draw(),wc(e)}}_draw(){const{options:e,columnSizes:n,lineWidths:s,ctx:r}=this,{align:a,labels:l}=e,u=nt.color,d=Ei(e.rtl,this.left,this.width),f=_t(l.font),{padding:m}=l,g=f.size,y=g/2;let x;this.drawTitle(),r.textAlign=d.textAlign("left"),r.textBaseline="middle",r.lineWidth=.5,r.font=f.string;const{boxWidth:_,boxHeight:k,itemHeight:b}=qy(l,g),S=function(z,E,D){if(isNaN(_)||_<=0||isNaN(k)||k<0)return;r.save();const M=Pe(D.lineWidth,1);if(r.fillStyle=Pe(D.fillStyle,u),r.lineCap=Pe(D.lineCap,"butt"),r.lineDashOffset=Pe(D.lineDashOffset,0),r.lineJoin=Pe(D.lineJoin,"miter"),r.lineWidth=M,r.strokeStyle=Pe(D.strokeStyle,u),r.setLineDash(Pe(D.lineDash,[])),l.usePointStyle){const N={radius:k*Math.SQRT2/2,pointStyle:D.pointStyle,rotation:D.rotation,borderWidth:M},F=d.xPlus(z,_/2),H=E+y;dx(r,N,F,H,l.pointStyleWidth&&_)}else{const N=E+Math.max((g-k)/2,0),F=d.leftForLtr(z,_),H=zr(D.borderRadius);r.beginPath(),Object.values(H).some(J=>J!==0)?eo(r,{x:F,y:N,w:_,h:k,radius:H}):r.rect(F,N,_,k),r.fill(),M!==0&&r.stroke()}r.restore()},I=function(z,E,D){Vr(r,D.text,z,E+b/2,f,{strikethrough:D.hidden,textAlign:d.textAlign(D.textAlign)})},C=this.isHorizontal(),T=this._computeTitleHeight();C?x={x:Ft(a,this.left+m,this.right-s[0]),y:this.top+m+T,line:0}:x={x:this.left+m,y:Ft(a,this.top+T+m,this.bottom-n[0].height),line:0},xx(this.ctx,e.textDirection);const A=b+m;this.legendItems.forEach((z,E)=>{r.strokeStyle=z.fontColor,r.fillStyle=z.fontColor;const D=r.measureText(z.text).width,M=d.textAlign(z.textAlign||(z.textAlign=l.textAlign)),N=_+y+D;let F=x.x,H=x.y;d.setWidth(this.width),C?E>0&&F+N+m>this.right&&(H=x.y+=A,x.line++,F=x.x=Ft(a,this.left+m,this.right-s[x.line])):E>0&&H+A>this.bottom&&(F=x.x=F+n[x.line].width+m,x.line++,H=x.y=Ft(a,this.top+T+m,this.bottom-n[x.line].height));const J=d.x(F);if(S(J,H,z),F=OC(M,F+_+y,C?F+N:this.right,e.rtl),I(d.x(F),H,z),C)x.x+=N+m;else if(typeof z.text!="string"){const Y=f.lineHeight;x.y+=Hx(z,Y)+m}else x.y+=A}),bx(this.ctx,e.textDirection)}drawTitle(){const e=this.options,n=e.title,s=_t(n.font),r=zt(n.padding);if(!n.display)return;const a=Ei(e.rtl,this.left,this.width),l=this.ctx,u=n.position,d=s.size/2,f=r.top+d;let m,g=this.left,y=this.width;if(this.isHorizontal())y=Math.max(...this.lineWidths),m=this.top+f,g=Ft(e.align,g,this.right-y);else{const _=this.columnSizes.reduce((k,b)=>Math.max(k,b.height),0);m=f+Ft(e.align,this.top,this.bottom-_-e.labels.padding-this._computeTitleHeight())}const x=Ft(u,g,g+y);l.textAlign=a.textAlign(Kh(u)),l.textBaseline="middle",l.strokeStyle=n.color,l.fillStyle=n.color,l.font=s.string,Vr(l,n.text,x,m,s)}_computeTitleHeight(){const e=this.options.title,n=_t(e.font),s=zt(e.padding);return e.display?n.lineHeight+s.height:0}_getLegendItemAt(e,n){let s,r,a;if(Ss(e,this.left,this.right)&&Ss(n,this.top,this.bottom)){for(a=this.legendHitBoxes,s=0;s<a.length;++s)if(r=a[s],Ss(e,r.left,r.left+r.width)&&Ss(n,r.top,r.top+r.height))return this.legendItems[s]}return null}handleEvent(e){const n=this.options;if(!CE(e.type,n))return;const s=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const r=this._hoveredItem,a=_E(r,s);r&&!a&&Ye(n.onLeave,[e,r,this],this),this._hoveredItem=s,s&&!a&&Ye(n.onHover,[e,s,this],this)}else s&&Ye(n.onClick,[e,s,this],this)}}function kE(t,e,n,s,r){const a=SE(s,t,e,n),l=jE(r,s,e.lineHeight);return{itemWidth:a,itemHeight:l}}function SE(t,e,n,s){let r=t.text;return r&&typeof r!="string"&&(r=r.reduce((a,l)=>a.length>l.length?a:l)),e+n.size/2+s.measureText(r).width}function jE(t,e,n){let s=t;return typeof e.text!="string"&&(s=Hx(e,n)),s}function Hx(t,e){const n=t.text?t.text.length:0;return e*n}function CE(t,e){return!!((t==="mousemove"||t==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(t==="click"||t==="mouseup"))}var PE={id:"legend",_element:Hy,start(t,e,n){const s=t.legend=new Hy({ctx:t.ctx,options:n,chart:t});$t.configure(t,s,n),$t.addBox(t,s)},stop(t){$t.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,n){const s=t.legend;$t.configure(t,s,n),s.options=n},afterUpdate(t){const e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,n){const s=e.datasetIndex,r=n.chart;r.isDatasetVisible(s)?(r.hide(s),e.hidden=!0):(r.show(s),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const e=t.data.datasets,{labels:{usePointStyle:n,pointStyle:s,textAlign:r,color:a,useBorderRadius:l,borderRadius:u}}=t.legend.options;return t._getSortedDatasetMetas().map(d=>{const f=d.controller.getStyle(n?0:void 0),m=zt(f.borderWidth);return{text:e[d.index].label,fillStyle:f.backgroundColor,fontColor:a,hidden:!d.visible,lineCap:f.borderCapStyle,lineDash:f.borderDash,lineDashOffset:f.borderDashOffset,lineJoin:f.borderJoinStyle,lineWidth:(m.width+m.height)/4,strokeStyle:f.borderColor,pointStyle:s||f.pointStyle,rotation:f.rotation,textAlign:r||f.textAlign,borderRadius:l&&(u||f.borderRadius),datasetIndex:d.index}},this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};class rf extends Ts{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,n){const s=this.options;if(this.left=0,this.top=0,!s.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=n;const r=tt(s.text)?s.text.length:1;this._padding=zt(s.padding);const a=r*_t(s.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=a:this.width=a}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:n,left:s,bottom:r,right:a,options:l}=this,u=l.align;let d=0,f,m,g;return this.isHorizontal()?(m=Ft(u,s,a),g=n+e,f=a-s):(l.position==="left"?(m=s+e,g=Ft(u,r,n),d=$e*-.5):(m=a-e,g=Ft(u,n,r),d=$e*.5),f=r-n),{titleX:m,titleY:g,maxWidth:f,rotation:d}}draw(){const e=this.ctx,n=this.options;if(!n.display)return;const s=_t(n.font),a=s.lineHeight/2+this._padding.top,{titleX:l,titleY:u,maxWidth:d,rotation:f}=this._drawArgs(a);Vr(e,n.text,0,0,s,{color:n.color,maxWidth:d,rotation:f,textAlign:Kh(n.align),textBaseline:"middle",translation:[l,u]})}}function IE(t,e){const n=new rf({ctx:t.ctx,options:e,chart:t});$t.configure(t,n,e),$t.addBox(t,n),t.titleBlock=n}var EE={id:"title",_element:rf,start(t,e,n){IE(t,n)},stop(t){const e=t.titleBlock;$t.removeBox(t,e),delete t.titleBlock},beforeUpdate(t,e,n){const s=t.titleBlock;$t.configure(t,s,n),s.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Bl=new WeakMap;var TE={id:"subtitle",start(t,e,n){const s=new rf({ctx:t.ctx,options:n,chart:t});$t.configure(t,s,n),$t.addBox(t,s),Bl.set(t,s)},stop(t){$t.removeBox(t,Bl.get(t)),Bl.delete(t)},beforeUpdate(t,e,n){const s=Bl.get(t);$t.configure(t,s,n),s.options=n},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Aa={average(t){if(!t.length)return!1;let e,n,s=new Set,r=0,a=0;for(e=0,n=t.length;e<n;++e){const u=t[e].element;if(u&&u.hasValue()){const d=u.tooltipPosition();s.add(d.x),r+=d.y,++a}}return a===0||s.size===0?!1:{x:[...s].reduce((u,d)=>u+d)/s.size,y:r/a}},nearest(t,e){if(!t.length)return!1;let n=e.x,s=e.y,r=Number.POSITIVE_INFINITY,a,l,u;for(a=0,l=t.length;a<l;++a){const d=t[a].element;if(d&&d.hasValue()){const f=d.getCenterPoint(),m=vh(e,f);m<r&&(r=m,u=d)}}if(u){const d=u.tooltipPosition();n=d.x,s=d.y}return{x:n,y:s}}};function es(t,e){return e&&(tt(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function bs(t){return(typeof t=="string"||t instanceof String)&&t.indexOf(`
`)>-1?t.split(`
`):t}function NE(t,e){const{element:n,datasetIndex:s,index:r}=e,a=t.getDatasetMeta(s).controller,{label:l,value:u}=a.getLabelAndValue(r);return{chart:t,label:l,parsed:a.getParsed(r),raw:t.data.datasets[s].data[r],formattedValue:u,dataset:a.getDataset(),dataIndex:r,datasetIndex:s,element:n}}function Ky(t,e){const n=t.chart.ctx,{body:s,footer:r,title:a}=t,{boxWidth:l,boxHeight:u}=e,d=_t(e.bodyFont),f=_t(e.titleFont),m=_t(e.footerFont),g=a.length,y=r.length,x=s.length,_=zt(e.padding);let k=_.height,b=0,S=s.reduce((T,A)=>T+A.before.length+A.lines.length+A.after.length,0);if(S+=t.beforeBody.length+t.afterBody.length,g&&(k+=g*f.lineHeight+(g-1)*e.titleSpacing+e.titleMarginBottom),S){const T=e.displayColors?Math.max(u,d.lineHeight):d.lineHeight;k+=x*T+(S-x)*d.lineHeight+(S-1)*e.bodySpacing}y&&(k+=e.footerMarginTop+y*m.lineHeight+(y-1)*e.footerSpacing);let I=0;const C=function(T){b=Math.max(b,n.measureText(T).width+I)};return n.save(),n.font=f.string,Ve(t.title,C),n.font=d.string,Ve(t.beforeBody.concat(t.afterBody),C),I=e.displayColors?l+2+e.boxPadding:0,Ve(s,T=>{Ve(T.before,C),Ve(T.lines,C),Ve(T.after,C)}),I=0,n.font=m.string,Ve(t.footer,C),n.restore(),b+=_.width,{width:b,height:k}}function AE(t,e){const{y:n,height:s}=e;return n<s/2?"top":n>t.height-s/2?"bottom":"center"}function OE(t,e,n,s){const{x:r,width:a}=s,l=n.caretSize+n.caretPadding;if(t==="left"&&r+a+l>e.width||t==="right"&&r-a-l<0)return!0}function RE(t,e,n,s){const{x:r,width:a}=n,{width:l,chartArea:{left:u,right:d}}=t;let f="center";return s==="center"?f=r<=(u+d)/2?"left":"right":r<=a/2?f="left":r>=l-a/2&&(f="right"),OE(f,t,e,n)&&(f="center"),f}function Gy(t,e,n){const s=n.yAlign||e.yAlign||AE(t,n);return{xAlign:n.xAlign||e.xAlign||RE(t,e,n,s),yAlign:s}}function ME(t,e){let{x:n,width:s}=t;return e==="right"?n-=s:e==="center"&&(n-=s/2),n}function LE(t,e,n){let{y:s,height:r}=t;return e==="top"?s+=n:e==="bottom"?s-=r+n:s-=r/2,s}function Yy(t,e,n,s){const{caretSize:r,caretPadding:a,cornerRadius:l}=t,{xAlign:u,yAlign:d}=n,f=r+a,{topLeft:m,topRight:g,bottomLeft:y,bottomRight:x}=zr(l);let _=ME(e,u);const k=LE(e,d,f);return d==="center"?u==="left"?_+=f:u==="right"&&(_-=f):u==="left"?_-=Math.max(m,y)+r:u==="right"&&(_+=Math.max(g,x)+r),{x:Ct(_,0,s.width-e.width),y:Ct(k,0,s.height-e.height)}}function $l(t,e,n){const s=zt(n.padding);return e==="center"?t.x+t.width/2:e==="right"?t.x+t.width-s.right:t.x+s.left}function Jy(t){return es([],bs(t))}function DE(t,e,n){return dr(t,{tooltip:e,tooltipItems:n,type:"tooltip"})}function Xy(t,e){const n=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return n?t.override(n):t}const Kx={beforeTitle:vs,title(t){if(t.length>0){const e=t[0],n=e.chart.data.labels,s=n?n.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(s>0&&e.dataIndex<s)return n[e.dataIndex]}return""},afterTitle:vs,beforeBody:vs,beforeLabel:vs,label(t){if(this&&this.options&&this.options.mode==="dataset")return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");const n=t.formattedValue;return Ae(n)||(e+=n),e},labelColor(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:n.borderColor,backgroundColor:n.backgroundColor,borderWidth:n.borderWidth,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:n.pointStyle,rotation:n.rotation}},afterLabel:vs,afterBody:vs,beforeFooter:vs,footer:vs,afterFooter:vs};function tn(t,e,n,s){const r=t[e].call(n,s);return typeof r>"u"?Kx[e].call(n,s):r}class Qy extends Ts{static positioners=Aa;constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const n=this.chart,s=this.options.setContext(this.getContext()),r=s.enabled&&n.options.animation&&s.animations,a=new jx(this.chart,r);return r._cacheable&&(this._cachedAnimations=Object.freeze(a)),a}getContext(){return this.$context||(this.$context=DE(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,n){const{callbacks:s}=n,r=tn(s,"beforeTitle",this,e),a=tn(s,"title",this,e),l=tn(s,"afterTitle",this,e);let u=[];return u=es(u,bs(r)),u=es(u,bs(a)),u=es(u,bs(l)),u}getBeforeBody(e,n){return Jy(tn(n.callbacks,"beforeBody",this,e))}getBody(e,n){const{callbacks:s}=n,r=[];return Ve(e,a=>{const l={before:[],lines:[],after:[]},u=Xy(s,a);es(l.before,bs(tn(u,"beforeLabel",this,a))),es(l.lines,tn(u,"label",this,a)),es(l.after,bs(tn(u,"afterLabel",this,a))),r.push(l)}),r}getAfterBody(e,n){return Jy(tn(n.callbacks,"afterBody",this,e))}getFooter(e,n){const{callbacks:s}=n,r=tn(s,"beforeFooter",this,e),a=tn(s,"footer",this,e),l=tn(s,"afterFooter",this,e);let u=[];return u=es(u,bs(r)),u=es(u,bs(a)),u=es(u,bs(l)),u}_createItems(e){const n=this._active,s=this.chart.data,r=[],a=[],l=[];let u=[],d,f;for(d=0,f=n.length;d<f;++d)u.push(NE(this.chart,n[d]));return e.filter&&(u=u.filter((m,g,y)=>e.filter(m,g,y,s))),e.itemSort&&(u=u.sort((m,g)=>e.itemSort(m,g,s))),Ve(u,m=>{const g=Xy(e.callbacks,m);r.push(tn(g,"labelColor",this,m)),a.push(tn(g,"labelPointStyle",this,m)),l.push(tn(g,"labelTextColor",this,m))}),this.labelColors=r,this.labelPointStyles=a,this.labelTextColors=l,this.dataPoints=u,u}update(e,n){const s=this.options.setContext(this.getContext()),r=this._active;let a,l=[];if(!r.length)this.opacity!==0&&(a={opacity:0});else{const u=Aa[s.position].call(this,r,this._eventPosition);l=this._createItems(s),this.title=this.getTitle(l,s),this.beforeBody=this.getBeforeBody(l,s),this.body=this.getBody(l,s),this.afterBody=this.getAfterBody(l,s),this.footer=this.getFooter(l,s);const d=this._size=Ky(this,s),f=Object.assign({},u,d),m=Gy(this.chart,s,f),g=Yy(s,f,m,this.chart);this.xAlign=m.xAlign,this.yAlign=m.yAlign,a={opacity:1,x:g.x,y:g.y,width:d.width,height:d.height,caretX:u.x,caretY:u.y}}this._tooltipItems=l,this.$context=void 0,a&&this._resolveAnimations().update(this,a),e&&s.external&&s.external.call(this,{chart:this.chart,tooltip:this,replay:n})}drawCaret(e,n,s,r){const a=this.getCaretPosition(e,s,r);n.lineTo(a.x1,a.y1),n.lineTo(a.x2,a.y2),n.lineTo(a.x3,a.y3)}getCaretPosition(e,n,s){const{xAlign:r,yAlign:a}=this,{caretSize:l,cornerRadius:u}=s,{topLeft:d,topRight:f,bottomLeft:m,bottomRight:g}=zr(u),{x:y,y:x}=e,{width:_,height:k}=n;let b,S,I,C,T,A;return a==="center"?(T=x+k/2,r==="left"?(b=y,S=b-l,C=T+l,A=T-l):(b=y+_,S=b+l,C=T-l,A=T+l),I=b):(r==="left"?S=y+Math.max(d,m)+l:r==="right"?S=y+_-Math.max(f,g)-l:S=this.caretX,a==="top"?(C=x,T=C-l,b=S-l,I=S+l):(C=x+k,T=C+l,b=S+l,I=S-l),A=C),{x1:b,x2:S,x3:I,y1:C,y2:T,y3:A}}drawTitle(e,n,s){const r=this.title,a=r.length;let l,u,d;if(a){const f=Ei(s.rtl,this.x,this.width);for(e.x=$l(this,s.titleAlign,s),n.textAlign=f.textAlign(s.titleAlign),n.textBaseline="middle",l=_t(s.titleFont),u=s.titleSpacing,n.fillStyle=s.titleColor,n.font=l.string,d=0;d<a;++d)n.fillText(r[d],f.x(e.x),e.y+l.lineHeight/2),e.y+=l.lineHeight+u,d+1===a&&(e.y+=s.titleMarginBottom-u)}}_drawColorBox(e,n,s,r,a){const l=this.labelColors[s],u=this.labelPointStyles[s],{boxHeight:d,boxWidth:f}=a,m=_t(a.bodyFont),g=$l(this,"left",a),y=r.x(g),x=d<m.lineHeight?(m.lineHeight-d)/2:0,_=n.y+x;if(a.usePointStyle){const k={radius:Math.min(f,d)/2,pointStyle:u.pointStyle,rotation:u.rotation,borderWidth:1},b=r.leftForLtr(y,f)+f/2,S=_+d/2;e.strokeStyle=a.multiKeyBackground,e.fillStyle=a.multiKeyBackground,bh(e,k,b,S),e.strokeStyle=l.borderColor,e.fillStyle=l.backgroundColor,bh(e,k,b,S)}else{e.lineWidth=Re(l.borderWidth)?Math.max(...Object.values(l.borderWidth)):l.borderWidth||1,e.strokeStyle=l.borderColor,e.setLineDash(l.borderDash||[]),e.lineDashOffset=l.borderDashOffset||0;const k=r.leftForLtr(y,f),b=r.leftForLtr(r.xPlus(y,1),f-2),S=zr(l.borderRadius);Object.values(S).some(I=>I!==0)?(e.beginPath(),e.fillStyle=a.multiKeyBackground,eo(e,{x:k,y:_,w:f,h:d,radius:S}),e.fill(),e.stroke(),e.fillStyle=l.backgroundColor,e.beginPath(),eo(e,{x:b,y:_+1,w:f-2,h:d-2,radius:S}),e.fill()):(e.fillStyle=a.multiKeyBackground,e.fillRect(k,_,f,d),e.strokeRect(k,_,f,d),e.fillStyle=l.backgroundColor,e.fillRect(b,_+1,f-2,d-2))}e.fillStyle=this.labelTextColors[s]}drawBody(e,n,s){const{body:r}=this,{bodySpacing:a,bodyAlign:l,displayColors:u,boxHeight:d,boxWidth:f,boxPadding:m}=s,g=_t(s.bodyFont);let y=g.lineHeight,x=0;const _=Ei(s.rtl,this.x,this.width),k=function(D){n.fillText(D,_.x(e.x+x),e.y+y/2),e.y+=y+a},b=_.textAlign(l);let S,I,C,T,A,z,E;for(n.textAlign=l,n.textBaseline="middle",n.font=g.string,e.x=$l(this,b,s),n.fillStyle=s.bodyColor,Ve(this.beforeBody,k),x=u&&b!=="right"?l==="center"?f/2+m:f+2+m:0,T=0,z=r.length;T<z;++T){for(S=r[T],I=this.labelTextColors[T],n.fillStyle=I,Ve(S.before,k),C=S.lines,u&&C.length&&(this._drawColorBox(n,e,T,_,s),y=Math.max(g.lineHeight,d)),A=0,E=C.length;A<E;++A)k(C[A]),y=g.lineHeight;Ve(S.after,k)}x=0,y=g.lineHeight,Ve(this.afterBody,k),e.y-=a}drawFooter(e,n,s){const r=this.footer,a=r.length;let l,u;if(a){const d=Ei(s.rtl,this.x,this.width);for(e.x=$l(this,s.footerAlign,s),e.y+=s.footerMarginTop,n.textAlign=d.textAlign(s.footerAlign),n.textBaseline="middle",l=_t(s.footerFont),n.fillStyle=s.footerColor,n.font=l.string,u=0;u<a;++u)n.fillText(r[u],d.x(e.x),e.y+l.lineHeight/2),e.y+=l.lineHeight+s.footerSpacing}}drawBackground(e,n,s,r){const{xAlign:a,yAlign:l}=this,{x:u,y:d}=e,{width:f,height:m}=s,{topLeft:g,topRight:y,bottomLeft:x,bottomRight:_}=zr(r.cornerRadius);n.fillStyle=r.backgroundColor,n.strokeStyle=r.borderColor,n.lineWidth=r.borderWidth,n.beginPath(),n.moveTo(u+g,d),l==="top"&&this.drawCaret(e,n,s,r),n.lineTo(u+f-y,d),n.quadraticCurveTo(u+f,d,u+f,d+y),l==="center"&&a==="right"&&this.drawCaret(e,n,s,r),n.lineTo(u+f,d+m-_),n.quadraticCurveTo(u+f,d+m,u+f-_,d+m),l==="bottom"&&this.drawCaret(e,n,s,r),n.lineTo(u+x,d+m),n.quadraticCurveTo(u,d+m,u,d+m-x),l==="center"&&a==="left"&&this.drawCaret(e,n,s,r),n.lineTo(u,d+g),n.quadraticCurveTo(u,d,u+g,d),n.closePath(),n.fill(),r.borderWidth>0&&n.stroke()}_updateAnimationTarget(e){const n=this.chart,s=this.$animations,r=s&&s.x,a=s&&s.y;if(r||a){const l=Aa[e.position].call(this,this._active,this._eventPosition);if(!l)return;const u=this._size=Ky(this,e),d=Object.assign({},l,this._size),f=Gy(n,e,d),m=Yy(e,d,f,n);(r._to!==m.x||a._to!==m.y)&&(this.xAlign=f.xAlign,this.yAlign=f.yAlign,this.width=u.width,this.height=u.height,this.caretX=l.x,this.caretY=l.y,this._resolveAnimations().update(this,m))}}_willRender(){return!!this.opacity}draw(e){const n=this.options.setContext(this.getContext());let s=this.opacity;if(!s)return;this._updateAnimationTarget(n);const r={width:this.width,height:this.height},a={x:this.x,y:this.y};s=Math.abs(s)<.001?0:s;const l=zt(n.padding),u=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;n.enabled&&u&&(e.save(),e.globalAlpha=s,this.drawBackground(a,e,r,n),xx(e,n.textDirection),a.y+=l.top,this.drawTitle(a,e,n),this.drawBody(a,e,n),this.drawFooter(a,e,n),bx(e,n.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,n){const s=this._active,r=e.map(({datasetIndex:u,index:d})=>{const f=this.chart.getDatasetMeta(u);if(!f)throw new Error("Cannot find a dataset at index "+u);return{datasetIndex:u,element:f.data[d],index:d}}),a=!tc(s,r),l=this._positionChanged(r,n);(a||l)&&(this._active=r,this._eventPosition=n,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,n,s=!0){if(n&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const r=this.options,a=this._active||[],l=this._getActiveElements(e,a,n,s),u=this._positionChanged(l,e),d=n||!tc(l,a)||u;return d&&(this._active=l,(r.enabled||r.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,n))),d}_getActiveElements(e,n,s,r){const a=this.options;if(e.type==="mouseout")return[];if(!r)return n.filter(u=>this.chart.data.datasets[u.datasetIndex]&&this.chart.getDatasetMeta(u.datasetIndex).controller.getParsed(u.index)!==void 0);const l=this.chart.getElementsAtEventForMode(e,a.mode,a,s);return a.reverse&&l.reverse(),l}_positionChanged(e,n){const{caretX:s,caretY:r,options:a}=this,l=Aa[a.position].call(this,e,n);return l!==!1&&(s!==l.x||r!==l.y)}}var FE={id:"tooltip",_element:Qy,positioners:Aa,afterInit(t,e,n){n&&(t.tooltip=new Qy({chart:t,options:n}))},beforeUpdate(t,e,n){t.tooltip&&t.tooltip.initialize(n)},reset(t,e,n){t.tooltip&&t.tooltip.initialize(n)},afterDraw(t){const e=t.tooltip;if(e&&e._willRender()){const n={tooltip:e};if(t.notifyPlugins("beforeTooltipDraw",{...n,cancelable:!0})===!1)return;e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",n)}},afterEvent(t,e){if(t.tooltip){const n=e.replay;t.tooltip.handleEvent(e.event,n,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:Kx},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>t!=="filter"&&t!=="itemSort"&&t!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},BE=Object.freeze({__proto__:null,Colors:X1,Decimation:tE,Filler:wE,Legend:PE,SubTitle:TE,Title:EE,Tooltip:FE});const $E=(t,e,n,s)=>(typeof e=="string"?(n=t.push(e)-1,s.unshift({index:n,label:e})):isNaN(e)&&(n=null),n);function zE(t,e,n,s){const r=t.indexOf(e);if(r===-1)return $E(t,e,n,s);const a=t.lastIndexOf(e);return r!==a?n:r}const UE=(t,e)=>t===null?null:Ct(Math.round(t),0,e);function Zy(t){const e=this.getLabels();return t>=0&&t<e.length?e[t]:t}class WE extends qr{static id="category";static defaults={ticks:{callback:Zy}};constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const n=this._addedLabels;if(n.length){const s=this.getLabels();for(const{index:r,label:a}of n)s[r]===a&&s.splice(r,1);this._addedLabels=[]}super.init(e)}parse(e,n){if(Ae(e))return null;const s=this.getLabels();return n=isFinite(n)&&s[n]===e?n:zE(s,e,Pe(n,e),this._addedLabels),UE(n,s.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:n}=this.getUserBounds();let{min:s,max:r}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(s=0),n||(r=this.getLabels().length-1)),this.min=s,this.max=r}buildTicks(){const e=this.min,n=this.max,s=this.options.offset,r=[];let a=this.getLabels();a=e===0&&n===a.length-1?a:a.slice(e,n+1),this._valueRange=Math.max(a.length-(s?0:1),1),this._startValue=this.min-(s?.5:0);for(let l=e;l<=n;l++)r.push({value:l});return r}getLabelForValue(e){return Zy.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}function VE(t,e){const n=[],{bounds:r,step:a,min:l,max:u,precision:d,count:f,maxTicks:m,maxDigits:g,includeBounds:y}=t,x=a||1,_=m-1,{min:k,max:b}=e,S=!Ae(l),I=!Ae(u),C=!Ae(f),T=(b-k)/(g+1);let A=Kg((b-k)/_/x)*x,z,E,D,M;if(A<1e-14&&!S&&!I)return[{value:k},{value:b}];M=Math.ceil(b/A)-Math.floor(k/A),M>_&&(A=Kg(M*A/_/x)*x),Ae(d)||(z=Math.pow(10,d),A=Math.ceil(A*z)/z),r==="ticks"?(E=Math.floor(k/A)*A,D=Math.ceil(b/A)*A):(E=k,D=b),S&&I&&a&&CC((u-l)/a,A/1e3)?(M=Math.round(Math.min((u-l)/A,m)),A=(u-l)/M,E=l,D=u):C?(E=S?l:E,D=I?u:D,M=f-1,A=(D-E)/M):(M=(D-E)/A,Fa(M,Math.round(M),A/1e3)?M=Math.round(M):M=Math.ceil(M));const N=Math.max(Gg(A),Gg(E));z=Math.pow(10,Ae(d)?N:d),E=Math.round(E*z)/z,D=Math.round(D*z)/z;let F=0;for(S&&(y&&E!==l?(n.push({value:l}),E<l&&F++,Fa(Math.round((E+F*A)*z)/z,l,ev(l,T,t))&&F++):E<l&&F++);F<M;++F){const H=Math.round((E+F*A)*z)/z;if(I&&H>u)break;n.push({value:H})}return I&&y&&D!==u?n.length&&Fa(n[n.length-1].value,u,ev(u,T,t))?n[n.length-1].value=u:n.push({value:u}):(!I||D===u)&&n.push({value:D}),n}function ev(t,e,{horizontal:n,minRotation:s}){const r=Bn(s),a=(n?Math.sin(r):Math.cos(r))||.001,l=.75*e*(""+t).length;return Math.min(e/a,l)}class lc extends qr{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,n){return Ae(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:n,maxDefined:s}=this.getUserBounds();let{min:r,max:a}=this;const l=d=>r=n?r:d,u=d=>a=s?a:d;if(e){const d=ss(r),f=ss(a);d<0&&f<0?u(0):d>0&&f>0&&l(0)}if(r===a){let d=a===0?1:Math.abs(a*.05);u(a+d),e||l(r-d)}this.min=r,this.max=a}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:n,stepSize:s}=e,r;return s?(r=Math.ceil(this.max/s)-Math.floor(this.min/s)+1,r>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${s} would result generating up to ${r} ticks. Limiting to 1000.`),r=1e3)):(r=this.computeTickLimit(),n=n||11),n&&(r=Math.min(n,r)),r}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,n=e.ticks;let s=this.getTickLimit();s=Math.max(2,s);const r={maxTicks:s,bounds:e.bounds,min:e.min,max:e.max,precision:n.precision,step:n.stepSize,count:n.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:n.minRotation||0,includeBounds:n.includeBounds!==!1},a=this._range||this,l=VE(r,a);return e.bounds==="ticks"&&nx(l,this,"value"),e.reverse?(l.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),l}configure(){const e=this.ticks;let n=this.min,s=this.max;if(super.configure(),this.options.offset&&e.length){const r=(s-n)/Math.max(e.length-1,1)/2;n-=r,s+=r}this._startValue=n,this._endValue=s,this._valueRange=s-n}getLabelForValue(e){return lo(e,this.chart.options.locale,this.options.ticks.format)}}class qE extends lc{static id="linear";static defaults={ticks:{callback:xc.formatters.numeric}};determineDataLimits(){const{min:e,max:n}=this.getMinMax(!0);this.min=ct(e)?e:0,this.max=ct(n)?n:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),n=e?this.width:this.height,s=Bn(this.options.ticks.minRotation),r=(e?Math.sin(s):Math.cos(s))||.001,a=this._resolveTickFontOptions(0);return Math.ceil(n/Math.min(40,a.lineHeight/r))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}const no=t=>Math.floor(sr(t)),Or=(t,e)=>Math.pow(10,no(t)+e);function tv(t){return t/Math.pow(10,no(t))===1}function nv(t,e,n){const s=Math.pow(10,n),r=Math.floor(t/s);return Math.ceil(e/s)-r}function HE(t,e){const n=e-t;let s=no(n);for(;nv(t,e,s)>10;)s++;for(;nv(t,e,s)<10;)s--;return Math.min(s,no(t))}function KE(t,{min:e,max:n}){e=hn(t.min,e);const s=[],r=no(e);let a=HE(e,n),l=a<0?Math.pow(10,Math.abs(a)):1;const u=Math.pow(10,a),d=r>a?Math.pow(10,r):0,f=Math.round((e-d)*l)/l,m=Math.floor((e-d)/u/10)*u*10;let g=Math.floor((f-m)/Math.pow(10,a)),y=hn(t.min,Math.round((d+m+g*Math.pow(10,a))*l)/l);for(;y<n;)s.push({value:y,major:tv(y),significand:g}),g>=10?g=g<15?15:20:g++,g>=20&&(a++,g=2,l=a>=0?1:l),y=Math.round((d+m+g*Math.pow(10,a))*l)/l;const x=hn(t.max,y);return s.push({value:x,major:tv(x),significand:g}),s}class GE extends qr{static id="logarithmic";static defaults={ticks:{callback:xc.formatters.logarithmic,major:{enabled:!0}}};constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(e,n){const s=lc.prototype.parse.apply(this,[e,n]);if(s===0){this._zero=!0;return}return ct(s)&&s>0?s:null}determineDataLimits(){const{min:e,max:n}=this.getMinMax(!0);this.min=ct(e)?Math.max(0,e):null,this.max=ct(n)?Math.max(0,n):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!ct(this._userMin)&&(this.min=e===Or(this.min,0)?Or(this.min,-1):Or(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:e,maxDefined:n}=this.getUserBounds();let s=this.min,r=this.max;const a=u=>s=e?s:u,l=u=>r=n?r:u;s===r&&(s<=0?(a(1),l(10)):(a(Or(s,-1)),l(Or(r,1)))),s<=0&&a(Or(r,-1)),r<=0&&l(Or(s,1)),this.min=s,this.max=r}buildTicks(){const e=this.options,n={min:this._userMin,max:this._userMax},s=KE(n,this);return e.bounds==="ticks"&&nx(s,this,"value"),e.reverse?(s.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),s}getLabelForValue(e){return e===void 0?"0":lo(e,this.chart.options.locale,this.options.ticks.format)}configure(){const e=this.min;super.configure(),this._startValue=sr(e),this._valueRange=sr(this.max)-sr(e)}getPixelForValue(e){return(e===void 0||e===0)&&(e=this.min),e===null||isNaN(e)?NaN:this.getPixelForDecimal(e===this.min?0:(sr(e)-this._startValue)/this._valueRange)}getValueForPixel(e){const n=this.getDecimalForPixel(e);return Math.pow(10,this._startValue+n*this._valueRange)}}function Ch(t){const e=t.ticks;if(e.display&&t.display){const n=zt(e.backdropPadding);return Pe(e.font&&e.font.size,nt.font.size)+n.height}return 0}function YE(t,e,n){return n=tt(n)?n:[n],{w:WC(t,e.string,n),h:n.length*e.lineHeight}}function sv(t,e,n,s,r){return t===s||t===r?{start:e-n/2,end:e+n/2}:t<s||t>r?{start:e-n,end:e}:{start:e,end:e+n}}function JE(t){const e={l:t.left+t._padding.left,r:t.right-t._padding.right,t:t.top+t._padding.top,b:t.bottom-t._padding.bottom},n=Object.assign({},e),s=[],r=[],a=t._pointLabels.length,l=t.options.pointLabels,u=l.centerPointLabels?$e/a:0;for(let d=0;d<a;d++){const f=l.setContext(t.getPointLabelContext(d));r[d]=f.padding;const m=t.getPointPosition(d,t.drawingArea+r[d],u),g=_t(f.font),y=YE(t.ctx,g,t._pointLabels[d]);s[d]=y;const x=Bt(t.getIndexAngle(d)+u),_=Math.round(qh(x)),k=sv(_,m.x,y.w,0,180),b=sv(_,m.y,y.h,90,270);XE(n,e,x,k,b)}t.setCenterPoint(e.l-n.l,n.r-e.r,e.t-n.t,n.b-e.b),t._pointLabelItems=eT(t,s,r)}function XE(t,e,n,s,r){const a=Math.abs(Math.sin(n)),l=Math.abs(Math.cos(n));let u=0,d=0;s.start<e.l?(u=(e.l-s.start)/a,t.l=Math.min(t.l,e.l-u)):s.end>e.r&&(u=(s.end-e.r)/a,t.r=Math.max(t.r,e.r+u)),r.start<e.t?(d=(e.t-r.start)/l,t.t=Math.min(t.t,e.t-d)):r.end>e.b&&(d=(r.end-e.b)/l,t.b=Math.max(t.b,e.b+d))}function QE(t,e,n){const s=t.drawingArea,{extra:r,additionalAngle:a,padding:l,size:u}=n,d=t.getPointPosition(e,s+r+l,a),f=Math.round(qh(Bt(d.angle+pt))),m=sT(d.y,u.h,f),g=tT(f),y=nT(d.x,u.w,g);return{visible:!0,x:d.x,y:m,textAlign:g,left:y,top:m,right:y+u.w,bottom:m+u.h}}function ZE(t,e){if(!e)return!0;const{left:n,top:s,right:r,bottom:a}=t;return!(Cs({x:n,y:s},e)||Cs({x:n,y:a},e)||Cs({x:r,y:s},e)||Cs({x:r,y:a},e))}function eT(t,e,n){const s=[],r=t._pointLabels.length,a=t.options,{centerPointLabels:l,display:u}=a.pointLabels,d={extra:Ch(a)/2,additionalAngle:l?$e/r:0};let f;for(let m=0;m<r;m++){d.padding=n[m],d.size=e[m];const g=QE(t,m,d);s.push(g),u==="auto"&&(g.visible=ZE(g,f),g.visible&&(f=g))}return s}function tT(t){return t===0||t===180?"center":t<180?"left":"right"}function nT(t,e,n){return n==="right"?t-=e:n==="center"&&(t-=e/2),t}function sT(t,e,n){return n===90||n===270?t-=e/2:(n>270||n<90)&&(t-=e),t}function rT(t,e,n){const{left:s,top:r,right:a,bottom:l}=n,{backdropColor:u}=e;if(!Ae(u)){const d=zr(e.borderRadius),f=zt(e.backdropPadding);t.fillStyle=u;const m=s-f.left,g=r-f.top,y=a-s+f.width,x=l-r+f.height;Object.values(d).some(_=>_!==0)?(t.beginPath(),eo(t,{x:m,y:g,w:y,h:x,radius:d}),t.fill()):t.fillRect(m,g,y,x)}}function iT(t,e){const{ctx:n,options:{pointLabels:s}}=t;for(let r=e-1;r>=0;r--){const a=t._pointLabelItems[r];if(!a.visible)continue;const l=s.setContext(t.getPointLabelContext(r));rT(n,l,a);const u=_t(l.font),{x:d,y:f,textAlign:m}=a;Vr(n,t._pointLabels[r],d,f+u.lineHeight/2,u,{color:l.color,textAlign:m,textBaseline:"middle"})}}function Gx(t,e,n,s){const{ctx:r}=t;if(n)r.arc(t.xCenter,t.yCenter,e,0,Qe);else{let a=t.getPointPosition(0,e);r.moveTo(a.x,a.y);for(let l=1;l<s;l++)a=t.getPointPosition(l,e),r.lineTo(a.x,a.y)}}function aT(t,e,n,s,r){const a=t.ctx,l=e.circular,{color:u,lineWidth:d}=e;!l&&!s||!u||!d||n<0||(a.save(),a.strokeStyle=u,a.lineWidth=d,a.setLineDash(r.dash||[]),a.lineDashOffset=r.dashOffset,a.beginPath(),Gx(t,n,l,s),a.closePath(),a.stroke(),a.restore())}function oT(t,e,n){return dr(t,{label:n,index:e,type:"pointLabel"})}class lT extends lc{static id="radialLinear";static defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:xc.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(e){return e},padding:5,centerPointLabels:!1}};static defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"};static descriptors={angleLines:{_fallback:"grid"}};constructor(e){super(e),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const e=this._padding=zt(Ch(this.options)/2),n=this.width=this.maxWidth-e.width,s=this.height=this.maxHeight-e.height;this.xCenter=Math.floor(this.left+n/2+e.left),this.yCenter=Math.floor(this.top+s/2+e.top),this.drawingArea=Math.floor(Math.min(n,s)/2)}determineDataLimits(){const{min:e,max:n}=this.getMinMax(!1);this.min=ct(e)&&!isNaN(e)?e:0,this.max=ct(n)&&!isNaN(n)?n:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/Ch(this.options))}generateTickLabels(e){lc.prototype.generateTickLabels.call(this,e),this._pointLabels=this.getLabels().map((n,s)=>{const r=Ye(this.options.pointLabels.callback,[n,s],this);return r||r===0?r:""}).filter((n,s)=>this.chart.getDataVisibility(s))}fit(){const e=this.options;e.display&&e.pointLabels.display?JE(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(e,n,s,r){this.xCenter+=Math.floor((e-n)/2),this.yCenter+=Math.floor((s-r)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(e,n,s,r))}getIndexAngle(e){const n=Qe/(this._pointLabels.length||1),s=this.options.startAngle||0;return Bt(e*n+Bn(s))}getDistanceFromCenterForValue(e){if(Ae(e))return NaN;const n=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-e)*n:(e-this.min)*n}getValueForDistanceFromCenter(e){if(Ae(e))return NaN;const n=e/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-n:this.min+n}getPointLabelContext(e){const n=this._pointLabels||[];if(e>=0&&e<n.length){const s=n[e];return oT(this.getContext(),e,s)}}getPointPosition(e,n,s=0){const r=this.getIndexAngle(e)-pt+s;return{x:Math.cos(r)*n+this.xCenter,y:Math.sin(r)*n+this.yCenter,angle:r}}getPointPositionForValue(e,n){return this.getPointPosition(e,this.getDistanceFromCenterForValue(n))}getBasePosition(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}getPointLabelPosition(e){const{left:n,top:s,right:r,bottom:a}=this._pointLabelItems[e];return{left:n,top:s,right:r,bottom:a}}drawBackground(){const{backgroundColor:e,grid:{circular:n}}=this.options;if(e){const s=this.ctx;s.save(),s.beginPath(),Gx(this,this.getDistanceFromCenterForValue(this._endValue),n,this._pointLabels.length),s.closePath(),s.fillStyle=e,s.fill(),s.restore()}}drawGrid(){const e=this.ctx,n=this.options,{angleLines:s,grid:r,border:a}=n,l=this._pointLabels.length;let u,d,f;if(n.pointLabels.display&&iT(this,l),r.display&&this.ticks.forEach((m,g)=>{if(g!==0||g===0&&this.min<0){d=this.getDistanceFromCenterForValue(m.value);const y=this.getContext(g),x=r.setContext(y),_=a.setContext(y);aT(this,x,d,l,_)}}),s.display){for(e.save(),u=l-1;u>=0;u--){const m=s.setContext(this.getPointLabelContext(u)),{color:g,lineWidth:y}=m;!y||!g||(e.lineWidth=y,e.strokeStyle=g,e.setLineDash(m.borderDash),e.lineDashOffset=m.borderDashOffset,d=this.getDistanceFromCenterForValue(n.reverse?this.min:this.max),f=this.getPointPosition(u,d),e.beginPath(),e.moveTo(this.xCenter,this.yCenter),e.lineTo(f.x,f.y),e.stroke())}e.restore()}}drawBorder(){}drawLabels(){const e=this.ctx,n=this.options,s=n.ticks;if(!s.display)return;const r=this.getIndexAngle(0);let a,l;e.save(),e.translate(this.xCenter,this.yCenter),e.rotate(r),e.textAlign="center",e.textBaseline="middle",this.ticks.forEach((u,d)=>{if(d===0&&this.min>=0&&!n.reverse)return;const f=s.setContext(this.getContext(d)),m=_t(f.font);if(a=this.getDistanceFromCenterForValue(this.ticks[d].value),f.showLabelBackdrop){e.font=m.string,l=e.measureText(u.label).width,e.fillStyle=f.backdropColor;const g=zt(f.backdropPadding);e.fillRect(-l/2-g.left,-a-m.size/2-g.top,l+g.width,m.size+g.height)}Vr(e,u.label,0,-a,m,{color:f.color,strokeColor:f.textStrokeColor,strokeWidth:f.textStrokeWidth})}),e.restore()}drawTitle(){}}const Cc={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},sn=Object.keys(Cc);function rv(t,e){return t-e}function iv(t,e){if(Ae(e))return null;const n=t._adapter,{parser:s,round:r,isoWeekday:a}=t._parseOpts;let l=e;return typeof s=="function"&&(l=s(l)),ct(l)||(l=typeof s=="string"?n.parse(l,s):n.parse(l)),l===null?null:(r&&(l=r==="week"&&(Ni(a)||a===!0)?n.startOf(l,"isoWeek",a):n.startOf(l,r)),+l)}function av(t,e,n,s){const r=sn.length;for(let a=sn.indexOf(t);a<r-1;++a){const l=Cc[sn[a]],u=l.steps?l.steps:Number.MAX_SAFE_INTEGER;if(l.common&&Math.ceil((n-e)/(u*l.size))<=s)return sn[a]}return sn[r-1]}function cT(t,e,n,s,r){for(let a=sn.length-1;a>=sn.indexOf(n);a--){const l=sn[a];if(Cc[l].common&&t._adapter.diff(r,s,l)>=e-1)return l}return sn[n?sn.indexOf(n):0]}function uT(t){for(let e=sn.indexOf(t)+1,n=sn.length;e<n;++e)if(Cc[sn[e]].common)return sn[e]}function ov(t,e,n){if(!n)t[e]=!0;else if(n.length){const{lo:s,hi:r}=Hh(n,e),a=n[s]>=e?n[s]:n[r];t[a]=!0}}function dT(t,e,n,s){const r=t._adapter,a=+r.startOf(e[0].value,s),l=e[e.length-1].value;let u,d;for(u=a;u<=l;u=+r.add(u,1,s))d=n[u],d>=0&&(e[d].major=!0);return e}function lv(t,e,n){const s=[],r={},a=e.length;let l,u;for(l=0;l<a;++l)u=e[l],r[u]=l,s.push({value:u,major:!1});return a===0||!n?s:dT(t,s,r,n)}class Ph extends qr{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,n={}){const s=e.time||(e.time={}),r=this._adapter=new hI._date(e.adapters.date);r.init(n),Da(s.displayFormats,r.formats()),this._parseOpts={parser:s.parser,round:s.round,isoWeekday:s.isoWeekday},super.init(e),this._normalized=n.normalized}parse(e,n){return e===void 0?null:iv(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,n=this._adapter,s=e.time.unit||"day";let{min:r,max:a,minDefined:l,maxDefined:u}=this.getUserBounds();function d(f){!l&&!isNaN(f.min)&&(r=Math.min(r,f.min)),!u&&!isNaN(f.max)&&(a=Math.max(a,f.max))}(!l||!u)&&(d(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&d(this.getMinMax(!1))),r=ct(r)&&!isNaN(r)?r:+n.startOf(Date.now(),s),a=ct(a)&&!isNaN(a)?a:+n.endOf(Date.now(),s)+1,this.min=Math.min(r,a-1),this.max=Math.max(r+1,a)}_getLabelBounds(){const e=this.getLabelTimestamps();let n=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;return e.length&&(n=e[0],s=e[e.length-1]),{min:n,max:s}}buildTicks(){const e=this.options,n=e.time,s=e.ticks,r=s.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&r.length&&(this.min=this._userMin||r[0],this.max=this._userMax||r[r.length-1]);const a=this.min,l=this.max,u=TC(r,a,l);return this._unit=n.unit||(s.autoSkip?av(n.minUnit,this.min,this.max,this._getLabelCapacity(a)):cT(this,u.length,n.minUnit,this.min,this.max)),this._majorUnit=!s.major.enabled||this._unit==="year"?void 0:uT(this._unit),this.initOffsets(r),e.reverse&&u.reverse(),lv(this,u,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let n=0,s=0,r,a;this.options.offset&&e.length&&(r=this.getDecimalForValue(e[0]),e.length===1?n=1-r:n=(this.getDecimalForValue(e[1])-r)/2,a=this.getDecimalForValue(e[e.length-1]),e.length===1?s=a:s=(a-this.getDecimalForValue(e[e.length-2]))/2);const l=e.length<3?.5:.25;n=Ct(n,0,l),s=Ct(s,0,l),this._offsets={start:n,end:s,factor:1/(n+1+s)}}_generate(){const e=this._adapter,n=this.min,s=this.max,r=this.options,a=r.time,l=a.unit||av(a.minUnit,n,s,this._getLabelCapacity(n)),u=Pe(r.ticks.stepSize,1),d=l==="week"?a.isoWeekday:!1,f=Ni(d)||d===!0,m={};let g=n,y,x;if(f&&(g=+e.startOf(g,"isoWeek",d)),g=+e.startOf(g,f?"day":l),e.diff(s,n,l)>1e5*u)throw new Error(n+" and "+s+" are too far apart with stepSize of "+u+" "+l);const _=r.ticks.source==="data"&&this.getDataTimestamps();for(y=g,x=0;y<s;y=+e.add(y,u,l),x++)ov(m,y,_);return(y===s||r.bounds==="ticks"||x===1)&&ov(m,y,_),Object.keys(m).sort(rv).map(k=>+k)}getLabelForValue(e){const n=this._adapter,s=this.options.time;return s.tooltipFormat?n.format(e,s.tooltipFormat):n.format(e,s.displayFormats.datetime)}format(e,n){const r=this.options.time.displayFormats,a=this._unit,l=n||r[a];return this._adapter.format(e,l)}_tickFormatFunction(e,n,s,r){const a=this.options,l=a.ticks.callback;if(l)return Ye(l,[e,n,s],this);const u=a.time.displayFormats,d=this._unit,f=this._majorUnit,m=d&&u[d],g=f&&u[f],y=s[n],x=f&&g&&y&&y.major;return this._adapter.format(e,r||(x?g:m))}generateTickLabels(e){let n,s,r;for(n=0,s=e.length;n<s;++n)r=e[n],r.label=this._tickFormatFunction(r.value,n,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const n=this._offsets,s=this.getDecimalForValue(e);return this.getPixelForDecimal((n.start+s)*n.factor)}getValueForPixel(e){const n=this._offsets,s=this.getDecimalForPixel(e)/n.factor-n.end;return this.min+s*(this.max-this.min)}_getLabelSize(e){const n=this.options.ticks,s=this.ctx.measureText(e).width,r=Bn(this.isHorizontal()?n.maxRotation:n.minRotation),a=Math.cos(r),l=Math.sin(r),u=this._resolveTickFontOptions(0).size;return{w:s*a+u*l,h:s*l+u*a}}_getLabelCapacity(e){const n=this.options.time,s=n.displayFormats,r=s[n.unit]||s.millisecond,a=this._tickFormatFunction(e,0,lv(this,[e],this._majorUnit),r),l=this._getLabelSize(a),u=Math.floor(this.isHorizontal()?this.width/l.w:this.height/l.h)-1;return u>0?u:1}getDataTimestamps(){let e=this._cache.data||[],n,s;if(e.length)return e;const r=this.getMatchingVisibleMetas();if(this._normalized&&r.length)return this._cache.data=r[0].controller.getAllParsedValues(this);for(n=0,s=r.length;n<s;++n)e=e.concat(r[n].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let n,s;if(e.length)return e;const r=this.getLabels();for(n=0,s=r.length;n<s;++n)e.push(iv(this,r[n]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return ix(e.sort(rv))}}function zl(t,e,n){let s=0,r=t.length-1,a,l,u,d;n?(e>=t[s].pos&&e<=t[r].pos&&({lo:s,hi:r}=js(t,"pos",e)),{pos:a,time:u}=t[s],{pos:l,time:d}=t[r]):(e>=t[s].time&&e<=t[r].time&&({lo:s,hi:r}=js(t,"time",e)),{time:a,pos:u}=t[s],{time:l,pos:d}=t[r]);const f=l-a;return f?u+(d-u)*(e-a)/f:u}class hT extends Ph{static id="timeseries";static defaults=Ph.defaults;constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),n=this._table=this.buildLookupTable(e);this._minPos=zl(n,this.min),this._tableRange=zl(n,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:n,max:s}=this,r=[],a=[];let l,u,d,f,m;for(l=0,u=e.length;l<u;++l)f=e[l],f>=n&&f<=s&&r.push(f);if(r.length<2)return[{time:n,pos:0},{time:s,pos:1}];for(l=0,u=r.length;l<u;++l)m=r[l+1],d=r[l-1],f=r[l],Math.round((m+d)/2)!==f&&a.push({time:f,pos:l/(u-1)});return a}_generate(){const e=this.min,n=this.max;let s=super.getDataTimestamps();return(!s.includes(e)||!s.length)&&s.splice(0,0,e),(!s.includes(n)||s.length===1)&&s.push(n),s.sort((r,a)=>r-a)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const n=this.getDataTimestamps(),s=this.getLabelTimestamps();return n.length&&s.length?e=this.normalize(n.concat(s)):e=n.length?n:s,e=this._cache.all=e,e}getDecimalForValue(e){return(zl(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const n=this._offsets,s=this.getDecimalForPixel(e)/n.factor-n.end;return zl(this._table,s*this._tableRange+this._minPos,!0)}}var fT=Object.freeze({__proto__:null,CategoryScale:WE,LinearScale:qE,LogarithmicScale:GE,RadialLinearScale:lT,TimeScale:Ph,TimeSeriesScale:hT});const pT=[dI,V1,BE,fT];sf.register(...pT);function ja({type:t,data:e,options:n}){const s=j.useRef(null),r=j.useRef(null);return j.useEffect(()=>{if(s.current)return r.current&&(r.current.destroy(),r.current=null),r.current=new sf(s.current,{type:t,data:e,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:"#4a5568"}}},...n}}),()=>{r.current&&(r.current.destroy(),r.current=null)}},[t,e,n]),c.jsx("div",{className:"dashboard-chart-wrap",children:c.jsx("canvas",{ref:s})})}const Ca={sale:1,expense:2,income:3};function mT(t){const e=new Date(`${t}T00:00:00`),n=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0");return`${n}-${s}`}function gT(){const t=new Date,e=new Date(t.getFullYear(),t.getMonth(),1),n=new Date(t.getFullYear(),t.getMonth()+1,0);return{from:e.toISOString().slice(0,10),to:n.toISOString().slice(0,10),daysInMonth:n.getDate()}}function yT(t=6){const e=new Date,n=[];for(let s=t-1;s>=0;s-=1){const r=new Date(e.getFullYear(),e.getMonth()-s,1);n.push(`${r.getFullYear()}-${String(r.getMonth()+1).padStart(2,"0")}`)}return n}async function vT(t,e="es"){const{data:n,error:s}=await G.from("account_payment_forms").select('id, name, kind, provider, reference, "isActive"').eq("accountId",t).eq("isActive",!0);if(s)throw s;const{data:r,error:a}=await G.from("transactions").select('id, date, type, total, balance, "accountPaymentFormId", "isInternalObligation", "isActive"').eq("accountId",t).eq("isActive",!0);if(a)throw a;const l=(r??[]).map(E=>E.id);let u=[];if(l.length>0){const{data:E,error:D}=await G.from("transactionDetails").select("transactionId, conceptId, total, concepts(name)").in("transactionId",l);if(D)throw D;u=E??[]}const d=new Map((n??[]).map(E=>[Number(E.id),E])),f=new Map((r??[]).map(E=>[Number(E.id),E])),g=(n??[]).filter(E=>E.kind==="bank_account").map(E=>{const D=(r??[]).filter(M=>Number(M.accountPaymentFormId)===Number(E.id)).reduce((M,N)=>M+Number(N.total||0),0);return{id:E.id,name:E.name,provider:E.provider,balance:D}}),{from:y,to:x,daysInMonth:_}=gT(),k=Array.from({length:_},(E,D)=>D+1),b=new Map(k.map(E=>[E,0]));(r??[]).filter(E=>E.type===Ca.sale&&E.date>=y&&E.date<=x).forEach(E=>{const D=Number(String(E.date).slice(-2));b.set(D,Number(b.get(D)||0)+Number(E.total||0))});const S=new Map,I=new Map;u.forEach(E=>{const D=f.get(Number(E.transactionId));if(!D||D.date<y||D.date>x)return;const M=E.concepts?.name||`#${E.conceptId}`,N=Math.abs(Number(E.total||0));D.type===Ca.expense&&S.set(M,Number(S.get(M)||0)+N),D.type===Ca.income&&I.set(M,Number(I.get(M)||0)+N)});const C=yT(6),T=new Intl.DateTimeFormat(e==="es"?"es-ES":"en-US",{month:"short",year:"2-digit"}),A=new Map(C.map(E=>[E,{income:0,expense:0}]));(r??[]).forEach(E=>{const D=mT(E.date);if(!A.has(D))return;const M=A.get(D);E.type===Ca.income&&(M.income+=Math.abs(Number(E.total||0))),E.type===Ca.expense&&(M.expense+=Math.abs(Number(E.total||0))),A.set(D,M)});const z=new Map;return(r??[]).filter(E=>E.isInternalObligation).forEach(E=>{const M=d.get(Number(E.accountPaymentFormId))?.name||"-";z.set(M,Number(z.get(M)||0)+Math.abs(Number(E.balance||E.total||0)))}),{bankBalances:g,salesByDay:{labels:k.map(E=>String(E)),values:k.map(E=>Number(b.get(E)||0))},expensesByConcept:{labels:[...S.keys()],values:[...S.values()]},incomesByConcept:{labels:[...I.keys()],values:[...I.values()]},incomeExpenseLine:{labels:C.map(E=>{const[D,M]=E.split("-").map(Number);return T.format(new Date(D,M-1,1))}),incomeValues:C.map(E=>A.get(E)?.income||0),expenseValues:C.map(E=>A.get(E)?.expense||0)},internalObligationsByPaymentForm:{labels:[...z.keys()],values:[...z.values()]}}}function Ie(t,e={}){const n=Number(t??0);return Number.isFinite(n)?new Intl.NumberFormat("en-US",{minimumFractionDigits:e.minimumFractionDigits??2,maximumFractionDigits:e.maximumFractionDigits??2}).format(n):"0"}const cv=["#0f766e","#0284c7","#f59e0b","#dc2626","#6366f1","#10b981","#f97316","#8b5cf6"];function zd(t){return t.labels.length?{labels:t.labels,datasets:[{data:t.values,backgroundColor:t.labels.map((e,n)=>cv[n%cv.length])}]}:{labels:["-"],datasets:[{data:[1],backgroundColor:["#cbd5e1"]}]}}function xT(){const{t}=Ee(),{account:e}=Oe(),[n,s]=j.useState(null),[r,a]=j.useState(""),[l,u]=j.useState(!0);j.useEffect(()=>{e?.accountId&&d()},[e?.accountId]);const d=async()=>{try{u(!0);const g=await vT(e.accountId);s(g),a("")}catch{a(t("common.genericLoadError"))}finally{u(!1)}},f=j.useMemo(()=>n?{labels:n.salesByDay.labels,datasets:[{label:t("dashboard.salesMonthBar"),data:n.salesByDay.values,backgroundColor:"#0f766e"}]}:{labels:[],datasets:[]},[n,t]),m=j.useMemo(()=>n?{labels:n.incomeExpenseLine.labels,datasets:[{label:t("dashboard.incomesLine"),data:n.incomeExpenseLine.incomeValues,borderColor:"#0f766e",backgroundColor:"rgba(15,118,110,0.2)",tension:.3},{label:t("dashboard.expensesLine"),data:n.incomeExpenseLine.expenseValues,borderColor:"#dc2626",backgroundColor:"rgba(220,38,38,0.2)",tension:.3}]}:{labels:[],datasets:[]},[n,t]);return l?c.jsx("p",{children:t("common.loading")}):c.jsxs("div",{className:"module-page dashboard-page",children:[c.jsx("h1",{children:t("dashboard.title")}),c.jsx("p",{children:t("dashboard.subtitle")}),r&&c.jsx("p",{className:"error-text",children:r}),n&&c.jsxs(c.Fragment,{children:[c.jsxs("section",{className:"generic-panel",children:[c.jsx("h2",{className:"crud-form-section-title",children:t("dashboard.bankBalances")}),c.jsxs("table",{className:"crud-table",children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:t("common.name")}),c.jsx("th",{children:t("paymentForms.provider")}),c.jsx("th",{children:t("transactions.balance")})]})}),c.jsx("tbody",{children:n.bankBalances.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:3,children:t("common.empty")})}):n.bankBalances.map(g=>c.jsxs("tr",{children:[c.jsx("td",{children:g.name}),c.jsx("td",{children:g.provider||"-"}),c.jsx("td",{children:Ie(g.balance)})]},g.id))})]})]}),c.jsxs("section",{className:"dashboard-grid",children:[c.jsxs("article",{className:"generic-panel dashboard-panel",children:[c.jsx("h2",{className:"crud-form-section-title",children:t("dashboard.salesMonthBar")}),c.jsx(ja,{type:"bar",data:f,options:{plugins:{legend:{display:!1}}}})]}),c.jsxs("article",{className:"generic-panel dashboard-panel",children:[c.jsx("h2",{className:"crud-form-section-title",children:t("dashboard.expensesByConceptDonut")}),c.jsx(ja,{type:"doughnut",data:zd(n.expensesByConcept)})]}),c.jsxs("article",{className:"generic-panel dashboard-panel",children:[c.jsx("h2",{className:"crud-form-section-title",children:t("dashboard.incomesByConceptDonut")}),c.jsx(ja,{type:"doughnut",data:zd(n.incomesByConcept)})]}),c.jsxs("article",{className:"generic-panel dashboard-panel",children:[c.jsx("h2",{className:"crud-form-section-title",children:t("dashboard.incomeVsExpenseLine")}),c.jsx(ja,{type:"line",data:m})]}),c.jsxs("article",{className:"generic-panel dashboard-panel",children:[c.jsx("h2",{className:"crud-form-section-title",children:t("dashboard.internalObligationsByPaymentForm")}),c.jsx(ja,{type:"doughnut",data:zd(n.internalObligationsByPaymentForm)})]})]})]})]})}function Un({page:t,pageSize:e,totalItems:n,onPageChange:s}){const{t:r}=Ee(),a=Math.max(1,Math.ceil(n/e));return c.jsxs("div",{className:"pagination-wrap",children:[c.jsx("button",{type:"button",className:"button-secondary",onClick:()=>s(t-1),disabled:t<=1,children:r("common.previous")}),c.jsxs("span",{children:[r("common.page")," ",t," ",r("common.of")," ",a]}),c.jsx("button",{type:"button",className:"button-secondary",onClick:()=>s(t+1),disabled:t>=a,children:r("common.next")})]})}const co="id, name, phone, address, type";async function uv(t){const{data:e,error:n}=await G.from("persons").select(co).eq("accountId",t).order("id",{ascending:!1});if(n)throw n;return e??[]}async function bT(t,e){const{data:n,error:s}=await G.from("persons").select(co).eq("accountId",t).eq("type",e).order("id",{ascending:!1});if(s)throw s;return n??[]}async function wT(t){const{data:e,error:n}=await G.from("persons").select(co).eq("id",t).single();if(n)throw n;return e}async function _T(t){const{data:e,error:n}=await G.from("persons").insert(t).select(co).single();if(n)throw n;return e}async function kT(t,e){const{data:n,error:s}=await G.from("persons").update(e).eq("id",t).select(co).single();if(s)throw s;return n}async function ST(t){const{error:e}=await G.from("persons").delete().eq("id",t);if(e)throw e}const jT={name:"",phone:"",address:""};function $r({personType:t,titleKey:e,basePath:n,embedded:s=!1,onCancel:r,onCreated:a}){const{t:l}=Ee(),{account:u,user:d}=Oe(),f=Ht(),{id:m}=zn(),g=!s&&!!m,[y,x]=j.useState(jT),[_,k]=j.useState(!1),[b,S]=j.useState(g),[I,C]=j.useState("");j.useEffect(()=>{g&&T()},[g,m]);const T=async()=>{try{S(!0);const E=await wT(m);x({name:E.name,phone:E.phone??"",address:E.address??""})}catch{C(l("common.genericLoadError"))}finally{S(!1)}},A=E=>{const{name:D,value:M}=E.target;x(N=>({...N,[D]:M}))},z=async E=>{if(E.preventDefault(),C(""),!E.currentTarget.checkValidity()){E.currentTarget.reportValidity(),C(l("common.requiredFields"));return}if(!u?.accountId||!d?.id){C(l("common.requiredFields"));return}const D={accountId:u.accountId,name:y.name.trim(),phone:y.phone.trim()||null,address:y.address.trim()||null,type:t};try{k(!0);let M=null;if(g?M=await kT(m,D):M=await _T({...D,createdById:d.id}),s){a?.(M);return}f(n)}catch{C(l("common.genericSaveError"))}finally{k(!1)}};return c.jsxs("div",{className:s?"":"module-page",children:[s?c.jsx("h3",{children:l(g?"common.edit":e)}):c.jsxs("div",{className:"page-header-row",children:[c.jsx("h1",{children:l(g?"common.edit":e)}),c.jsx(st,{to:n,className:"button-link-secondary",children:l("common.backToList")})]}),I&&c.jsx("p",{className:"error-text",children:I}),b?c.jsx("p",{children:l("common.loading")}):c.jsxs("form",{className:"crud-form",onSubmit:z,children:[c.jsxs("div",{className:"form-grid-2",children:[c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:l("common.name")}),c.jsx("input",{name:"name",placeholder:l("common.name"),value:y.name,onChange:A,required:!0})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:l("common.phone")}),c.jsx("input",{name:"phone",placeholder:l("common.phone"),value:y.phone,onChange:A})]}),c.jsxs("label",{className:"field-block form-span-2",children:[c.jsx("span",{children:l("common.address")}),c.jsx("input",{name:"address",placeholder:l("common.address"),value:y.address,onChange:A})]})]}),c.jsxs("div",{className:"crud-form-actions",children:[s?c.jsx("button",{type:"button",className:"button-secondary",onClick:()=>r?.(),children:l("common.cancel")}):null,c.jsx("button",{type:"submit",disabled:_,children:l(g?"common.update":"common.create")})]})]})]})}function kn({actions:t}){const[e,n]=j.useState(!1),s=j.useRef(null);return j.useEffect(()=>{const r=a=>{s.current?.contains(a.target)||n(!1)};return window.addEventListener("click",r),()=>window.removeEventListener("click",r)},[]),c.jsxs("div",{className:"row-actions-wrap",ref:s,children:[c.jsx("button",{type:"button",className:"row-menu-btn",onClick:()=>n(r=>!r),"aria-label":"Actions",children:c.jsx(A_,{})}),e&&c.jsx("div",{className:"row-menu-dropdown",children:t.map(r=>r.to?c.jsx(st,{to:r.to,className:`row-menu-item ${r.danger?"danger":""}`,children:r.label},r.key):c.jsx("button",{type:"button",className:`row-menu-item ${r.danger?"danger":""}`,onClick:()=>{r.onClick?.(),n(!1)},disabled:r.disabled,children:r.label},r.key))})]})}const Ud=10;function dv({personType:t,titleKey:e,basePath:n}){const{t:s}=Ee(),{account:r}=Oe(),[a,l]=j.useState([]),[u,d]=j.useState(""),[f,m]=j.useState(!0),[g,y]=j.useState(1),[x,_]=is(),k=x.get("create")==="1";j.useEffect(()=>{r?.accountId&&S()},[r?.accountId,t]);const b=j.useMemo(()=>{const C=(g-1)*Ud;return a.slice(C,C+Ud)},[a,g]),S=async()=>{try{m(!0);const C=await bT(r.accountId,t);l(C),d(""),y(1)}catch{d(s("common.genericLoadError"))}finally{m(!1)}},I=async C=>{try{await ST(C),await S()}catch{d(s("common.genericSaveError"))}};return c.jsxs("div",{className:"module-page",children:[c.jsx("h1",{children:s(e)}),u&&c.jsx("p",{className:"error-text",children:u}),f?c.jsx("p",{children:s("common.loading")}):a.length===0?c.jsx("p",{children:s("common.empty")}):c.jsxs(c.Fragment,{children:[c.jsxs("table",{className:"crud-table",children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:s("common.name")}),c.jsx("th",{children:s("common.phone")}),c.jsx("th",{children:s("common.address")}),c.jsx("th",{children:s("common.actions")})]})}),c.jsx("tbody",{children:b.map(C=>c.jsxs("tr",{children:[c.jsx("td",{children:C.name}),c.jsx("td",{children:C.phone??"-"}),c.jsx("td",{children:C.address??"-"}),c.jsx("td",{className:"table-actions",children:c.jsx(kn,{actions:[{key:"edit",label:s("common.edit"),to:`${n}/${C.id}/edit`},{key:"delete",label:s("common.delete"),onClick:()=>I(C.id),danger:!0}]})})]},C.id))})]}),c.jsx(Un,{page:g,pageSize:Ud,totalItems:a.length,onPageChange:y})]}),k?c.jsx("div",{className:"modal-backdrop",onClick:()=>{const C=new URLSearchParams(x);C.delete("create"),_(C)},children:c.jsx("div",{className:"modal-card",onClick:C=>C.stopPropagation(),children:c.jsx($r,{embedded:!0,personType:t,titleKey:t===1?"actions.newClient":"actions.newProvider",basePath:n,onCancel:()=>{const C=new URLSearchParams(x);C.delete("create"),_(C)},onCreated:async()=>{await S();const C=new URLSearchParams(x);C.delete("create"),_(C)}})})}):null]})}const Pc="id, name, phone, email, address, isPartner";async function cc(t){const{data:e,error:n}=await G.from("employes").select(Pc).eq("accountId",t).order("id",{ascending:!1});if(n)throw n;return e??[]}async function CT(t){const{data:e,error:n}=await G.from("employes").select(Pc).eq("id",t).single();if(n)throw n;return e}async function PT(t){const{data:e,error:n}=await G.from("employes").insert(t).select(Pc).single();if(n)throw n;return e}async function IT(t,e){const{data:n,error:s}=await G.from("employes").update(e).eq("id",t).select(Pc).single();if(s)throw s;return n}async function ET(t){const{error:e}=await G.from("employes").delete().eq("id",t);if(e)throw e}const TT={name:"",phone:"",email:"",address:"",isPartner:!1};function uc({embedded:t=!1,onCancel:e,onCreated:n}){const{t:s}=Ee(),{account:r,user:a}=Oe(),l=Ht(),{id:u}=zn(),d=!t&&!!u,[f,m]=j.useState(TT),[g,y]=j.useState(!1),[x,_]=j.useState(d),[k,b]=j.useState("");j.useEffect(()=>{d&&S()},[d,u]);const S=async()=>{try{_(!0);const T=await CT(u);m({name:T.name,phone:T.phone??"",email:T.email??"",address:T.address??"",isPartner:!!T.isPartner})}catch{b(s("common.genericLoadError"))}finally{_(!1)}},I=T=>{const{name:A,value:z,type:E,checked:D}=T.target;m(M=>({...M,[A]:E==="checkbox"?D:z}))},C=async T=>{if(T.preventDefault(),b(""),!T.currentTarget.checkValidity()){T.currentTarget.reportValidity(),b(s("common.requiredFields"));return}if(!r?.accountId||!a?.id){b(s("common.requiredFields"));return}const A={accountId:r.accountId,name:f.name.trim(),phone:f.phone.trim()||null,email:f.email.trim()||null,address:f.address.trim()||null,isPartner:f.isPartner};try{y(!0);let z=null;if(d?z=await IT(u,A):z=await PT({...A,createdById:a.id}),t){n?.(z);return}l("/employees")}catch{b(s("common.genericSaveError"))}finally{y(!1)}};return c.jsxs("div",{className:t?"":"module-page",children:[t?c.jsx("h3",{children:s(d?"common.edit":"actions.newEmployee")}):c.jsxs("div",{className:"page-header-row",children:[c.jsx("h1",{children:s(d?"common.edit":"common.create")}),c.jsx(st,{to:"/employees",className:"button-link-secondary",children:s("common.backToList")})]}),k&&c.jsx("p",{className:"error-text",children:k}),x?c.jsx("p",{children:s("common.loading")}):c.jsxs("form",{className:"crud-form",onSubmit:C,children:[c.jsxs("div",{className:"form-grid-2",children:[c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:s("common.name")}),c.jsx("input",{name:"name",placeholder:s("common.name"),value:f.name,onChange:I,required:!0})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:s("common.phone")}),c.jsx("input",{name:"phone",placeholder:s("common.phone"),value:f.phone,onChange:I})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:s("common.email")}),c.jsx("input",{name:"email",placeholder:s("common.email"),value:f.email,onChange:I})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:s("common.address")}),c.jsx("input",{name:"address",placeholder:s("common.address"),value:f.address,onChange:I})]}),c.jsxs("label",{className:"checkbox-field form-span-2",children:[c.jsx("input",{name:"isPartner",type:"checkbox",checked:f.isPartner,onChange:I}),s("employees.isPartner")]})]}),c.jsxs("div",{className:"crud-form-actions",children:[t?c.jsx("button",{type:"button",className:"button-secondary",onClick:()=>e?.(),children:s("common.cancel")}):null,c.jsx("button",{type:"submit",disabled:g,children:s(d?"common.update":"common.create")})]})]})]})}const Wd=10;function NT(){const{t}=Ee(),{account:e}=Oe(),[n,s]=j.useState([]),[r,a]=j.useState(""),[l,u]=j.useState(!0),[d,f]=j.useState(1),[m,g]=is(),y=m.get("create")==="1";j.useEffect(()=>{e?.accountId&&_()},[e?.accountId]);const x=j.useMemo(()=>{const b=(d-1)*Wd;return n.slice(b,b+Wd)},[n,d]),_=async()=>{try{u(!0);const b=await cc(e.accountId);s(b),a(""),f(1)}catch{a(t("common.genericLoadError"))}finally{u(!1)}},k=async b=>{try{await ET(b),await _()}catch{a(t("common.genericSaveError"))}};return c.jsxs("div",{className:"module-page",children:[c.jsx("h1",{children:t("employees.title")}),c.jsx("p",{children:t("employees.sensitiveHint")}),r&&c.jsx("p",{className:"error-text",children:r}),l?c.jsx("p",{children:t("common.loading")}):n.length===0?c.jsx("p",{children:t("common.empty")}):c.jsxs(c.Fragment,{children:[c.jsxs("table",{className:"crud-table",children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:t("common.name")}),c.jsx("th",{children:t("common.phone")}),c.jsx("th",{children:t("common.email")}),c.jsx("th",{children:t("common.address")}),c.jsx("th",{children:t("employees.isPartner")}),c.jsx("th",{children:t("common.actions")})]})}),c.jsx("tbody",{children:x.map(b=>c.jsxs("tr",{children:[c.jsx("td",{children:b.name}),c.jsx("td",{children:b.phone??"-"}),c.jsx("td",{children:b.email??"-"}),c.jsx("td",{children:b.address??"-"}),c.jsx("td",{children:b.isPartner?t("common.yes"):t("common.no")}),c.jsx("td",{className:"table-actions",children:c.jsx(kn,{actions:[{key:"edit",label:t("common.edit"),to:`/employees/${b.id}/edit`},{key:"delete",label:t("common.delete"),onClick:()=>k(b.id),danger:!0}]})})]},b.id))})]}),c.jsx(Un,{page:d,pageSize:Wd,totalItems:n.length,onPageChange:f})]}),y?c.jsx("div",{className:"modal-backdrop",onClick:()=>{const b=new URLSearchParams(m);b.delete("create"),g(b)},children:c.jsx("div",{className:"modal-card",onClick:b=>b.stopPropagation(),children:c.jsx(uc,{embedded:!0,onCancel:()=>{const b=new URLSearchParams(m);b.delete("create"),g(b)},onCreated:async()=>{await _();const b=new URLSearchParams(m);b.delete("create"),g(b)}})})}):null]})}function ts({label:t,value:e,onValueChange:n,options:s,getOptionLabel:r,onSelect:a,placeholder:l,addButton:u,renderCreateModal:d,onCreateRecord:f,noResultsText:m,selectedPillText:g,onClearSelection:y}){const[x,_]=j.useState(!1),[k,b]=j.useState(-1),[S,I]=j.useState(!1),C=j.useMemo(()=>{const A=e.trim().toLowerCase();return A?s.filter(z=>r(z).toLowerCase().includes(A)).slice(0,50):s.slice(0,50)},[r,s,e]),T=A=>{if(!x){(A.key==="ArrowDown"||A.key==="ArrowUp")&&(_(!0),b(C.length>0?0:-1),A.preventDefault());return}if(A.key==="ArrowDown"){if(A.preventDefault(),C.length===0)return;b(z=>z<C.length-1?z+1:0);return}if(A.key==="ArrowUp"){if(A.preventDefault(),C.length===0)return;b(z=>z>0?z-1:C.length-1);return}if(A.key==="Enter"){k>=0&&k<C.length&&(A.preventDefault(),a(C[k]),_(!1));return}A.key==="Escape"&&(_(!1),b(-1))};return c.jsxs("div",{className:"lookup-wrap",children:[t?c.jsx("label",{children:t}):null,c.jsxs("div",{className:"lookup-input-row",children:[g?c.jsxs("div",{className:"lookup-selected-pill",children:[c.jsx("span",{children:g}),y?c.jsx("button",{type:"button",onClick:()=>{y(),_(!1),b(-1)},"aria-label":"clear selected",children:""}):null]}):c.jsx("input",{value:e,onChange:A=>{n(A.target.value),_(!0),b(0)},onFocus:()=>{_(!0),b(C.length>0?0:-1)},onClick:()=>{_(!0),b(C.length>0?0:-1)},onBlur:()=>setTimeout(()=>_(!1),120),onKeyDown:T,placeholder:l}),u?c.jsx("div",{className:"lookup-input-action",children:u}):null,!u&&d?c.jsx("div",{className:"lookup-input-action",children:c.jsx("button",{type:"button",className:"button-secondary lookup-add-button",onClick:()=>I(!0),title:"create",children:"+"})}):null]}),!g&&x&&c.jsx("div",{className:"lookup-results",children:C.length>0?C.map((A,z)=>c.jsx("button",{type:"button",className:`lookup-item ${k===z?"active":""}`,onMouseDown:E=>E.preventDefault(),onClick:()=>{a(A),_(!1)},children:r(A)},A.id)):c.jsx("div",{className:"lookup-empty",children:m})}),d?dw.createPortal(d({isOpen:S,onClose:()=>I(!1),onCreated:async A=>{f&&await f(A),I(!1)}}),document.body):null]})}const uo="id, name, parentConceptId, isGroup, isIncome, isExpense, isProduct, isPaymentForm, isAccountPayableConcept, isIncomingPaymentConcept, isOutgoingPaymentConcept, isSystem, taxPercentage, price, additionalCharges";async function Ri(t){const{data:e,error:n}=await G.from("concepts").select(uo).eq("accountId",t).order("id",{ascending:!1});if(n)throw n;return e??[]}async function Ih(t,e){let n=G.from("concepts").select(uo).eq("accountId",t);e==="products"&&(n=n.eq("isProduct",!0).eq("isGroup",!1)),e==="income"&&(n=n.eq("isIncome",!0).eq("isProduct",!1).eq("isGroup",!1).eq("isIncomingPaymentConcept",!1)),e==="expense"&&(n=n.eq("isExpense",!0).eq("isGroup",!1).eq("isOutgoingPaymentConcept",!1).eq("isAccountPayableConcept",!1)),e==="groups"&&(n=n.eq("isGroup",!0)),e==="payable"&&(n=n.eq("isAccountPayableConcept",!0).eq("isGroup",!1));const{data:s,error:r}=await n.order("id",{ascending:!1});if(r)throw r;return s??[]}async function AT(t){const{data:e,error:n}=await G.from("concepts").select(uo).eq("id",t).single();if(n)throw n;return e}async function OT(t){const{data:e,error:n}=await G.from("concepts").insert(t).select(uo).single();if(n)throw n;return e}async function RT(t,e){const{data:n,error:s}=await G.from("concepts").update(e).eq("id",t).select(uo).single();if(s)throw s;return n}async function MT(t){const{error:e}=await G.from("concepts").delete().eq("id",t);if(e)throw e}const LT={products:{isProduct:!0,isIncome:!0,isExpense:!1,isGroup:!1,isPaymentForm:!1,isAccountPayableConcept:!1},income:{isProduct:!1,isIncome:!0,isExpense:!1,isGroup:!1,isPaymentForm:!1,isAccountPayableConcept:!1},expense:{isProduct:!1,isIncome:!1,isExpense:!0,isGroup:!1,isPaymentForm:!1,isAccountPayableConcept:!1},payable:{isProduct:!1,isIncome:!1,isExpense:!0,isGroup:!1,isPaymentForm:!1,isAccountPayableConcept:!0},groups:{isProduct:!1,isIncome:!1,isExpense:!1,isGroup:!0,isPaymentForm:!1,isAccountPayableConcept:!1}},DT={name:"",parentConceptId:"",taxPercentage:0,price:0,additionalCharges:0,groupType:"income"};function nn({moduleType:t,titleKey:e,basePath:n,embedded:s=!1,onCancel:r,onCreated:a}){const{t:l}=Ee(),{account:u,user:d}=Oe(),f=Ht(),{id:m}=zn(),g=!s&&!!m,[y,x]=j.useState(DT),[_,k]=j.useState(!1),[b,S]=j.useState(g),[I,C]=j.useState(""),[T,A]=j.useState([]),[z,E]=j.useState("");j.useEffect(()=>{u?.accountId&&D()},[u?.accountId]),j.useEffect(()=>{!g||!u?.accountId||M()},[g,m,u?.accountId]);const D=async()=>{try{const H=await Ih(u.accountId,"groups");A(H)}catch{A([])}},M=async()=>{try{S(!0);const H=await AT(m);x({name:H.name,parentConceptId:H.parentConceptId?String(H.parentConceptId):"",taxPercentage:H.taxPercentage??0,price:H.price??0,additionalCharges:H.additionalCharges??0,groupType:H.isExpense?"expense":"income"});const J=H.parentConceptId?T.find(Y=>Y.id===Number(H.parentConceptId)):null;E(J?.name||"")}catch{C(l("common.genericLoadError"))}finally{S(!1)}},N=H=>{const{name:J,value:Y}=H.target;x(X=>({...X,[J]:Y}))},F=async H=>{if(H.preventDefault(),C(""),!H.currentTarget.checkValidity()){H.currentTarget.reportValidity(),C(l("common.requiredFields"));return}if(!u?.accountId||!d?.id){C(l("common.requiredFields"));return}if(["income","expense","payable"].includes(t)&&!y.parentConceptId){C(l("common.requiredFields"));return}const J={accountId:u.accountId,name:y.name.trim(),parentConceptId:t==="groups"?null:y.parentConceptId?Number(y.parentConceptId):null,taxPercentage:t==="products"&&Number(y.taxPercentage)||0,price:Number(y.price)||0,additionalCharges:Number(y.additionalCharges)||0,...LT[t]};t==="groups"&&(J.isIncome=y.groupType==="income",J.isExpense=y.groupType==="expense");try{k(!0);let Y=null;if(g?Y=await RT(m,J):Y=await OT({...J,createdById:d.id}),s){a?.(Y);return}f(n)}catch{C(l("common.genericSaveError"))}finally{k(!1)}};return c.jsxs("div",{className:s?"":"module-page",children:[s?c.jsx("h3",{children:l(g?"common.edit":e)}):c.jsxs("div",{className:"page-header-row",children:[c.jsx("h1",{children:l(g?"common.edit":e)}),c.jsx(st,{to:n,className:"button-link-secondary",children:l("common.backToList")})]}),I&&c.jsx("p",{className:"error-text",children:I}),b?c.jsx("p",{children:l("common.loading")}):c.jsxs("form",{className:"crud-form",onSubmit:F,children:[c.jsxs("div",{className:"form-grid-2",children:[c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:l("common.name")}),c.jsx("input",{name:"name",placeholder:l("common.name"),value:y.name,onChange:N,required:!0})]}),t!=="groups"?["income","expense","payable"].includes(t)?c.jsx(ts,{label:l("concepts.group"),value:z,onValueChange:E,options:T,getOptionLabel:H=>H.name||"",onSelect:H=>{x(J=>({...J,parentConceptId:String(H.id)})),E("")},placeholder:`-- ${l("concepts.group")} --`,noResultsText:l("common.empty"),selectedPillText:T.find(H=>H.id===Number(y.parentConceptId))?.name||"",onClearSelection:()=>{x(H=>({...H,parentConceptId:""})),E("")},renderCreateModal:({isOpen:H,onClose:J,onCreated:Y})=>H?c.jsx("div",{className:"modal-backdrop",onClick:J,children:c.jsx("div",{className:"modal-card",onClick:X=>X.stopPropagation(),children:c.jsx(nn,{embedded:!0,moduleType:"groups",titleKey:"actions.newConceptGroup",basePath:"/concept-groups",onCancel:J,onCreated:Y})})}):null,onCreateRecord:async H=>{const J=await Ih(u.accountId,"groups");A(J),x(Y=>({...Y,parentConceptId:String(H.id)})),E("")}}):c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:l("concepts.group")}),c.jsxs("select",{name:"parentConceptId",value:y.parentConceptId,onChange:N,children:[c.jsx("option",{value:"",children:`-- ${l("concepts.noGroup")} --`}),T.map(H=>c.jsx("option",{value:H.id,children:H.name},H.id))]})]}):c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:l("concepts.groupType")}),c.jsxs("select",{name:"groupType",value:y.groupType,onChange:N,children:[c.jsx("option",{value:"income",children:l("concepts.groupTypeIncome")}),c.jsx("option",{value:"expense",children:l("concepts.groupTypeExpense")})]})]}),t==="products"?c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:l("concepts.taxPercentage")}),c.jsx("input",{name:"taxPercentage",type:"number",min:"0",step:"0.01",placeholder:l("concepts.taxPercentage"),value:y.taxPercentage,onChange:N,required:!0})]}):null,t==="products"&&c.jsxs(c.Fragment,{children:[c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:l("transactions.price")}),c.jsx("input",{name:"price",type:"number",min:"0",step:"0.01",placeholder:l("transactions.price"),value:y.price,onChange:N,required:!0})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:l("transactions.additionalCharges")}),c.jsx("input",{name:"additionalCharges",type:"number",min:"0",step:"0.01",placeholder:l("transactions.additionalCharges"),value:y.additionalCharges,onChange:N,required:!0})]})]})]}),c.jsxs("div",{className:"crud-form-actions",children:[s?c.jsx("button",{type:"button",className:"button-secondary",onClick:()=>r?.(),children:l("common.cancel")}):null,c.jsx("button",{type:"submit",disabled:_,children:l(g?"common.update":"common.create")})]})]})]})}const Vd=10;function Pa({moduleType:t,titleKey:e,basePath:n}){const{t:s}=Ee(),{account:r}=Oe(),[a,l]=j.useState([]),[u,d]=j.useState(""),[f,m]=j.useState(!0),[g,y]=j.useState(1),[x,_]=is(),k=x.get("create")==="1";j.useEffect(()=>{r?.accountId&&S()},[r?.accountId,t]);const b=j.useMemo(()=>{const C=(g-1)*Vd;return a.slice(C,C+Vd)},[a,g]),S=async()=>{try{m(!0);const C=await Ih(r.accountId,t);l(C),d(""),y(1)}catch{d(s("common.genericLoadError"))}finally{m(!1)}},I=async C=>{try{await MT(C),await S()}catch{d(s("common.genericSaveError"))}};return c.jsxs("div",{className:"module-page",children:[c.jsx("h1",{children:s(e)}),u&&c.jsx("p",{className:"error-text",children:u}),f?c.jsx("p",{children:s("common.loading")}):a.length===0?c.jsx("p",{children:s("common.empty")}):c.jsxs(c.Fragment,{children:[c.jsxs("table",{className:"crud-table",children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:s("common.name")}),c.jsx("th",{children:s("concepts.group")}),c.jsx("th",{children:s("concepts.taxPercentage")}),t==="products"&&c.jsx("th",{children:s("transactions.price")}),t==="products"&&c.jsx("th",{children:s("transactions.additionalCharges")}),c.jsx("th",{children:s("common.actions")})]})}),c.jsx("tbody",{children:b.map(C=>c.jsxs("tr",{children:[c.jsx("td",{children:C.name}),c.jsx("td",{children:C.parentConceptId??"-"}),c.jsx("td",{children:C.taxPercentage}),t==="products"&&c.jsx("td",{children:Number(C.price||0).toFixed(2)}),t==="products"&&c.jsx("td",{children:Number(C.additionalCharges||0).toFixed(2)}),c.jsx("td",{className:"table-actions",children:c.jsx(kn,{actions:[...C.isSystem?[]:[{key:"edit",label:s("common.edit"),to:`${n}/${C.id}/edit`}],...C.isSystem?[]:[{key:"delete",label:s("common.delete"),onClick:()=>I(C.id),danger:!0}]]})})]},C.id))})]}),c.jsx(Un,{page:g,pageSize:Vd,totalItems:a.length,onPageChange:y})]}),k?c.jsx("div",{className:"modal-backdrop",onClick:()=>{const C=new URLSearchParams(x);C.delete("create"),_(C)},children:c.jsx("div",{className:"modal-card",onClick:C=>C.stopPropagation(),children:c.jsx(nn,{embedded:!0,moduleType:t,titleKey:t==="products"?"actions.newProduct":t==="income"?"actions.newIncomeConcept":t==="expense"?"actions.newExpenseConcept":t==="payable"?"actions.newPayableConcept":"actions.newConceptGroup",basePath:n,onCancel:()=>{const C=new URLSearchParams(x);C.delete("create"),_(C)},onCreated:async()=>{await S();const C=new URLSearchParams(x);C.delete("create"),_(C)}})})}):null]})}const Ic='id, "accountId", name, kind, provider, reference, "employeeId", "createInternalPayableOnOutgoingPayment", "isActive"';async function ur(t){const{data:e,error:n}=await G.from("account_payment_forms").select(Ic).eq("accountId",t).eq("isActive",!0).order("id",{ascending:!1});if(n)throw n;return e??[]}async function FT(t){const{data:e,error:n}=await G.from("account_payment_forms").select(Ic).eq("id",t).single();if(n)throw n;return e}async function BT(t){const{data:e,error:n}=await G.from("account_payment_forms").insert(t).select(Ic).single();if(n)throw n;return e}async function $T(t,e){const{data:n,error:s}=await G.from("account_payment_forms").update(e).eq("id",t).select(Ic).single();if(s)throw s;return n}async function zT(t){const{error:e}=await G.from("account_payment_forms").update({isActive:!1}).eq("id",t);if(e)throw e}async function so(t){const{data:e,error:n}=await G.from("payment_methods").select('id, "accountId", code, name, is_active').eq("accountId",t).eq("is_active",!0).order("id");if(n)throw n;return e??[]}async function UT(t){const{data:e,error:n}=await G.from("payment_methods").insert(t).select('id, "accountId", code, name, is_active').single();if(n)throw n;return e}const Nt={sale:1,expense:2,income:3,purchase:4,outgoingPayment:5,incomingPayment:6};async function WT({accountId:t,type:e,excludeInternalObligations:n=!1}){let s=G.from("transactions").select('id, personId, date, type, status, total, balance, payments, name, currencyId, "projectId", "referenceNumber", "paymentMethodId", "accountPaymentFormId", "isReconciled", "reconciledAt", "isInternalObligation", "sourceTransactionId", "isInternalTransfer", "isDeposit", isActive, persons(name), projects(name), account_payment_forms(name)').eq("accountId",t).eq("type",e);n&&(s=s.eq("isInternalObligation",!1));const{data:r,error:a}=await s.order("id",{ascending:!1});if(a)throw a;return r??[]}async function VT(t=[]){const e=(t||[]).map(a=>Number(a)).filter(a=>Number.isFinite(a)&&a>0);if(e.length===0)return{};const{data:n,error:s}=await G.from("transactionDetails").select("id, transactionId, concepts(name)").in("transactionId",e).order("id",{ascending:!0});if(s)throw s;const r={};for(const a of n??[]){const l=Number(a.transactionId);!l||r[l]||(r[l]=a.concepts?.name??null)}return r}async function qT({accountId:t,projectId:e,dateFrom:n,dateTo:s}){let r=G.from("transactions").select('id, date, type, total, balance, name, personId, "projectId", isActive, persons(name), projects(name)').eq("accountId",t).eq("projectId",e).eq("isActive",!0);n&&(r=r.gte("date",n)),s&&(r=r.lte("date",s));const{data:a,error:l}=await r.order("date",{ascending:!1});if(l)throw l;return a??[]}async function hv({transaction:t,details:e}){const{data:n,error:s}=await G.from("transactions").insert(t).select("id").single();if(s)throw s;const r=e.map(l=>({...l,transactionId:n.id})),{error:a}=await G.from("transactionDetails").insert(r);if(a)throw await G.from("transactions").delete().eq("id",n.id),a;return n}async function Yx(t){const{error:e}=await G.from("transactions").update({isActive:!1}).eq("id",t);if(e)throw e}async function Jx(t){const{data:e,error:n}=await G.from("transactions").select('id, accountId, personId, date, type, name, total, balance, payments, "projectId", "referenceNumber", "paymentMethodId", "accountPaymentFormId", "isReconciled", "reconciledAt", "isInternalObligation", "sourceTransactionId", "isInternalTransfer", "isDeposit", isActive, currencyId, persons(name), projects(name), account_payment_forms(name)').eq("id",t).single();if(n)throw n;return e}async function HT(t){const{data:e,error:n}=await G.from("transactionDetails").select("id, conceptId, quantity, price, net, taxPercentage, tax, discountPercentage, discount, total, additionalCharges, transactionPaidId, concepts(name)").eq("transactionId",t).order("id");if(n)throw n;return e??[]}async function KT(t){const{data:e,error:n}=await G.from("transactionDetails").select('id, total, transactionId, transactionPaidId, transactions!transaction_details_transactionId_fkey(id, date, type, name, "referenceNumber", paymentMethodId, accountPaymentFormId)').eq("transactionPaidId",t).order("id",{ascending:!1});if(n)throw n;return(e??[]).map(s=>({...s,transactions:s.transactions??null}))}async function GT({paidTransaction:t,paymentTransaction:e,paymentDetail:n}){const{data:s,error:r}=await G.from("transactions").select("id, total, balance, payments").eq("id",t.id).single();if(r)throw r;const a=Number(e.total||0);if(a<=0||a>Number(s.balance||0))throw new Error("Payment amount exceeds current balance.");const{data:l,error:u}=await G.from("transactions").insert(e).select("id").single();if(u)throw u;const{error:d}=await G.from("transactionDetails").insert({...n,transactionId:l.id,transactionPaidId:t.id});if(d)throw await G.from("transactions").delete().eq("id",l.id),d;const f=Number(s.payments||0),m=Number(e.total||0),g=f+m,y=Math.max(Number(s.total||0)-g,0),{error:x}=await G.from("transactions").update({payments:g,balance:y}).eq("id",t.id);if(x)throw x;return l}async function YT({accountId:t,accountPaymentFormId:e}){const{data:n,error:s}=await G.from("transactions").select('id, date, type, total, isIncomingPayment, isOutcomingPayment, "accountPaymentFormId", "isReconciled", "reconciledAt", "referenceNumber", "isInternalObligation", "sourceTransactionId", "isInternalTransfer", "isDeposit", isActive, name').eq("accountId",t).eq("accountPaymentFormId",e).eq("isActive",!0).order("date",{ascending:!1});if(s)throw s;return n??[]}async function JT(t,e){const{error:n}=await G.from("transactions").update({isReconciled:!0,reconciledAt:e}).eq("id",t);if(n)throw n}async function XT(t){const{error:e}=await G.from("transactions").update({isReconciled:!1,reconciledAt:null}).eq("id",t);if(e)throw e}async function QT(t){const{data:e,error:n}=await G.from("transactions").select('id, date, name, total, payments, balance, currencyId, "referenceNumber", "accountPaymentFormId", "sourceTransactionId", isActive, account_payment_forms(name)').eq("accountId",t).eq("isInternalObligation",!0).eq("isActive",!0).order("id",{ascending:!1});if(n)throw n;return e??[]}async function ZT({accountId:t,userId:e,date:n,name:s,referenceNumber:r,currencyId:a,accountPaymentFormId:l,total:u}){const d=Math.abs(Number(u||0)),f={accountId:t,personId:null,date:n,type:Nt.purchase,name:s?.trim()||"Obligacin interna",referenceNumber:r?.trim()||null,deliverTo:null,deliveryAddress:null,status:1,createdById:e,net:d,discounts:0,taxes:0,additionalCharges:0,total:d,isAccountPayable:!0,isAccountReceivable:!1,isIncomingPayment:!1,isOutcomingPayment:!1,balance:d,payments:0,isActive:!0,currencyId:Number(a),paymentMethodId:null,accountPaymentFormId:l?Number(l):null,isInternalObligation:!0,sourceTransactionId:null,isInternalTransfer:!1,isDeposit:!1},{data:m,error:g}=await G.from("transactions").insert(f).select("id").single();if(g)throw g;return m}async function eN(t,{date:e,name:n,referenceNumber:s,currencyId:r,accountPaymentFormId:a,total:l}){const{data:u,error:d}=await G.from("transactions").select("id, payments").eq("id",t).single();if(d)throw d;const f=Math.abs(Number(u.payments||0)),m=Math.abs(Number(l||0));if(m<f)throw new Error("Total cannot be lower than already registered payments.");const g={date:e,name:n?.trim()||"Obligacin interna",referenceNumber:s?.trim()||null,currencyId:Number(r),accountPaymentFormId:a?Number(a):null,net:m,total:m,payments:f,balance:Math.max(m-f,0)},{data:y,error:x}=await G.from("transactions").update(g).eq("id",t).select("id").single();if(x)throw x;return y}async function tN(t,{dateFrom:e,dateTo:n,currencyId:s}={}){let r=G.from("transactions").select("id, date, name, total, balance, currencyId").eq("accountId",t).eq("isInternalObligation",!0).eq("isActive",!0);e&&(r=r.gte("date",e)),n&&(r=r.lte("date",n)),s&&(r=r.eq("currencyId",s));const{data:a,error:l}=await r.order("date",{ascending:!1});if(l)throw l;return a??[]}async function nN({accountId:t,userId:e,date:n,amount:s,currencyId:r,referenceNumber:a,description:l,cashPaymentMethodId:u,transferPaymentMethodId:d,fromCashFormId:f,toBankFormId:m,outgoingConceptId:g,incomingConceptId:y}){const x=Math.abs(Number(s||0));if(!x)throw new Error("Invalid amount");const _=l?.trim()||"Depsito bancario",k={accountId:t,personId:null,date:n,deliverTo:null,deliveryAddress:null,status:1,createdById:e,net:x,discounts:0,taxes:0,additionalCharges:0,total:x,isAccountPayable:!1,isAccountReceivable:!1,balance:0,payments:x,isActive:!0,currencyId:Number(r),referenceNumber:a?.trim()||null,isInternalObligation:!1,sourceTransactionId:null,isInternalTransfer:!0,isDeposit:!0},b={...k,type:Nt.outgoingPayment,name:`${_} (salida)`,isIncomingPayment:!1,isOutcomingPayment:!0,paymentMethodId:Number(u),accountPaymentFormId:Number(f)},{data:S,error:I}=await G.from("transactions").insert(b).select("id").single();if(I)throw I;const C={...k,type:Nt.incomingPayment,name:`${_} (entrada)`,isIncomingPayment:!0,isOutcomingPayment:!1,paymentMethodId:Number(d),accountPaymentFormId:Number(m),sourceTransactionId:S.id},{data:T,error:A}=await G.from("transactions").insert(C).select("id").single();if(A)throw await G.from("transactions").delete().eq("id",S.id),A;const z=[{transactionId:S.id,conceptId:Number(g),quantity:1,price:x,net:x,taxPercentage:0,tax:0,discountPercentage:0,discount:0,total:x,additionalCharges:0,createdById:e,sellerId:null,transactionPaidId:null},{transactionId:T.id,conceptId:Number(y),quantity:1,price:x,net:x,taxPercentage:0,tax:0,discountPercentage:0,discount:0,total:x,additionalCharges:0,createdById:e,sellerId:null,transactionPaidId:null}],{error:E}=await G.from("transactionDetails").insert(z);if(E)throw await G.from("transactions").delete().in("id",[S.id,T.id]),E}async function sN({accountId:t,userId:e,date:n,amount:s,currencyId:r,referenceNumber:a,description:l,transferPaymentMethodId:u,fromBankFormId:d,toBankFormId:f,fromBankLabel:m,toBankLabel:g,outgoingConceptId:y,incomingConceptId:x}){const _=Math.abs(Number(s||0));if(!_)throw new Error("Invalid amount");if(Number(d)===Number(f))throw new Error("Source and destination must be different.");const k=l?.trim()||"Traslado entre cuentas",b={accountId:t,personId:null,date:n,referenceNumber:a?.trim()||null,status:1,createdById:e,net:0,discounts:0,taxes:0,additionalCharges:0,total:0,isAccountPayable:!1,isAccountReceivable:!1,isIncomingPayment:!1,isOutcomingPayment:!1,balance:0,payments:0,isActive:!0,currencyId:Number(r),paymentMethodId:Number(u),isInternalObligation:!1,isInternalTransfer:!0,isDeposit:!1,isReconciled:!0,reconciledAt:n},S={...b,type:Nt.outgoingPayment,name:`${k} (salida)`,deliverTo:m||null,deliveryAddress:g||null,net:-_,total:-_,isOutcomingPayment:!0,payments:-_,accountPaymentFormId:Number(d),sourceTransactionId:null},{data:I,error:C}=await G.from("transactions").insert(S).select("id").single();if(C)throw C;const T={...b,type:Nt.incomingPayment,name:`${k} (entrada)`,deliverTo:m||null,deliveryAddress:g||null,net:_,total:_,isIncomingPayment:!0,payments:_,accountPaymentFormId:Number(f),sourceTransactionId:I.id},{data:A,error:z}=await G.from("transactions").insert(T).select("id").single();if(z)throw await G.from("transactions").delete().eq("id",I.id),z;const E={transactionId:I.id,conceptId:Number(y),quantity:1,price:-_,net:-_,taxPercentage:0,tax:0,discountPercentage:0,discount:0,total:-_,additionalCharges:0,createdById:e,sellerId:null,transactionPaidId:null},D={transactionId:A.id,conceptId:Number(x),quantity:1,price:_,net:_,taxPercentage:0,tax:0,discountPercentage:0,discount:0,total:_,additionalCharges:0,createdById:e,sellerId:null,transactionPaidId:null},{error:M}=await G.from("transactionDetails").insert(E);if(M)throw await G.from("transactions").delete().in("id",[I.id,A.id]),M;const{error:N}=await G.from("transactionDetails").insert(D);if(N)throw await G.from("transactions").delete().in("id",[I.id,A.id]),N}async function rN(t){const{data:e,error:n}=await G.from("transactions").select('id, date, name, total, "referenceNumber", "sourceTransactionId", "accountPaymentFormId", isActive, account_payment_forms(name)').eq("accountId",t).eq("isDeposit",!0).eq("isIncomingPayment",!0).eq("isActive",!0).order("id",{ascending:!1});if(n)throw n;return e??[]}async function iN(t){const{data:e,error:n}=await G.from("transactions").select('id, "sourceTransactionId"').eq("id",t).single();if(n)throw n;const s=[e.id];e.sourceTransactionId&&s.push(e.sourceTransactionId);const{error:r}=await G.from("transactions").update({isActive:!1}).in("id",s);if(r)throw r}async function aN(t){const{data:e,error:n}=await G.from("transactions").select('id, date, name, total, "referenceNumber", "sourceTransactionId", deliverTo, "deliveryAddress", isActive, account_payment_forms(name)').eq("accountId",t).eq("isInternalTransfer",!0).eq("isDeposit",!1).eq("isIncomingPayment",!0).eq("isActive",!0).order("id",{ascending:!1});if(n)throw n;return e??[]}async function oN(t){const{data:e,error:n}=await G.from("transactions").select('id, "sourceTransactionId"').eq("id",t).single();if(n)throw n;const s=[e.id];e.sourceTransactionId&&s.push(e.sourceTransactionId);const{error:r}=await G.from("transactions").update({isActive:!1}).in("id",s);if(r)throw r}function pn(t){const e=String(t?.name||"").trim(),n=String(t?.provider||"").trim();return n?`${e} - ${n}`:e}const lN={date:new Date().toISOString().slice(0,10),amount:0,description:"",referenceNumber:"",paymentMethodId:"",accountPaymentFormId:""};function Xx({isOpen:t,onClose:e,transaction:n,direction:s,onSaved:r}){const{t:a}=Ee(),{account:l,user:u}=Oe(),[d,f]=j.useState(lN),[m,g]=j.useState([]),[y,x]=j.useState([]),[_,k]=j.useState([]),[b,S]=j.useState(""),[I,C]=j.useState(!1),T=j.useMemo(()=>m.find(N=>N.id===Number(d.paymentMethodId))??null,[m,d.paymentMethodId]),A=T?.code==="card"||T?.code==="bank_transfer",z=j.useMemo(()=>T?T.code==="card"?y.filter(N=>N.kind==="credit_card"):T.code==="bank_transfer"?y.filter(N=>N.kind==="bank_account"):T.code==="cash"?y.filter(N=>N.kind==="cashbox"):y:y,[y,T]);j.useEffect(()=>{!t||!l?.accountId||(E(),f(N=>({...N,amount:Number(n?.balance||0)})))},[t,l?.accountId,n?.id]);const E=async()=>{try{const[N,F,H]=await Promise.all([so(l.accountId),ur(l.accountId),Ri(l.accountId)]);g(N),x(F),k(H),S("")}catch{S(a("common.genericLoadError"))}};if(!t||!n)return null;const D=N=>{const{name:F,value:H}=N.target;if(F==="paymentMethodId"){f(J=>({...J,paymentMethodId:H,accountPaymentFormId:""}));return}f(J=>({...J,[F]:H}))},M=async N=>{if(N.preventDefault(),S(""),!N.currentTarget.checkValidity()){N.currentTarget.reportValidity(),S(a("common.requiredFields"));return}if(!l?.accountId||!u?.id)return;if(!d.paymentMethodId){S(a("transactions.paymentMethodRequired"));return}if(A&&!d.accountPaymentFormId){S(a("transactions.accountPaymentFormRequired"));return}const F=Number(d.amount||0);if(F<=0||F>Number(n.balance||0)){S(a("transactions.invalidPaymentAmount"));return}const H=_.find(X=>s==="incoming"?X.isIncomingPaymentConcept:X.isOutgoingPaymentConcept);if(!H){S(a("transactions.missingSystemPaymentConcept"));return}const J={accountId:l.accountId,personId:n.personId,date:d.date,type:s==="incoming"?Nt.incomingPayment:Nt.outgoingPayment,name:d.description?.trim()||null,referenceNumber:d.referenceNumber?.trim()||null,deliverTo:null,deliveryAddress:null,status:1,createdById:u.id,net:F,discounts:0,taxes:0,additionalCharges:0,total:F,isAccountPayable:!1,isAccountReceivable:!1,isIncomingPayment:s==="incoming",isOutcomingPayment:s==="outgoing",balance:0,payments:F,isActive:!0,currencyId:n.currencyId??null,paymentMethodId:Number(d.paymentMethodId),accountPaymentFormId:d.accountPaymentFormId?Number(d.accountPaymentFormId):null},Y={conceptId:H.id,quantity:1,price:F,net:F,taxPercentage:0,tax:0,discountPercentage:0,discount:0,total:F,additionalCharges:0,createdById:u.id,sellerId:null};try{C(!0),await GT({paidTransaction:n,paymentTransaction:J,paymentDetail:Y}),r?.(),e?.()}catch(X){S(X?.message||a("common.genericSaveError"))}finally{C(!1)}};return c.jsx("div",{className:"modal-backdrop",onClick:e,children:c.jsxs("div",{className:"modal-card",onClick:N=>N.stopPropagation(),children:[c.jsx("h3",{children:a(s==="incoming"?"transactions.newIncomingPayment":"transactions.newOutgoingPayment")}),b&&c.jsx("p",{className:"error-text",children:b}),c.jsxs("form",{className:"crud-form",onSubmit:M,children:[c.jsxs("div",{className:"form-grid-2",children:[c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:a("transactions.date")}),c.jsx("input",{type:"date",name:"date",value:d.date,onChange:D,required:!0})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:a("transactions.amount")}),c.jsx("input",{type:"number",min:"0",step:"0.01",name:"amount",value:d.amount,onChange:D,required:!0})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:a("transactions.paymentMethod")}),c.jsxs("select",{name:"paymentMethodId",value:d.paymentMethodId,onChange:D,required:!0,children:[c.jsx("option",{value:"",children:`-- ${a("transactions.selectPaymentMethod")} --`}),m.map(N=>c.jsx("option",{value:N.id,children:N.name},N.id))]})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:a("transactions.accountPaymentForm")}),c.jsxs("select",{name:"accountPaymentFormId",value:d.accountPaymentFormId,onChange:D,required:A,children:[c.jsx("option",{value:"",children:`-- ${a("transactions.selectAccountPaymentForm")} --`}),z.map(N=>c.jsx("option",{value:N.id,children:pn(N)},N.id))]})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:a("transactions.referenceNumber")}),c.jsx("input",{name:"referenceNumber",value:d.referenceNumber,onChange:D})]}),c.jsxs("label",{className:"field-block form-span-2",children:[c.jsx("span",{children:a("transactions.description")}),c.jsx("input",{name:"description",value:d.description,onChange:D})]})]}),c.jsxs("div",{className:"crud-form-actions",children:[c.jsx("button",{type:"button",className:"button-secondary",onClick:e,children:a("common.cancel")}),c.jsx("button",{type:"submit",disabled:I,children:a("common.create")})]})]})]})})}const cN={name:"",kind:"bank_account",provider:"",reference:"",employeeId:"",createInternalPayableOnOutgoingPayment:!1};function dc({embedded:t=!1,onCancel:e,onCreated:n}){const{t:s}=Ee(),{account:r,user:a}=Oe(),l=Ht(),{id:u}=zn(),d=!t&&!!u,[f,m]=j.useState(cN),[g,y]=j.useState(""),[x,_]=j.useState(d),[k,b]=j.useState(!1),[S,I]=j.useState([]);j.useEffect(()=>{r?.accountId&&C()},[r?.accountId]),j.useEffect(()=>{!d||!r?.accountId||T()},[d,u,r?.accountId]);const C=async()=>{try{const E=await cc(r.accountId);I(E)}catch{I([])}},T=async()=>{try{_(!0);const E=await FT(u);m({name:E.name||"",kind:E.kind||"bank_account",provider:E.provider||"",reference:E.reference||"",employeeId:E.employeeId?String(E.employeeId):"",createInternalPayableOnOutgoingPayment:!!E.createInternalPayableOnOutgoingPayment})}catch{y(s("common.genericLoadError"))}finally{_(!1)}},A=E=>{const{name:D,value:M}=E.target;if(D==="createInternalPayableOnOutgoingPayment"){m(N=>({...N,createInternalPayableOnOutgoingPayment:E.target.checked}));return}m(N=>({...N,[D]:M}))},z=async E=>{if(E.preventDefault(),y(""),!E.currentTarget.checkValidity()){E.currentTarget.reportValidity(),y(s("common.requiredFields"));return}if(!r?.accountId||!a?.id){y(s("common.requiredFields"));return}const D={accountId:r.accountId,name:f.name.trim(),kind:f.kind,provider:f.provider.trim()||null,reference:f.reference.trim()||null,createInternalPayableOnOutgoingPayment:!!f.createInternalPayableOnOutgoingPayment};f.employeeId&&(D.employeeId=Number(f.employeeId));try{b(!0);let M=null;if(d?M=await $T(u,D):M=await BT({...D,createdById:a.id}),t){n?.(M);return}l("/payment-forms")}catch{y(s("common.genericSaveError"))}finally{b(!1)}};return c.jsxs("div",{className:t?"":"module-page",children:[t?c.jsx("h3",{children:s(d?"common.edit":"actions.newPaymentForm")}):c.jsxs("div",{className:"page-header-row",children:[c.jsx("h1",{children:s(d?"common.edit":"actions.newPaymentForm")}),c.jsx(st,{to:"/payment-forms",className:"button-link-secondary",children:s("common.backToList")})]}),g&&c.jsx("p",{className:"error-text",children:g}),x?c.jsx("p",{children:s("common.loading")}):c.jsxs("form",{className:"crud-form",onSubmit:z,children:[c.jsxs("div",{className:"form-grid-2",children:[c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:s("common.name")}),c.jsx("input",{name:"name",value:f.name,onChange:A,required:!0})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:s("paymentForms.kind")}),c.jsxs("select",{name:"kind",value:f.kind,onChange:A,required:!0,children:[c.jsx("option",{value:"bank_account",children:s("paymentForms.kinds.bank_account")}),c.jsx("option",{value:"credit_card",children:s("paymentForms.kinds.credit_card")}),c.jsx("option",{value:"cashbox",children:s("paymentForms.kinds.cashbox")})]})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:s("paymentForms.provider")}),c.jsx("input",{name:"provider",value:f.provider,onChange:A})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:s("paymentForms.reference")}),c.jsx("input",{name:"reference",value:f.reference,onChange:A})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:s("paymentForms.employee")}),c.jsxs("select",{name:"employeeId",value:f.employeeId,onChange:A,children:[c.jsx("option",{value:"",children:`-- ${s("transactions.optionalSeller")} --`}),S.map(E=>c.jsx("option",{value:E.id,children:E.name},E.id))]})]}),c.jsxs("label",{className:"checkbox-field form-span-2",children:[c.jsx("input",{type:"checkbox",name:"createInternalPayableOnOutgoingPayment",checked:f.createInternalPayableOnOutgoingPayment,onChange:A}),c.jsx("span",{children:s("paymentForms.createInternalPayableOnOutgoingPayment")})]})]}),c.jsxs("div",{className:"crud-form-actions",children:[t?c.jsx("button",{type:"button",className:"button-secondary",onClick:()=>e?.(),children:s("common.cancel")}):null,c.jsx("button",{type:"submit",disabled:k,children:s(d?"common.update":"common.create")})]})]})]})}const Ec='id, name, description, "startDate", "endDate", "isActive"';async function ro(t,{activeOnly:e=!0}={}){let n=G.from("projects").select(Ec).eq("accountId",t);e&&(n=n.eq("isActive",!0));const{data:s,error:r}=await n.order("id",{ascending:!1});if(r)throw r;return s??[]}async function Qx(t){const{data:e,error:n}=await G.from("projects").select(Ec).eq("id",t).single();if(n)throw n;return e}async function uN(t){const{data:e,error:n}=await G.from("projects").insert(t).select(Ec).single();if(n)throw n;return e}async function dN(t,e){const{data:n,error:s}=await G.from("projects").update(e).eq("id",t).select(Ec).single();if(s)throw s;return n}async function hN(t){const{error:e}=await G.from("projects").update({isActive:!1}).eq("id",t);if(e)throw e}const fN={name:"",description:"",startDate:"",endDate:""};function io({embedded:t=!1,onCancel:e,onCreated:n}){const{t:s}=Ee(),{account:r,user:a}=Oe(),l=Ht(),{id:u}=zn(),d=!t&&!!u,[f,m]=j.useState(fN),[g,y]=j.useState(!1),[x,_]=j.useState(d),[k,b]=j.useState("");j.useEffect(()=>{d&&S()},[d,u]);const S=async()=>{try{_(!0);const T=await Qx(u);m({name:T.name||"",description:T.description||"",startDate:T.startDate||"",endDate:T.endDate||""})}catch{b(s("common.genericLoadError"))}finally{_(!1)}},I=T=>{const{name:A,value:z}=T.target;m(E=>({...E,[A]:z}))},C=async T=>{if(T.preventDefault(),b(""),!T.currentTarget.checkValidity()){T.currentTarget.reportValidity(),b(s("common.requiredFields"));return}if(!r?.accountId||!a?.id){b(s("common.requiredFields"));return}const A={accountId:r.accountId,name:f.name.trim(),description:f.description.trim()||null,startDate:f.startDate||null,endDate:f.endDate||null,isActive:!0};try{y(!0);let z=null;if(d?z=await dN(u,A):z=await uN({...A,createdById:a.id}),t){n?.(z);return}l("/projects")}catch{b(s("common.genericSaveError"))}finally{y(!1)}};return c.jsxs("div",{className:t?"":"module-page",children:[t?c.jsx("h3",{children:s(d?"common.edit":"actions.newProject")}):c.jsxs("div",{className:"page-header-row",children:[c.jsx("h1",{children:s(d?"common.edit":"actions.newProject")}),c.jsx(st,{to:"/projects",className:"button-link-secondary",children:s("common.backToList")})]}),k&&c.jsx("p",{className:"error-text",children:k}),x?c.jsx("p",{children:s("common.loading")}):c.jsxs("form",{className:"crud-form",onSubmit:C,children:[c.jsxs("div",{className:"form-grid-2",children:[c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:s("common.name")}),c.jsx("input",{name:"name",value:f.name,onChange:I,required:!0})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:s("transactions.description")}),c.jsx("input",{name:"description",value:f.description,onChange:I})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:s("projects.startDate")}),c.jsx("input",{type:"date",name:"startDate",value:f.startDate,onChange:I})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:s("projects.endDate")}),c.jsx("input",{type:"date",name:"endDate",value:f.endDate,onChange:I})]})]}),c.jsxs("div",{className:"crud-form-actions",children:[t?c.jsx("button",{type:"button",className:"button-secondary",onClick:()=>e?.(),children:s("common.cancel")}):null,c.jsx("button",{type:"submit",disabled:g,children:s(d?"common.update":"common.create")})]})]})]})}async function ho(t){const{data:e,error:n}=await G.from("currencies").select("id, name, symbol, isLocal").or(`accountId.eq.${t},accountId.is.null`).order("isLocal",{ascending:!1}).order("name",{ascending:!0});if(n)throw n;return e??[]}const pN={sale:{type:Nt.sale,titleKey:"transactions.salesCreateTitle",personFilter:1,conceptFilter:t=>!!t.isProduct,backPath:"/sales"},purchase:{type:Nt.purchase,titleKey:"transactions.purchasesCreateTitle",personFilter:2,conceptFilter:t=>!!t.isAccountPayableConcept,backPath:"/purchases"},expense:{type:Nt.expense,titleKey:"transactions.expensesCreateTitle",personFilter:2,conceptFilter:t=>!!t.isExpense&&!t.isOutgoingPaymentConcept,backPath:"/expenses"},income:{type:Nt.income,titleKey:"transactions.incomesCreateTitle",personFilter:null,conceptFilter:t=>!!t.isIncome&&!t.isProduct&&!t.isIncomingPaymentConcept,backPath:"/incomes"}},mN={date:new Date().toISOString().slice(0,10),personId:"",conceptId:"",description:"",amount:0,additionalCharges:0,currencyId:"",referenceNumber:"",paymentMode:"cash",paymentMethodId:"",accountPaymentFormId:"",projectId:"",employeeId:""},gN={date:new Date().toISOString().slice(0,10),paymentMode:"cash",description:"",currencyId:"",referenceNumber:"",paymentMethodId:"",accountPaymentFormId:"",projectId:""};function Eh(t){const e=Number(t.quantity)||0,n=Number(t.price)||0,s=Number(t.taxPercentage)||0,r=Number(t.discountPercentage)||0,a=Number(t.additionalCharges)||0,l=e*n,u=l*(s/100),d=l*(r/100),f=l+u-d+a;return{net:l,tax:u,discount:d,total:f,quantity:e,price:n,taxPercentage:s,discountPercentage:r,additionalCharges:a}}function yN(t){return t.reduce((e,n)=>{const s=Eh(n);return e.net+=s.net,e.tax+=s.tax,e.discount+=s.discount,e.additionalCharges+=s.additionalCharges,e.total+=s.total,e},{net:0,tax:0,discount:0,additionalCharges:0,total:0})}function vN({t,accountId:e,onCancel:n,onCreated:s}){const[r,a]=j.useState(""),[l,u]=j.useState(!1),[d,f]=j.useState(""),m=async g=>{if(g.preventDefault(),f(""),!e||!r.trim()){f(t("common.requiredFields"));return}const x=`custom_${r.trim().toLowerCase().replace(/[^a-z0-9]+/g,"_").replace(/^_+|_+$/g,"")||"method"}_${Date.now()}`;try{u(!0);const _=await UT({accountId:e,code:x,name:r.trim(),is_active:!0,isSystem:!1});s?.(_)}catch{f(t("common.genericSaveError"))}finally{u(!1)}};return c.jsxs("form",{className:"crud-form",onSubmit:m,children:[c.jsx("h3",{children:t("transactions.paymentMethod")}),d?c.jsx("p",{className:"error-text",children:d}):null,c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:t("common.name")}),c.jsx("input",{value:r,onChange:g=>a(g.target.value),required:!0})]}),c.jsxs("div",{className:"crud-form-actions",children:[c.jsx("button",{type:"button",className:"button-secondary",onClick:n,children:t("common.cancel")}),c.jsx("button",{type:"submit",disabled:l,children:t("common.create")})]})]})}function Oa({moduleType:t,embedded:e=!1,onCancel:n,onCreated:s}){const{t:r}=Ee(),{account:a,user:l}=Oe(),u=Ht(),d=pN[t],[f,m]=j.useState([]),[g,y]=j.useState([]),[x,_]=j.useState([]),[k,b]=j.useState([]),[S,I]=j.useState([]),[C,T]=j.useState([]),[A,z]=j.useState([]),[E,D]=j.useState(mN),[M,N]=j.useState(gN),[F,H]=j.useState(""),[J,Y]=j.useState(""),[X,re]=j.useState(""),[pe,ee]=j.useState(""),[ce,ie]=j.useState(null),[U,B]=j.useState(""),[le,ae]=j.useState(""),[ge,we]=j.useState(""),[Le,Te]=j.useState(""),[De,mt]=j.useState(""),[Kt,mn]=j.useState([]),[as,Ue]=j.useState(""),[os,ls]=j.useState(!0),[Wn,Sn]=j.useState(!1),Ut=j.useMemo(()=>g.filter(d.conceptFilter),[g,d.conceptFilter]),At=j.useMemo(()=>d.personFilter?f.filter(R=>R.type===d.personFilter):f,[f,d.personFilter]),vt=j.useMemo(()=>S.find(R=>R.id===Number(E.paymentMethodId))??null,[S,E.paymentMethodId]),Ot=j.useMemo(()=>S.find(R=>R.id===Number(M.paymentMethodId))??null,[S,M.paymentMethodId]),jn=j.useMemo(()=>k.find(R=>R.isLocal)?.id??"",[k]),Gt=j.useMemo(()=>vt?vt.code==="card"?C.filter(R=>R.kind==="credit_card"):vt.code==="bank_transfer"?C.filter(R=>R.kind==="bank_account"):vt.code==="cash"?C.filter(R=>R.kind==="cashbox"):C:C,[C,vt]),Cn=j.useMemo(()=>Ot?Ot.code==="card"?C.filter(R=>R.kind==="credit_card"):Ot.code==="bank_transfer"?C.filter(R=>R.kind==="bank_account"):Ot.code==="cash"?C.filter(R=>R.kind==="cashbox"):C:C,[C,Ot]),Vn=j.useMemo(()=>{const R=t==="income"||t==="expense",ne=t==="purchase"&&E.paymentMode==="cash";return!R&&!ne?!1:vt?.code==="card"||vt?.code==="bank_transfer"},[t,E.paymentMode,vt]),qn=j.useMemo(()=>M.paymentMode!=="cash"?!1:Ot?.code==="card"||Ot?.code==="bank_transfer",[M.paymentMode,Ot]),Hn=j.useMemo(()=>yN(Kt),[Kt]);j.useEffect(()=>{a?.accountId&&fr()},[a?.accountId,d.type]),j.useEffect(()=>{jn&&(D(R=>({...R,currencyId:R.currencyId||String(jn)})),N(R=>({...R,currencyId:R.currencyId||String(jn)})))},[jn]);const fr=async()=>{try{ls(!0);const[R,ne,oe,je,Fe,dt,an]=await Promise.allSettled([uv(a.accountId),Ri(a.accountId),cc(a.accountId),ho(a.accountId),so(a.accountId),ur(a.accountId),ro(a.accountId)]);m(R.status==="fulfilled"?R.value:[]),y(ne.status==="fulfilled"?ne.value:[]),_(oe.status==="fulfilled"?oe.value:[]),b(je.status==="fulfilled"?je.value:[]),I(Fe.status==="fulfilled"?Fe.value:[]),T(dt.status==="fulfilled"?dt.value:[]),z(an.status==="fulfilled"?an.value:[]),Ue("")}catch{Ue(r("common.genericLoadError"))}finally{ls(!1)}},Kn=async R=>{try{const ne=await uv(a.accountId);m(ne),t==="sale"?(ie(R),B("")):D(oe=>({...oe,personId:String(R.id)}))}catch{Ue(r("common.genericLoadError"))}},Gn=async R=>{try{const ne=await Ri(a.accountId);y(ne),D(oe=>({...oe,conceptId:String(R.id),additionalCharges:R.additionalCharges??oe.additionalCharges})),t==="sale"&&As(R)}catch{Ue(r("common.genericLoadError"))}},Ns=async R=>{try{const ne=await ro(a.accountId);z(ne),t==="sale"?(N(oe=>({...oe,projectId:String(R.id)})),Te("")):(D(oe=>({...oe,projectId:String(R.id)})),ae(""))}catch{Ue(r("common.genericLoadError"))}},Hr=async R=>{try{const ne=await cc(a.accountId);_(ne),D(oe=>({...oe,employeeId:String(R.id)})),we("")}catch{Ue(r("common.genericLoadError"))}},He=R=>{const{name:ne,value:oe}=R.target;if(ne==="paymentMode"&&oe==="credit"){D(je=>({...je,paymentMode:oe,paymentMethodId:"",accountPaymentFormId:""}));return}if(ne==="conceptId"){const je=Ut.find(Fe=>Fe.id===Number(oe));D(Fe=>({...Fe,conceptId:oe,additionalCharges:je?.additionalCharges??Fe.additionalCharges}));return}if(ne==="paymentMethodId"){D(je=>({...je,paymentMethodId:oe,accountPaymentFormId:""}));return}D(je=>({...je,[ne]:oe}))},rn=R=>{const{name:ne,value:oe}=R.target;if(ne==="paymentMode"&&oe==="credit"){N(je=>({...je,paymentMode:oe,paymentMethodId:"",accountPaymentFormId:""}));return}if(ne==="paymentMethodId"){N(je=>({...je,paymentMethodId:oe,accountPaymentFormId:""}));return}N(je=>({...je,[ne]:oe}))},As=R=>{mn(ne=>[...ne,{rowId:`${R.id}-${Date.now()}-${Math.random()}`,conceptId:R.id,conceptName:R.name,quantity:1,price:Number(R.price)||0,taxPercentage:Number(R.taxPercentage)||0,discountPercentage:0,additionalCharges:Number(R.additionalCharges)||0,sellerId:""}]),mt("")},Wt=(R,ne,oe)=>{mn(je=>je.map(Fe=>Fe.rowId===R?{...Fe,[ne]:oe}:Fe))},W=R=>{mn(ne=>ne.filter(oe=>oe.rowId!==R))},Se=({isCredit:R,personId:ne,description:oe,date:je,totals:Fe,currencyId:dt,referenceNumber:an,paymentMethodId:cs,accountPaymentFormId:Pn,projectId:Os,employeeId:In,incomingPayment:Fi=!1})=>({accountId:a.accountId,personId:ne||null,date:je,type:d.type,name:oe?.trim()||null,referenceNumber:an?.trim()||null,deliverTo:null,deliveryAddress:null,status:1,createdById:l.id,net:Fe.net,discounts:Fe.discount,taxes:Fe.tax,additionalCharges:Fe.additionalCharges,total:Fe.total,isAccountPayable:t==="purchase"?R:!1,isAccountReceivable:t==="sale"?R:!1,isIncomingPayment:Fi,isOutcomingPayment:!1,balance:R?Fe.total:0,payments:R?0:Fe.total,isActive:!0,currencyId:dt?Number(dt):null,projectId:Os?Number(Os):null,employeeId:In?Number(In):null,paymentMethodId:cs?Number(cs):null,accountPaymentFormId:Pn?Number(Pn):null}),ze=async R=>{if(R.preventDefault(),Ue(""),!R.currentTarget.checkValidity()){R.currentTarget.reportValidity(),Ue(r("common.requiredFields"));return}if(!a?.accountId||!l?.id||!E.conceptId||!E.currencyId){Ue(r("common.requiredFields"));return}if(t==="purchase"&&!E.personId){Ue(r("transactions.providerRequired"));return}const ne=t==="purchase"&&E.paymentMode==="cash";if((t==="income"||t==="expense"||ne)&&!E.paymentMethodId){Ue(r("transactions.paymentMethodRequired"));return}if(Vn&&!E.accountPaymentFormId){Ue(r("transactions.accountPaymentFormRequired"));return}const je=Number(E.amount)||0,Fe=Number(E.additionalCharges)||0,dt=t==="expense";if(Math.abs(je)<=0){Ue(r("transactions.invalidTransactionAmount"));return}const an=dt?-Math.abs(je):je,cs=dt?-Math.abs(Fe):Fe,Pn=an+cs,Os=t==="purchase"?E.paymentMode==="credit":!1,In=t!=="purchase"||E.paymentMode==="cash",Fi=Se({isCredit:Os,personId:E.personId?Number(E.personId):null,description:E.description,date:E.date,totals:{net:an,tax:0,discount:0,additionalCharges:cs,total:Pn},currencyId:E.currencyId,referenceNumber:E.referenceNumber,paymentMethodId:In?E.paymentMethodId:null,accountPaymentFormId:In?E.accountPaymentFormId:null,projectId:E.projectId,employeeId:t==="income"||t==="expense"?E.employeeId:null,incomingPayment:t==="income"}),pr={conceptId:Number(E.conceptId),quantity:1,price:an,net:an,taxPercentage:0,tax:0,discountPercentage:0,discount:0,total:Pn,additionalCharges:cs,createdById:l.id,sellerId:null,transactionPaidId:null};try{Sn(!0);const Kr=await hv({transaction:Fi,details:[pr]});e?s?.(Kr):u(d.backPath)}catch{Ue(r("common.genericSaveError"))}finally{Sn(!1)}},Ze=async R=>{if(R.preventDefault(),Ue(""),!R.currentTarget.checkValidity()){R.currentTarget.reportValidity(),Ue(r("common.requiredFields"));return}if(!a?.accountId||!l?.id||!ce||Kt.length===0||!M.currencyId){Ue(r("transactions.saleValidationError"));return}const ne=M.paymentMode==="credit";if(!ne&&!M.paymentMethodId){Ue(r("transactions.paymentMethodRequired"));return}if(qn&&!M.accountPaymentFormId){Ue(r("transactions.accountPaymentFormRequired"));return}const oe=Se({isCredit:ne,personId:ce.id,description:M.description,date:M.date,totals:Hn,currencyId:M.currencyId,referenceNumber:M.referenceNumber,paymentMethodId:ne?null:M.paymentMethodId,accountPaymentFormId:ne?null:M.accountPaymentFormId,projectId:M.projectId,incomingPayment:!1}),je=Kt.map(Fe=>{const dt=Eh(Fe);return{conceptId:Number(Fe.conceptId),quantity:dt.quantity,price:dt.price,net:dt.net,taxPercentage:dt.taxPercentage,tax:dt.tax,discountPercentage:dt.discountPercentage,discount:dt.discount,total:dt.total,additionalCharges:dt.additionalCharges,createdById:l.id,sellerId:Fe.sellerId?Number(Fe.sellerId):null,transactionPaidId:null}});try{Sn(!0);const Fe=await hv({transaction:oe,details:je});e?s?.(Fe):u(d.backPath)}catch{Ue(r("common.genericSaveError"))}finally{Sn(!1)}};return os?c.jsx("p",{children:r("common.loading")}):c.jsxs("div",{className:e?"":"module-page",children:[e?c.jsx("h3",{children:r(d.titleKey)}):c.jsxs("div",{className:"page-header-row",children:[c.jsx("h1",{children:r(d.titleKey)}),c.jsx(st,{to:d.backPath,className:"button-link-secondary",children:r("common.backToList")})]}),as&&c.jsx("p",{className:"error-text",children:as}),t!=="sale"?c.jsxs("form",{className:"crud-form",onSubmit:ze,children:[c.jsxs("section",{className:"crud-form-section",children:[c.jsx("h2",{className:"crud-form-section-title",children:r("transactions.sectionGeneral")}),c.jsxs("div",{className:"form-grid-2",children:[c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:r("transactions.date")}),c.jsx("input",{type:"date",name:"date",value:E.date,onChange:He,required:!0})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:r("transactions.currency")}),c.jsxs("select",{name:"currencyId",value:E.currencyId,onChange:He,required:!0,children:[c.jsx("option",{value:"",children:`-- ${r("transactions.selectCurrency")} --`}),k.map(R=>c.jsxs("option",{value:R.id,children:[R.name," (",R.symbol,")"]},R.id))]})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:r("transactions.person")}),t==="income"||t==="expense"?c.jsx(ts,{label:"",value:F,onValueChange:H,options:At,getOptionLabel:R=>R.name||"",onSelect:R=>D(ne=>({...ne,personId:String(R.id)})),placeholder:`-- ${r(t==="expense"?"transactions.selectProvider":"transactions.optionalPerson")} --`,noResultsText:r("common.empty"),selectedPillText:At.find(R=>R.id===Number(E.personId))?.name||"",onClearSelection:()=>{D(R=>({...R,personId:""})),H("")},onCreateRecord:Kn,renderCreateModal:({isOpen:R,onClose:ne,onCreated:oe})=>R?c.jsx("div",{className:"modal-backdrop",onClick:ne,children:c.jsx("div",{className:"modal-card",onClick:je=>je.stopPropagation(),children:c.jsx($r,{embedded:!0,personType:t==="expense"?2:1,titleKey:t==="expense"?"actions.newProvider":"actions.newClient",basePath:t==="expense"?"/providers":"/clients",onCancel:ne,onCreated:oe})})}):null}):c.jsxs("div",{className:"field-select-with-action",children:[c.jsxs("select",{name:"personId",value:E.personId,onChange:He,required:t==="purchase",children:[c.jsx("option",{value:"",children:t==="purchase"?`-- ${r("transactions.selectProvider")} --`:`-- ${r("transactions.optionalPerson")} --`}),At.map(R=>c.jsx("option",{value:R.id,children:R.name},R.id))]}),c.jsx(st,{to:t==="purchase"?"/providers/new":"/clients/new",className:"button-secondary",title:r("actions.newPerson"),children:"+"})]})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:r("transactions.concept")}),t==="income"||t==="expense"?c.jsx(ts,{label:"",value:J,onValueChange:Y,options:Ut,getOptionLabel:R=>R.name||"",onSelect:R=>D(ne=>({...ne,conceptId:String(R.id),additionalCharges:R.additionalCharges??ne.additionalCharges})),placeholder:`-- ${r("transactions.selectConcept")} --`,noResultsText:r("common.empty"),selectedPillText:Ut.find(R=>R.id===Number(E.conceptId))?.name||"",onClearSelection:()=>{D(R=>({...R,conceptId:"",additionalCharges:0})),Y("")},onCreateRecord:Gn,renderCreateModal:({isOpen:R,onClose:ne,onCreated:oe})=>R?c.jsx("div",{className:"modal-backdrop",onClick:ne,children:c.jsx("div",{className:"modal-card",onClick:je=>je.stopPropagation(),children:c.jsx(nn,{embedded:!0,moduleType:t==="expense"?"expense":"income",titleKey:t==="expense"?"actions.newExpenseConcept":"actions.newIncomeConcept",basePath:t==="expense"?"/expense-concepts":"/income-concepts",onCancel:ne,onCreated:oe})})}):null}):c.jsxs("div",{className:"field-select-with-action",children:[c.jsxs("select",{name:"conceptId",value:E.conceptId,onChange:He,required:!0,children:[c.jsx("option",{value:"",children:`-- ${r("transactions.selectConcept")} --`}),Ut.map(R=>c.jsx("option",{value:R.id,children:R.name},R.id))]}),c.jsx(st,{to:t==="purchase"?"/payable-concepts/new":t==="expense"?"/expense-concepts/new":"/income-concepts/new",className:"button-secondary",title:r("actions.newConcept"),children:"+"})]})]}),c.jsxs("label",{className:"field-block form-span-2",children:[c.jsx("span",{children:r("transactions.description")}),c.jsx("input",{name:"description",value:E.description,onChange:He})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:r("transactions.referenceNumber")}),c.jsx("input",{name:"referenceNumber",value:E.referenceNumber,onChange:He})]}),c.jsx(ts,{label:r("projects.project"),value:le,onValueChange:R=>{ae(R),R||D(ne=>({...ne,projectId:""}))},options:A,getOptionLabel:R=>R.name||"",onSelect:R=>{ae(""),D(ne=>({...ne,projectId:String(R.id)}))},placeholder:`-- ${r("projects.optionalProject")} --`,onCreateRecord:Ns,renderCreateModal:({isOpen:R,onClose:ne,onCreated:oe})=>R?c.jsx("div",{className:"modal-backdrop",onClick:ne,children:c.jsx("div",{className:"modal-card",onClick:je=>je.stopPropagation(),children:c.jsx(io,{embedded:!0,onCancel:ne,onCreated:oe})})}):null,noResultsText:r("common.empty"),selectedPillText:A.find(R=>R.id===Number(E.projectId))?.name||"",onClearSelection:()=>{D(R=>({...R,projectId:""})),ae("")}}),(t==="income"||t==="expense")&&c.jsx(ts,{label:r("transactions.employee"),value:ge,onValueChange:R=>{we(R),R||D(ne=>({...ne,employeeId:""}))},options:x,getOptionLabel:R=>R.name||"",onSelect:R=>{we(""),D(ne=>({...ne,employeeId:String(R.id)}))},placeholder:`-- ${r("transactions.optionalSeller")} --`,noResultsText:r("common.empty"),selectedPillText:x.find(R=>R.id===Number(E.employeeId))?.name||"",onClearSelection:()=>{D(R=>({...R,employeeId:""})),we("")},onCreateRecord:Hr,renderCreateModal:({isOpen:R,onClose:ne,onCreated:oe})=>R?c.jsx("div",{className:"modal-backdrop",onClick:ne,children:c.jsx("div",{className:"modal-card",onClick:je=>je.stopPropagation(),children:c.jsx(uc,{embedded:!0,onCancel:ne,onCreated:oe})})}):null})]})]}),(t==="purchase"||t==="income"||t==="expense")&&c.jsxs("section",{className:"crud-form-section",children:[c.jsx("h2",{className:"crud-form-section-title",children:r("transactions.sectionPayment")}),c.jsxs("div",{className:"form-grid-2",children:[t==="purchase"&&c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:r("transactions.paymentMode")}),c.jsxs("select",{name:"paymentMode",value:E.paymentMode,onChange:He,children:[c.jsx("option",{value:"cash",children:r("transactions.cash")}),c.jsx("option",{value:"credit",children:r("transactions.credit")})]})]}),(t!=="purchase"||E.paymentMode==="cash")&&c.jsxs(c.Fragment,{children:[c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:r("transactions.paymentMethod")}),t==="income"||t==="expense"?c.jsx(ts,{label:"",value:X,onValueChange:re,options:S,getOptionLabel:R=>R.name||"",onSelect:R=>D(ne=>({...ne,paymentMethodId:String(R.id),accountPaymentFormId:""})),placeholder:`-- ${r("transactions.selectPaymentMethod")} --`,noResultsText:r("common.empty"),selectedPillText:S.find(R=>R.id===Number(E.paymentMethodId))?.name||"",onClearSelection:()=>{D(R=>({...R,paymentMethodId:"",accountPaymentFormId:""})),re("")},renderCreateModal:({isOpen:R,onClose:ne,onCreated:oe})=>R?c.jsx("div",{className:"modal-backdrop",onClick:ne,children:c.jsx("div",{className:"modal-card",onClick:je=>je.stopPropagation(),children:c.jsx(vN,{t:r,accountId:a?.accountId,onCancel:ne,onCreated:oe})})}):null,onCreateRecord:async R=>{const ne=await so(a.accountId);I(ne),D(oe=>({...oe,paymentMethodId:String(R.id),accountPaymentFormId:""})),re("")}}):c.jsxs("select",{name:"paymentMethodId",value:E.paymentMethodId,onChange:He,required:t!=="purchase"||E.paymentMode==="cash",children:[c.jsx("option",{value:"",children:`-- ${r("transactions.selectPaymentMethod")} --`}),S.map(R=>c.jsx("option",{value:R.id,children:R.name},R.id))]})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:r("transactions.accountPaymentForm")}),t==="income"||t==="expense"?c.jsx(ts,{label:"",value:pe,onValueChange:ee,options:Gt,getOptionLabel:R=>pn(R),onSelect:R=>D(ne=>({...ne,accountPaymentFormId:String(R.id)})),placeholder:`-- ${r("transactions.selectAccountPaymentForm")} --`,noResultsText:r("common.empty"),selectedPillText:Gt.find(R=>R.id===Number(E.accountPaymentFormId))?pn(Gt.find(R=>R.id===Number(E.accountPaymentFormId))):"",onClearSelection:()=>{D(R=>({...R,accountPaymentFormId:""})),ee("")},onCreateRecord:async R=>{const ne=await ur(a.accountId);T(ne),D(oe=>({...oe,accountPaymentFormId:String(R.id)})),ee("")},renderCreateModal:({isOpen:R,onClose:ne,onCreated:oe})=>R?c.jsx("div",{className:"modal-backdrop",onClick:ne,children:c.jsx("div",{className:"modal-card",onClick:je=>je.stopPropagation(),children:c.jsx(dc,{embedded:!0,onCancel:ne,onCreated:oe})})}):null}):c.jsxs("select",{name:"accountPaymentFormId",value:E.accountPaymentFormId,onChange:He,required:Vn,children:[c.jsx("option",{value:"",children:`-- ${r("transactions.selectAccountPaymentForm")} --`}),Gt.map(R=>c.jsx("option",{value:R.id,children:pn(R)},R.id))]})]})]})]})]}),c.jsxs("section",{className:"crud-form-section",children:[c.jsx("h2",{className:"crud-form-section-title",children:r("transactions.sectionAmounts")}),c.jsxs("div",{className:"form-grid-2",children:[c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:r("transactions.amount")}),c.jsx("input",{name:"amount",type:"number",min:"0",step:"0.01",value:E.amount,onChange:He,required:!0})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:r("transactions.additionalCharges")}),c.jsx("input",{name:"additionalCharges",type:"number",step:"0.01",value:E.additionalCharges,readOnly:!0})]})]})]}),c.jsxs("p",{children:[r("transactions.summary")," ",(Number(E.amount||0)+Number(E.additionalCharges||0)).toFixed(2)]}),c.jsxs("div",{className:"crud-form-actions",children:[e?c.jsx("button",{type:"button",className:"button-secondary",onClick:()=>n?.(),children:r("common.cancel")}):null,c.jsx("button",{type:"submit",disabled:Wn,children:r("common.create")})]})]}):c.jsxs("form",{className:"crud-form",onSubmit:Ze,children:[c.jsxs("section",{className:"crud-form-section",children:[c.jsx("h2",{className:"crud-form-section-title",children:r("transactions.sectionGeneral")}),c.jsxs("div",{className:"form-grid-2",children:[c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:r("transactions.date")}),c.jsx("input",{type:"date",name:"date",value:M.date,onChange:rn,required:!0})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:r("transactions.currency")}),c.jsxs("select",{name:"currencyId",value:M.currencyId,onChange:rn,required:!0,children:[c.jsx("option",{value:"",children:`-- ${r("transactions.selectCurrency")} --`}),k.map(R=>c.jsxs("option",{value:R.id,children:[R.name," (",R.symbol,")"]},R.id))]})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:r("transactions.paymentMode")}),c.jsxs("select",{name:"paymentMode",value:M.paymentMode,onChange:rn,children:[c.jsx("option",{value:"cash",children:r("transactions.cash")}),c.jsx("option",{value:"credit",children:r("transactions.credit")})]})]}),c.jsx(ts,{label:r("transactions.clientLookup"),value:U,onValueChange:R=>{B(R),R||ie(null)},options:At,getOptionLabel:R=>R.name||"",onSelect:R=>{ie(R),B("")},placeholder:r("transactions.lookupPlaceholder"),onCreateRecord:Kn,renderCreateModal:({isOpen:R,onClose:ne,onCreated:oe})=>R?c.jsx("div",{className:"modal-backdrop",onClick:ne,children:c.jsx("div",{className:"modal-card",onClick:je=>je.stopPropagation(),children:c.jsx($r,{embedded:!0,personType:1,titleKey:"actions.newClient",basePath:"/clients",onCancel:ne,onCreated:oe})})}):null,noResultsText:r("common.empty"),selectedPillText:ce?.name||"",onClearSelection:()=>{ie(null),B("")}}),c.jsxs("label",{className:"field-block form-span-2",children:[c.jsx("span",{children:r("transactions.description")}),c.jsx("input",{name:"description",value:M.description,onChange:rn})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:r("transactions.referenceNumber")}),c.jsx("input",{name:"referenceNumber",value:M.referenceNumber,onChange:rn})]}),c.jsx(ts,{label:r("projects.project"),value:Le,onValueChange:R=>{Te(R),R||N(ne=>({...ne,projectId:""}))},options:A,getOptionLabel:R=>R.name||"",onSelect:R=>{Te(""),N(ne=>({...ne,projectId:String(R.id)}))},placeholder:`-- ${r("projects.optionalProject")} --`,onCreateRecord:Ns,renderCreateModal:({isOpen:R,onClose:ne,onCreated:oe})=>R?c.jsx("div",{className:"modal-backdrop",onClick:ne,children:c.jsx("div",{className:"modal-card",onClick:je=>je.stopPropagation(),children:c.jsx(io,{embedded:!0,onCancel:ne,onCreated:oe})})}):null,noResultsText:r("common.empty"),selectedPillText:A.find(R=>R.id===Number(M.projectId))?.name||"",onClearSelection:()=>{N(R=>({...R,projectId:""})),Te("")}})]})]}),M.paymentMode==="cash"&&c.jsxs("section",{className:"crud-form-section",children:[c.jsx("h2",{className:"crud-form-section-title",children:r("transactions.sectionPayment")}),c.jsxs("div",{className:"form-grid-2",children:[c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:r("transactions.paymentMethod")}),c.jsxs("select",{name:"paymentMethodId",value:M.paymentMethodId,onChange:rn,required:!0,children:[c.jsx("option",{value:"",children:`-- ${r("transactions.selectPaymentMethod")} --`}),S.map(R=>c.jsx("option",{value:R.id,children:R.name},R.id))]})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:r("transactions.accountPaymentForm")}),c.jsxs("select",{name:"accountPaymentFormId",value:M.accountPaymentFormId,onChange:rn,required:qn,children:[c.jsx("option",{value:"",children:`-- ${r("transactions.selectAccountPaymentForm")} --`}),Cn.map(R=>c.jsx("option",{value:R.id,children:pn(R)},R.id))]})]})]})]}),c.jsxs("section",{className:"crud-form-section",children:[c.jsx("h2",{className:"crud-form-section-title",children:r("transactions.sectionDetail")}),c.jsx(ts,{label:r("transactions.productLookup"),value:De,onValueChange:mt,options:Ut,getOptionLabel:R=>R.name||"",onSelect:R=>{As(R),mt("")},placeholder:r("transactions.productLookupPlaceholder"),onCreateRecord:Gn,renderCreateModal:({isOpen:R,onClose:ne,onCreated:oe})=>R?c.jsx("div",{className:"modal-backdrop",onClick:ne,children:c.jsx("div",{className:"modal-card",onClick:je=>je.stopPropagation(),children:c.jsx(nn,{embedded:!0,moduleType:"products",titleKey:"actions.newProduct",basePath:"/products",onCancel:ne,onCreated:oe})})}):null,noResultsText:r("common.empty")})]}),c.jsxs("table",{className:"crud-table invoice-lines-table",children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:r("transactions.product")}),c.jsx("th",{children:r("transactions.quantity")}),c.jsx("th",{children:r("transactions.price")}),c.jsx("th",{children:r("transactions.taxPercentage")}),c.jsx("th",{children:r("transactions.discountPercentage")}),c.jsx("th",{children:r("transactions.additionalCharges")}),c.jsx("th",{children:r("transactions.lineTotal")}),c.jsx("th",{children:r("transactions.seller")}),c.jsx("th",{children:r("common.actions")})]})}),c.jsx("tbody",{children:Kt.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:9,children:r("transactions.noLines")})}):Kt.map(R=>{const ne=Eh(R);return c.jsxs("tr",{children:[c.jsx("td",{children:R.conceptName}),c.jsx("td",{children:c.jsx("input",{type:"number",min:"0",step:"0.01",value:R.quantity,onChange:oe=>Wt(R.rowId,"quantity",oe.target.value)})}),c.jsx("td",{children:c.jsx("input",{type:"number",min:"0",step:"0.01",value:R.price,onChange:oe=>Wt(R.rowId,"price",oe.target.value)})}),c.jsx("td",{children:c.jsx("input",{type:"number",min:"0",step:"0.01",value:R.taxPercentage,onChange:oe=>Wt(R.rowId,"taxPercentage",oe.target.value)})}),c.jsx("td",{children:c.jsx("input",{type:"number",min:"0",step:"0.01",value:R.discountPercentage,onChange:oe=>Wt(R.rowId,"discountPercentage",oe.target.value)})}),c.jsx("td",{children:c.jsx("input",{type:"number",step:"0.01",value:R.additionalCharges,onChange:oe=>Wt(R.rowId,"additionalCharges",oe.target.value)})}),c.jsx("td",{children:ne.total.toFixed(2)}),c.jsx("td",{children:c.jsxs("select",{value:R.sellerId,onChange:oe=>Wt(R.rowId,"sellerId",oe.target.value),children:[c.jsx("option",{value:"",children:`-- ${r("transactions.optionalSeller")} --`}),x.map(oe=>c.jsx("option",{value:oe.id,children:oe.name},oe.id))]})}),c.jsx("td",{children:c.jsx("button",{type:"button",className:"button-danger",onClick:()=>W(R.rowId),children:r("common.delete")})})]},R.rowId)})})]}),c.jsxs("p",{children:[r("transactions.summary")," ",Hn.total.toFixed(2)]}),c.jsxs("div",{className:"crud-form-actions",children:[e?c.jsx("button",{type:"button",className:"button-secondary",onClick:()=>n?.(),children:r("common.cancel")}):null,c.jsx("button",{type:"submit",disabled:Wn,children:r("common.create")})]})]})]})}const xN={sale:{type:Nt.sale,titleKey:"transactions.salesTitle"},expense:{type:Nt.expense,titleKey:"transactions.expensesTitle"},income:{type:Nt.income,titleKey:"transactions.incomesTitle"},purchase:{type:Nt.purchase,titleKey:"transactions.purchasesTitle"},outgoingPayment:{type:Nt.outgoingPayment,titleKey:"transactions.outgoingPaymentsTitle"},incomingPayment:{type:Nt.incomingPayment,titleKey:"transactions.incomingPaymentsTitle"}},qd=10;function Ul({moduleType:t}){const{t:e,language:n}=Ee(),{account:s}=Oe(),r=xN[t],a=["sale","purchase","expense","income"].includes(t),[l,u]=j.useState([]),[d,f]=j.useState(""),[m,g]=j.useState(!0),[y,x]=j.useState(1),[_,k]=j.useState({open:!1,transaction:null,direction:"incoming"}),[b,S]=j.useState({dateFrom:"",dateTo:"",person:"",minAmount:"",maxAmount:""}),[I,C]=is(),T=I.get("create")==="1";j.useEffect(()=>{s?.accountId&&E()},[s?.accountId,r.type]);const A=j.useMemo(()=>{const F=b.person.trim().toLowerCase(),H=b.minAmount===""?null:Number(b.minAmount),J=b.maxAmount===""?null:Number(b.maxAmount);return l.filter(Y=>!(b.dateFrom&&Y.date<b.dateFrom||b.dateTo&&Y.date>b.dateTo||F&&!(Y.persons?.name||"").toLowerCase().includes(F)||Number.isFinite(H)&&Number(Y.total||0)<H||Number.isFinite(J)&&Number(Y.total||0)>J))},[l,b]),z=j.useMemo(()=>{const F=(y-1)*qd;return A.slice(F,F+qd)},[A,y]);j.useEffect(()=>{x(1)},[b]);const E=async()=>{try{g(!0);const F=await WT({accountId:s.accountId,type:r.type,excludeInternalObligations:t==="purchase"});if(t==="income"||t==="expense"){const H=await VT(F.map(J=>J.id));u(F.map(J=>({...J,conceptName:H[Number(J.id)]??"-"})))}else u(F);f(""),x(1)}catch{f(e("common.genericLoadError"))}finally{g(!1)}},D=async F=>{try{await Yx(F),await E()}catch{f(e("common.genericSaveError"))}},M=F=>{const{name:H,value:J}=F.target;S(Y=>({...Y,[H]:J}))},N=()=>{S({dateFrom:"",dateTo:"",person:"",minAmount:"",maxAmount:""})};return c.jsxs("div",{className:"module-page",children:[c.jsx("h1",{children:e(r.titleKey)}),a&&c.jsxs("details",{className:"generic-panel filters-accordion",children:[c.jsx("summary",{className:"filters-accordion-summary",children:e("reports.applicableFilters")}),c.jsxs("div",{className:"filters-accordion-body",children:[c.jsxs("div",{className:"transaction-filters-grid",children:[c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:e("reports.dateFrom")}),c.jsx("input",{type:"date",name:"dateFrom",value:b.dateFrom,onChange:M})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:e("reports.dateTo")}),c.jsx("input",{type:"date",name:"dateTo",value:b.dateTo,onChange:M})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:e("transactions.person")}),c.jsx("input",{type:"text",name:"person",value:b.person,onChange:M,placeholder:`-- ${e("transactions.person")} --`})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:e("transactions.minAmount")}),c.jsx("input",{type:"number",min:"0",step:"0.01",name:"minAmount",value:b.minAmount,onChange:M,placeholder:`-- ${e("transactions.minAmount")} --`})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:e("transactions.maxAmount")}),c.jsx("input",{type:"number",min:"0",step:"0.01",name:"maxAmount",value:b.maxAmount,onChange:M,placeholder:`-- ${e("transactions.maxAmount")} --`})]})]}),c.jsx("div",{className:"crud-form-actions",children:c.jsx("button",{type:"button",className:"button-secondary",onClick:N,children:e("common.clearFilters")})})]})]}),d&&c.jsx("p",{className:"error-text",children:d}),m?c.jsx("p",{children:e("common.loading")}):A.length===0?c.jsx("p",{children:e("common.empty")}):c.jsxs(c.Fragment,{children:[c.jsxs("table",{className:"crud-table",children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"ID"}),c.jsx("th",{children:e("transactions.date")}),c.jsx("th",{children:e("common.name")}),(t==="income"||t==="expense")&&c.jsx("th",{children:e("transactions.concept")}),c.jsx("th",{children:e("transactions.person")}),c.jsx("th",{children:e("projects.project")}),c.jsx("th",{children:e("transactions.total")}),c.jsx("th",{children:e("transactions.balance")}),c.jsx("th",{children:e("transactions.referenceNumber")}),c.jsx("th",{children:e("transactions.status")}),c.jsx("th",{children:e("common.actions")})]})}),c.jsx("tbody",{children:z.map(F=>c.jsxs("tr",{children:[c.jsx("td",{children:t==="sale"||t==="purchase"?c.jsx(st,{to:`/${t==="sale"?"sales":"purchases"}/${F.id}`,children:F.id}):F.id}),c.jsx("td",{children:ut(F.date,n)}),c.jsx("td",{children:F.name??"-"}),(t==="income"||t==="expense")&&c.jsx("td",{children:F.conceptName??"-"}),c.jsx("td",{children:F.persons?.name??"-"}),c.jsx("td",{children:F.projects?.name??"-"}),c.jsx("td",{children:Ie(F.total)}),c.jsx("td",{children:Ie(F.balance)}),c.jsx("td",{children:F.referenceNumber??"-"}),c.jsx("td",{children:F.isActive?e("transactions.active"):e("transactions.inactive")}),c.jsx("td",{className:"table-actions",children:c.jsx(kn,{actions:[...t==="sale"||t==="purchase"?[{key:"detail",label:e("transactions.viewDetail"),to:`/${t==="sale"?"sales":"purchases"}/${F.id}`}]:[],...t==="purchase"&&Number(F.balance||0)>0?[{key:"pay",label:e("transactions.newOutgoingPayment"),onClick:()=>k({open:!0,transaction:F,direction:"outgoing"})}]:[],...t==="sale"&&Number(F.balance||0)>0?[{key:"collect",label:e("transactions.newIncomingPayment"),onClick:()=>k({open:!0,transaction:F,direction:"incoming"})}]:[],{key:"deactivate",label:e("transactions.deactivate"),onClick:()=>D(F.id),disabled:!F.isActive,danger:!0}]})})]},F.id))})]}),c.jsx(Un,{page:y,pageSize:qd,totalItems:A.length,onPageChange:x}),c.jsx(Xx,{isOpen:_.open,transaction:_.transaction,direction:_.direction,onClose:()=>k({open:!1,transaction:null,direction:"incoming"}),onSaved:E})]}),t!=="sale"&&T?c.jsx("div",{className:"modal-backdrop",onClick:()=>{const F=new URLSearchParams(I);F.delete("create"),C(F)},children:c.jsx("div",{className:"modal-card",onClick:F=>F.stopPropagation(),children:c.jsx(Oa,{embedded:!0,moduleType:t,onCancel:()=>{const F=new URLSearchParams(I);F.delete("create"),C(F)},onCreated:async()=>{await E();const F=new URLSearchParams(I);F.delete("create"),C(F)}})})}):null]})}function fv({moduleType:t}){const{t:e,language:n}=Ee(),{id:s}=zn(),[r,a]=j.useState(null),[l,u]=j.useState([]),[d,f]=j.useState([]),[m,g]=j.useState(!1),[y,x]=j.useState(""),[_,k]=j.useState(!0),b=t==="sale"?"/sales":"/purchases";j.useEffect(()=>{S()},[s]);const S=async()=>{try{k(!0);const[I,C,T]=await Promise.all([Jx(s),HT(s),KT(s)]);a(I),u(C),f(T),x("")}catch{x(e("common.genericLoadError"))}finally{k(!1)}};return _?c.jsx("p",{children:e("common.loading")}):c.jsxs("div",{className:"module-page",children:[c.jsxs("div",{className:"page-header-row",children:[c.jsx("h1",{children:e("transactions.detailTitle")}),c.jsxs("div",{className:"crud-form-actions",children:[c.jsx(st,{to:b,className:"button-link-secondary",children:e("common.backToList")}),Number(r?.balance||0)>0&&c.jsx("button",{type:"button",className:"button-link-primary",onClick:()=>g(!0),children:e(t==="sale"?"transactions.newIncomingPayment":"transactions.newOutgoingPayment")})]})]}),y&&c.jsx("p",{className:"error-text",children:y}),r&&c.jsxs("section",{className:"generic-panel",children:[c.jsxs("p",{children:["ID: ",r.id]}),c.jsxs("p",{children:[e("transactions.person"),": ",r.persons?.name??"-"]}),c.jsxs("p",{children:[e("transactions.total"),": ",Ie(r.total)]}),c.jsxs("p",{children:[e("transactions.balance"),": ",Ie(r.balance)]}),c.jsxs("p",{children:[e("transactions.referenceNumber"),": ",r.referenceNumber||"-"]})]}),c.jsxs("section",{className:"generic-panel",children:[c.jsx("h3",{children:e("transactions.detailLines")}),c.jsxs("table",{className:"crud-table",children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:e("transactions.concept")}),c.jsx("th",{children:e("transactions.quantity")}),c.jsx("th",{children:e("transactions.price")}),c.jsx("th",{children:e("transactions.total")})]})}),c.jsx("tbody",{children:l.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:4,children:e("common.empty")})}):l.map(I=>c.jsxs("tr",{children:[c.jsx("td",{children:I.concepts?.name??"-"}),c.jsx("td",{children:I.quantity}),c.jsx("td",{children:Ie(I.price)}),c.jsx("td",{children:Ie(I.total)})]},I.id))})]})]}),c.jsxs("section",{className:"generic-panel",children:[c.jsx("h3",{children:e("transactions.paymentsApplied")}),c.jsxs("table",{className:"crud-table",children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"ID"}),c.jsx("th",{children:e("transactions.date")}),c.jsx("th",{children:e("transactions.referenceNumber")}),c.jsx("th",{children:e("transactions.total")})]})}),c.jsx("tbody",{children:d.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:3,children:e("common.empty")})}):d.map(I=>c.jsxs("tr",{children:[c.jsx("td",{children:I.transactionId}),c.jsx("td",{children:ut(I.transactions?.date,n)}),c.jsx("td",{children:I.transactions?.referenceNumber??"-"}),c.jsx("td",{children:Ie(I.total)})]},I.id))})]})]}),c.jsx(Xx,{isOpen:m,transaction:r,direction:t==="sale"?"incoming":"outgoing",onClose:()=>g(!1),onSaved:S})]})}const bN='id, name, "periodType", "periodStart", "periodEnd", "projectId", "isActive", projects(name)';async function Zx(t,{activeOnly:e=!0}={}){let n=G.from("budgets").select(bN).eq("accountId",t);e&&(n=n.eq("isActive",!0));const{data:s,error:r}=await n.order("id",{ascending:!1});if(r)throw r;return s??[]}async function eb(t){const{data:e,error:n}=await G.from("budgets").select('id, name, "periodType", "periodStart", "periodEnd", "projectId", "isActive"').eq("id",t).single();if(n)throw n;return e}async function tb(t){const{data:e,error:n}=await G.from("budget_lines").select('id, "budgetId", "conceptId", amount, concepts(name)').eq("budgetId",t).order("id",{ascending:!0});if(n)throw n;return e??[]}async function wN({budget:t,lines:e}){const{data:n,error:s}=await G.from("budgets").insert(t).select("id").single();if(s)throw s;const r=(e??[]).filter(a=>Number(a.conceptId)).map(a=>({budgetId:n.id,conceptId:Number(a.conceptId),amount:Number(a.amount||0),createdById:t.createdById}));if(r.length>0){const{error:a}=await G.from("budget_lines").insert(r);if(a)throw await G.from("budgets").delete().eq("id",n.id),a}return n}async function _N(t,{budget:e,lines:n}){const{error:s}=await G.from("budgets").update(e).eq("id",t);if(s)throw s;const{error:r}=await G.from("budget_lines").delete().eq("budgetId",t);if(r)throw r;const a=(n??[]).filter(l=>Number(l.conceptId)).map(l=>({budgetId:t,conceptId:Number(l.conceptId),amount:Number(l.amount||0),createdById:e.createdById}));if(a.length>0){const{error:l}=await G.from("budget_lines").insert(a);if(l)throw l}}async function kN(t){const{error:e}=await G.from("budgets").update({isActive:!1}).eq("id",t);if(e)throw e}async function nb({accountId:t,budgetId:e,dateFrom:n,dateTo:s}){const{data:r,error:a}=await G.from("budgets").select('id, name, "periodStart", "periodEnd", "projectId"').eq("id",e).eq("accountId",t).single();if(a)throw a;const{data:l,error:u}=await G.from("budget_lines").select('id, "conceptId", amount, concepts(name, isExpense, isIncome)').eq("budgetId",e);if(u)throw u;const d=[...new Set((l??[]).map(_=>_.conceptId).filter(Boolean))];if(d.length===0)return[];const f=n||r.periodStart,m=s||r.periodEnd,{data:g,error:y}=await G.from("transactionDetails").select('conceptId, total, transactions!transaction_details_transactionId_fkey(accountId, date, isActive, "projectId")').in("conceptId",d);if(y)throw y;const x=new Map;return(g??[]).forEach(_=>{const k=_.transactions;if(!k||k.accountId!==t||k.isActive!==!0||f&&k.date<f||m&&k.date>m||r.projectId&&Number(k.projectId||0)!==Number(r.projectId))return;const b=Number(_.conceptId),C=!!(l??[]).find(T=>Number(T.conceptId)===b)?.concepts?.isExpense?Math.abs(Number(_.total||0)):Number(_.total||0);x.set(b,(x.get(b)||0)+C)}),(l??[]).map(_=>{const k=Number(_.amount||0),b=Number(x.get(Number(_.conceptId))||0);return{id:_.id,conceptId:_.conceptId,conceptName:_.concepts?.name||`#${_.conceptId}`,budgeted:k,executed:b,variance:k-b}})}async function sb({accountId:t,projectId:e,dateFrom:n,dateTo:s}){const{data:r,error:a}=await G.from("budgets").select('id, "periodStart", "periodEnd"').eq("accountId",t).eq("projectId",e).eq("isActive",!0);if(a)throw a;const l=(r??[]).map(k=>k.id),{data:u,error:d}=l.length?await G.from("budget_lines").select('id, "budgetId", "conceptId", amount, concepts(name, isExpense, isIncome)').in("budgetId",l):{data:[],error:null};if(d)throw d;const{data:f,error:m}=await G.from("transactionDetails").select('conceptId, total, transactions!transaction_details_transactionId_fkey(accountId, date, isActive, "projectId")');if(m)throw m;const g=new Map;(u??[]).forEach(k=>{const b=Number(k.conceptId);g.set(b,(g.get(b)||0)+Number(k.amount||0))});const y=new Map;(f??[]).forEach(k=>{const b=k.transactions;if(!b||b.accountId!==t||b.isActive!==!0||Number(b.projectId||0)!==Number(e)||n&&b.date<n||s&&b.date>s)return;const S=Number(k.conceptId),T=!!(u??[]).find(A=>Number(A.conceptId)===S)?.concepts?.isExpense?Math.abs(Number(k.total||0)):Number(k.total||0);y.set(S,(y.get(S)||0)+T)});const x=[...new Set([...g.keys(),...y.keys()])],_=new Map((u??[]).map(k=>[Number(k.conceptId),k.concepts?.name||`#${k.conceptId}`]));return x.map(k=>{const b=Number(g.get(k)||0),S=Number(y.get(k)||0);return{id:k,conceptId:k,conceptName:_.get(k)||`#${k}`,budgeted:b,executed:S,variance:b-S}})}async function SN(t,{dateFrom:e,dateTo:n}={}){let s=G.from("transactions").select('id, date, type, total, balance, payments, additionalCharges, isActive, isAccountPayable, isAccountReceivable, isIncomingPayment, isOutcomingPayment, "accountPaymentFormId", "projectId", currencyId, account_payment_forms(name), projects(name)').eq("accountId",t).eq("isActive",!0);e&&(s=s.gte("date",e)),n&&(s=s.lte("date",n));const{data:r,error:a}=await s.order("date",{ascending:!1});if(a)throw a;return r??[]}async function jN({accountId:t,reportId:e,dateFrom:n,dateTo:s,currencyId:r,budgetId:a,projectId:l}){const u="https://vpbokueczoylouivgnin.supabase.co",d="sb_publishable_qnne91NTAXswisfSQlObFg_NnwBiV9d";async function f(){let{data:{session:_}}=await G.auth.getSession();if((!_?.access_token||!_?.expires_at||_.expires_at*1e3<=Date.now()+6e4)&&(_=(await G.auth.refreshSession()).data.session),!_?.access_token)throw new Error("Missing auth session for report export request.");return _.access_token}async function m(_){const k=await fetch(`${u}/functions/v1/export-report`,{method:"POST",headers:{"Content-Type":"application/json",apikey:d,Authorization:`Bearer ${_}`},body:JSON.stringify({accountId:t,reportId:e,dateFrom:n,dateTo:s,currencyId:r,budgetId:a,projectId:l})});let b;try{b=await k.json()}catch{b=null}return{response:k,payload:b}}let g=await f(),{response:y,payload:x}=await m(g);if(y.status===401){if(g=(await G.auth.refreshSession()).data.session?.access_token,!g)throw new Error(x?.error??"Unauthorized. Please sign in again.");const k=await m(g);y=k.response,x=k.payload}if(!y.ok)throw new Error(x?.error??`Report export HTTP ${y.status}`);if(x?.success===!1||!x?.downloadUrl)throw new Error(`Report export failed: ${x?.error??"unknown function error"}`);return x}const Hd=[{id:"sales",titleKey:"reports.sales",filters:["dateRange","currency"]},{id:"receivable",titleKey:"reports.accountsReceivable",filters:["dateRange","currency"]},{id:"payable",titleKey:"reports.accountsPayable",filters:["dateRange","currency"]},{id:"internal_obligations",titleKey:"reports.internalObligations",filters:["dateRange","currency"]},{id:"budget_execution",titleKey:"reports.budgetExecution",filters:["budget"]},{id:"project_execution",titleKey:"reports.projectExecution",filters:["project","dateRange"]},{id:"expenses",titleKey:"reports.expenses",filters:["dateRange","currency"]},{id:"cashflow",titleKey:"reports.cashflow",filters:["dateRange","currency"]}];function CN(){const{t,language:e}=Ee(),{account:n}=Oe(),[s,r]=j.useState("sales"),[a,l]=j.useState({dateFrom:"",dateTo:"",currencyId:"",budgetId:"",projectId:""}),[u,d]=j.useState([]),[f,m]=j.useState([]),[g,y]=j.useState([]),[x,_]=j.useState([]),[k,b]=j.useState(""),[S,I]=j.useState(!1),[C,T]=j.useState(!1),[A,z]=j.useState(!1),[E,D]=j.useState(!0),M=j.useMemo(()=>Hd.find(B=>B.id===s)??Hd[0],[s]);j.useEffect(()=>{n?.accountId&&N()},[n?.accountId]);const N=async()=>{try{const[B,le,ae]=await Promise.all([ho(n.accountId).catch(()=>[]),ro(n.accountId).catch(()=>[]),Zx(n.accountId).catch(()=>[])]);d(B),m(le),y(ae)}catch{d([]),m([]),y([])}},F=B=>{const{name:le,value:ae}=B.target;l(ge=>({...ge,[le]:ae}))},H=(B,le)=>{if(le==="internal_obligations")return B;if(le==="sales")return B.filter(ae=>ae.type===1);if(le==="expenses")return B.filter(ae=>ae.type===2);if(le==="receivable")return B.filter(ae=>ae.isAccountReceivable&&Number(ae.balance||0)>0);if(le==="payable")return B.filter(ae=>ae.isAccountPayable&&Number(ae.balance||0)>0);if(le==="cashflow"){const ae=new Map;return B.forEach(ge=>{if(!ge.accountPaymentFormId||!(ge.isIncomingPayment||ge.isOutcomingPayment||ge.type===2))return;const we=String(ge.accountPaymentFormId),Le=ge.account_payment_forms?.name||`#${ge.accountPaymentFormId}`,Te=ge.isIncomingPayment?Math.abs(Number(ge.total||0)):-Math.abs(Number(ge.total||0)),De=ae.get(we)||{id:we,date:"-",typeLabel:Le,total:0,balance:0};De.total+=Te,ae.set(we,De)}),Array.from(ae.values())}return B},J=async()=>{if(!(!n?.accountId||!s))try{if(I(!0),s==="budget_execution"){if(!a.budgetId){b(t("reports.budgetRequired"));return}const B=await nb({accountId:n.accountId,budgetId:Number(a.budgetId),dateFrom:a.dateFrom||void 0,dateTo:a.dateTo||void 0});_(B)}else if(s==="project_execution"){if(!a.projectId){b(t("reports.projectRequired"));return}const B=await sb({accountId:n.accountId,projectId:Number(a.projectId),dateFrom:a.dateFrom||void 0,dateTo:a.dateTo||void 0});_(B)}else if(s==="internal_obligations"){const B=await tN(n.accountId,{dateFrom:a.dateFrom||void 0,dateTo:a.dateTo||void 0,currencyId:a.currencyId?Number(a.currencyId):void 0});_(H(B,s))}else{const B=await SN(n.accountId,{dateFrom:a.dateFrom||void 0,dateTo:a.dateTo||void 0}),le=a.currencyId?B.filter(ae=>String(ae.currencyId??"")===a.currencyId):B;_(H(le,s))}z(!0),D(!1),b("")}catch{b(t("common.genericLoadError"))}finally{I(!1)}},Y=j.useMemo(()=>x.map(B=>({...B,typeLabel:s==="budget_execution"||s==="project_execution"?B.conceptName||"-":s==="internal_obligations"?B.name||t("reports.internalObligations"):s==="cashflow"?B.typeLabel||"-":B.type===1?t("reports.sales"):B.type===2?t("reports.expenses"):t("reports.incomes")})),[x,s,t]),X=j.useMemo(()=>["budget_execution","project_execution"].includes(s)?x.reduce((B,le)=>(B.budgeted+=Number(le.budgeted||0),B.executed+=Number(le.executed||0),B.variance+=Number(le.variance||0),B),{budgeted:0,executed:0,variance:0}):null,[x,s]),re=!["budget_execution","project_execution"].includes(s),pe=j.useMemo(()=>{const B=u.find(ge=>String(ge.id)===String(a.currencyId))?.name||t("reports.currencyFilterHint"),le=g.find(ge=>String(ge.id)===String(a.budgetId))?.name||"-",ae=f.find(ge=>String(ge.id)===String(a.projectId))?.name||"-";return[`${t("reports.dateFrom")}: ${ut(a.dateFrom,e)}`,`${t("reports.dateTo")}: ${ut(a.dateTo,e)}`,`${t("reports.currencyFilter")}: ${B}`,`${t("reports.budget")}: ${le}`,`${t("projects.project")}: ${ae}`]},[a,u,g,f,t,e]),ee=j.useMemo(()=>x.reduce((B,le)=>B+Number(le.total||0),0),[x]),ce=j.useMemo(()=>x.reduce((B,le)=>B+Number(le.balance||0),0),[x]),ie=j.useMemo(()=>s!=="sales"?0:x.reduce((B,le)=>B+Number(le.additionalCharges||0),0),[x,s]),U=async()=>{if(!(!n?.accountId||!s||C))try{T(!0);const B=await jN({accountId:n.accountId,reportId:s,dateFrom:a.dateFrom||null,dateTo:a.dateTo||null,currencyId:a.currencyId?Number(a.currencyId):null,budgetId:a.budgetId?Number(a.budgetId):null,projectId:a.projectId?Number(a.projectId):null});window.open(B.downloadUrl,"_blank","noopener,noreferrer"),b("")}catch(B){b(B?.message||t("common.genericLoadError"))}finally{T(!1)}};return c.jsxs("div",{className:"module-page",children:[c.jsx("h1",{children:t("reports.title")}),k&&c.jsx("p",{className:"error-text",children:k}),E&&c.jsxs("div",{className:"grid-2",children:[c.jsxs("section",{className:"generic-panel",children:[c.jsx("h3",{children:t("reports.availableReports")}),c.jsx("div",{className:"reports-list",role:"listbox","aria-label":t("reports.availableReports"),children:Hd.map(B=>c.jsx("button",{type:"button",className:`reports-list-item ${s===B.id?"active":""}`,"aria-selected":s===B.id,onClick:()=>r(B.id),children:t(B.titleKey)},B.id))})]}),c.jsxs("section",{className:"generic-panel",children:[c.jsx("h3",{children:t("reports.applicableFilters")}),c.jsxs("div",{className:"form-grid-2",children:[M.filters.includes("dateRange")&&c.jsxs(c.Fragment,{children:[c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:t("reports.dateFrom")}),c.jsx("input",{type:"date",name:"dateFrom",value:a.dateFrom,onChange:F})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:t("reports.dateTo")}),c.jsx("input",{type:"date",name:"dateTo",value:a.dateTo,onChange:F})]})]}),M.filters.includes("currency")&&c.jsxs("label",{className:"field-block form-span-2",children:[c.jsx("span",{children:t("reports.currencyFilter")}),c.jsxs("select",{name:"currencyId",value:a.currencyId,onChange:F,children:[c.jsx("option",{value:"",children:`-- ${t("reports.currencyFilterHint")} --`}),u.map(B=>c.jsxs("option",{value:B.id,children:[B.name," (",B.symbol,")"]},B.id))]})]}),M.filters.includes("budget")&&c.jsxs("label",{className:"field-block form-span-2",children:[c.jsx("span",{children:t("reports.budget")}),c.jsxs("select",{name:"budgetId",value:a.budgetId,onChange:F,children:[c.jsx("option",{value:"",children:`-- ${t("reports.selectBudget")} --`}),g.map(B=>c.jsx("option",{value:B.id,children:B.name},B.id))]})]}),M.filters.includes("project")&&c.jsxs("label",{className:"field-block form-span-2",children:[c.jsx("span",{children:t("projects.project")}),c.jsxs("select",{name:"projectId",value:a.projectId,onChange:F,children:[c.jsx("option",{value:"",children:`-- ${t("reports.selectProject")} --`}),f.map(B=>c.jsx("option",{value:B.id,children:B.name},B.id))]})]})]})]})]}),c.jsx("div",{className:"actions-menu",children:c.jsx("div",{className:"actions-primary",children:!A||E?c.jsx("button",{type:"button",className:"action-btn main",disabled:!s||S,onClick:J,children:t("reports.run")}):c.jsxs(c.Fragment,{children:[c.jsx("button",{type:"button",className:"action-btn",onClick:()=>D(!0),children:t("reports.changeReportFilters")}),re?c.jsx("button",{type:"button",className:"action-btn",onClick:U,disabled:C,children:t(C?"common.loading":"reports.exportExcel")}):null]})})}),A&&!E&&c.jsxs("section",{className:"generic-panel",children:[c.jsx("h3",{children:t(M.titleKey)}),pe.map(B=>c.jsx("p",{children:B},B)),c.jsxs("p",{children:[t("reports.totalRecords"),":"," ",Ie(x.length,{minimumFractionDigits:0,maximumFractionDigits:0})]}),X?c.jsxs("p",{children:[t("budgets.totalBudget"),": ",Ie(X.budgeted)," | ",t("reports.executed"),": ",Ie(X.executed)," | ",t("reports.variance"),": ",Ie(X.variance)]}):c.jsxs(c.Fragment,{children:[c.jsxs("p",{children:[t("transactions.total"),": ",Ie(ee)]}),s==="sales"?c.jsxs("p",{children:[t("transactions.additionalCharges"),": ",Ie(ie)]}):null,(s==="receivable"||s==="payable"||s==="internal_obligations"||s==="cashflow")&&c.jsxs("p",{children:[t("transactions.balance"),": ",Ie(ce)]})]}),c.jsxs("table",{className:"crud-table",children:[c.jsx("thead",{children:X?c.jsxs("tr",{children:[c.jsx("th",{children:t("transactions.concept")}),c.jsx("th",{children:t("budgets.budgetAmount")}),c.jsx("th",{children:t("reports.executed")}),c.jsx("th",{children:t("reports.variance")})]}):c.jsxs("tr",{children:[c.jsx("th",{children:"ID"}),c.jsx("th",{children:t("transactions.date")}),c.jsx("th",{children:t("common.type")}),c.jsx("th",{children:t("transactions.total")}),c.jsx("th",{children:t("transactions.balance")})]})}),c.jsx("tbody",{children:Y.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:X?4:5,children:t("common.empty")})}):X?Y.map(B=>c.jsxs("tr",{children:[c.jsx("td",{children:B.typeLabel}),c.jsx("td",{children:Ie(B.budgeted||0)}),c.jsx("td",{children:Ie(B.executed||0)}),c.jsx("td",{children:Ie(B.variance||0)})]},`${s}-${B.id}`)):Y.map(B=>c.jsxs("tr",{children:[c.jsx("td",{children:B.id}),c.jsx("td",{children:ut(B.date,e)}),c.jsx("td",{children:B.typeLabel}),c.jsx("td",{children:Ie(B.total||0)}),c.jsx("td",{children:Ie(B.balance||0)})]},`${s}-${B.id}-${B.date}`))})]})]})]})}const af='id, name, "isSystemAdmin", "canCreateUsers", "canCreateProfiles", "canVoidTransactions", permissions';async function rb(t){const{data:e,error:n}=await G.from("account_profiles").select(af).eq("accountId",t).order("id",{ascending:!1});if(n)throw n;return e??[]}async function PN(t){const{data:e,error:n}=await G.from("account_profiles").insert(t).select(af).single();if(n)throw n;return e}async function IN(t,e){const{data:n,error:s}=await G.from("account_profiles").update(e).eq("id",t).select(af).single();if(s)throw s;return n}async function EN(t){const{data:e,error:n}=await G.from("users_to_profiles").select('id, "userId", "profileId", account_profiles(name)').eq("accountId",t).order("id",{ascending:!1});if(n)throw n;return e??[]}async function TN({accountId:t,userId:e,profileId:n}){const{error:s}=await G.from("users_to_profiles").delete().eq("accountId",t).eq("userId",e);if(s)throw s;const{error:r}=await G.from("users_to_profiles").insert({accountId:t,userId:e,profileId:n});if(r)throw r}async function NN(t,e){const{data:n,error:s}=await G.from("users_to_profiles").select('id, "profileId", account_profiles(id, name, "isSystemAdmin")').eq("accountId",t).eq("userId",e).maybeSingle();if(s)throw s;return n}const Kd=10,Kl={name:"",canCreateUsers:!1,canCreateProfiles:!1,canVoidTransactions:!1,permissions:{transactions:{read:!0,create:!1,update:!1},concepts:{read:!0,create:!1,update:!1},clients:{read:!0,create:!1,update:!1},providers:{read:!0,create:!1,update:!1}}};function pv(t){return JSON.parse(JSON.stringify(t??Kl.permissions))}function AN(){const{t}=Ee(),{account:e,user:n}=Oe(),[s,r]=j.useState([]),[a,l]=j.useState(""),[u,d]=j.useState(1),[f,m]=j.useState(null),[g,y]=j.useState(!1),[x,_]=j.useState(Kl);j.useEffect(()=>{e?.accountId&&I()},[e?.accountId]);const k=j.useMemo(()=>{const N=(u-1)*Kd;return s.slice(N,N+Kd)},[s,u]),b=["transactions","concepts","clients","providers"],S=["read","create","update"],I=async()=>{try{const N=await rb(e.accountId);r(N),l(""),d(1)}catch{l(t("common.genericLoadError"))}},C=()=>{m(null),_(Kl),y(!1)},T=()=>{m(null),_(Kl),y(!0)},A=N=>{m(N.id),_({name:N.name,canCreateUsers:!!N.canCreateUsers,canCreateProfiles:!!N.canCreateProfiles,canVoidTransactions:!!N.canVoidTransactions,permissions:pv(N.permissions)}),y(!0)},z=N=>{m(null),_({name:`${N.name} (copy)`,canCreateUsers:!!N.canCreateUsers,canCreateProfiles:!!N.canCreateProfiles,canVoidTransactions:!!N.canVoidTransactions,permissions:pv(N.permissions)}),y(!0)},E=N=>{const{name:F,value:H,type:J,checked:Y}=N.target;_(X=>({...X,[F]:J==="checkbox"?Y:H}))},D=(N,F,H)=>{_(J=>({...J,permissions:{...J.permissions,[N]:{...J.permissions[N],[F]:H}}}))},M=async N=>{if(N.preventDefault(),l(""),!N.currentTarget.checkValidity()){N.currentTarget.reportValidity(),l(t("common.requiredFields"));return}if(!e?.accountId||!n?.id){l(t("common.requiredFields"));return}const F={accountId:e.accountId,name:x.name.trim(),canCreateUsers:x.canCreateUsers,canCreateProfiles:x.canCreateProfiles,canVoidTransactions:x.canVoidTransactions,permissions:x.permissions,createdById:n.id};try{f?await IN(f,F):await PN(F),C(),await I()}catch{l(t("common.genericSaveError"))}};return c.jsxs("div",{className:"module-page",children:[c.jsxs("div",{className:"page-header-row",children:[c.jsx("h1",{children:t("profiles.title")}),c.jsx("button",{type:"button",className:"button-link-primary",onClick:T,children:t("profiles.newProfile")})]}),a&&c.jsx("p",{className:"error-text",children:a}),c.jsxs("table",{className:"crud-table",children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:t("common.name")}),c.jsx("th",{children:t("profiles.canCreateUsers")}),c.jsx("th",{children:t("profiles.canCreateProfiles")}),c.jsx("th",{children:t("profiles.canVoidTransactions")}),c.jsx("th",{children:t("common.actions")})]})}),c.jsx("tbody",{children:k.map(N=>c.jsxs("tr",{children:[c.jsx("td",{children:N.name}),c.jsx("td",{children:N.canCreateUsers?t("common.yes"):t("common.no")}),c.jsx("td",{children:N.canCreateProfiles?t("common.yes"):t("common.no")}),c.jsx("td",{children:N.canVoidTransactions?t("common.yes"):t("common.no")}),c.jsx("td",{className:"table-actions",children:c.jsx(kn,{actions:[{key:"edit",label:t("common.edit"),onClick:()=>A(N)},{key:"duplicate",label:t("profiles.duplicate"),onClick:()=>z(N)}]})})]},N.id))})]}),c.jsx(Un,{page:u,pageSize:Kd,totalItems:s.length,onPageChange:d}),g&&c.jsxs("form",{className:"crud-form",onSubmit:M,children:[c.jsx("h3",{children:t(f?"profiles.editProfile":"profiles.createProfile")}),c.jsxs("div",{className:"form-grid-2",children:[c.jsxs("label",{className:"field-block form-span-2",children:[c.jsx("span",{children:t("common.name")}),c.jsx("input",{name:"name",placeholder:t("common.name"),value:x.name,onChange:E,required:!0})]}),c.jsxs("label",{className:"checkbox-field",children:[c.jsx("input",{type:"checkbox",name:"canCreateUsers",checked:x.canCreateUsers,onChange:E}),t("profiles.canCreateUsers")]}),c.jsxs("label",{className:"checkbox-field",children:[c.jsx("input",{type:"checkbox",name:"canCreateProfiles",checked:x.canCreateProfiles,onChange:E}),t("profiles.canCreateProfiles")]}),c.jsxs("label",{className:"checkbox-field form-span-2",children:[c.jsx("input",{type:"checkbox",name:"canVoidTransactions",checked:x.canVoidTransactions,onChange:E}),t("profiles.canVoidTransactions")]})]}),c.jsxs("table",{className:"crud-table",children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:t("profiles.module")}),c.jsx("th",{children:t("profiles.read")}),c.jsx("th",{children:t("profiles.write")}),c.jsx("th",{children:t("profiles.update")})]})}),c.jsx("tbody",{children:b.map(N=>c.jsxs("tr",{children:[c.jsx("td",{children:t(`profiles.modules.${N}`)}),S.map(F=>c.jsx("td",{children:c.jsx("input",{type:"checkbox",checked:!!x.permissions?.[N]?.[F],onChange:H=>D(N,F,H.target.checked)})},F))]},N))})]}),c.jsxs("div",{className:"crud-form-actions",children:[c.jsx("button",{type:"submit",children:t(f?"common.update":"common.create")}),c.jsx("button",{type:"button",className:"button-secondary",onClick:C,children:t("common.cancel")})]})]})]})}async function ON(t){let{data:{session:e}}=await G.auth.getSession();if(e?.access_token||(e=(await G.auth.refreshSession()).data.session),!e?.access_token)throw new Error("Missing auth session for list users request.");const{data:n,error:s}=await G.functions.invoke("list-account-users",{body:{accountId:t},headers:{Authorization:`Bearer ${e.access_token}`}});if(s)throw new Error(`List users function error: ${s.message??"unknown error"}`);if(n?.success===!1)throw new Error(`List users failed: ${n.error??"unknown function error"}`);return n?.users??[]}async function RN(t){const{data:e,error:n}=await G.from("account_user_invitations").select('id, email, status, "profileId", "created_at", "expiresAt", account_profiles(name)').eq("accountId",t).order("id",{ascending:!1});if(n)throw n;return e??[]}async function MN(t){let{data:{session:e}}=await G.auth.getSession();if(e?.access_token||(e=(await G.auth.refreshSession()).data.session),!e?.access_token)throw new Error("Missing auth session for invitation request.");const{data:n,error:s}=await G.functions.invoke("send-invitation",{body:t,headers:{Authorization:`Bearer ${e.access_token}`}});if(s)throw new Error(`Invitation function error: ${s.message??"unknown error"}`);if(n?.success===!1)throw new Error(`Invitation failed: ${n.error??"unknown function error"}`);return n}async function LN(t){let{data:{session:e}}=await G.auth.getSession();if(e?.access_token||(e=(await G.auth.refreshSession()).data.session),!e?.access_token)throw new Error("Missing auth session for invitation resend request.");const{data:n,error:s}=await G.functions.invoke("send-invitation",{body:t,headers:{Authorization:`Bearer ${e.access_token}`}});if(s)throw new Error(`Invitation resend function error: ${s.message??"unknown error"}`);if(n?.success===!1)throw new Error(`Invitation resend failed: ${n.error??"unknown function error"}`);return n}async function DN(t){let{data:{session:e}}=await G.auth.getSession();if(e?.access_token||(e=(await G.auth.refreshSession()).data.session),!e?.access_token)throw new Error("Missing auth session for deactivate user request.");const{data:n,error:s}=await G.functions.invoke("deactivate-account-user",{body:t,headers:{Authorization:`Bearer ${e.access_token}`}});if(s)throw new Error(`Deactivate user function error: ${s.message??"unknown error"}`);if(n?.success===!1)throw new Error(`Deactivate user failed: ${n.error??"unknown function error"}`);return n}function FN(){const{t,language:e}=Ee(),{account:n,user:s}=Oe(),[r,a]=j.useState([]),[l,u]=j.useState([]),[d,f]=j.useState([]),[m,g]=j.useState([]),[y,x]=j.useState({email:"",profileId:""}),[_,k]=j.useState(""),[b,S]=j.useState("");j.useEffect(()=>{n?.accountId&&I()},[n?.accountId]),j.useEffect(()=>{if(!b)return;const M=window.setTimeout(()=>S(""),3200);return()=>window.clearTimeout(M)},[b]);const I=async()=>{try{const[M,N,F,H]=await Promise.all([ON(n.accountId),rb(n.accountId),EN(n.accountId),RN(n.accountId)]);a(M),u(N),f(F),g(H),await $h({accountId:n.accountId}).catch(()=>null),k("")}catch{k(t("common.genericLoadError"))}},C=M=>{const N=d.find(F=>F.userId===M);return N?.profileId?String(N.profileId):""},T=async(M,N)=>{try{if(!N)return;await TN({accountId:n.accountId,userId:M,profileId:Number(N)}),await I()}catch(F){console.error("Invitation error",F),k(F?.message||t("common.genericSaveError"))}},A=M=>{const{name:N,value:F}=M.target;x(H=>({...H,[N]:F}))},z=async M=>{if(M.preventDefault(),k(""),!M.currentTarget.checkValidity()){M.currentTarget.reportValidity(),k(t("common.requiredFields"));return}if(!y.email||!y.profileId||!n?.accountId||!s?.id){k(t("common.requiredFields"));return}try{const N=y.email.trim().toLowerCase();if(m.some(H=>(H.email||"").toLowerCase()===N&&H.status==="sent"&&(!H.expiresAt||new Date(H.expiresAt).getTime()>Date.now()))){k(t("admin.activeInvitationExists"));return}await MN({accountId:n.accountId,email:N,profileId:Number(y.profileId),appUrl:window.location.origin}),x({email:"",profileId:""}),S(t("admin.invitationSent")),await I()}catch(N){k(N?.message||t("common.genericSaveError"))}},E=async M=>{if(!(!n?.accountId||!M))try{k(""),await LN({accountId:n.accountId,resendInvitationId:M,appUrl:window.location.origin}),S(t("admin.invitationResent")),await I()}catch(N){k(N?.message||t("common.genericSaveError"))}},D=async M=>{if(!(!n?.accountId||!M))try{await DN({accountId:n.accountId,userId:M}),await I()}catch(N){k(N?.message||t("common.genericSaveError"))}};return c.jsxs("div",{className:"module-page",children:[c.jsx("h1",{children:t("admin.title")}),_&&c.jsx("p",{className:"error-text",children:_}),b&&c.jsx("div",{className:"app-toast",children:b}),c.jsxs("form",{className:"crud-form",onSubmit:z,children:[c.jsx("h3",{children:t("admin.inviteUser")}),c.jsxs("div",{className:"form-grid-2",children:[c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:t("common.email")}),c.jsx("input",{name:"email",type:"email",placeholder:t("common.email"),value:y.email,onChange:A,required:!0})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:t("admin.profile")}),c.jsxs("select",{name:"profileId",value:y.profileId,onChange:A,required:!0,children:[c.jsx("option",{value:"",children:`-- ${t("admin.selectProfile")} --`}),l.map(M=>c.jsx("option",{value:M.id,children:M.name},M.id))]})]})]}),c.jsx("div",{className:"crud-form-actions",children:c.jsx("button",{type:"submit",children:t("admin.createInvite")})})]}),c.jsxs("table",{className:"crud-table",children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:t("common.email")}),c.jsx("th",{children:t("admin.userId")}),c.jsx("th",{children:t("admin.profile")}),c.jsx("th",{children:t("common.actions")})]})}),c.jsx("tbody",{children:r.map(M=>c.jsxs("tr",{children:[c.jsx("td",{children:M.email??"-"}),c.jsx("td",{children:M.userId}),c.jsx("td",{children:c.jsxs("select",{value:C(M.userId),onChange:N=>T(M.userId,N.target.value),children:[c.jsx("option",{value:"",children:`-- ${t("admin.selectProfile")} --`}),l.map(N=>c.jsx("option",{value:N.id,children:N.name},N.id))]})}),c.jsx("td",{children:M.userId===s?.id?"-":c.jsx("button",{type:"button",className:"button-danger",onClick:()=>D(M.userId),children:t("admin.deactivateUser")})})]},M.userId))})]}),c.jsxs("table",{className:"crud-table",children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:t("common.email")}),c.jsx("th",{children:t("admin.profile")}),c.jsx("th",{children:t("admin.status")}),c.jsx("th",{children:t("admin.expiresAt")}),c.jsx("th",{children:t("common.actions")})]})}),c.jsx("tbody",{children:m.map(M=>c.jsxs("tr",{children:[c.jsx("td",{children:M.email}),c.jsx("td",{children:M.account_profiles?.name??"-"}),c.jsx("td",{children:M.status}),c.jsx("td",{children:Fh(M.expiresAt,e)}),c.jsx("td",{children:M.status==="sent"?c.jsx("button",{type:"button",className:"button-secondary",onClick:()=>E(M.id),children:t("admin.resendInvite")}):"-"})]},M.id))})]})]})}const Wl=[{path:"/account/billing",key:"accountManage.billing",icon:ah},{path:"/account/users",key:"accountManage.users",icon:F_},{path:"/account/profiles",key:"accountManage.profiles",icon:R_},{path:"/account/invitations",key:"accountManage.invitations",icon:T_},{path:"/account/settings",key:"accountManage.settings",icon:O_}];function BN(){const{t}=Ee(),{account:e}=Oe(),{pathname:n}=$n(),[s,r]=j.useState(window.matchMedia("(max-width: 980px)").matches),[a,l]=j.useState(!1),u=j.useRef(null),d=j.useMemo(()=>Wl.find(g=>n.startsWith(g.path))??Wl[0],[n]),f=s?[d]:Wl,m=s?Wl.filter(g=>g.path!==d.path):[];return j.useEffect(()=>{const g=()=>{const y=window.matchMedia("(max-width: 980px)").matches;if(!y&&u.current){const x=u.current.scrollWidth>u.current.clientWidth+2;r(x)}else r(y)};return g(),window.addEventListener("resize",g),()=>window.removeEventListener("resize",g)},[]),j.useEffect(()=>{const g=()=>l(!1);return window.addEventListener("click",g),()=>window.removeEventListener("click",g)},[]),e&&!e.isOriginalAccount?c.jsx(ks,{to:"/",replace:!0}):c.jsx("div",{className:"account-manage-shell",children:c.jsxs("section",{className:"account-manage-content",children:[c.jsxs("nav",{className:"app-menu account-app-menu",children:[c.jsx("div",{className:"app-menu-primary",ref:u,children:f.map(g=>c.jsx(Ra,{to:g.path,className:({isActive:y})=>`app-menu-entry ${y?"active":""}`,children:t(g.key)},g.path))}),m.length>0?c.jsxs("div",{className:"account-menu-overflow-wrap",onClick:g=>g.stopPropagation(),children:[c.jsx("button",{type:"button",className:"action-btn overflow-trigger-btn",onClick:()=>l(g=>!g),children:t("common.more")}),a?c.jsx("div",{className:"account-menu-overflow-dropdown",children:m.map(g=>c.jsx(Ra,{to:g.path,className:({isActive:y})=>`panel-action ${y?"active":""}`,onClick:()=>l(!1),children:t(g.key)},g.path))}):null]}):null]}),c.jsx("div",{className:"workspace-body single-column",children:c.jsx("section",{className:"generic-panel",children:c.jsx(nh,{})})})]})})}const $N={name:"",email:"",phone:"",address:"",reportRetentionDays:30};function zN(){const{t}=Ee(),{account:e,user:n}=Oe(),[s,r]=j.useState($N),[a,l]=j.useState(!1),[u,d]=j.useState(!0),[f,m]=j.useState(""),[g,y]=j.useState("");j.useEffect(()=>{!e?.accountId||!n?.id||x()},[e?.accountId,n?.id]);const x=async()=>{try{d(!0);const[b,S]=await Promise.all([jj(e.accountId),NN(e.accountId,n.id)]);r({name:b.name??"",email:b.email??"",phone:b.phone??"",address:b.address??"",reportRetentionDays:Number(b.reportRetentionDays??30)}),l(!!S?.account_profiles?.isSystemAdmin),m(""),y("")}catch{m(t("common.genericLoadError"))}finally{d(!1)}},_=b=>{const{name:S,value:I}=b.target;r(C=>({...C,[S]:S==="reportRetentionDays"?Number(I||1):I}))},k=async b=>{if(b.preventDefault(),m(""),!b.currentTarget.checkValidity()){b.currentTarget.reportValidity(),m(t("common.requiredFields"));return}if(!e?.accountId||!a){m(t("common.requiredFields"));return}try{await Cj(e.accountId,{name:s.name.trim(),email:s.email.trim()||null,phone:s.phone.trim()||null,address:s.address.trim()||null,reportRetentionDays:Math.max(1,Number(s.reportRetentionDays||30))}),y(t("accountManage.accountSaved")),m("")}catch{m(t("common.genericSaveError"))}};return u?c.jsx("p",{children:t("common.loading")}):c.jsxs("div",{className:"module-page",children:[c.jsx("h1",{children:t("accountManage.accountSettingsTitle")}),!a&&c.jsx("p",{className:"error-text",children:t("accountManage.adminOnly")}),f&&c.jsx("p",{className:"error-text",children:f}),g&&c.jsx("p",{className:"success-text",children:g}),c.jsxs("form",{className:"crud-form",onSubmit:k,children:[c.jsxs("div",{className:"form-grid-2",children:[c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:t("common.name")}),c.jsx("input",{name:"name",value:s.name,onChange:_,disabled:!a,required:!0})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:t("common.email")}),c.jsx("input",{name:"email",type:"email",value:s.email,onChange:_,disabled:!a})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:t("common.phone")}),c.jsx("input",{name:"phone",value:s.phone,onChange:_,disabled:!a})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:t("common.address")}),c.jsx("input",{name:"address",value:s.address,onChange:_,disabled:!a})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:t("accountManage.reportRetentionDays")}),c.jsx("input",{name:"reportRetentionDays",type:"number",min:1,max:3650,value:s.reportRetentionDays,onChange:_,disabled:!a}),c.jsx("small",{children:t("accountManage.reportRetentionHint")})]})]}),c.jsx("div",{className:"crud-form-actions",children:c.jsx("button",{type:"submit",disabled:!a,children:t("common.save")})})]})]})}function UN(){const{t,language:e}=Ee(),{account:n}=Oe(),[s,r]=j.useState(""),[a,l]=j.useState(""),[u,d]=j.useState(!1),f=j.useMemo(()=>{if(!n?.trialEndsAt)return 0;const _=new Date(n.trialEndsAt).getTime()-Date.now();return Math.max(0,Math.ceil(_/(1e3*60*60*24)))},[n?.trialEndsAt]),m=n?.billingStatus==="active"||n?.billingStatus==="past_due"||n?.billingStatus==="incomplete",g=async()=>{if(n?.accountId)try{d(!0),r(""),l("");const _=await Vj({accountId:n.accountId,appUrl:window.location.origin});window.location.href=_.url}catch(_){r(_?.message||t("common.genericLoadError")),d(!1)}},y=async()=>{if(n?.accountId)try{d(!0),r(""),l("");const _=await qj({accountId:n.accountId,appUrl:window.location.origin});window.location.href=_.url}catch(_){r(_?.message||t("common.genericLoadError")),d(!1)}},x=async()=>{if(n?.accountId)try{d(!0),r(""),l("");const _=await $h({accountId:n.accountId});if(_?.requiresApproval&&_?.url){window.location.href=_.url;return}l(t("billing.seatsSynced"))}catch(_){r(_?.message||t("common.genericSaveError"))}finally{d(!1)}};return c.jsxs("div",{className:"module-page",children:[c.jsx("h1",{children:t("billing.title")}),c.jsx("p",{children:t("billing.description")}),c.jsx("p",{children:t("billing.priceHint")}),c.jsxs("p",{children:[t("billing.status"),": ",c.jsx("strong",{children:n?.billingStatus||"-"})]}),c.jsxs("p",{children:[t("billing.trialEndsAt"),": ",c.jsx("strong",{children:Fh(n?.trialEndsAt,e)})]}),c.jsxs("p",{children:[t("billing.trialDaysLeft"),": ",c.jsx("strong",{children:f})]}),s&&c.jsx("p",{className:"error-text",children:s}),a&&c.jsx("p",{children:a}),c.jsxs("div",{className:"crud-form-actions",children:[c.jsx("button",{type:"button",className:"button-link-primary",onClick:g,disabled:u,children:t("billing.startMembership")}),c.jsx("button",{type:"button",className:"button-secondary",onClick:y,disabled:u||!m,children:t("billing.manageSubscription")}),c.jsx("button",{type:"button",className:"button-secondary",onClick:x,disabled:u,children:t("billing.syncSeats")})]}),c.jsx("p",{children:t("billing.paypalManageHint")})]})}function WN(){const{t,language:e}=Ee(),{refreshAccounts:n,switchAccount:s}=Oe(),[r,a]=j.useState([]),[l,u]=j.useState(!0),[d,f]=j.useState(""),[m,g]=j.useState("");j.useEffect(()=>{y()},[]);const y=async()=>{try{u(!0);const _=await Yv();a(_),f("")}catch{a([]),f(t("common.genericLoadError"))}finally{u(!1)}},x=async(_,k)=>{try{const b=await Gv({invitationId:Number(_),email:(k||"").toLowerCase()});await n?.(),b?.accountId&&s?.(Number(b.accountId)),g(t("accountManage.invitationAccepted")),f(""),await y()}catch{f(t("common.genericSaveError"))}};return c.jsxs("div",{className:"module-page",children:[c.jsx("h1",{children:t("accountManage.pendingInvitationsTitle")}),m&&c.jsx("p",{className:"success-text",children:m}),d&&c.jsx("p",{className:"error-text",children:d}),l?c.jsx("p",{children:t("common.loading")}):c.jsxs("table",{className:"crud-table",children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:t("common.account")}),c.jsx("th",{children:t("admin.profile")}),c.jsx("th",{children:t("admin.expiresAt")}),c.jsx("th",{children:t("common.actions")})]})}),c.jsx("tbody",{children:r.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:4,children:t("common.empty")})}):r.map(_=>c.jsxs("tr",{children:[c.jsx("td",{children:_.accounts?.name??`${t("topbar.currentAccount")} #${_.accountId}`}),c.jsx("td",{children:_.account_profiles?.name??"-"}),c.jsx("td",{children:Fh(_.expiresAt,e)}),c.jsx("td",{children:c.jsx("button",{type:"button",className:"button-link-primary",onClick:()=>x(_.id,_.email),children:t("accountManage.acceptInvitation")})})]},_.id))})]})]})}const Gd=10;function VN(){const{t}=Ee(),{account:e}=Oe(),[n,s]=j.useState([]),[r,a]=j.useState(""),[l,u]=j.useState(!0),[d,f]=j.useState(1),[m,g]=is(),y=m.get("create")==="1";j.useEffect(()=>{e?.accountId&&_()},[e?.accountId]);const x=j.useMemo(()=>{const b=(d-1)*Gd;return n.slice(b,b+Gd)},[n,d]),_=async()=>{try{u(!0);const b=await ur(e.accountId);s(b),a(""),f(1)}catch{a(t("common.genericLoadError"))}finally{u(!1)}},k=async b=>{try{await zT(b),await _()}catch{a(t("common.genericSaveError"))}};return c.jsxs("div",{className:"module-page",children:[c.jsx("h1",{children:t("paymentForms.title")}),r&&c.jsx("p",{className:"error-text",children:r}),l?c.jsx("p",{children:t("common.loading")}):n.length===0?c.jsx("p",{children:t("common.empty")}):c.jsxs(c.Fragment,{children:[c.jsxs("table",{className:"crud-table",children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:t("common.name")}),c.jsx("th",{children:t("paymentForms.kind")}),c.jsx("th",{children:t("paymentForms.provider")}),c.jsx("th",{children:t("paymentForms.reference")}),c.jsx("th",{children:t("paymentForms.createInternalPayableOnOutgoingPaymentShort")}),c.jsx("th",{children:t("common.actions")})]})}),c.jsx("tbody",{children:x.map(b=>c.jsxs("tr",{children:[c.jsx("td",{children:b.name}),c.jsx("td",{children:t(`paymentForms.kinds.${b.kind}`)}),c.jsx("td",{children:b.provider||"-"}),c.jsx("td",{children:b.reference||"-"}),c.jsx("td",{children:b.createInternalPayableOnOutgoingPayment?t("common.yes"):t("common.no")}),c.jsx("td",{className:"table-actions",children:c.jsx(kn,{actions:[{key:"edit",label:t("common.edit"),to:`/payment-forms/${b.id}/edit`},{key:"delete",label:t("common.delete"),onClick:()=>k(b.id),danger:!0}]})})]},b.id))})]}),c.jsx(Un,{page:d,pageSize:Gd,totalItems:n.length,onPageChange:f})]}),y?c.jsx("div",{className:"modal-backdrop",onClick:()=>{const b=new URLSearchParams(m);b.delete("create"),g(b)},children:c.jsx("div",{className:"modal-card",onClick:b=>b.stopPropagation(),children:c.jsx(dc,{embedded:!0,onCancel:()=>{const b=new URLSearchParams(m);b.delete("create"),g(b)},onCreated:async()=>{await _();const b=new URLSearchParams(m);b.delete("create"),g(b)}})})}):null]})}function mv(t){return Number(t.total||0)}function qN(){const{t,language:e}=Ee(),{account:n}=Oe(),[s,r]=j.useState([]),[a,l]=j.useState(""),[u,d]=j.useState(new Date(new Date().setDate(1)).toISOString().slice(0,10)),[f,m]=j.useState(new Date().toISOString().slice(0,10)),[g,y]=j.useState(new Date().toISOString().slice(0,10)),[x,_]=j.useState([]),[k,b]=j.useState("");j.useEffect(()=>{n?.accountId&&S()},[n?.accountId]),j.useEffect(()=>{!n?.accountId||!a||I()},[n?.accountId,a]);const S=async()=>{try{const F=(await ur(n.accountId)).filter(H=>H.kind==="bank_account");r(F),F[0]&&l(String(F[0].id)),b("")}catch{b(t("common.genericLoadError"))}},I=async()=>{try{const N=await YT({accountId:n.accountId,accountPaymentFormId:Number(a)});_(N),b("")}catch{b(t("common.genericLoadError"))}},C=j.useMemo(()=>x.filter(N=>N.isActive!==!1),[x]),T=j.useMemo(()=>{const N=new Date(`${u}T00:00:00.000Z`),F=new Date(`${f}T23:59:59.999Z`);return C.filter(H=>{const J=new Date(`${H.date}T00:00:00.000Z`);return J>=N&&J<=F}).reduce((H,J)=>H+mv(J),0)},[C,u,f]),A=j.useMemo(()=>C.filter(N=>N.isReconciled&&N.reconciledAt&&N.reconciledAt<u).reduce((N,F)=>N+mv(F),0),[C,u]),z=j.useMemo(()=>A+T,[A,T]),E=j.useMemo(()=>{const N=new Date(`${u}T00:00:00.000Z`),F=new Date(`${f}T23:59:59.999Z`);return C.filter(H=>{const J=new Date(`${H.date}T00:00:00.000Z`);return J>=N&&J<=F})},[C,u,f]),D=async N=>{try{await JT(N,g),await I()}catch{b(t("common.genericSaveError"))}},M=async N=>{try{await XT(N),await I()}catch{b(t("common.genericSaveError"))}};return c.jsxs("div",{className:"module-page",children:[c.jsx("h1",{children:t("reconciliation.title")}),k&&c.jsx("p",{className:"error-text",children:k}),c.jsxs("section",{className:"generic-panel",children:[c.jsxs("div",{className:"form-grid-2",children:[c.jsxs("label",{className:"field-block form-span-2",children:[c.jsx("span",{children:t("reconciliation.bankAccount")}),c.jsxs("select",{value:a,onChange:N=>l(N.target.value),children:[c.jsx("option",{value:"",children:`-- ${t("transactions.selectAccountPaymentForm")} --`}),s.map(N=>c.jsx("option",{value:N.id,children:pn(N)},N.id))]})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:t("reports.dateFrom")}),c.jsx("input",{type:"date",value:u,onChange:N=>d(N.target.value)})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:t("reports.dateTo")}),c.jsx("input",{type:"date",value:f,onChange:N=>m(N.target.value)})]}),c.jsxs("label",{className:"field-block form-span-2",children:[c.jsx("span",{children:t("reconciliation.reconcileDate")}),c.jsx("input",{type:"date",value:g,onChange:N=>y(N.target.value)}),c.jsx("small",{children:t("reconciliation.reconcileDateHelp")})]})]}),c.jsxs("p",{children:[t("reconciliation.previousBalance"),": ",c.jsx("strong",{children:Ie(A)})]}),c.jsxs("p",{children:[t("reconciliation.currentBalance"),": ",c.jsx("strong",{children:Ie(z)})]}),c.jsxs("p",{children:[t("reconciliation.periodMovementsSum"),": ",c.jsx("strong",{children:Ie(T)})]})]}),c.jsxs("table",{className:"crud-table",children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"ID"}),c.jsx("th",{children:t("transactions.date")}),c.jsx("th",{children:t("transactions.referenceNumber")}),c.jsx("th",{children:t("transactions.total")}),c.jsx("th",{children:t("reconciliation.reconciled")}),c.jsx("th",{children:t("common.actions")})]})}),c.jsx("tbody",{children:E.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:6,children:t("common.empty")})}):E.map(N=>c.jsxs("tr",{children:[c.jsx("td",{children:N.id}),c.jsx("td",{children:ut(N.date,e)}),c.jsx("td",{children:N.referenceNumber||"-"}),c.jsx("td",{children:Ie(N.total)}),c.jsx("td",{children:N.isReconciled?ut(N.reconciledAt,e):"-"}),c.jsxs("td",{className:"table-actions reconciliation-actions",children:[N.isReconciled?null:c.jsx("button",{type:"button",className:"button-secondary",onClick:()=>D(N.id),children:t("reconciliation.reconcile")}),c.jsx(kn,{actions:[{key:"change-reconcile-date",label:t("reconciliation.changeReconcileDate"),onClick:()=>D(N.id),disabled:!N.isReconciled},{key:"unreconcile",label:t("reconciliation.unreconcile"),onClick:()=>M(N.id),disabled:!N.isReconciled,danger:!0}]})]})]},N.id))})]})]})}const HN={date:new Date().toISOString().slice(0,10),name:"",referenceNumber:"",accountPaymentFormId:"",currencyId:"",total:0};function Th({embedded:t=!1,onCancel:e,onCreated:n}){const{t:s}=Ee(),{account:r,user:a}=Oe(),l=Ht(),{id:u}=zn(),d=!t&&!!u,[f,m]=j.useState(HN),[g,y]=j.useState(""),[x,_]=j.useState(d),[k,b]=j.useState(!1),[S,I]=j.useState([]),[C,T]=j.useState([]),[A,z]=j.useState(0);j.useEffect(()=>{r?.accountId&&E()},[r?.accountId]),j.useEffect(()=>{!d||!r?.accountId||D()},[d,u,r?.accountId]);const E=async()=>{try{const[F,H]=await Promise.all([ur(r.accountId),ho(r.accountId)]);I(F),T(H);const J=H.find(Y=>Y.isLocal)?.id;m(Y=>({...Y,currencyId:Y.currencyId||(J?String(J):"")}))}catch{I([]),T([])}},D=async()=>{try{_(!0);const F=await Jx(u);if(!F.isInternalObligation)throw new Error("Not an internal obligation");m({date:F.date||new Date().toISOString().slice(0,10),name:F.name||"",referenceNumber:F.referenceNumber||"",accountPaymentFormId:F.accountPaymentFormId?String(F.accountPaymentFormId):"",currencyId:F.currencyId?String(F.currencyId):"",total:Number(F.total||0)}),z(Number(F.payments||0))}catch{y(s("common.genericLoadError"))}finally{_(!1)}},M=F=>{const{name:H,value:J}=F.target;m(Y=>({...Y,[H]:J}))},N=async F=>{if(F.preventDefault(),y(""),!F.currentTarget.checkValidity()){F.currentTarget.reportValidity(),y(s("common.requiredFields"));return}if(!r?.accountId||!a?.id||!f.currencyId){y(s("common.requiredFields"));return}const H=Number(f.total||0);if(H<=0){y(s("transactions.invalidTransactionAmount"));return}if(H<A){y(s("internalObligations.totalLowerThanPayments"));return}const J={accountId:r.accountId,date:f.date,name:f.name.trim(),referenceNumber:f.referenceNumber.trim()||null,accountPaymentFormId:f.accountPaymentFormId?Number(f.accountPaymentFormId):null,currencyId:Number(f.currencyId),total:H,payments:A,balance:Math.max(H-A,0)};try{b(!0);let Y=null;if(d?Y=await eN(u,J):Y=await ZT({...J,userId:a.id}),t){n?.(Y);return}l("/internal-obligations")}catch{y(s("common.genericSaveError"))}finally{b(!1)}};return c.jsxs("div",{className:t?"":"module-page",children:[t?c.jsx("h3",{children:s(d?"common.edit":"actions.newInternalObligation")}):c.jsxs("div",{className:"page-header-row",children:[c.jsx("h1",{children:s(d?"common.edit":"actions.newInternalObligation")}),c.jsx(st,{to:"/internal-obligations",className:"button-link-secondary",children:s("common.backToList")})]}),g&&c.jsx("p",{className:"error-text",children:g}),x?c.jsx("p",{children:s("common.loading")}):c.jsxs("form",{className:"crud-form",onSubmit:N,children:[c.jsxs("div",{className:"form-grid-2",children:[c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:s("transactions.date")}),c.jsx("input",{type:"date",name:"date",value:f.date,onChange:M,required:!0})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:s("transactions.currency")}),c.jsxs("select",{name:"currencyId",value:f.currencyId,onChange:M,required:!0,children:[c.jsx("option",{value:"",children:`-- ${s("transactions.selectCurrency")} --`}),C.map(F=>c.jsxs("option",{value:F.id,children:[F.name," (",F.symbol,")"]},F.id))]})]}),c.jsxs("label",{className:"field-block form-span-2",children:[c.jsx("span",{children:s("common.name")}),c.jsx("input",{name:"name",value:f.name,onChange:M,required:!0})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:s("paymentForms.title")}),c.jsxs("select",{name:"accountPaymentFormId",value:f.accountPaymentFormId,onChange:M,children:[c.jsx("option",{value:"",children:`-- ${s("transactions.selectAccountPaymentForm")} --`}),S.map(F=>c.jsx("option",{value:F.id,children:pn(F)},F.id))]})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:s("transactions.referenceNumber")}),c.jsx("input",{name:"referenceNumber",value:f.referenceNumber,onChange:M})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:s("transactions.total")}),c.jsx("input",{type:"number",step:"0.01",min:"0",name:"total",value:f.total,onChange:M,required:!0})]})]}),c.jsxs("div",{className:"crud-form-actions",children:[t?c.jsx("button",{type:"button",className:"button-secondary",onClick:()=>e?.(),children:s("common.cancel")}):null,c.jsx("button",{type:"submit",disabled:k,children:s(d?"common.update":"common.create")})]})]})]})}const Yd=10;function KN(){const{t,language:e}=Ee(),{account:n}=Oe(),[s,r]=j.useState([]),[a,l]=j.useState(""),[u,d]=j.useState(!0),[f,m]=j.useState(1),[g,y]=is(),x=g.get("create")==="1";j.useEffect(()=>{n?.accountId&&k()},[n?.accountId]);const _=j.useMemo(()=>{const S=(f-1)*Yd;return s.slice(S,S+Yd)},[s,f]),k=async()=>{try{d(!0);const S=await QT(n.accountId);r(S),l(""),m(1)}catch{l(t("common.genericLoadError"))}finally{d(!1)}},b=async S=>{try{await Yx(S),await k()}catch{l(t("common.genericSaveError"))}};return c.jsxs("div",{className:"module-page",children:[c.jsx("h1",{children:t("internalObligations.title")}),a&&c.jsx("p",{className:"error-text",children:a}),u?c.jsx("p",{children:t("common.loading")}):s.length===0?c.jsx("p",{children:t("common.empty")}):c.jsxs(c.Fragment,{children:[c.jsxs("table",{className:"crud-table",children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"ID"}),c.jsx("th",{children:t("transactions.date")}),c.jsx("th",{children:t("common.name")}),c.jsx("th",{children:t("paymentForms.kind")}),c.jsx("th",{children:t("transactions.referenceNumber")}),c.jsx("th",{children:t("transactions.total")}),c.jsx("th",{children:t("transactions.balance")}),c.jsx("th",{children:t("common.actions")})]})}),c.jsx("tbody",{children:_.map(S=>c.jsxs("tr",{children:[c.jsx("td",{children:S.id}),c.jsx("td",{children:ut(S.date,e)}),c.jsx("td",{children:S.name}),c.jsx("td",{children:S.account_payment_forms?.name||"-"}),c.jsx("td",{children:S.referenceNumber||"-"}),c.jsx("td",{children:Ie(S.total)}),c.jsx("td",{children:Ie(S.balance)}),c.jsx("td",{className:"table-actions",children:c.jsx(kn,{actions:[{key:"edit",label:t("common.edit"),to:`/internal-obligations/${S.id}/edit`},{key:"delete",label:t("common.delete"),onClick:()=>b(S.id),danger:!0}]})})]},S.id))})]}),c.jsx(Un,{page:f,pageSize:Yd,totalItems:s.length,onPageChange:m})]}),x?c.jsx("div",{className:"modal-backdrop",onClick:()=>{const S=new URLSearchParams(g);S.delete("create"),y(S)},children:c.jsx("div",{className:"modal-card",onClick:S=>S.stopPropagation(),children:c.jsx(Th,{embedded:!0,onCancel:()=>{const S=new URLSearchParams(g);S.delete("create"),y(S)},onCreated:async()=>{await k();const S=new URLSearchParams(g);S.delete("create"),y(S)}})})}):null]})}const GN={date:new Date().toISOString().slice(0,10),amount:0,currencyId:"",fromCashFormId:"",toBankFormId:"",referenceNumber:"",description:""};function ib({embedded:t=!1,onCancel:e,onCreated:n}){const{t:s}=Ee(),{account:r,user:a}=Oe(),l=Ht(),[u,d]=j.useState(GN),[f,m]=j.useState([]),[g,y]=j.useState([]),[x,_]=j.useState([]),[k,b]=j.useState([]),[S,I]=j.useState(!1),[C,T]=j.useState(""),A=j.useMemo(()=>f.filter(N=>N.kind==="cashbox"),[f]),z=j.useMemo(()=>f.filter(N=>N.kind==="bank_account"),[f]);j.useEffect(()=>{r?.accountId&&E()},[r?.accountId]);const E=async()=>{try{const[N,F,H,J]=await Promise.all([ur(r.accountId),ho(r.accountId),so(r.accountId),Ri(r.accountId)]);m(N),y(F),_(H),b(J);const Y=F.find(X=>X.isLocal)?.id;d(X=>({...X,currencyId:X.currencyId||String(Y||"")})),T("")}catch{T(s("common.genericLoadError"))}},D=N=>{const{name:F,value:H}=N.target;d(J=>({...J,[F]:H}))},M=async N=>{if(N.preventDefault(),T(""),!N.currentTarget.checkValidity()){N.currentTarget.reportValidity(),T(s("common.requiredFields"));return}if(!r?.accountId||!a?.id||!u.currencyId){T(s("common.requiredFields"));return}const F=Math.abs(Number(u.amount||0));if(!F||!u.fromCashFormId||!u.toBankFormId){T(s("common.requiredFields"));return}const H=k.find(re=>re.isOutgoingPaymentConcept),J=k.find(re=>re.isIncomingPaymentConcept),Y=x.find(re=>re.code==="cash"),X=x.find(re=>re.code==="bank_transfer");if(!H||!J||!Y||!X){T(s("transactions.missingSystemPaymentConcept"));return}try{I(!0);const re=await nN({accountId:r.accountId,userId:a.id,date:u.date,amount:F,currencyId:Number(u.currencyId),referenceNumber:u.referenceNumber,description:u.description,cashPaymentMethodId:Y.id,transferPaymentMethodId:X.id,fromCashFormId:Number(u.fromCashFormId),toBankFormId:Number(u.toBankFormId),outgoingConceptId:H.id,incomingConceptId:J.id});t?n?.(re):l("/bank-deposits")}catch(re){T(re?.message||s("common.genericSaveError"))}finally{I(!1)}};return c.jsxs("div",{className:t?"":"module-page",children:[t?c.jsx("h3",{children:s("actions.newBankDeposit")}):c.jsxs("div",{className:"page-header-row",children:[c.jsx("h1",{children:s("bankDeposits.title")}),c.jsx(st,{to:"/bank-deposits",className:"button-link-secondary",children:s("common.backToList")})]}),C&&c.jsx("p",{className:"error-text",children:C}),c.jsxs("form",{className:"crud-form",onSubmit:M,children:[c.jsxs("div",{className:"form-grid-2",children:[c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:s("transactions.date")}),c.jsx("input",{type:"date",name:"date",value:u.date,onChange:D,required:!0})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:s("transactions.currency")}),c.jsxs("select",{name:"currencyId",value:u.currencyId,onChange:D,required:!0,children:[c.jsx("option",{value:"",children:`-- ${s("transactions.selectCurrency")} --`}),g.map(N=>c.jsxs("option",{value:N.id,children:[N.name," (",N.symbol,")"]},N.id))]})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:s("bankDeposits.fromCash")}),c.jsxs("select",{name:"fromCashFormId",value:u.fromCashFormId,onChange:D,required:!0,children:[c.jsx("option",{value:"",children:`-- ${s("transactions.selectAccountPaymentForm")} --`}),A.map(N=>c.jsx("option",{value:N.id,children:pn(N)},N.id))]})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:s("bankDeposits.toBankAccount")}),c.jsxs("select",{name:"toBankFormId",value:u.toBankFormId,onChange:D,required:!0,children:[c.jsx("option",{value:"",children:`-- ${s("transactions.selectAccountPaymentForm")} --`}),z.map(N=>c.jsx("option",{value:N.id,children:pn(N)},N.id))]})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:s("transactions.amount")}),c.jsx("input",{type:"number",min:"0",step:"0.01",name:"amount",value:u.amount,onChange:D,required:!0})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:s("transactions.referenceNumber")}),c.jsx("input",{name:"referenceNumber",value:u.referenceNumber,onChange:D})]}),c.jsxs("label",{className:"field-block form-span-2",children:[c.jsx("span",{children:s("transactions.description")}),c.jsx("input",{name:"description",value:u.description,onChange:D})]})]}),c.jsxs("div",{className:"crud-form-actions",children:[t?c.jsx("button",{type:"button",className:"button-secondary",onClick:()=>e?.(),children:s("common.cancel")}):null,c.jsx("button",{type:"submit",disabled:S,children:s("common.create")})]})]})]})}const Jd=10;function YN(){const{t,language:e}=Ee(),{account:n}=Oe(),[s,r]=j.useState([]),[a,l]=j.useState(""),[u,d]=j.useState(!0),[f,m]=j.useState(1),[g,y]=is(),x=g.get("create")==="1";j.useEffect(()=>{n?.accountId&&k()},[n?.accountId]);const _=j.useMemo(()=>{const S=(f-1)*Jd;return s.slice(S,S+Jd)},[s,f]),k=async()=>{try{d(!0);const S=await rN(n.accountId);r(S),l(""),m(1)}catch{l(t("common.genericLoadError"))}finally{d(!1)}},b=async S=>{try{await iN(S),await k()}catch{l(t("common.genericSaveError"))}};return c.jsxs("div",{className:"module-page",children:[c.jsx("h1",{children:t("bankDeposits.title")}),a&&c.jsx("p",{className:"error-text",children:a}),u?c.jsx("p",{children:t("common.loading")}):s.length===0?c.jsx("p",{children:t("common.empty")}):c.jsxs(c.Fragment,{children:[c.jsxs("table",{className:"crud-table",children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"ID"}),c.jsx("th",{children:t("transactions.date")}),c.jsx("th",{children:t("common.name")}),c.jsx("th",{children:t("transactions.accountPaymentForm")}),c.jsx("th",{children:t("transactions.referenceNumber")}),c.jsx("th",{children:t("transactions.total")}),c.jsx("th",{children:t("common.actions")})]})}),c.jsx("tbody",{children:_.map(S=>c.jsxs("tr",{children:[c.jsx("td",{children:S.id}),c.jsx("td",{children:ut(S.date,e)}),c.jsx("td",{children:S.name||"-"}),c.jsx("td",{children:S.account_payment_forms?.name||"-"}),c.jsx("td",{children:S.referenceNumber||"-"}),c.jsx("td",{children:Ie(S.total)}),c.jsx("td",{className:"table-actions",children:c.jsx(kn,{actions:[{key:"deactivate",label:t("transactions.deactivate"),onClick:()=>b(S.id),danger:!0}]})})]},S.id))})]}),c.jsx(Un,{page:f,pageSize:Jd,totalItems:s.length,onPageChange:m})]}),x?c.jsx("div",{className:"modal-backdrop",onClick:()=>{const S=new URLSearchParams(g);S.delete("create"),y(S)},children:c.jsx("div",{className:"modal-card",onClick:S=>S.stopPropagation(),children:c.jsx(ib,{embedded:!0,onCancel:()=>{const S=new URLSearchParams(g);S.delete("create"),y(S)},onCreated:async()=>{await k();const S=new URLSearchParams(g);S.delete("create"),y(S)}})})}):null]})}const JN={date:new Date().toISOString().slice(0,10),amount:0,currencyId:"",fromBankFormId:"",toBankFormId:"",referenceNumber:"",description:""};function ab({embedded:t=!1,onCancel:e,onCreated:n}){const{t:s}=Ee(),{account:r,user:a}=Oe(),l=Ht(),[u,d]=j.useState(JN),[f,m]=j.useState([]),[g,y]=j.useState([]),[x,_]=j.useState([]),[k,b]=j.useState([]),[S,I]=j.useState(!1),[C,T]=j.useState(""),A=j.useMemo(()=>f.filter(M=>M.kind==="bank_account"),[f]);j.useEffect(()=>{r?.accountId&&z()},[r?.accountId]);const z=async()=>{try{const[M,N,F,H]=await Promise.all([ur(r.accountId),ho(r.accountId),so(r.accountId),Ri(r.accountId)]);m(M),y(N),_(F),b(H);const J=N.find(Y=>Y.isLocal)?.id;d(Y=>({...Y,currencyId:Y.currencyId||String(J||"")})),T("")}catch{T(s("common.genericLoadError"))}},E=M=>{const{name:N,value:F}=M.target;d(H=>({...H,[N]:F}))},D=async M=>{if(M.preventDefault(),T(""),!M.currentTarget.checkValidity()){M.currentTarget.reportValidity(),T(s("common.requiredFields"));return}if(!r?.accountId||!a?.id||!u.currencyId){T(s("common.requiredFields"));return}const N=Math.abs(Number(u.amount||0));if(!N||!u.fromBankFormId||!u.toBankFormId){T(s("common.requiredFields"));return}if(Number(u.fromBankFormId)===Number(u.toBankFormId)){T(s("bankTransfers.sameAccountError"));return}const F=k.find(re=>re.isOutgoingPaymentConcept),H=k.find(re=>re.isIncomingPaymentConcept),J=x.find(re=>re.code==="bank_transfer");if(!F||!H||!J){T(s("transactions.missingSystemPaymentConcept"));return}const Y=A.find(re=>re.id===Number(u.fromBankFormId)),X=A.find(re=>re.id===Number(u.toBankFormId));try{I(!0);const re=await sN({accountId:r.accountId,userId:a.id,date:u.date,amount:N,currencyId:Number(u.currencyId),referenceNumber:u.referenceNumber,description:u.description,transferPaymentMethodId:J.id,fromBankFormId:Number(u.fromBankFormId),toBankFormId:Number(u.toBankFormId),fromBankLabel:Y?pn(Y):null,toBankLabel:X?pn(X):null,outgoingConceptId:F.id,incomingConceptId:H.id});t?n?.(re):l("/bank-transfers")}catch(re){T(re?.message||s("common.genericSaveError"))}finally{I(!1)}};return c.jsxs("div",{className:t?"":"module-page",children:[t?c.jsx("h3",{children:s("actions.newBankTransfer")}):c.jsxs("div",{className:"page-header-row",children:[c.jsx("h1",{children:s("bankTransfers.title")}),c.jsx(st,{to:"/bank-transfers",className:"button-link-secondary",children:s("common.backToList")})]}),C&&c.jsx("p",{className:"error-text",children:C}),c.jsxs("form",{className:"crud-form",onSubmit:D,children:[c.jsxs("div",{className:"form-grid-2",children:[c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:s("transactions.date")}),c.jsx("input",{type:"date",name:"date",value:u.date,onChange:E,required:!0})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:s("transactions.currency")}),c.jsxs("select",{name:"currencyId",value:u.currencyId,onChange:E,required:!0,children:[c.jsx("option",{value:"",children:`-- ${s("transactions.selectCurrency")} --`}),g.map(M=>c.jsxs("option",{value:M.id,children:[M.name," (",M.symbol,")"]},M.id))]})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:s("bankTransfers.fromBankAccount")}),c.jsxs("select",{name:"fromBankFormId",value:u.fromBankFormId,onChange:E,required:!0,children:[c.jsx("option",{value:"",children:`-- ${s("transactions.selectAccountPaymentForm")} --`}),A.map(M=>c.jsx("option",{value:M.id,children:pn(M)},M.id))]})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:s("bankTransfers.toBankAccount")}),c.jsxs("select",{name:"toBankFormId",value:u.toBankFormId,onChange:E,required:!0,children:[c.jsx("option",{value:"",children:`-- ${s("transactions.selectAccountPaymentForm")} --`}),A.map(M=>c.jsx("option",{value:M.id,children:pn(M)},M.id))]})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:s("transactions.amount")}),c.jsx("input",{type:"number",min:"0",step:"0.01",name:"amount",value:u.amount,onChange:E,required:!0})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:s("transactions.referenceNumber")}),c.jsx("input",{name:"referenceNumber",value:u.referenceNumber,onChange:E})]}),c.jsxs("label",{className:"field-block form-span-2",children:[c.jsx("span",{children:s("transactions.description")}),c.jsx("input",{name:"description",value:u.description,onChange:E})]})]}),c.jsxs("div",{className:"crud-form-actions",children:[t?c.jsx("button",{type:"button",className:"button-secondary",onClick:()=>e?.(),children:s("common.cancel")}):null,c.jsx("button",{type:"submit",disabled:S,children:s("common.create")})]})]})]})}const Xd=10;function XN(){const{t,language:e}=Ee(),{account:n}=Oe(),[s,r]=j.useState([]),[a,l]=j.useState(""),[u,d]=j.useState(!0),[f,m]=j.useState(1),[g,y]=is(),x=g.get("create")==="1";j.useEffect(()=>{n?.accountId&&k()},[n?.accountId]);const _=j.useMemo(()=>{const S=(f-1)*Xd;return s.slice(S,S+Xd)},[s,f]),k=async()=>{try{d(!0);const S=await aN(n.accountId);r(S),l(""),m(1)}catch{l(t("common.genericLoadError"))}finally{d(!1)}},b=async S=>{try{await oN(S),await k()}catch{l(t("common.genericSaveError"))}};return c.jsxs("div",{className:"module-page",children:[c.jsx("h1",{children:t("bankTransfers.title")}),a&&c.jsx("p",{className:"error-text",children:a}),u?c.jsx("p",{children:t("common.loading")}):s.length===0?c.jsx("p",{children:t("common.empty")}):c.jsxs(c.Fragment,{children:[c.jsxs("table",{className:"crud-table",children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"ID"}),c.jsx("th",{children:t("bankTransfers.sourceTransactionId")}),c.jsx("th",{children:t("transactions.date")}),c.jsx("th",{children:t("common.name")}),c.jsx("th",{children:t("bankTransfers.fromBankAccount")}),c.jsx("th",{children:t("bankTransfers.toBankAccount")}),c.jsx("th",{children:t("transactions.referenceNumber")}),c.jsx("th",{children:t("transactions.total")}),c.jsx("th",{children:t("common.actions")})]})}),c.jsx("tbody",{children:_.map(S=>c.jsxs("tr",{children:[c.jsx("td",{children:S.id}),c.jsx("td",{children:S.sourceTransactionId||"-"}),c.jsx("td",{children:ut(S.date,e)}),c.jsx("td",{children:S.name||"-"}),c.jsx("td",{children:S.deliverTo||"-"}),c.jsx("td",{children:S.deliveryAddress||S.account_payment_forms?.name||"-"}),c.jsx("td",{children:S.referenceNumber||"-"}),c.jsx("td",{children:Ie(S.total)}),c.jsx("td",{className:"table-actions",children:c.jsx(kn,{actions:[{key:"deactivate",label:t("transactions.deactivate"),onClick:()=>b(S.id),danger:!0}]})})]},S.id))})]}),c.jsx(Un,{page:f,pageSize:Xd,totalItems:s.length,onPageChange:m})]}),x?c.jsx("div",{className:"modal-backdrop",onClick:()=>{const S=new URLSearchParams(g);S.delete("create"),y(S)},children:c.jsx("div",{className:"modal-card",onClick:S=>S.stopPropagation(),children:c.jsx(ab,{embedded:!0,onCancel:()=>{const S=new URLSearchParams(g);S.delete("create"),y(S)},onCreated:async()=>{await k();const S=new URLSearchParams(g);S.delete("create"),y(S)}})})}):null]})}const Qd=10;function QN(){const{t,language:e}=Ee(),{account:n}=Oe(),[s,r]=j.useState([]),[a,l]=j.useState(""),[u,d]=j.useState(!0),[f,m]=j.useState(1),[g,y]=is(),x=g.get("create")==="1";j.useEffect(()=>{n?.accountId&&k()},[n?.accountId]);const _=j.useMemo(()=>{const S=(f-1)*Qd;return s.slice(S,S+Qd)},[s,f]),k=async()=>{try{d(!0);const S=await ro(n.accountId);r(S),l(""),m(1)}catch{l(t("common.genericLoadError"))}finally{d(!1)}},b=async S=>{try{await hN(S),await k()}catch{l(t("common.genericSaveError"))}};return c.jsxs("div",{className:"module-page",children:[c.jsx("h1",{children:t("projects.title")}),a&&c.jsx("p",{className:"error-text",children:a}),u?c.jsx("p",{children:t("common.loading")}):s.length===0?c.jsx("p",{children:t("common.empty")}):c.jsxs(c.Fragment,{children:[c.jsxs("table",{className:"crud-table",children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:t("common.name")}),c.jsx("th",{children:t("projects.startDate")}),c.jsx("th",{children:t("projects.endDate")}),c.jsx("th",{children:t("transactions.status")}),c.jsx("th",{children:t("common.actions")})]})}),c.jsx("tbody",{children:_.map(S=>c.jsxs("tr",{children:[c.jsx("td",{children:S.name}),c.jsx("td",{children:ut(S.startDate,e)}),c.jsx("td",{children:ut(S.endDate,e)}),c.jsx("td",{children:S.isActive?t("transactions.active"):t("transactions.inactive")}),c.jsx("td",{className:"table-actions",children:c.jsx(kn,{actions:[{key:"edit",label:t("common.edit"),to:`/projects/${S.id}/edit`},{key:"deactivate",label:t("transactions.deactivate"),onClick:()=>b(S.id),danger:!0}]})})]},S.id))})]}),c.jsx(Un,{page:f,pageSize:Qd,totalItems:s.length,onPageChange:m})]}),x?c.jsx("div",{className:"modal-backdrop",onClick:()=>{const S=new URLSearchParams(g);S.delete("create"),y(S)},children:c.jsx("div",{className:"modal-card",onClick:S=>S.stopPropagation(),children:c.jsx(io,{embedded:!0,onCancel:()=>{const S=new URLSearchParams(g);S.delete("create"),y(S)},onCreated:async()=>{await k();const S=new URLSearchParams(g);S.delete("create"),y(S)}})})}):null]})}function ZN(){const{t,language:e}=Ee(),{account:n}=Oe(),{id:s}=zn(),[r,a]=j.useState(null),[l,u]=j.useState([]),[d,f]=j.useState([]),[m,g]=j.useState(""),[y,x]=j.useState(!0);j.useEffect(()=>{!n?.accountId||!s||k()},[n?.accountId,s]);const _=j.useMemo(()=>l.reduce((b,S)=>(b.budgeted+=Number(S.budgeted||0),b.executed+=Number(S.executed||0),b.variance+=Number(S.variance||0),b),{budgeted:0,executed:0,variance:0}),[l]),k=async()=>{try{x(!0);const[b,S,I]=await Promise.all([Qx(s),sb({accountId:n.accountId,projectId:Number(s)}),qT({accountId:n.accountId,projectId:Number(s)})]);a(b),u(S),f(I),g("")}catch{g(t("common.genericLoadError"))}finally{x(!1)}};return c.jsxs("div",{className:"module-page",children:[c.jsxs("div",{className:"page-header-row",children:[c.jsx("h1",{children:t("projects.title")}),c.jsx(st,{to:"/projects",className:"button-link-secondary",children:t("common.backToList")})]}),m&&c.jsx("p",{className:"error-text",children:m}),y?c.jsx("p",{children:t("common.loading")}):c.jsxs(c.Fragment,{children:[c.jsxs("section",{className:"generic-panel",children:[c.jsxs("p",{children:[c.jsxs("strong",{children:[t("common.name"),":"]})," ",r?.name||"-"]}),c.jsxs("p",{children:[c.jsxs("strong",{children:[t("projects.startDate"),":"]})," ",ut(r?.startDate,e)," | ",c.jsxs("strong",{children:[t("projects.endDate"),":"]})," ",ut(r?.endDate,e)]}),c.jsxs("p",{children:[t("budgets.totalBudget"),": ",Ie(_.budgeted)," | ",t("reports.executed"),": ",Ie(_.executed)," |"," ",t("reports.variance"),": ",Ie(_.variance)]})]}),c.jsxs("section",{className:"generic-panel",children:[c.jsx("h3",{children:t("reports.projectExecution")}),c.jsxs("table",{className:"crud-table",children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:t("transactions.concept")}),c.jsx("th",{children:t("budgets.budgetAmount")}),c.jsx("th",{children:t("reports.executed")}),c.jsx("th",{children:t("reports.variance")})]})}),c.jsx("tbody",{children:l.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:4,children:t("common.empty")})}):l.map(b=>c.jsxs("tr",{children:[c.jsx("td",{children:b.conceptName}),c.jsx("td",{children:Ie(b.budgeted)}),c.jsx("td",{className:Number(b.executed||0)>Number(b.budgeted||0)?"text-danger":"",children:Ie(b.executed)}),c.jsx("td",{children:Ie(b.variance)})]},b.id))})]})]}),c.jsxs("section",{className:"generic-panel",children:[c.jsx("h3",{children:t("transactions.detailTitle")}),c.jsxs("table",{className:"crud-table",children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"ID"}),c.jsx("th",{children:t("transactions.date")}),c.jsx("th",{children:t("common.name")}),c.jsx("th",{children:t("transactions.total")})]})}),c.jsx("tbody",{children:d.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:4,children:t("common.empty")})}):d.map(b=>c.jsxs("tr",{children:[c.jsx("td",{children:b.id}),c.jsx("td",{children:ut(b.date,e)}),c.jsx("td",{children:b.name||"-"}),c.jsx("td",{children:Ie(b.total)})]},b.id))})]})]})]})]})}const eA={name:"",periodType:"monthly",periodStart:"",periodEnd:"",projectId:""};function Nh({embedded:t=!1,onCancel:e,onCreated:n}){const{t:s}=Ee(),{account:r,user:a}=Oe(),l=Ht(),{id:u}=zn(),d=!t&&!!u,[f,m]=j.useState(eA),[g,y]=j.useState([]),[x,_]=j.useState([]),[k,b]=j.useState([]),[S,I]=j.useState(""),[C,T]=j.useState(!0),[A,z]=j.useState(!1),E=j.useMemo(()=>x.filter(Y=>!Y.isGroup&&(Y.isIncome||Y.isExpense||Y.isProduct)),[x]);j.useEffect(()=>{r?.accountId&&D()},[r?.accountId]),j.useEffect(()=>{!d||!r?.accountId||M()},[d,u,r?.accountId]);const D=async()=>{try{const[Y,X]=await Promise.all([Ri(r.accountId),ro(r.accountId)]);_(Y),b(X)}catch{I(s("common.genericLoadError"))}finally{d||T(!1)}},M=async()=>{try{T(!0);const[Y,X]=await Promise.all([eb(u),tb(u)]);m({name:Y.name||"",periodType:Y.periodType||"monthly",periodStart:Y.periodStart||"",periodEnd:Y.periodEnd||"",projectId:Y.projectId?String(Y.projectId):""}),y((X||[]).map(re=>({rowId:String(re.id),conceptId:String(re.conceptId),amount:Number(re.amount||0)}))),I("")}catch{I(s("common.genericLoadError"))}finally{T(!1)}},N=()=>{y(Y=>[...Y,{rowId:`${Date.now()}-${Math.random()}`,conceptId:"",amount:0}])},F=(Y,X,re)=>{y(pe=>pe.map(ee=>ee.rowId===Y?{...ee,[X]:re}:ee))},H=Y=>{y(X=>X.filter(re=>re.rowId!==Y))},J=async Y=>{if(Y.preventDefault(),I(""),!Y.currentTarget.checkValidity()){Y.currentTarget.reportValidity(),I(s("common.requiredFields"));return}if(!r?.accountId||!a?.id){I(s("common.requiredFields"));return}const X={accountId:r.accountId,name:f.name.trim(),periodType:f.periodType,periodStart:f.periodStart,periodEnd:f.periodEnd,projectId:f.projectId?Number(f.projectId):null,isActive:!0,createdById:a.id},re=g.filter(pe=>pe.conceptId).map(pe=>({conceptId:Number(pe.conceptId),amount:Number(pe.amount||0)}));if(re.length===0){I(s("common.requiredFields"));return}try{z(!0);let pe=null;if(d?pe=await _N(u,{budget:X,lines:re}):pe=await wN({budget:X,lines:re}),t){n?.(pe);return}l("/budgets")}catch{I(s("common.genericSaveError"))}finally{z(!1)}};return c.jsxs("div",{className:t?"":"module-page",children:[t?c.jsx("h3",{children:s(d?"common.edit":"actions.newBudget")}):c.jsxs("div",{className:"page-header-row",children:[c.jsx("h1",{children:s(d?"common.edit":"actions.newBudget")}),c.jsx(st,{to:"/budgets",className:"button-link-secondary",children:s("common.backToList")})]}),S&&c.jsx("p",{className:"error-text",children:S}),C?c.jsx("p",{children:s("common.loading")}):c.jsxs("form",{className:"crud-form",onSubmit:J,children:[c.jsxs("div",{className:"form-grid-2",children:[c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:s("common.name")}),c.jsx("input",{name:"name",value:f.name,onChange:Y=>m(X=>({...X,name:Y.target.value})),required:!0})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:s("budgets.periodType")}),c.jsxs("select",{name:"periodType",value:f.periodType,onChange:Y=>m(X=>({...X,periodType:Y.target.value})),children:[c.jsx("option",{value:"daily",children:s("budgets.periods.daily")}),c.jsx("option",{value:"weekly",children:s("budgets.periods.weekly")}),c.jsx("option",{value:"monthly",children:s("budgets.periods.monthly")}),c.jsx("option",{value:"yearly",children:s("budgets.periods.yearly")})]})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:s("reports.dateFrom")}),c.jsx("input",{type:"date",name:"periodStart",value:f.periodStart,onChange:Y=>m(X=>({...X,periodStart:Y.target.value}))})]}),c.jsxs("label",{className:"field-block",children:[c.jsx("span",{children:s("reports.dateTo")}),c.jsx("input",{type:"date",name:"periodEnd",value:f.periodEnd,onChange:Y=>m(X=>({...X,periodEnd:Y.target.value}))})]}),c.jsxs("label",{className:"field-block form-span-2",children:[c.jsx("span",{children:s("projects.project")}),c.jsxs("select",{name:"projectId",value:f.projectId,onChange:Y=>m(X=>({...X,projectId:Y.target.value})),children:[c.jsx("option",{value:"",children:`-- ${s("projects.optionalProject")} --`}),k.map(Y=>c.jsx("option",{value:Y.id,children:Y.name},Y.id))]})]})]}),c.jsxs("section",{className:"crud-form-section",children:[c.jsxs("div",{className:"page-header-row",children:[c.jsx("h2",{className:"crud-form-section-title",children:s("budgets.lines")}),c.jsx("button",{type:"button",className:"button-secondary",onClick:N,children:s("budgets.addLine")})]}),c.jsxs("table",{className:"crud-table",children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:s("transactions.concept")}),c.jsx("th",{children:s("budgets.budgetAmount")}),c.jsx("th",{children:s("common.actions")})]})}),c.jsx("tbody",{children:g.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:3,children:s("common.empty")})}):g.map(Y=>c.jsxs("tr",{children:[c.jsx("td",{children:c.jsxs("select",{value:Y.conceptId,onChange:X=>F(Y.rowId,"conceptId",X.target.value),children:[c.jsx("option",{value:"",children:`-- ${s("transactions.selectConcept")} --`}),E.map(X=>c.jsx("option",{value:X.id,children:X.name},X.id))]})}),c.jsx("td",{children:c.jsx("input",{type:"number",step:"0.01",value:Y.amount,onChange:X=>F(Y.rowId,"amount",X.target.value)})}),c.jsx("td",{children:c.jsx("button",{type:"button",className:"button-danger",onClick:()=>H(Y.rowId),children:s("common.delete")})})]},Y.rowId))})]})]}),c.jsxs("div",{className:"crud-form-actions",children:[t?c.jsx("button",{type:"button",className:"button-secondary",onClick:()=>e?.(),children:s("common.cancel")}):null,c.jsx("button",{type:"submit",disabled:A,children:s(d?"common.update":"common.create")})]})]})]})}const Zd=10;function tA(){const{t,language:e}=Ee(),{account:n}=Oe(),[s,r]=j.useState([]),[a,l]=j.useState({}),[u,d]=j.useState(""),[f,m]=j.useState(!0),[g,y]=j.useState(1),[x,_]=is(),k=x.get("create")==="1";j.useEffect(()=>{n?.accountId&&S()},[n?.accountId]);const b=j.useMemo(()=>{const C=(g-1)*Zd;return s.slice(C,C+Zd)},[s,g]),S=async()=>{try{m(!0);const C=await Zx(n.accountId);r(C),y(1),d("");const T={};await Promise.all(C.map(async A=>{const z=await tb(A.id).catch(()=>[]);T[A.id]=z.reduce((E,D)=>E+Number(D.amount||0),0)})),l(T)}catch{d(t("common.genericLoadError"))}finally{m(!1)}},I=async C=>{try{await kN(C),await S()}catch{d(t("common.genericSaveError"))}};return c.jsxs("div",{className:"module-page",children:[c.jsx("h1",{children:t("budgets.title")}),u&&c.jsx("p",{className:"error-text",children:u}),f?c.jsx("p",{children:t("common.loading")}):s.length===0?c.jsx("p",{children:t("common.empty")}):c.jsxs(c.Fragment,{children:[c.jsxs("table",{className:"crud-table",children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:t("common.name")}),c.jsx("th",{children:t("budgets.periodType")}),c.jsx("th",{children:t("reports.dateFrom")}),c.jsx("th",{children:t("reports.dateTo")}),c.jsx("th",{children:t("projects.project")}),c.jsx("th",{children:t("budgets.totalBudget")}),c.jsx("th",{children:t("common.actions")})]})}),c.jsx("tbody",{children:b.map(C=>c.jsxs("tr",{children:[c.jsx("td",{children:c.jsx(st,{to:`/budgets/${C.id}`,children:C.name})}),c.jsx("td",{children:t(`budgets.periods.${C.periodType}`)}),c.jsx("td",{children:ut(C.periodStart,e)}),c.jsx("td",{children:ut(C.periodEnd,e)}),c.jsx("td",{children:C.projects?.name||"-"}),c.jsx("td",{children:Ie(a[C.id]||0)}),c.jsx("td",{className:"table-actions",children:c.jsx(kn,{actions:[{key:"detail",label:t("transactions.viewDetail"),to:`/budgets/${C.id}`},{key:"edit",label:t("common.edit"),to:`/budgets/${C.id}/edit`},{key:"deactivate",label:t("transactions.deactivate"),onClick:()=>I(C.id),danger:!0}]})})]},C.id))})]}),c.jsx(Un,{page:g,pageSize:Zd,totalItems:s.length,onPageChange:y})]}),k?c.jsx("div",{className:"modal-backdrop",onClick:()=>{const C=new URLSearchParams(x);C.delete("create"),_(C)},children:c.jsx("div",{className:"modal-card",onClick:C=>C.stopPropagation(),children:c.jsx(Nh,{embedded:!0,onCancel:()=>{const C=new URLSearchParams(x);C.delete("create"),_(C)},onCreated:async()=>{await S();const C=new URLSearchParams(x);C.delete("create"),_(C)}})})}):null]})}function nA(){const{t,language:e}=Ee(),{account:n}=Oe(),{id:s}=zn(),[r,a]=j.useState(null),[l,u]=j.useState([]),[d,f]=j.useState(""),[m,g]=j.useState(!0);j.useEffect(()=>{!n?.accountId||!s||x()},[n?.accountId,s]);const y=j.useMemo(()=>l.reduce((_,k)=>(_.budgeted+=Number(k.budgeted||0),_.executed+=Number(k.executed||0),_.variance+=Number(k.variance||0),_),{budgeted:0,executed:0,variance:0}),[l]),x=async()=>{try{g(!0);const[_,k]=await Promise.all([eb(s),nb({accountId:n.accountId,budgetId:Number(s)})]);a(_),u(k),f("")}catch{f(t("common.genericLoadError"))}finally{g(!1)}};return c.jsxs("div",{className:"module-page",children:[c.jsxs("div",{className:"page-header-row",children:[c.jsx("h1",{children:t("budgets.title")}),c.jsx(st,{to:"/budgets",className:"button-link-secondary",children:t("common.backToList")})]}),d&&c.jsx("p",{className:"error-text",children:d}),m?c.jsx("p",{children:t("common.loading")}):c.jsxs(c.Fragment,{children:[c.jsxs("section",{className:"generic-panel",children:[c.jsxs("p",{children:[c.jsxs("strong",{children:[t("common.name"),":"]})," ",r?.name||"-"]}),c.jsxs("p",{children:[c.jsxs("strong",{children:[t("budgets.periodType"),":"]})," ",r?.periodType?t(`budgets.periods.${r.periodType}`):"-"]}),c.jsxs("p",{children:[c.jsxs("strong",{children:[t("reports.dateFrom"),":"]})," ",ut(r?.periodStart,e)," | ",c.jsxs("strong",{children:[t("reports.dateTo"),":"]})," ",ut(r?.periodEnd,e)]}),c.jsxs("p",{children:[t("budgets.totalBudget"),": ",Ie(y.budgeted)," | ",t("reports.executed"),": ",Ie(y.executed)," |"," ",t("reports.variance"),": ",Ie(y.variance)]})]}),c.jsxs("table",{className:"crud-table",children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:t("transactions.concept")}),c.jsx("th",{children:t("budgets.budgetAmount")}),c.jsx("th",{children:t("reports.executed")}),c.jsx("th",{children:t("reports.variance")})]})}),c.jsx("tbody",{children:l.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:4,children:t("common.empty")})}):l.map(_=>c.jsxs("tr",{children:[c.jsx("td",{children:_.conceptName}),c.jsx("td",{children:Ie(_.budgeted)}),c.jsx("td",{className:Number(_.executed||0)>Number(_.budgeted||0)?"text-danger":"",children:Ie(_.executed)}),c.jsx("td",{children:Ie(_.variance)})]},_.id))})]})]})]})}function sA(){return c.jsxs(s_,{children:[c.jsx(de,{path:"/login",element:c.jsx(zj,{})}),c.jsx(de,{path:"/register",element:c.jsx(Uj,{})}),c.jsx(de,{path:"/accept-invitation/:invitationId",element:c.jsx(Hj,{})}),c.jsxs(de,{path:"/",element:c.jsx($j,{children:c.jsx(Bj,{})}),children:[c.jsx(de,{index:!0,element:c.jsx(xT,{})}),c.jsx(de,{path:"clients",element:c.jsx(dv,{personType:1,titleKey:"clients.title",basePath:"/clients"})}),c.jsx(de,{path:"clients/new",element:c.jsx($r,{personType:1,titleKey:"actions.newClient",basePath:"/clients"})}),c.jsx(de,{path:"clients/:id/edit",element:c.jsx($r,{personType:1,titleKey:"actions.newClient",basePath:"/clients"})}),c.jsx(de,{path:"providers",element:c.jsx(dv,{personType:2,titleKey:"providers.title",basePath:"/providers"})}),c.jsx(de,{path:"providers/new",element:c.jsx($r,{personType:2,titleKey:"actions.newProvider",basePath:"/providers"})}),c.jsx(de,{path:"providers/:id/edit",element:c.jsx($r,{personType:2,titleKey:"actions.newProvider",basePath:"/providers"})}),c.jsx(de,{path:"employees",element:c.jsx(NT,{})}),c.jsx(de,{path:"employees/new",element:c.jsx(uc,{})}),c.jsx(de,{path:"employees/:id/edit",element:c.jsx(uc,{})}),c.jsx(de,{path:"products",element:c.jsx(Pa,{moduleType:"products",titleKey:"conceptModules.products",basePath:"/products"})}),c.jsx(de,{path:"products/new",element:c.jsx(nn,{moduleType:"products",titleKey:"actions.newProduct",basePath:"/products"})}),c.jsx(de,{path:"products/:id/edit",element:c.jsx(nn,{moduleType:"products",titleKey:"actions.newProduct",basePath:"/products"})}),c.jsx(de,{path:"income-concepts",element:c.jsx(Pa,{moduleType:"income",titleKey:"conceptModules.income",basePath:"/income-concepts"})}),c.jsx(de,{path:"income-concepts/new",element:c.jsx(nn,{moduleType:"income",titleKey:"actions.newIncomeConcept",basePath:"/income-concepts"})}),c.jsx(de,{path:"income-concepts/:id/edit",element:c.jsx(nn,{moduleType:"income",titleKey:"actions.newIncomeConcept",basePath:"/income-concepts"})}),c.jsx(de,{path:"expense-concepts",element:c.jsx(Pa,{moduleType:"expense",titleKey:"conceptModules.expense",basePath:"/expense-concepts"})}),c.jsx(de,{path:"expense-concepts/new",element:c.jsx(nn,{moduleType:"expense",titleKey:"actions.newExpenseConcept",basePath:"/expense-concepts"})}),c.jsx(de,{path:"expense-concepts/:id/edit",element:c.jsx(nn,{moduleType:"expense",titleKey:"actions.newExpenseConcept",basePath:"/expense-concepts"})}),c.jsx(de,{path:"payable-concepts",element:c.jsx(Pa,{moduleType:"payable",titleKey:"conceptModules.payable",basePath:"/payable-concepts"})}),c.jsx(de,{path:"payable-concepts/new",element:c.jsx(nn,{moduleType:"payable",titleKey:"actions.newPayableConcept",basePath:"/payable-concepts"})}),c.jsx(de,{path:"payable-concepts/:id/edit",element:c.jsx(nn,{moduleType:"payable",titleKey:"actions.newPayableConcept",basePath:"/payable-concepts"})}),c.jsx(de,{path:"concept-groups",element:c.jsx(Pa,{moduleType:"groups",titleKey:"conceptModules.groups",basePath:"/concept-groups"})}),c.jsx(de,{path:"concept-groups/new",element:c.jsx(nn,{moduleType:"groups",titleKey:"actions.newConceptGroup",basePath:"/concept-groups"})}),c.jsx(de,{path:"concept-groups/:id/edit",element:c.jsx(nn,{moduleType:"groups",titleKey:"actions.newConceptGroup",basePath:"/concept-groups"})}),c.jsx(de,{path:"sales",element:c.jsx(Ul,{moduleType:"sale"})}),c.jsx(de,{path:"sales/new",element:c.jsx(Oa,{moduleType:"sale"})}),c.jsx(de,{path:"sales/:id",element:c.jsx(fv,{moduleType:"sale"})}),c.jsx(de,{path:"expenses",element:c.jsx(Ul,{moduleType:"expense"})}),c.jsx(de,{path:"expenses/new",element:c.jsx(Oa,{moduleType:"expense"})}),c.jsx(de,{path:"incomes",element:c.jsx(Ul,{moduleType:"income"})}),c.jsx(de,{path:"incomes/new",element:c.jsx(Oa,{moduleType:"income"})}),c.jsx(de,{path:"purchases",element:c.jsx(Ul,{moduleType:"purchase"})}),c.jsx(de,{path:"purchases/new",element:c.jsx(Oa,{moduleType:"purchase"})}),c.jsx(de,{path:"purchases/:id",element:c.jsx(fv,{moduleType:"purchase"})}),c.jsx(de,{path:"payment-forms",element:c.jsx(VN,{})}),c.jsx(de,{path:"payment-forms/new",element:c.jsx(dc,{})}),c.jsx(de,{path:"payment-forms/:id/edit",element:c.jsx(dc,{})}),c.jsx(de,{path:"bank-deposits",element:c.jsx(YN,{})}),c.jsx(de,{path:"bank-deposits/new",element:c.jsx(ib,{})}),c.jsx(de,{path:"bank-transfers",element:c.jsx(XN,{})}),c.jsx(de,{path:"bank-transfers/new",element:c.jsx(ab,{})}),c.jsx(de,{path:"internal-obligations",element:c.jsx(KN,{})}),c.jsx(de,{path:"internal-obligations/new",element:c.jsx(Th,{})}),c.jsx(de,{path:"internal-obligations/:id/edit",element:c.jsx(Th,{})}),c.jsx(de,{path:"bank-reconciliation",element:c.jsx(qN,{})}),c.jsx(de,{path:"projects",element:c.jsx(QN,{})}),c.jsx(de,{path:"projects/new",element:c.jsx(io,{})}),c.jsx(de,{path:"projects/:id",element:c.jsx(ZN,{})}),c.jsx(de,{path:"projects/:id/edit",element:c.jsx(io,{})}),c.jsx(de,{path:"budgets",element:c.jsx(tA,{})}),c.jsx(de,{path:"budgets/new",element:c.jsx(Nh,{})}),c.jsx(de,{path:"budgets/:id",element:c.jsx(nA,{})}),c.jsx(de,{path:"budgets/:id/edit",element:c.jsx(Nh,{})}),c.jsx(de,{path:"reports",element:c.jsx(CN,{})}),c.jsxs(de,{path:"account",element:c.jsx(BN,{}),children:[c.jsx(de,{index:!0,element:c.jsx(ks,{to:"/account/users",replace:!0})}),c.jsx(de,{path:"billing",element:c.jsx(UN,{})}),c.jsx(de,{path:"users",element:c.jsx(FN,{})}),c.jsx(de,{path:"profiles",element:c.jsx(AN,{})}),c.jsx(de,{path:"invitations",element:c.jsx(WN,{})}),c.jsx(de,{path:"settings",element:c.jsx(zN,{})})]}),c.jsx(de,{path:"profiles",element:c.jsx(ks,{to:"/account/profiles",replace:!0})}),c.jsx(de,{path:"admin",element:c.jsx(ks,{to:"/account/users",replace:!0})})]}),c.jsx(de,{path:"*",element:c.jsx(ks,{to:"/",replace:!0})})]})}uw.createRoot(document.getElementById("root")).render(c.jsx(Ps.StrictMode,{children:c.jsx(h_,{children:c.jsx(Tj,{children:c.jsx(Pj,{children:c.jsx(sA,{})})})})}));
